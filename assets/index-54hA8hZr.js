import{$,c as commonjsGlobal,g as getDefaultExportFromCjs,a as getAugmentedNamespace,B as Base64,b as configs,p as parser,s as settings,i as i18n,u as urlParameters,o as overpass,h as htmlentities,l as lzw_decode,d as lzw_encode,_ as _$1,f as ffs_construct_query,e as ffs_repair_search}from"./urlParameters-B9tB8Euw.js";/*! jQuery UI - v1.13.2 - 2022-07-14
* http://jqueryui.com
* Includes: widget.js, position.js, data.js, disable-selection.js, effect.js, effects/effect-blind.js, effects/effect-bounce.js, effects/effect-clip.js, effects/effect-drop.js, effects/effect-explode.js, effects/effect-fade.js, effects/effect-fold.js, effects/effect-highlight.js, effects/effect-puff.js, effects/effect-pulsate.js, effects/effect-scale.js, effects/effect-shake.js, effects/effect-size.js, effects/effect-slide.js, effects/effect-transfer.js, focusable.js, form-reset-mixin.js, jquery-patch.js, keycode.js, labels.js, scroll-parent.js, tabbable.js, unique-id.js, widgets/accordion.js, widgets/autocomplete.js, widgets/button.js, widgets/checkboxradio.js, widgets/controlgroup.js, widgets/datepicker.js, widgets/dialog.js, widgets/draggable.js, widgets/droppable.js, widgets/menu.js, widgets/mouse.js, widgets/progressbar.js, widgets/resizable.js, widgets/selectable.js, widgets/selectmenu.js, widgets/slider.js, widgets/sortable.js, widgets/spinner.js, widgets/tabs.js, widgets/tooltip.js
* Copyright jQuery Foundation and other contributors; Licensed MIT */(function(g){typeof define=="function"&&define.amd?define(["jquery"],g):g($)})(function(g){g.ui=g.ui||{},g.ui.version="1.13.2";/*!
 * jQuery UI Widget 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */var B=0,M=Array.prototype.hasOwnProperty,P=Array.prototype.slice;g.cleanData=function(d){return function(b){var S,k,R;for(R=0;(k=b[R])!=null;R++)S=g._data(k,"events"),S&&S.remove&&g(k).triggerHandler("remove");d(b)}}(g.cleanData),g.widget=function(d,b,S){var k,R,W,se={},le=d.split(".")[0];d=d.split(".")[1];var fe=le+"-"+d;return S||(S=b,b=g.Widget),Array.isArray(S)&&(S=g.extend.apply(null,[{}].concat(S))),g.expr.pseudos[fe.toLowerCase()]=function(be){return!!g.data(be,fe)},g[le]=g[le]||{},k=g[le][d],R=g[le][d]=function(be,Te){if(!this||!this._createWidget)return new R(be,Te);arguments.length&&this._createWidget(be,Te)},g.extend(R,k,{version:S.version,_proto:g.extend({},S),_childConstructors:[]}),W=new b,W.options=g.widget.extend({},W.options),g.each(S,function(be,Te){if(typeof Te!="function"){se[be]=Te;return}se[be]=function(){function Ve(){return b.prototype[be].apply(this,arguments)}function Ue(me){return b.prototype[be].apply(this,me)}return function(){var me=this._super,ke=this._superApply,qe;return this._super=Ve,this._superApply=Ue,qe=Te.apply(this,arguments),this._super=me,this._superApply=ke,qe}}()}),R.prototype=g.widget.extend(W,{widgetEventPrefix:k&&W.widgetEventPrefix||d},se,{constructor:R,namespace:le,widgetName:d,widgetFullName:fe}),k?(g.each(k._childConstructors,function(be,Te){var Ve=Te.prototype;g.widget(Ve.namespace+"."+Ve.widgetName,R,Te._proto)}),delete k._childConstructors):b._childConstructors.push(R),g.widget.bridge(d,R),R},g.widget.extend=function(d){for(var b=P.call(arguments,1),S=0,k=b.length,R,W;S<k;S++)for(R in b[S])W=b[S][R],M.call(b[S],R)&&W!==void 0&&(g.isPlainObject(W)?d[R]=g.isPlainObject(d[R])?g.widget.extend({},d[R],W):g.widget.extend({},W):d[R]=W);return d},g.widget.bridge=function(d,b){var S=b.prototype.widgetFullName||d;g.fn[d]=function(k){var R=typeof k=="string",W=P.call(arguments,1),se=this;return R?!this.length&&k==="instance"?se=void 0:this.each(function(){var le,fe=g.data(this,S);if(k==="instance")return se=fe,!1;if(!fe)return g.error("cannot call methods on "+d+" prior to initialization; attempted to call method '"+k+"'");if(typeof fe[k]!="function"||k.charAt(0)==="_")return g.error("no such method '"+k+"' for "+d+" widget instance");if(le=fe[k].apply(fe,W),le!==fe&&le!==void 0)return se=le&&le.jquery?se.pushStack(le.get()):le,!1}):(W.length&&(k=g.widget.extend.apply(null,[k].concat(W))),this.each(function(){var le=g.data(this,S);le?(le.option(k||{}),le._init&&le._init()):g.data(this,S,new b(k,this))})),se}},g.Widget=function(){},g.Widget._childConstructors=[],g.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(d,b){b=g(b||this.defaultElement||this)[0],this.element=g(b),this.uuid=B++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=g(),this.hoverable=g(),this.focusable=g(),this.classesElementLookup={},b!==this&&(g.data(b,this.widgetFullName,this),this._on(!0,this.element,{remove:function(S){S.target===b&&this.destroy()}}),this.document=g(b.style?b.ownerDocument:b.document||b),this.window=g(this.document[0].defaultView||this.document[0].parentWindow)),this.options=g.widget.extend({},this.options,this._getCreateOptions(),d),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:g.noop,_create:g.noop,_init:g.noop,destroy:function(){var d=this;this._destroy(),g.each(this.classesElementLookup,function(b,S){d._removeClass(S,b)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:g.noop,widget:function(){return this.element},option:function(d,b){var S=d,k,R,W;if(arguments.length===0)return g.widget.extend({},this.options);if(typeof d=="string")if(S={},k=d.split("."),d=k.shift(),k.length){for(R=S[d]=g.widget.extend({},this.options[d]),W=0;W<k.length-1;W++)R[k[W]]=R[k[W]]||{},R=R[k[W]];if(d=k.pop(),arguments.length===1)return R[d]===void 0?null:R[d];R[d]=b}else{if(arguments.length===1)return this.options[d]===void 0?null:this.options[d];S[d]=b}return this._setOptions(S),this},_setOptions:function(d){var b;for(b in d)this._setOption(b,d[b]);return this},_setOption:function(d,b){return d==="classes"&&this._setOptionClasses(b),this.options[d]=b,d==="disabled"&&this._setOptionDisabled(b),this},_setOptionClasses:function(d){var b,S,k;for(b in d)k=this.classesElementLookup[b],!(d[b]===this.options.classes[b]||!k||!k.length)&&(S=g(k.get()),this._removeClass(k,b),S.addClass(this._classes({element:S,keys:b,classes:d,add:!0})))},_setOptionDisabled:function(d){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!d),d&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(d){var b=[],S=this;d=g.extend({element:this.element,classes:this.options.classes||{}},d);function k(){var W=[];d.element.each(function(se,le){var fe=g.map(S.classesElementLookup,function(be){return be}).some(function(be){return be.is(le)});fe||W.push(le)}),S._on(g(W),{remove:"_untrackClassesElement"})}function R(W,se){var le,fe;for(fe=0;fe<W.length;fe++)le=S.classesElementLookup[W[fe]]||g(),d.add?(k(),le=g(g.uniqueSort(le.get().concat(d.element.get())))):le=g(le.not(d.element).get()),S.classesElementLookup[W[fe]]=le,b.push(W[fe]),se&&d.classes[W[fe]]&&b.push(d.classes[W[fe]])}return d.keys&&R(d.keys.match(/\S+/g)||[],!0),d.extra&&R(d.extra.match(/\S+/g)||[]),b.join(" ")},_untrackClassesElement:function(d){var b=this;g.each(b.classesElementLookup,function(S,k){g.inArray(d.target,k)!==-1&&(b.classesElementLookup[S]=g(k.not(d.target).get()))}),this._off(g(d.target))},_removeClass:function(d,b,S){return this._toggleClass(d,b,S,!1)},_addClass:function(d,b,S){return this._toggleClass(d,b,S,!0)},_toggleClass:function(d,b,S,k){k=typeof k=="boolean"?k:S;var R=typeof d=="string"||d===null,W={extra:R?b:S,keys:R?d:b,element:R?this.element:d,add:k};return W.element.toggleClass(this._classes(W),k),this},_on:function(d,b,S){var k,R=this;typeof d!="boolean"&&(S=b,b=d,d=!1),S?(b=k=g(b),this.bindings=this.bindings.add(b)):(S=b,b=this.element,k=this.widget()),g.each(S,function(W,se){function le(){if(!(!d&&(R.options.disabled===!0||g(this).hasClass("ui-state-disabled"))))return(typeof se=="string"?R[se]:se).apply(R,arguments)}typeof se!="string"&&(le.guid=se.guid=se.guid||le.guid||g.guid++);var fe=W.match(/^([\w:-]*)\s*(.*)$/),be=fe[1]+R.eventNamespace,Te=fe[2];Te?k.on(be,Te,le):b.on(be,le)})},_off:function(d,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,d.off(b),this.bindings=g(this.bindings.not(d).get()),this.focusable=g(this.focusable.not(d).get()),this.hoverable=g(this.hoverable.not(d).get())},_delay:function(d,b){function S(){return(typeof d=="string"?k[d]:d).apply(k,arguments)}var k=this;return setTimeout(S,b||0)},_hoverable:function(d){this.hoverable=this.hoverable.add(d),this._on(d,{mouseenter:function(b){this._addClass(g(b.currentTarget),null,"ui-state-hover")},mouseleave:function(b){this._removeClass(g(b.currentTarget),null,"ui-state-hover")}})},_focusable:function(d){this.focusable=this.focusable.add(d),this._on(d,{focusin:function(b){this._addClass(g(b.currentTarget),null,"ui-state-focus")},focusout:function(b){this._removeClass(g(b.currentTarget),null,"ui-state-focus")}})},_trigger:function(d,b,S){var k,R,W=this.options[d];if(S=S||{},b=g.Event(b),b.type=(d===this.widgetEventPrefix?d:this.widgetEventPrefix+d).toLowerCase(),b.target=this.element[0],R=b.originalEvent,R)for(k in R)k in b||(b[k]=R[k]);return this.element.trigger(b,S),!(typeof W=="function"&&W.apply(this.element[0],[b].concat(S))===!1||b.isDefaultPrevented())}},g.each({show:"fadeIn",hide:"fadeOut"},function(d,b){g.Widget.prototype["_"+d]=function(S,k,R){typeof k=="string"&&(k={effect:k});var W,se=k?k===!0||typeof k=="number"?b:k.effect||b:d;k=k||{},typeof k=="number"?k={duration:k}:k===!0&&(k={}),W=!g.isEmptyObject(k),k.complete=R,k.delay&&S.delay(k.delay),W&&g.effects&&g.effects.effect[se]?S[d](k):se!==d&&S[se]?S[se](k.duration,k.easing,R):S.queue(function(le){g(this)[d](),R&&R.call(S[0]),le()})}}),g.widget;/*!
 * jQuery UI Position 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/position/
 */(function(){var d,b=Math.max,S=Math.abs,k=/left|center|right/,R=/top|center|bottom/,W=/[\+\-]\d+(\.[\d]+)?%?/,se=/^\w+/,le=/%$/,fe=g.fn.position;function be(me,ke,qe){return[parseFloat(me[0])*(le.test(me[0])?ke/100:1),parseFloat(me[1])*(le.test(me[1])?qe/100:1)]}function Te(me,ke){return parseInt(g.css(me,ke),10)||0}function Ve(me){return me!=null&&me===me.window}function Ue(me){var ke=me[0];return ke.nodeType===9?{width:me.width(),height:me.height(),offset:{top:0,left:0}}:Ve(ke)?{width:me.width(),height:me.height(),offset:{top:me.scrollTop(),left:me.scrollLeft()}}:ke.preventDefault?{width:0,height:0,offset:{top:ke.pageY,left:ke.pageX}}:{width:me.outerWidth(),height:me.outerHeight(),offset:me.offset()}}g.position={scrollbarWidth:function(){if(d!==void 0)return d;var me,ke,qe=g("<div style='display:block;position:absolute;width:200px;height:200px;overflow:hidden;'><div style='height:300px;width:auto;'></div></div>"),lt=qe.children()[0];return g("body").append(qe),me=lt.offsetWidth,qe.css("overflow","scroll"),ke=lt.offsetWidth,me===ke&&(ke=qe[0].clientWidth),qe.remove(),d=me-ke},getScrollInfo:function(me){var ke=me.isWindow||me.isDocument?"":me.element.css("overflow-x"),qe=me.isWindow||me.isDocument?"":me.element.css("overflow-y"),lt=ke==="scroll"||ke==="auto"&&me.width<me.element[0].scrollWidth,pt=qe==="scroll"||qe==="auto"&&me.height<me.element[0].scrollHeight;return{width:pt?g.position.scrollbarWidth():0,height:lt?g.position.scrollbarWidth():0}},getWithinInfo:function(me){var ke=g(me||window),qe=Ve(ke[0]),lt=!!ke[0]&&ke[0].nodeType===9,pt=!qe&&!lt;return{element:ke,isWindow:qe,isDocument:lt,offset:pt?g(me).offset():{left:0,top:0},scrollLeft:ke.scrollLeft(),scrollTop:ke.scrollTop(),width:ke.outerWidth(),height:ke.outerHeight()}}},g.fn.position=function(me){if(!me||!me.of)return fe.apply(this,arguments);me=g.extend({},me);var ke,qe,lt,pt,Ft,zt,Nt=typeof me.of=="string"?g(document).find(me.of):g(me.of),Mt=g.position.getWithinInfo(me.within),$t=g.position.getScrollInfo(Mt),ri=(me.collision||"flip").split(" "),ci={};return zt=Ue(Nt),Nt[0].preventDefault&&(me.at="left top"),qe=zt.width,lt=zt.height,pt=zt.offset,Ft=g.extend({},pt),g.each(["my","at"],function(){var wt=(me[this]||"").split(" "),di,ii;wt.length===1&&(wt=k.test(wt[0])?wt.concat(["center"]):R.test(wt[0])?["center"].concat(wt):["center","center"]),wt[0]=k.test(wt[0])?wt[0]:"center",wt[1]=R.test(wt[1])?wt[1]:"center",di=W.exec(wt[0]),ii=W.exec(wt[1]),ci[this]=[di?di[0]:0,ii?ii[0]:0],me[this]=[se.exec(wt[0])[0],se.exec(wt[1])[0]]}),ri.length===1&&(ri[1]=ri[0]),me.at[0]==="right"?Ft.left+=qe:me.at[0]==="center"&&(Ft.left+=qe/2),me.at[1]==="bottom"?Ft.top+=lt:me.at[1]==="center"&&(Ft.top+=lt/2),ke=be(ci.at,qe,lt),Ft.left+=ke[0],Ft.top+=ke[1],this.each(function(){var wt,di,ii=g(this),Hi=ii.outerWidth(),Vi=ii.outerHeight(),Ot=Te(this,"marginLeft"),_i=Te(this,"marginTop"),Ti=Hi+Ot+Te(this,"marginRight")+$t.width,Wi=Vi+_i+Te(this,"marginBottom")+$t.height,Zt=g.extend({},Ft),mi=be(ci.my,ii.outerWidth(),ii.outerHeight());me.my[0]==="right"?Zt.left-=Hi:me.my[0]==="center"&&(Zt.left-=Hi/2),me.my[1]==="bottom"?Zt.top-=Vi:me.my[1]==="center"&&(Zt.top-=Vi/2),Zt.left+=mi[0],Zt.top+=mi[1],wt={marginLeft:Ot,marginTop:_i},g.each(["left","top"],function(bi,$i){g.ui.position[ri[bi]]&&g.ui.position[ri[bi]][$i](Zt,{targetWidth:qe,targetHeight:lt,elemWidth:Hi,elemHeight:Vi,collisionPosition:wt,collisionWidth:Ti,collisionHeight:Wi,offset:[ke[0]+mi[0],ke[1]+mi[1]],my:me.my,at:me.at,within:Mt,elem:ii})}),me.using&&(di=function(bi){var $i=pt.left-Zt.left,tr=$i+qe-Hi,Ar=pt.top-Zt.top,Tr=Ar+lt-Vi,ji={target:{element:Nt,left:pt.left,top:pt.top,width:qe,height:lt},element:{element:ii,left:Zt.left,top:Zt.top,width:Hi,height:Vi},horizontal:tr<0?"left":$i>0?"right":"center",vertical:Tr<0?"top":Ar>0?"bottom":"middle"};qe<Hi&&S($i+tr)<qe&&(ji.horizontal="center"),lt<Vi&&S(Ar+Tr)<lt&&(ji.vertical="middle"),b(S($i),S(tr))>b(S(Ar),S(Tr))?ji.important="horizontal":ji.important="vertical",me.using.call(this,bi,ji)}),ii.offset(g.extend(Zt,{using:di}))})},g.ui.position={fit:{left:function(me,ke){var qe=ke.within,lt=qe.isWindow?qe.scrollLeft:qe.offset.left,pt=qe.width,Ft=me.left-ke.collisionPosition.marginLeft,zt=lt-Ft,Nt=Ft+ke.collisionWidth-pt-lt,Mt;ke.collisionWidth>pt?zt>0&&Nt<=0?(Mt=me.left+zt+ke.collisionWidth-pt-lt,me.left+=zt-Mt):Nt>0&&zt<=0?me.left=lt:zt>Nt?me.left=lt+pt-ke.collisionWidth:me.left=lt:zt>0?me.left+=zt:Nt>0?me.left-=Nt:me.left=b(me.left-Ft,me.left)},top:function(me,ke){var qe=ke.within,lt=qe.isWindow?qe.scrollTop:qe.offset.top,pt=ke.within.height,Ft=me.top-ke.collisionPosition.marginTop,zt=lt-Ft,Nt=Ft+ke.collisionHeight-pt-lt,Mt;ke.collisionHeight>pt?zt>0&&Nt<=0?(Mt=me.top+zt+ke.collisionHeight-pt-lt,me.top+=zt-Mt):Nt>0&&zt<=0?me.top=lt:zt>Nt?me.top=lt+pt-ke.collisionHeight:me.top=lt:zt>0?me.top+=zt:Nt>0?me.top-=Nt:me.top=b(me.top-Ft,me.top)}},flip:{left:function(me,ke){var qe=ke.within,lt=qe.offset.left+qe.scrollLeft,pt=qe.width,Ft=qe.isWindow?qe.scrollLeft:qe.offset.left,zt=me.left-ke.collisionPosition.marginLeft,Nt=zt-Ft,Mt=zt+ke.collisionWidth-pt-Ft,$t=ke.my[0]==="left"?-ke.elemWidth:ke.my[0]==="right"?ke.elemWidth:0,ri=ke.at[0]==="left"?ke.targetWidth:ke.at[0]==="right"?-ke.targetWidth:0,ci=-2*ke.offset[0],wt,di;Nt<0?(wt=me.left+$t+ri+ci+ke.collisionWidth-pt-lt,(wt<0||wt<S(Nt))&&(me.left+=$t+ri+ci)):Mt>0&&(di=me.left-ke.collisionPosition.marginLeft+$t+ri+ci-Ft,(di>0||S(di)<Mt)&&(me.left+=$t+ri+ci))},top:function(me,ke){var qe=ke.within,lt=qe.offset.top+qe.scrollTop,pt=qe.height,Ft=qe.isWindow?qe.scrollTop:qe.offset.top,zt=me.top-ke.collisionPosition.marginTop,Nt=zt-Ft,Mt=zt+ke.collisionHeight-pt-Ft,$t=ke.my[1]==="top",ri=$t?-ke.elemHeight:ke.my[1]==="bottom"?ke.elemHeight:0,ci=ke.at[1]==="top"?ke.targetHeight:ke.at[1]==="bottom"?-ke.targetHeight:0,wt=-2*ke.offset[1],di,ii;Nt<0?(ii=me.top+ri+ci+wt+ke.collisionHeight-pt-lt,(ii<0||ii<S(Nt))&&(me.top+=ri+ci+wt)):Mt>0&&(di=me.top-ke.collisionPosition.marginTop+ri+ci+wt-Ft,(di>0||S(di)<Mt)&&(me.top+=ri+ci+wt))}},flipfit:{left:function(){g.ui.position.flip.left.apply(this,arguments),g.ui.position.fit.left.apply(this,arguments)},top:function(){g.ui.position.flip.top.apply(this,arguments),g.ui.position.fit.top.apply(this,arguments)}}}})(),g.ui.position;/*!
 * jQuery UI :data 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.extend(g.expr.pseudos,{data:g.expr.createPseudo?g.expr.createPseudo(function(d){return function(b){return!!g.data(b,d)}}):function(d,b,S){return!!g.data(d,S[3])}});/*!
 * jQuery UI Disable Selection 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.fn.extend({disableSelection:function(){var d="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(d+".ui-disableSelection",function(b){b.preventDefault()})}}(),enableSelection:function(){return this.off(".ui-disableSelection")}});var K=g;/*!
 * jQuery Color Animations v2.2.0
 * https://github.com/jquery/jquery-color
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: Sun May 10 09:02:36 2020 +0200
 */var Y="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",re={},D=re.toString,ne=/^([\-+])=\s*(\d+\.?\d*)/,ae=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(d){return[d[1],d[2],d[3],d[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(d){return[d[1]*2.55,d[2]*2.55,d[3]*2.55,d[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})?/,parse:function(d){return[parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16),d[4]?(parseInt(d[4],16)/255).toFixed(2):1]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])?/,parse:function(d){return[parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16),d[4]?(parseInt(d[4]+d[4],16)/255).toFixed(2):1]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(d){return[d[1],d[2]/100,d[3]/100,d[4]]}}],ue=K.Color=function(d,b,S,k){return new K.Color.fn.parse(d,b,S,k)},ge={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},Be={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},De=ue.support={},ze=K("<p>")[0],Oe,Je=K.each;ze.style.cssText="background-color:rgba(1,1,1,.5)",De.rgba=ze.style.backgroundColor.indexOf("rgba")>-1,Je(ge,function(d,b){b.cache="_"+d,b.props.alpha={idx:3,type:"percent",def:1}}),K.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(d,b){re["[object "+b+"]"]=b.toLowerCase()});function We(d){return d==null?d+"":typeof d=="object"?re[D.call(d)]||"object":typeof d}function ut(d,b,S){var k=Be[b.type]||{};return d==null?S||!b.def?null:b.def:(d=k.floor?~~d:parseFloat(d),isNaN(d)?b.def:k.mod?(d+k.mod)%k.mod:Math.min(k.max,Math.max(0,d)))}function et(d){var b=ue(),S=b._rgba=[];return d=d.toLowerCase(),Je(ae,function(k,R){var W,se=R.re.exec(d),le=se&&R.parse(se),fe=R.space||"rgba";if(le)return W=b[fe](le),b[ge[fe].cache]=W[ge[fe].cache],S=b._rgba=W._rgba,!1}),S.length?(S.join()==="0,0,0,0"&&K.extend(S,Oe.transparent),b):Oe[d]}ue.fn=K.extend(ue.prototype,{parse:function(d,b,S,k){if(d===void 0)return this._rgba=[null,null,null,null],this;(d.jquery||d.nodeType)&&(d=K(d).css(b),b=void 0);var R=this,W=We(d),se=this._rgba=[];if(b!==void 0&&(d=[d,b,S,k],W="array"),W==="string")return this.parse(et(d)||Oe._default);if(W==="array")return Je(ge.rgba.props,function(le,fe){se[fe.idx]=ut(d[fe.idx],fe)}),this;if(W==="object")return d instanceof ue?Je(ge,function(le,fe){d[fe.cache]&&(R[fe.cache]=d[fe.cache].slice())}):Je(ge,function(le,fe){var be=fe.cache;Je(fe.props,function(Te,Ve){if(!R[be]&&fe.to){if(Te==="alpha"||d[Te]==null)return;R[be]=fe.to(R._rgba)}R[be][Ve.idx]=ut(d[Te],Ve,!0)}),R[be]&&K.inArray(null,R[be].slice(0,3))<0&&(R[be][3]==null&&(R[be][3]=1),fe.from&&(R._rgba=fe.from(R[be])))}),this},is:function(d){var b=ue(d),S=!0,k=this;return Je(ge,function(R,W){var se,le=b[W.cache];return le&&(se=k[W.cache]||W.to&&W.to(k._rgba)||[],Je(W.props,function(fe,be){if(le[be.idx]!=null)return S=le[be.idx]===se[be.idx],S})),S}),S},_space:function(){var d=[],b=this;return Je(ge,function(S,k){b[k.cache]&&d.push(S)}),d.pop()},transition:function(d,b){var S=ue(d),k=S._space(),R=ge[k],W=this.alpha()===0?ue("transparent"):this,se=W[R.cache]||R.to(W._rgba),le=se.slice();return S=S[R.cache],Je(R.props,function(fe,be){var Te=be.idx,Ve=se[Te],Ue=S[Te],me=Be[be.type]||{};Ue!==null&&(Ve===null?le[Te]=Ue:(me.mod&&(Ue-Ve>me.mod/2?Ve+=me.mod:Ve-Ue>me.mod/2&&(Ve-=me.mod)),le[Te]=ut((Ue-Ve)*b+Ve,be)))}),this[k](le)},blend:function(d){if(this._rgba[3]===1)return this;var b=this._rgba.slice(),S=b.pop(),k=ue(d)._rgba;return ue(K.map(b,function(R,W){return(1-S)*k[W]+S*R}))},toRgbaString:function(){var d="rgba(",b=K.map(this._rgba,function(S,k){return S??(k>2?1:0)});return b[3]===1&&(b.pop(),d="rgb("),d+b.join()+")"},toHslaString:function(){var d="hsla(",b=K.map(this.hsla(),function(S,k){return S==null&&(S=k>2?1:0),k&&k<3&&(S=Math.round(S*100)+"%"),S});return b[3]===1&&(b.pop(),d="hsl("),d+b.join()+")"},toHexString:function(d){var b=this._rgba.slice(),S=b.pop();return d&&b.push(~~(S*255)),"#"+K.map(b,function(k){return k=(k||0).toString(16),k.length===1?"0"+k:k}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}}),ue.fn.parse.prototype=ue.fn;function At(d,b,S){return S=(S+1)%1,S*6<1?d+(b-d)*S*6:S*2<1?b:S*3<2?d+(b-d)*(2/3-S)*6:d}ge.hsla.to=function(d){if(d[0]==null||d[1]==null||d[2]==null)return[null,null,null,d[3]];var b=d[0]/255,S=d[1]/255,k=d[2]/255,R=d[3],W=Math.max(b,S,k),se=Math.min(b,S,k),le=W-se,fe=W+se,be=fe*.5,Te,Ve;return se===W?Te=0:b===W?Te=60*(S-k)/le+360:S===W?Te=60*(k-b)/le+120:Te=60*(b-S)/le+240,le===0?Ve=0:be<=.5?Ve=le/fe:Ve=le/(2-fe),[Math.round(Te)%360,Ve,be,R??1]},ge.hsla.from=function(d){if(d[0]==null||d[1]==null||d[2]==null)return[null,null,null,d[3]];var b=d[0]/360,S=d[1],k=d[2],R=d[3],W=k<=.5?k*(1+S):k+S-k*S,se=2*k-W;return[Math.round(At(se,W,b+1/3)*255),Math.round(At(se,W,b)*255),Math.round(At(se,W,b-1/3)*255),R]},Je(ge,function(d,b){var S=b.props,k=b.cache,R=b.to,W=b.from;ue.fn[d]=function(se){if(R&&!this[k]&&(this[k]=R(this._rgba)),se===void 0)return this[k].slice();var le,fe=We(se),be=fe==="array"||fe==="object"?se:arguments,Te=this[k].slice();return Je(S,function(Ve,Ue){var me=be[fe==="object"?Ve:Ue.idx];me==null&&(me=Te[Ue.idx]),Te[Ue.idx]=ut(me,Ue)}),W?(le=ue(W(Te)),le[k]=Te,le):ue(Te)},Je(S,function(se,le){ue.fn[se]||(ue.fn[se]=function(fe){var be,Te,Ve,Ue,me=We(fe);return se==="alpha"?Ue=this._hsla?"hsla":"rgba":Ue=d,be=this[Ue](),Te=be[le.idx],me==="undefined"?Te:(me==="function"&&(fe=fe.call(this,Te),me=We(fe)),fe==null&&le.empty?this:(me==="string"&&(Ve=ne.exec(fe),Ve&&(fe=Te+parseFloat(Ve[2])*(Ve[1]==="+"?1:-1))),be[le.idx]=fe,this[Ue](be)))})})}),ue.hook=function(d){var b=d.split(" ");Je(b,function(S,k){K.cssHooks[k]={set:function(R,W){var se,le,fe="";if(W!=="transparent"&&(We(W)!=="string"||(se=et(W)))){if(W=ue(se||W),!De.rgba&&W._rgba[3]!==1){for(le=k==="backgroundColor"?R.parentNode:R;(fe===""||fe==="transparent")&&le&&le.style;)try{fe=K.css(le,"backgroundColor"),le=le.parentNode}catch{}W=W.blend(fe&&fe!=="transparent"?fe:"_default")}W=W.toRgbaString()}try{R.style[k]=W}catch{}}},K.fx.step[k]=function(R){R.colorInit||(R.start=ue(R.elem,k),R.end=ue(R.end),R.colorInit=!0),K.cssHooks[k].set(R.elem,R.start.transition(R.end,R.pos))}})},ue.hook(Y),K.cssHooks.borderColor={expand:function(d){var b={};return Je(["Top","Right","Bottom","Left"],function(S,k){b["border"+k+"Color"]=d}),b}},Oe=K.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"};/*!
 * jQuery UI Effects 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */var nt="ui-effects-",ft="ui-effects-style",Tt="ui-effects-animated";g.effects={effect:{}},function(){var d=["add","remove","toggle"],b={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};g.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(W,se){g.fx.step[se]=function(le){(le.end!=="none"&&!le.setAttr||le.pos===1&&!le.setAttr)&&(K.style(le.elem,se,le.end),le.setAttr=!0)}});function S(W){return W.replace(/-([\da-z])/gi,function(se,le){return le.toUpperCase()})}function k(W){var se,le,fe=W.ownerDocument.defaultView?W.ownerDocument.defaultView.getComputedStyle(W,null):W.currentStyle,be={};if(fe&&fe.length&&fe[0]&&fe[fe[0]])for(le=fe.length;le--;)se=fe[le],typeof fe[se]=="string"&&(be[S(se)]=fe[se]);else for(se in fe)typeof fe[se]=="string"&&(be[se]=fe[se]);return be}function R(W,se){var le={},fe,be;for(fe in se)be=se[fe],W[fe]!==be&&(b[fe]||(g.fx.step[fe]||!isNaN(parseFloat(be)))&&(le[fe]=be));return le}g.fn.addBack||(g.fn.addBack=function(W){return this.add(W==null?this.prevObject:this.prevObject.filter(W))}),g.effects.animateClass=function(W,se,le,fe){var be=g.speed(se,le,fe);return this.queue(function(){var Te=g(this),Ve=Te.attr("class")||"",Ue,me=be.children?Te.find("*").addBack():Te;me=me.map(function(){var ke=g(this);return{el:ke,start:k(this)}}),Ue=function(){g.each(d,function(ke,qe){W[qe]&&Te[qe+"Class"](W[qe])})},Ue(),me=me.map(function(){return this.end=k(this.el[0]),this.diff=R(this.start,this.end),this}),Te.attr("class",Ve),me=me.map(function(){var ke=this,qe=g.Deferred(),lt=g.extend({},be,{queue:!1,complete:function(){qe.resolve(ke)}});return this.el.animate(this.diff,lt),qe.promise()}),g.when.apply(g,me.get()).done(function(){Ue(),g.each(arguments,function(){var ke=this.el;g.each(this.diff,function(qe){ke.css(qe,"")})}),be.complete.call(Te[0])})})},g.fn.extend({addClass:function(W){return function(se,le,fe,be){return le?g.effects.animateClass.call(this,{add:se},le,fe,be):W.apply(this,arguments)}}(g.fn.addClass),removeClass:function(W){return function(se,le,fe,be){return arguments.length>1?g.effects.animateClass.call(this,{remove:se},le,fe,be):W.apply(this,arguments)}}(g.fn.removeClass),toggleClass:function(W){return function(se,le,fe,be,Te){return typeof le=="boolean"||le===void 0?fe?g.effects.animateClass.call(this,le?{add:se}:{remove:se},fe,be,Te):W.apply(this,arguments):g.effects.animateClass.call(this,{toggle:se},le,fe,be)}}(g.fn.toggleClass),switchClass:function(W,se,le,fe,be){return g.effects.animateClass.call(this,{add:se,remove:W},le,fe,be)}})}(),function(){g.expr&&g.expr.pseudos&&g.expr.pseudos.animated&&(g.expr.pseudos.animated=function(k){return function(R){return!!g(R).data(Tt)||k(R)}}(g.expr.pseudos.animated)),g.uiBackCompat!==!1&&g.extend(g.effects,{save:function(k,R){for(var W=0,se=R.length;W<se;W++)R[W]!==null&&k.data(nt+R[W],k[0].style[R[W]])},restore:function(k,R){for(var W,se=0,le=R.length;se<le;se++)R[se]!==null&&(W=k.data(nt+R[se]),k.css(R[se],W))},setMode:function(k,R){return R==="toggle"&&(R=k.is(":hidden")?"show":"hide"),R},createWrapper:function(k){if(k.parent().is(".ui-effects-wrapper"))return k.parent();var R={width:k.outerWidth(!0),height:k.outerHeight(!0),float:k.css("float")},W=g("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),se={width:k.width(),height:k.height()},le=document.activeElement;try{le.id}catch{le=document.body}return k.wrap(W),(k[0]===le||g.contains(k[0],le))&&g(le).trigger("focus"),W=k.parent(),k.css("position")==="static"?(W.css({position:"relative"}),k.css({position:"relative"})):(g.extend(R,{position:k.css("position"),zIndex:k.css("z-index")}),g.each(["top","left","bottom","right"],function(fe,be){R[be]=k.css(be),isNaN(parseInt(R[be],10))&&(R[be]="auto")}),k.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),k.css(se),W.css(R).show()},removeWrapper:function(k){var R=document.activeElement;return k.parent().is(".ui-effects-wrapper")&&(k.parent().replaceWith(k),(k[0]===R||g.contains(k[0],R))&&g(R).trigger("focus")),k}}),g.extend(g.effects,{version:"1.13.2",define:function(k,R,W){return W||(W=R,R="effect"),g.effects.effect[k]=W,g.effects.effect[k].mode=R,W},scaledDimensions:function(k,R,W){if(R===0)return{height:0,width:0,outerHeight:0,outerWidth:0};var se=W!=="horizontal"?(R||100)/100:1,le=W!=="vertical"?(R||100)/100:1;return{height:k.height()*le,width:k.width()*se,outerHeight:k.outerHeight()*le,outerWidth:k.outerWidth()*se}},clipToBox:function(k){return{width:k.clip.right-k.clip.left,height:k.clip.bottom-k.clip.top,left:k.clip.left,top:k.clip.top}},unshift:function(k,R,W){var se=k.queue();R>1&&se.splice.apply(se,[1,0].concat(se.splice(R,W))),k.dequeue()},saveStyle:function(k){k.data(ft,k[0].style.cssText)},restoreStyle:function(k){k[0].style.cssText=k.data(ft)||"",k.removeData(ft)},mode:function(k,R){var W=k.is(":hidden");return R==="toggle"&&(R=W?"show":"hide"),(W?R==="hide":R==="show")&&(R="none"),R},getBaseline:function(k,R){var W,se;switch(k[0]){case"top":W=0;break;case"middle":W=.5;break;case"bottom":W=1;break;default:W=k[0]/R.height}switch(k[1]){case"left":se=0;break;case"center":se=.5;break;case"right":se=1;break;default:se=k[1]/R.width}return{x:se,y:W}},createPlaceholder:function(k){var R,W=k.css("position"),se=k.position();return k.css({marginTop:k.css("marginTop"),marginBottom:k.css("marginBottom"),marginLeft:k.css("marginLeft"),marginRight:k.css("marginRight")}).outerWidth(k.outerWidth()).outerHeight(k.outerHeight()),/^(static|relative)/.test(W)&&(W="absolute",R=g("<"+k[0].nodeName+">").insertAfter(k).css({display:/^(inline|ruby)/.test(k.css("display"))?"inline-block":"block",visibility:"hidden",marginTop:k.css("marginTop"),marginBottom:k.css("marginBottom"),marginLeft:k.css("marginLeft"),marginRight:k.css("marginRight"),float:k.css("float")}).outerWidth(k.outerWidth()).outerHeight(k.outerHeight()).addClass("ui-effects-placeholder"),k.data(nt+"placeholder",R)),k.css({position:W,left:se.left,top:se.top}),R},removePlaceholder:function(k){var R=nt+"placeholder",W=k.data(R);W&&(W.remove(),k.removeData(R))},cleanUp:function(k){g.effects.restoreStyle(k),g.effects.removePlaceholder(k)},setTransition:function(k,R,W,se){return se=se||{},g.each(R,function(le,fe){var be=k.cssUnit(fe);be[0]>0&&(se[fe]=be[0]*W+be[1])}),se}});function d(k,R,W,se){return g.isPlainObject(k)&&(R=k,k=k.effect),k={effect:k},R==null&&(R={}),typeof R=="function"&&(se=R,W=null,R={}),(typeof R=="number"||g.fx.speeds[R])&&(se=W,W=R,R={}),typeof W=="function"&&(se=W,W=null),R&&g.extend(k,R),W=W||R.duration,k.duration=g.fx.off?0:typeof W=="number"?W:W in g.fx.speeds?g.fx.speeds[W]:g.fx.speeds._default,k.complete=se||R.complete,k}function b(k){return!!(!k||typeof k=="number"||g.fx.speeds[k]||typeof k=="string"&&!g.effects.effect[k]||typeof k=="function"||typeof k=="object"&&!k.effect)}g.fn.extend({effect:function(){var k=d.apply(this,arguments),R=g.effects.effect[k.effect],W=R.mode,se=k.queue,le=se||"fx",fe=k.complete,be=k.mode,Te=[],Ve=function(me){var ke=g(this),qe=g.effects.mode(ke,be)||W;ke.data(Tt,!0),Te.push(qe),W&&(qe==="show"||qe===W&&qe==="hide")&&ke.show(),(!W||qe!=="none")&&g.effects.saveStyle(ke),typeof me=="function"&&me()};if(g.fx.off||!R)return be?this[be](k.duration,fe):this.each(function(){fe&&fe.call(this)});function Ue(me){var ke=g(this);function qe(){ke.removeData(Tt),g.effects.cleanUp(ke),k.mode==="hide"&&ke.hide(),lt()}function lt(){typeof fe=="function"&&fe.call(ke[0]),typeof me=="function"&&me()}k.mode=Te.shift(),g.uiBackCompat!==!1&&!W?(ke.is(":hidden")?be==="hide":be==="show")?(ke[be](),lt()):R.call(ke[0],k,lt):k.mode==="none"?(ke[be](),lt()):R.call(ke[0],k,qe)}return se===!1?this.each(Ve).each(Ue):this.queue(le,Ve).queue(le,Ue)},show:function(k){return function(R){if(b(R))return k.apply(this,arguments);var W=d.apply(this,arguments);return W.mode="show",this.effect.call(this,W)}}(g.fn.show),hide:function(k){return function(R){if(b(R))return k.apply(this,arguments);var W=d.apply(this,arguments);return W.mode="hide",this.effect.call(this,W)}}(g.fn.hide),toggle:function(k){return function(R){if(b(R)||typeof R=="boolean")return k.apply(this,arguments);var W=d.apply(this,arguments);return W.mode="toggle",this.effect.call(this,W)}}(g.fn.toggle),cssUnit:function(k){var R=this.css(k),W=[];return g.each(["em","px","%","pt"],function(se,le){R.indexOf(le)>0&&(W=[parseFloat(R),le])}),W},cssClip:function(k){return k?this.css("clip","rect("+k.top+"px "+k.right+"px "+k.bottom+"px "+k.left+"px)"):S(this.css("clip"),this)},transfer:function(k,R){var W=g(this),se=g(k.to),le=se.css("position")==="fixed",fe=g("body"),be=le?fe.scrollTop():0,Te=le?fe.scrollLeft():0,Ve=se.offset(),Ue={top:Ve.top-be,left:Ve.left-Te,height:se.innerHeight(),width:se.innerWidth()},me=W.offset(),ke=g("<div class='ui-effects-transfer'></div>");ke.appendTo("body").addClass(k.className).css({top:me.top-be,left:me.left-Te,height:W.innerHeight(),width:W.innerWidth(),position:le?"fixed":"absolute"}).animate(Ue,k.duration,k.easing,function(){ke.remove(),typeof R=="function"&&R()})}});function S(k,R){var W=R.outerWidth(),se=R.outerHeight(),le=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/,fe=le.exec(k)||["",0,W,se,0];return{top:parseFloat(fe[1])||0,right:fe[2]==="auto"?W:parseFloat(fe[2]),bottom:fe[3]==="auto"?se:parseFloat(fe[3]),left:parseFloat(fe[4])||0}}g.fx.step.clip=function(k){k.clipInit||(k.start=g(k.elem).cssClip(),typeof k.end=="string"&&(k.end=S(k.end,k.elem)),k.clipInit=!0),g(k.elem).cssClip({top:k.pos*(k.end.top-k.start.top)+k.start.top,right:k.pos*(k.end.right-k.start.right)+k.start.right,bottom:k.pos*(k.end.bottom-k.start.bottom)+k.start.bottom,left:k.pos*(k.end.left-k.start.left)+k.start.left})}}(),function(){var d={};g.each(["Quad","Cubic","Quart","Quint","Expo"],function(b,S){d[S]=function(k){return Math.pow(k,b+2)}}),g.extend(d,{Sine:function(b){return 1-Math.cos(b*Math.PI/2)},Circ:function(b){return 1-Math.sqrt(1-b*b)},Elastic:function(b){return b===0||b===1?b:-Math.pow(2,8*(b-1))*Math.sin(((b-1)*80-7.5)*Math.PI/15)},Back:function(b){return b*b*(3*b-2)},Bounce:function(b){for(var S,k=4;b<((S=Math.pow(2,--k))-1)/11;);return 1/Math.pow(4,3-k)-7.5625*Math.pow((S*3-2)/22-b,2)}}),g.each(d,function(b,S){g.easing["easeIn"+b]=S,g.easing["easeOut"+b]=function(k){return 1-S(1-k)},g.easing["easeInOut"+b]=function(k){return k<.5?S(k*2)/2:1-S(k*-2+2)/2}})}(),g.effects;/*!
 * jQuery UI Effects Blind 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("blind","hide",function(d,b){var S={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},k=g(this),R=d.direction||"up",W=k.cssClip(),se={clip:g.extend({},W)},le=g.effects.createPlaceholder(k);se.clip[S[R][0]]=se.clip[S[R][1]],d.mode==="show"&&(k.cssClip(se.clip),le&&le.css(g.effects.clipToBox(se)),se.clip=W),le&&le.animate(g.effects.clipToBox(se),d.duration,d.easing),k.animate(se,{queue:!1,duration:d.duration,easing:d.easing,complete:b})});/*!
 * jQuery UI Effects Bounce 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("bounce",function(d,b){var S,k,R,W=g(this),se=d.mode,le=se==="hide",fe=se==="show",be=d.direction||"up",Te=d.distance,Ve=d.times||5,Ue=Ve*2+(fe||le?1:0),me=d.duration/Ue,ke=d.easing,qe=be==="up"||be==="down"?"top":"left",lt=be==="up"||be==="left",pt=0,Ft=W.queue().length;for(g.effects.createPlaceholder(W),R=W.css(qe),Te||(Te=W[qe==="top"?"outerHeight":"outerWidth"]()/3),fe&&(k={opacity:1},k[qe]=R,W.css("opacity",0).css(qe,lt?-Te*2:Te*2).animate(k,me,ke)),le&&(Te=Te/Math.pow(2,Ve-1)),k={},k[qe]=R;pt<Ve;pt++)S={},S[qe]=(lt?"-=":"+=")+Te,W.animate(S,me,ke).animate(k,me,ke),Te=le?Te*2:Te/2;le&&(S={opacity:0},S[qe]=(lt?"-=":"+=")+Te,W.animate(S,me,ke)),W.queue(b),g.effects.unshift(W,Ft,Ue+1)});/*!
 * jQuery UI Effects Clip 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("clip","hide",function(d,b){var S,k={},R=g(this),W=d.direction||"vertical",se=W==="both",le=se||W==="horizontal",fe=se||W==="vertical";S=R.cssClip(),k.clip={top:fe?(S.bottom-S.top)/2:S.top,right:le?(S.right-S.left)/2:S.right,bottom:fe?(S.bottom-S.top)/2:S.bottom,left:le?(S.right-S.left)/2:S.left},g.effects.createPlaceholder(R),d.mode==="show"&&(R.cssClip(k.clip),k.clip=S),R.animate(k,{queue:!1,duration:d.duration,easing:d.easing,complete:b})});/*!
 * jQuery UI Effects Drop 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("drop","hide",function(d,b){var S,k=g(this),R=d.mode,W=R==="show",se=d.direction||"left",le=se==="up"||se==="down"?"top":"left",fe=se==="up"||se==="left"?"-=":"+=",be=fe==="+="?"-=":"+=",Te={opacity:0};g.effects.createPlaceholder(k),S=d.distance||k[le==="top"?"outerHeight":"outerWidth"](!0)/2,Te[le]=fe+S,W&&(k.css(Te),Te[le]=be+S,Te.opacity=1),k.animate(Te,{queue:!1,duration:d.duration,easing:d.easing,complete:b})});/*!
 * jQuery UI Effects Explode 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("explode","hide",function(d,b){var S,k,R,W,se,le,fe=d.pieces?Math.round(Math.sqrt(d.pieces)):3,be=fe,Te=g(this),Ve=d.mode,Ue=Ve==="show",me=Te.show().css("visibility","hidden").offset(),ke=Math.ceil(Te.outerWidth()/be),qe=Math.ceil(Te.outerHeight()/fe),lt=[];function pt(){lt.push(this),lt.length===fe*be&&Ft()}for(S=0;S<fe;S++)for(W=me.top+S*qe,le=S-(fe-1)/2,k=0;k<be;k++)R=me.left+k*ke,se=k-(be-1)/2,Te.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-k*ke,top:-S*qe}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:ke,height:qe,left:R+(Ue?se*ke:0),top:W+(Ue?le*qe:0),opacity:Ue?0:1}).animate({left:R+(Ue?0:se*ke),top:W+(Ue?0:le*qe),opacity:Ue?1:0},d.duration||500,d.easing,pt);function Ft(){Te.css({visibility:"visible"}),g(lt).remove(),b()}});/*!
 * jQuery UI Effects Fade 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("fade","toggle",function(d,b){var S=d.mode==="show";g(this).css("opacity",S?0:1).animate({opacity:S?1:0},{queue:!1,duration:d.duration,easing:d.easing,complete:b})});/*!
 * jQuery UI Effects Fold 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("fold","hide",function(d,b){var S=g(this),k=d.mode,R=k==="show",W=k==="hide",se=d.size||15,le=/([0-9]+)%/.exec(se),fe=!!d.horizFirst,be=fe?["right","bottom"]:["bottom","right"],Te=d.duration/2,Ve=g.effects.createPlaceholder(S),Ue=S.cssClip(),me={clip:g.extend({},Ue)},ke={clip:g.extend({},Ue)},qe=[Ue[be[0]],Ue[be[1]]],lt=S.queue().length;le&&(se=parseInt(le[1],10)/100*qe[W?0:1]),me.clip[be[0]]=se,ke.clip[be[0]]=se,ke.clip[be[1]]=0,R&&(S.cssClip(ke.clip),Ve&&Ve.css(g.effects.clipToBox(ke)),ke.clip=Ue),S.queue(function(pt){Ve&&Ve.animate(g.effects.clipToBox(me),Te,d.easing).animate(g.effects.clipToBox(ke),Te,d.easing),pt()}).animate(me,Te,d.easing).animate(ke,Te,d.easing).queue(b),g.effects.unshift(S,lt,4)});/*!
 * jQuery UI Effects Highlight 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("highlight","show",function(d,b){var S=g(this),k={backgroundColor:S.css("backgroundColor")};d.mode==="hide"&&(k.opacity=0),g.effects.saveStyle(S),S.css({backgroundImage:"none",backgroundColor:d.color||"#ffff99"}).animate(k,{queue:!1,duration:d.duration,easing:d.easing,complete:b})});/*!
 * jQuery UI Effects Size 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("size",function(d,b){var S,k,R,W=g(this),se=["fontSize"],le=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],fe=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],be=d.mode,Te=be!=="effect",Ve=d.scale||"both",Ue=d.origin||["middle","center"],me=W.css("position"),ke=W.position(),qe=g.effects.scaledDimensions(W),lt=d.from||qe,pt=d.to||g.effects.scaledDimensions(W,0);g.effects.createPlaceholder(W),be==="show"&&(R=lt,lt=pt,pt=R),k={from:{y:lt.height/qe.height,x:lt.width/qe.width},to:{y:pt.height/qe.height,x:pt.width/qe.width}},(Ve==="box"||Ve==="both")&&(k.from.y!==k.to.y&&(lt=g.effects.setTransition(W,le,k.from.y,lt),pt=g.effects.setTransition(W,le,k.to.y,pt)),k.from.x!==k.to.x&&(lt=g.effects.setTransition(W,fe,k.from.x,lt),pt=g.effects.setTransition(W,fe,k.to.x,pt))),(Ve==="content"||Ve==="both")&&k.from.y!==k.to.y&&(lt=g.effects.setTransition(W,se,k.from.y,lt),pt=g.effects.setTransition(W,se,k.to.y,pt)),Ue&&(S=g.effects.getBaseline(Ue,qe),lt.top=(qe.outerHeight-lt.outerHeight)*S.y+ke.top,lt.left=(qe.outerWidth-lt.outerWidth)*S.x+ke.left,pt.top=(qe.outerHeight-pt.outerHeight)*S.y+ke.top,pt.left=(qe.outerWidth-pt.outerWidth)*S.x+ke.left),delete lt.outerHeight,delete lt.outerWidth,W.css(lt),(Ve==="content"||Ve==="both")&&(le=le.concat(["marginTop","marginBottom"]).concat(se),fe=fe.concat(["marginLeft","marginRight"]),W.find("*[width]").each(function(){var Ft=g(this),zt=g.effects.scaledDimensions(Ft),Nt={height:zt.height*k.from.y,width:zt.width*k.from.x,outerHeight:zt.outerHeight*k.from.y,outerWidth:zt.outerWidth*k.from.x},Mt={height:zt.height*k.to.y,width:zt.width*k.to.x,outerHeight:zt.height*k.to.y,outerWidth:zt.width*k.to.x};k.from.y!==k.to.y&&(Nt=g.effects.setTransition(Ft,le,k.from.y,Nt),Mt=g.effects.setTransition(Ft,le,k.to.y,Mt)),k.from.x!==k.to.x&&(Nt=g.effects.setTransition(Ft,fe,k.from.x,Nt),Mt=g.effects.setTransition(Ft,fe,k.to.x,Mt)),Te&&g.effects.saveStyle(Ft),Ft.css(Nt),Ft.animate(Mt,d.duration,d.easing,function(){Te&&g.effects.restoreStyle(Ft)})})),W.animate(pt,{queue:!1,duration:d.duration,easing:d.easing,complete:function(){var Ft=W.offset();pt.opacity===0&&W.css("opacity",lt.opacity),Te||(W.css("position",me==="static"?"relative":me).offset(Ft),g.effects.saveStyle(W)),b()}})});/*!
 * jQuery UI Effects Scale 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("scale",function(d,b){var S=g(this),k=d.mode,R=parseInt(d.percent,10)||(parseInt(d.percent,10)===0||k!=="effect"?0:100),W=g.extend(!0,{from:g.effects.scaledDimensions(S),to:g.effects.scaledDimensions(S,R,d.direction||"both"),origin:d.origin||["middle","center"]},d);d.fade&&(W.from.opacity=1,W.to.opacity=0),g.effects.effect.size.call(this,W,b)});/*!
 * jQuery UI Effects Puff 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("puff","hide",function(d,b){var S=g.extend(!0,{},d,{fade:!0,percent:parseInt(d.percent,10)||150});g.effects.effect.scale.call(this,S,b)});/*!
 * jQuery UI Effects Pulsate 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("pulsate","show",function(d,b){var S=g(this),k=d.mode,R=k==="show",W=k==="hide",se=R||W,le=(d.times||5)*2+(se?1:0),fe=d.duration/le,be=0,Te=1,Ve=S.queue().length;for((R||!S.is(":visible"))&&(S.css("opacity",0).show(),be=1);Te<le;Te++)S.animate({opacity:be},fe,d.easing),be=1-be;S.animate({opacity:be},fe,d.easing),S.queue(b),g.effects.unshift(S,Ve,le+1)});/*!
 * jQuery UI Effects Shake 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("shake",function(d,b){var S=1,k=g(this),R=d.direction||"left",W=d.distance||20,se=d.times||3,le=se*2+1,fe=Math.round(d.duration/le),be=R==="up"||R==="down"?"top":"left",Te=R==="up"||R==="left",Ve={},Ue={},me={},ke=k.queue().length;for(g.effects.createPlaceholder(k),Ve[be]=(Te?"-=":"+=")+W,Ue[be]=(Te?"+=":"-=")+W*2,me[be]=(Te?"-=":"+=")+W*2,k.animate(Ve,fe,d.easing);S<se;S++)k.animate(Ue,fe,d.easing).animate(me,fe,d.easing);k.animate(Ue,fe,d.easing).animate(Ve,fe/2,d.easing).queue(b),g.effects.unshift(k,ke,le+1)});/*!
 * jQuery UI Effects Slide 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("slide","show",function(d,b){var S,k,R=g(this),W={up:["bottom","top"],down:["top","bottom"],left:["right","left"],right:["left","right"]},se=d.mode,le=d.direction||"left",fe=le==="up"||le==="down"?"top":"left",be=le==="up"||le==="left",Te=d.distance||R[fe==="top"?"outerHeight":"outerWidth"](!0),Ve={};g.effects.createPlaceholder(R),S=R.cssClip(),k=R.position()[fe],Ve[fe]=(be?-1:1)*Te+k,Ve.clip=R.cssClip(),Ve.clip[W[le][1]]=Ve.clip[W[le][0]],se==="show"&&(R.cssClip(Ve.clip),R.css(fe,Ve[fe]),Ve.clip=S,Ve[fe]=k),R.animate(Ve,{queue:!1,duration:d.duration,easing:d.easing,complete:b})}),g.uiBackCompat!==!1&&g.effects.define("transfer",function(d,b){g(this).transfer(d,b)});/*!
 * jQuery UI Focusable 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.ui.focusable=function(d,b){var S,k,R,W,se,le=d.nodeName.toLowerCase();return le==="area"?(S=d.parentNode,k=S.name,!d.href||!k||S.nodeName.toLowerCase()!=="map"?!1:(R=g("img[usemap='#"+k+"']"),R.length>0&&R.is(":visible"))):(/^(input|select|textarea|button|object)$/.test(le)?(W=!d.disabled,W&&(se=g(d).closest("fieldset")[0],se&&(W=!se.disabled))):le==="a"?W=d.href||b:W=b,W&&g(d).is(":visible")&&qt(g(d)))};function qt(d){for(var b=d.css("visibility");b==="inherit";)d=d.parent(),b=d.css("visibility");return b==="visible"}g.extend(g.expr.pseudos,{focusable:function(d){return g.ui.focusable(d,g.attr(d,"tabindex")!=null)}}),g.ui.focusable,g.fn._form=function(){return typeof this[0].form=="string"?this.closest("form"):g(this[0].form)};/*!
 * jQuery UI Form Reset Mixin 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.ui.formResetMixin={_formResetHandler:function(){var d=g(this);setTimeout(function(){var b=d.data("ui-form-reset-instances");g.each(b,function(){this.refresh()})})},_bindFormResetHandler:function(){if(this.form=this.element._form(),!!this.form.length){var d=this.form.data("ui-form-reset-instances")||[];d.length||this.form.on("reset.ui-form-reset",this._formResetHandler),d.push(this),this.form.data("ui-form-reset-instances",d)}},_unbindFormResetHandler:function(){if(this.form.length){var d=this.form.data("ui-form-reset-instances");d.splice(g.inArray(this,d),1),d.length?this.form.data("ui-form-reset-instances",d):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}};/*!
 * jQuery UI Support for jQuery core 1.8.x and newer 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 */if(g.expr.pseudos||(g.expr.pseudos=g.expr[":"]),g.uniqueSort||(g.uniqueSort=g.unique),!g.escapeSelector){var Vt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g,vt=function(d,b){return b?d==="\0"?"ï¿½":d.slice(0,-1)+"\\"+d.charCodeAt(d.length-1).toString(16)+" ":"\\"+d};g.escapeSelector=function(d){return(d+"").replace(Vt,vt)}}(!g.fn.even||!g.fn.odd)&&g.fn.extend({even:function(){return this.filter(function(d){return d%2===0})},odd:function(){return this.filter(function(d){return d%2===1})}});/*!
 * jQuery UI Keycode 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38};/*!
 * jQuery UI Labels 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.fn.labels=function(){var d,b,S,k,R;return this.length?this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(k=this.eq(0).parents("label"),S=this.attr("id"),S&&(d=this.eq(0).parents().last(),R=d.add(d.length?d.siblings():this.siblings()),b="label[for='"+g.escapeSelector(S)+"']",k=k.add(R.find(b).addBack(b))),this.pushStack(k)):this.pushStack([])};/*!
 * jQuery UI Scroll Parent 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.fn.scrollParent=function(d){var b=this.css("position"),S=b==="absolute",k=d?/(auto|scroll|hidden)/:/(auto|scroll)/,R=this.parents().filter(function(){var W=g(this);return S&&W.css("position")==="static"?!1:k.test(W.css("overflow")+W.css("overflow-y")+W.css("overflow-x"))}).eq(0);return b==="fixed"||!R.length?g(this[0].ownerDocument||document):R};/*!
 * jQuery UI Tabbable 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.extend(g.expr.pseudos,{tabbable:function(d){var b=g.attr(d,"tabindex"),S=b!=null;return(!S||b>=0)&&g.ui.focusable(d,S)}});/*!
 * jQuery UI Unique ID 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.fn.extend({uniqueId:function(){var d=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++d)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&g(this).removeAttr("id")})}});/*!
 * jQuery UI Accordion 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.accordion",{version:"1.13.2",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:function(d){return d.find("> li > :first-child").add(d.find("> :not(li)").even())},heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var d=this.options;this.prevShow=this.prevHide=g(),this._addClass("ui-accordion","ui-widget ui-helper-reset"),this.element.attr("role","tablist"),!d.collapsible&&(d.active===!1||d.active==null)&&(d.active=0),this._processPanels(),d.active<0&&(d.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():g()}},_createIcons:function(){var d,b,S=this.options.icons;S&&(d=g("<span>"),this._addClass(d,"ui-accordion-header-icon","ui-icon "+S.header),d.prependTo(this.headers),b=this.active.children(".ui-accordion-header-icon"),this._removeClass(b,S.header)._addClass(b,null,S.activeHeader)._addClass(this.headers,"ui-accordion-icons"))},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons"),this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var d;this.element.removeAttr("role"),this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(),this._destroyIcons(),d=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(),this.options.heightStyle!=="content"&&d.css("height","")},_setOption:function(d,b){if(d==="active"){this._activate(b);return}d==="event"&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(b)),this._super(d,b),d==="collapsible"&&!b&&this.options.active===!1&&this._activate(0),d==="icons"&&(this._destroyIcons(),b&&this._createIcons())},_setOptionDisabled:function(d){this._super(d),this.element.attr("aria-disabled",d),this._toggleClass(null,"ui-state-disabled",!!d),this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!d)},_keydown:function(d){if(!(d.altKey||d.ctrlKey)){var b=g.ui.keyCode,S=this.headers.length,k=this.headers.index(d.target),R=!1;switch(d.keyCode){case b.RIGHT:case b.DOWN:R=this.headers[(k+1)%S];break;case b.LEFT:case b.UP:R=this.headers[(k-1+S)%S];break;case b.SPACE:case b.ENTER:this._eventHandler(d);break;case b.HOME:R=this.headers[0];break;case b.END:R=this.headers[S-1];break}R&&(g(d.target).attr("tabIndex",-1),g(R).attr("tabIndex",0),g(R).trigger("focus"),d.preventDefault())}},_panelKeyDown:function(d){d.keyCode===g.ui.keyCode.UP&&d.ctrlKey&&g(d.currentTarget).prev().trigger("focus")},refresh:function(){var d=this.options;this._processPanels(),d.active===!1&&d.collapsible===!0||!this.headers.length?(d.active=!1,this.active=g()):d.active===!1?this._activate(0):this.active.length&&!g.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(d.active=!1,this.active=g()):this._activate(Math.max(0,d.active-1)):d.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var d=this.headers,b=this.panels;typeof this.options.header=="function"?this.headers=this.options.header(this.element):this.headers=this.element.find(this.options.header),this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default"),this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide(),this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content"),b&&(this._off(d.not(this.headers)),this._off(b.not(this.panels)))},_refresh:function(){var d,b=this.options,S=b.heightStyle,k=this.element.parent();this.active=this._findActive(b.active),this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed"),this._addClass(this.active.next(),"ui-accordion-content-active"),this.active.next().show(),this.headers.attr("role","tab").each(function(){var R=g(this),W=R.uniqueId().attr("id"),se=R.next(),le=se.uniqueId().attr("id");R.attr("aria-controls",le),se.attr("aria-labelledby",W)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(b.event),S==="fill"?(d=k.height(),this.element.siblings(":visible").each(function(){var R=g(this),W=R.css("position");W==="absolute"||W==="fixed"||(d-=R.outerHeight(!0))}),this.headers.each(function(){d-=g(this).outerHeight(!0)}),this.headers.next().each(function(){g(this).height(Math.max(0,d-g(this).innerHeight()+g(this).height()))}).css("overflow","auto")):S==="auto"&&(d=0,this.headers.next().each(function(){var R=g(this).is(":visible");R||g(this).show(),d=Math.max(d,g(this).css("height","").height()),R||g(this).hide()}).height(d))},_activate:function(d){var b=this._findActive(d)[0];b!==this.active[0]&&(b=b||this.active[0],this._eventHandler({target:b,currentTarget:b,preventDefault:g.noop}))},_findActive:function(d){return typeof d=="number"?this.headers.eq(d):g()},_setupEvents:function(d){var b={keydown:"_keydown"};d&&g.each(d.split(" "),function(S,k){b[k]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,b),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(d){var b,S,k=this.options,R=this.active,W=g(d.currentTarget),se=W[0]===R[0],le=se&&k.collapsible,fe=le?g():W.next(),be=R.next(),Te={oldHeader:R,oldPanel:be,newHeader:le?g():W,newPanel:fe};d.preventDefault(),!(se&&!k.collapsible||this._trigger("beforeActivate",d,Te)===!1)&&(k.active=le?!1:this.headers.index(W),this.active=se?g():W,this._toggle(Te),this._removeClass(R,"ui-accordion-header-active","ui-state-active"),k.icons&&(b=R.children(".ui-accordion-header-icon"),this._removeClass(b,null,k.icons.activeHeader)._addClass(b,null,k.icons.header)),se||(this._removeClass(W,"ui-accordion-header-collapsed")._addClass(W,"ui-accordion-header-active","ui-state-active"),k.icons&&(S=W.children(".ui-accordion-header-icon"),this._removeClass(S,null,k.icons.header)._addClass(S,null,k.icons.activeHeader)),this._addClass(W.next(),"ui-accordion-content-active")))},_toggle:function(d){var b=d.newPanel,S=this.prevShow.length?this.prevShow:d.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=b,this.prevHide=S,this.options.animate?this._animate(b,S,d):(S.hide(),b.show(),this._toggleComplete(d)),S.attr({"aria-hidden":"true"}),S.prev().attr({"aria-selected":"false","aria-expanded":"false"}),b.length&&S.length?S.prev().attr({tabIndex:-1,"aria-expanded":"false"}):b.length&&this.headers.filter(function(){return parseInt(g(this).attr("tabIndex"),10)===0}).attr("tabIndex",-1),b.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(d,b,S){var k,R,W,se=this,le=0,fe=d.css("box-sizing"),be=d.length&&(!b.length||d.index()<b.index()),Te=this.options.animate||{},Ve=be&&Te.down||Te,Ue=function(){se._toggleComplete(S)};if(typeof Ve=="number"&&(W=Ve),typeof Ve=="string"&&(R=Ve),R=R||Ve.easing||Te.easing,W=W||Ve.duration||Te.duration,!b.length)return d.animate(this.showProps,W,R,Ue);if(!d.length)return b.animate(this.hideProps,W,R,Ue);k=d.show().outerHeight(),b.animate(this.hideProps,{duration:W,easing:R,step:function(me,ke){ke.now=Math.round(me)}}),d.hide().animate(this.showProps,{duration:W,easing:R,complete:Ue,step:function(me,ke){ke.now=Math.round(me),ke.prop!=="height"?fe==="content-box"&&(le+=ke.now):se.options.heightStyle!=="content"&&(ke.now=Math.round(k-b.outerHeight()-le),le=0)}})},_toggleComplete:function(d){var b=d.oldPanel,S=b.prev();this._removeClass(b,"ui-accordion-content-active"),this._removeClass(S,"ui-accordion-header-active")._addClass(S,"ui-accordion-header-collapsed"),b.length&&(b.parent()[0].className=b.parent()[0].className),this._trigger("activate",null,d)}}),g.ui.safeActiveElement=function(d){var b;try{b=d.activeElement}catch{b=d.body}return b||(b=d.body),b.nodeName||(b=d.body),b};/*!
 * jQuery UI Menu 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.menu",{version:"1.13.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.lastMousePosition={x:null,y:null},this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(d){d.preventDefault(),this._activateItem(d)},"click .ui-menu-item":function(d){var b=g(d.target),S=g(g.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&b.not(".ui-state-disabled").length&&(this.select(d),d.isPropagationStopped()||(this.mouseHandled=!0),b.has(".ui-menu").length?this.expand(d):!this.element.is(":focus")&&S.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&this.active.parents(".ui-menu").length===1&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":"_activateItem","mousemove .ui-menu-item":"_activateItem",mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(d,b){var S=this.active||this._menuItems().first();b||this.focus(d,S)},blur:function(d){this._delay(function(){var b=!g.contains(this.element[0],g.ui.safeActiveElement(this.document[0]));b&&this.collapseAll(d)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(d){this._closeOnDocumentClick(d)&&this.collapseAll(d,!0),this.mouseHandled=!1}})},_activateItem:function(d){if(!this.previousFilter&&!(d.clientX===this.lastMousePosition.x&&d.clientY===this.lastMousePosition.y)){this.lastMousePosition={x:d.clientX,y:d.clientY};var b=g(d.target).closest(".ui-menu-item"),S=g(d.currentTarget);b[0]===S[0]&&(S.is(".ui-state-active")||(this._removeClass(S.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(d,S)))}},_destroy:function(){var d=this.element.find(".ui-menu-item").removeAttr("role aria-disabled"),b=d.children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),b.children().each(function(){var S=g(this);S.data("ui-menu-submenu-caret")&&S.remove()})},_keydown:function(d){var b,S,k,R,W=!0;switch(d.keyCode){case g.ui.keyCode.PAGE_UP:this.previousPage(d);break;case g.ui.keyCode.PAGE_DOWN:this.nextPage(d);break;case g.ui.keyCode.HOME:this._move("first","first",d);break;case g.ui.keyCode.END:this._move("last","last",d);break;case g.ui.keyCode.UP:this.previous(d);break;case g.ui.keyCode.DOWN:this.next(d);break;case g.ui.keyCode.LEFT:this.collapse(d);break;case g.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(d);break;case g.ui.keyCode.ENTER:case g.ui.keyCode.SPACE:this._activate(d);break;case g.ui.keyCode.ESCAPE:this.collapse(d);break;default:W=!1,S=this.previousFilter||"",R=!1,k=d.keyCode>=96&&d.keyCode<=105?(d.keyCode-96).toString():String.fromCharCode(d.keyCode),clearTimeout(this.filterTimer),k===S?R=!0:k=S+k,b=this._filterMenuItems(k),b=R&&b.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):b,b.length||(k=String.fromCharCode(d.keyCode),b=this._filterMenuItems(k)),b.length?(this.focus(d,b),this.previousFilter=k,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}W&&d.preventDefault()},_activate:function(d){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(d):this.select(d))},refresh:function(){var d,b,S,k,R,W=this,se=this.options.icons.submenu,le=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),S=le.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var fe=g(this),be=fe.prev(),Te=g("<span>").data("ui-menu-submenu-caret",!0);W._addClass(Te,"ui-menu-icon","ui-icon "+se),be.attr("aria-haspopup","true").prepend(Te),fe.attr("aria-labelledby",be.attr("id"))}),this._addClass(S,"ui-menu","ui-widget ui-widget-content ui-front"),d=le.add(this.element),b=d.find(this.options.items),b.not(".ui-menu-item").each(function(){var fe=g(this);W._isDivider(fe)&&W._addClass(fe,"ui-menu-divider","ui-widget-content")}),k=b.not(".ui-menu-item, .ui-menu-divider"),R=k.children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(k,"ui-menu-item")._addClass(R,"ui-menu-item-wrapper"),b.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!g.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(d,b){if(d==="icons"){var S=this.element.find(".ui-menu-icon");this._removeClass(S,null,this.options.icons.submenu)._addClass(S,null,b.submenu)}this._super(d,b)},_setOptionDisabled:function(d){this._super(d),this.element.attr("aria-disabled",String(d)),this._toggleClass(null,"ui-state-disabled",!!d)},focus:function(d,b){var S,k,R;this.blur(d,d&&d.type==="focus"),this._scrollIntoView(b),this.active=b.first(),k=this.active.children(".ui-menu-item-wrapper"),this._addClass(k,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",k.attr("id")),R=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(R,null,"ui-state-active"),d&&d.type==="keydown"?this._close():this.timer=this._delay(function(){this._close()},this.delay),S=b.children(".ui-menu"),S.length&&d&&/^mouse/.test(d.type)&&this._startOpening(S),this.activeMenu=b.parent(),this._trigger("focus",d,{item:b})},_scrollIntoView:function(d){var b,S,k,R,W,se;this._hasScroll()&&(b=parseFloat(g.css(this.activeMenu[0],"borderTopWidth"))||0,S=parseFloat(g.css(this.activeMenu[0],"paddingTop"))||0,k=d.offset().top-this.activeMenu.offset().top-b-S,R=this.activeMenu.scrollTop(),W=this.activeMenu.height(),se=d.outerHeight(),k<0?this.activeMenu.scrollTop(R+k):k+se>W&&this.activeMenu.scrollTop(R+k-W+se))},blur:function(d,b){b||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",d,{item:this.active}),this.active=null)},_startOpening:function(d){clearTimeout(this.timer),d.attr("aria-hidden")==="true"&&(this.timer=this._delay(function(){this._close(),this._open(d)},this.delay))},_open:function(d){var b=g.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(d.parents(".ui-menu")).hide().attr("aria-hidden","true"),d.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(b)},collapseAll:function(d,b){clearTimeout(this.timer),this.timer=this._delay(function(){var S=b?this.element:g(d&&d.target).closest(this.element.find(".ui-menu"));S.length||(S=this.element),this._close(S),this.blur(d),this._removeClass(S.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=S},b?0:this.delay)},_close:function(d){d||(d=this.active?this.active.parent():this.element),d.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(d){return!g(d.target).closest(".ui-menu").length},_isDivider:function(d){return!/[^\-\u2014\u2013\s]/.test(d.text())},collapse:function(d){var b=this.active&&this.active.parent().closest(".ui-menu-item",this.element);b&&b.length&&(this._close(),this.focus(d,b))},expand:function(d){var b=this.active&&this._menuItems(this.active.children(".ui-menu")).first();b&&b.length&&(this._open(b.parent()),this._delay(function(){this.focus(d,b)}))},next:function(d){this._move("next","first",d)},previous:function(d){this._move("prev","last",d)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_menuItems:function(d){return(d||this.element).find(this.options.items).filter(".ui-menu-item")},_move:function(d,b,S){var k;this.active&&(d==="first"||d==="last"?k=this.active[d==="first"?"prevAll":"nextAll"](".ui-menu-item").last():k=this.active[d+"All"](".ui-menu-item").first()),(!k||!k.length||!this.active)&&(k=this._menuItems(this.activeMenu)[b]()),this.focus(S,k)},nextPage:function(d){var b,S,k;if(!this.active){this.next(d);return}this.isLastItem()||(this._hasScroll()?(S=this.active.offset().top,k=this.element.innerHeight(),g.fn.jquery.indexOf("3.2.")===0&&(k+=this.element[0].offsetHeight-this.element.outerHeight()),this.active.nextAll(".ui-menu-item").each(function(){return b=g(this),b.offset().top-S-k<0}),this.focus(d,b)):this.focus(d,this._menuItems(this.activeMenu)[this.active?"last":"first"]()))},previousPage:function(d){var b,S,k;if(!this.active){this.next(d);return}this.isFirstItem()||(this._hasScroll()?(S=this.active.offset().top,k=this.element.innerHeight(),g.fn.jquery.indexOf("3.2.")===0&&(k+=this.element[0].offsetHeight-this.element.outerHeight()),this.active.prevAll(".ui-menu-item").each(function(){return b=g(this),b.offset().top-S+k>0}),this.focus(d,b)):this.focus(d,this._menuItems(this.activeMenu).first()))},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(d){this.active=this.active||g(d.target).closest(".ui-menu-item");var b={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(d,!0),this._trigger("select",d,b)},_filterMenuItems:function(d){var b=d.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),S=new RegExp("^"+b,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return S.test(String.prototype.trim.call(g(this).children(".ui-menu-item-wrapper").text()))})}});/*!
 * jQuery UI Autocomplete 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.autocomplete",{version:"1.13.2",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,liveRegionTimer:null,_create:function(){var d,b,S,k=this.element[0].nodeName.toLowerCase(),R=k==="textarea",W=k==="input";this.isMultiLine=R||!W&&this._isContentEditable(this.element),this.valueMethod=this.element[R||W?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(se){if(this.element.prop("readOnly")){d=!0,S=!0,b=!0;return}d=!1,S=!1,b=!1;var le=g.ui.keyCode;switch(se.keyCode){case le.PAGE_UP:d=!0,this._move("previousPage",se);break;case le.PAGE_DOWN:d=!0,this._move("nextPage",se);break;case le.UP:d=!0,this._keyEvent("previous",se);break;case le.DOWN:d=!0,this._keyEvent("next",se);break;case le.ENTER:this.menu.active&&(d=!0,se.preventDefault(),this.menu.select(se));break;case le.TAB:this.menu.active&&this.menu.select(se);break;case le.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(se),se.preventDefault());break;default:b=!0,this._searchTimeout(se);break}},keypress:function(se){if(d){d=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&se.preventDefault();return}if(!b){var le=g.ui.keyCode;switch(se.keyCode){case le.PAGE_UP:this._move("previousPage",se);break;case le.PAGE_DOWN:this._move("nextPage",se);break;case le.UP:this._keyEvent("previous",se);break;case le.DOWN:this._keyEvent("next",se);break}}},input:function(se){if(S){S=!1,se.preventDefault();return}this._searchTimeout(se)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(se){clearTimeout(this.searching),this.close(se),this._change(se)}}),this._initSource(),this.menu=g("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().attr({unselectable:"on"}).menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(se){se.preventDefault()},menufocus:function(se,le){var fe,be;if(this.isNewMenu&&(this.isNewMenu=!1,se.originalEvent&&/^mouse/.test(se.originalEvent.type))){this.menu.blur(),this.document.one("mousemove",function(){g(se.target).trigger(se.originalEvent)});return}be=le.item.data("ui-autocomplete-item"),this._trigger("focus",se,{item:be})!==!1&&se.originalEvent&&/^key/.test(se.originalEvent.type)&&this._value(be.value),fe=le.item.attr("aria-label")||be.value,fe&&String.prototype.trim.call(fe).length&&(clearTimeout(this.liveRegionTimer),this.liveRegionTimer=this._delay(function(){this.liveRegion.html(g("<div>").text(fe))},100))},menuselect:function(se,le){var fe=le.item.data("ui-autocomplete-item"),be=this.previous;this.element[0]!==g.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=be,this._delay(function(){this.previous=be,this.selectedItem=fe})),this._trigger("select",se,{item:fe})!==!1&&this._value(fe.value),this.term=this._value(),this.close(se),this.selectedItem=fe}}),this.liveRegion=g("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(d,b){this._super(d,b),d==="source"&&this._initSource(),d==="appendTo"&&this.menu.element.appendTo(this._appendTo()),d==="disabled"&&b&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(d){var b=this.menu.element[0];return d.target===this.element[0]||d.target===b||g.contains(b,d.target)},_closeOnClickOutside:function(d){this._isEventTargetInWidget(d)||this.close()},_appendTo:function(){var d=this.options.appendTo;return d&&(d=d.jquery||d.nodeType?g(d):this.document.find(d).eq(0)),(!d||!d[0])&&(d=this.element.closest(".ui-front, dialog")),d.length||(d=this.document[0].body),d},_initSource:function(){var d,b,S=this;Array.isArray(this.options.source)?(d=this.options.source,this.source=function(k,R){R(g.ui.autocomplete.filter(d,k.term))}):typeof this.options.source=="string"?(b=this.options.source,this.source=function(k,R){S.xhr&&S.xhr.abort(),S.xhr=g.ajax({url:b,data:k,dataType:"json",success:function(W){R(W)},error:function(){R([])}})}):this.source=this.options.source},_searchTimeout:function(d){clearTimeout(this.searching),this.searching=this._delay(function(){var b=this.term===this._value(),S=this.menu.element.is(":visible"),k=d.altKey||d.ctrlKey||d.metaKey||d.shiftKey;(!b||b&&!S&&!k)&&(this.selectedItem=null,this.search(null,d))},this.options.delay)},search:function(d,b){if(d=d??this._value(),this.term=this._value(),d.length<this.options.minLength)return this.close(b);if(this._trigger("search",b)!==!1)return this._search(d)},_search:function(d){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:d},this._response())},_response:function(){var d=++this.requestIndex;return(function(b){d===this.requestIndex&&this.__response(b),this.pending--,this.pending||this._removeClass("ui-autocomplete-loading")}).bind(this)},__response:function(d){d&&(d=this._normalize(d)),this._trigger("response",null,{content:d}),!this.options.disabled&&d&&d.length&&!this.cancelSearch?(this._suggest(d),this._trigger("open")):this._close()},close:function(d){this.cancelSearch=!0,this._close(d)},_close:function(d){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",d))},_change:function(d){this.previous!==this._value()&&this._trigger("change",d,{item:this.selectedItem})},_normalize:function(d){return d.length&&d[0].label&&d[0].value?d:g.map(d,function(b){return typeof b=="string"?{label:b,value:b}:g.extend({},b,{label:b.label||b.value,value:b.value||b.label})})},_suggest:function(d){var b=this.menu.element.empty();this._renderMenu(b,d),this.isNewMenu=!0,this.menu.refresh(),b.show(),this._resizeMenu(),b.position(g.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var d=this.menu.element;d.outerWidth(Math.max(d.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(d,b){var S=this;g.each(b,function(k,R){S._renderItemData(d,R)})},_renderItemData:function(d,b){return this._renderItem(d,b).data("ui-autocomplete-item",b)},_renderItem:function(d,b){return g("<li>").append(g("<div>").text(b.label)).appendTo(d)},_move:function(d,b){if(!this.menu.element.is(":visible")){this.search(null,b);return}if(this.menu.isFirstItem()&&/^previous/.test(d)||this.menu.isLastItem()&&/^next/.test(d)){this.isMultiLine||this._value(this.term),this.menu.blur();return}this.menu[d](b)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(d,b){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(d,b),b.preventDefault())},_isContentEditable:function(d){if(!d.length)return!1;var b=d.prop("contentEditable");return b==="inherit"?this._isContentEditable(d.parent()):b==="true"}}),g.extend(g.ui.autocomplete,{escapeRegex:function(d){return d.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(d,b){var S=new RegExp(g.ui.autocomplete.escapeRegex(b),"i");return g.grep(d,function(k){return S.test(k.label||k.value||k)})}}),g.widget("ui.autocomplete",g.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(d){return d+(d>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(d){var b;this._superApply(arguments),!(this.options.disabled||this.cancelSearch)&&(d&&d.length?b=this.options.messages.results(d.length):b=this.options.messages.noResults,clearTimeout(this.liveRegionTimer),this.liveRegionTimer=this._delay(function(){this.liveRegion.html(g("<div>").text(b))},100))}}),g.ui.autocomplete;/*!
 * jQuery UI Controlgroup 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */var Ut=/ui-corner-([a-z]){2,6}/g;g.widget("ui.controlgroup",{version:"1.13.2",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var d=this,b=[];g.each(this.options.items,function(S,k){var R,W={};if(k){if(S==="controlgroupLabel"){R=d.element.find(k),R.each(function(){var se=g(this);se.children(".ui-controlgroup-label-contents").length||se.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),d._addClass(R,null,"ui-widget ui-widget-content ui-state-default"),b=b.concat(R.get());return}g.fn[S]&&(d["_"+S+"Options"]?W=d["_"+S+"Options"]("middle"):W={classes:{}},d.element.find(k).each(function(){var se=g(this),le=se[S]("instance"),fe=g.widget.extend({},W);if(!(S==="button"&&se.parent(".ui-spinner").length)){le||(le=se[S]()[S]("instance")),le&&(fe.classes=d._resolveClassesValues(fe.classes,le)),se[S](fe);var be=se[S]("widget");g.data(be[0],"ui-controlgroup-data",le||se[S]("instance")),b.push(be[0])}}))}}),this.childWidgets=g(g.uniqueSort(b)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(d){this.childWidgets.each(function(){var b=g(this),S=b.data("ui-controlgroup-data");S&&S[d]&&S[d]()})},_updateCornerClass:function(d,b){var S="ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all",k=this._buildSimpleOptions(b,"label").classes.label;this._removeClass(d,null,S),this._addClass(d,null,k)},_buildSimpleOptions:function(d,b){var S=this.options.direction==="vertical",k={classes:{}};return k.classes[b]={middle:"",first:"ui-corner-"+(S?"top":"left"),last:"ui-corner-"+(S?"bottom":"right"),only:"ui-corner-all"}[d],k},_spinnerOptions:function(d){var b=this._buildSimpleOptions(d,"ui-spinner");return b.classes["ui-spinner-up"]="",b.classes["ui-spinner-down"]="",b},_buttonOptions:function(d){return this._buildSimpleOptions(d,"ui-button")},_checkboxradioOptions:function(d){return this._buildSimpleOptions(d,"ui-checkboxradio-label")},_selectmenuOptions:function(d){var b=this.options.direction==="vertical";return{width:b?"auto":!1,classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(b?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(b?"top":"left")},last:{"ui-selectmenu-button-open":b?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(b?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[d]}},_resolveClassesValues:function(d,b){var S={};return g.each(d,function(k){var R=b.options.classes[k]||"";R=String.prototype.trim.call(R.replace(Ut,"")),S[k]=(R+" "+d[k]).replace(/\s+/g," ")}),S},_setOption:function(d,b){if(d==="direction"&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(d,b),d==="disabled"){this._callChildMethod(b?"disable":"enable");return}this.refresh()},refresh:function(){var d,b=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),this.options.direction==="horizontal"&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),d=this.childWidgets,this.options.onlyVisible&&(d=d.filter(":visible")),d.length&&(g.each(["first","last"],function(S,k){var R=d[k]().data("ui-controlgroup-data");if(R&&b["_"+R.widgetName+"Options"]){var W=b["_"+R.widgetName+"Options"](d.length===1?"only":k);W.classes=b._resolveClassesValues(W.classes,R),R.element[R.widgetName](W)}else b._updateCornerClass(d[k](),k)}),this._callChildMethod("refresh"))}});/*!
 * jQuery UI Checkboxradio 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.checkboxradio",[g.ui.formResetMixin,{version:"1.13.2",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var d,b,S,k=this._super()||{};return this._readType(),b=this.element.labels(),this.label=g(b[b.length-1]),this.label.length||g.error("No label found for checkboxradio widget"),this.originalLabel="",S=this.label.contents().not(this.element[0]),S.length&&(this.originalLabel+=S.clone().wrapAll("<div></div>").parent().html()),this.originalLabel&&(k.label=this.originalLabel),d=this.element[0].disabled,d!=null&&(k.disabled=d),k},_create:function(){var d=this.element[0].checked;this._bindFormResetHandler(),this.options.disabled==null&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),this.type==="radio"&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),d&&this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var d=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,(d!=="input"||!/radio|checkbox/.test(this.type))&&g.error("Can't create checkboxradio on element.nodeName="+d+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var d,b=this.element[0].name,S="input[name='"+g.escapeSelector(b)+"']";return b?(this.form.length?d=g(this.form[0].elements).filter(S):d=g(S).filter(function(){return g(this)._form().length===0}),d.not(this.element)):g([])},_toggleClasses:function(){var d=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",d),this.options.icon&&this.type==="checkbox"&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",d)._toggleClass(this.icon,null,"ui-icon-blank",!d),this.type==="radio"&&this._getRadioGroup().each(function(){var b=g(this).checkboxradio("instance");b&&b._removeClass(b.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(d,b){if(!(d==="label"&&!b)){if(this._super(d,b),d==="disabled"){this._toggleClass(this.label,null,"ui-state-disabled",b),this.element[0].disabled=b;return}this.refresh()}},_updateIcon:function(d){var b="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=g("<span>"),this.iconSpace=g("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),this.type==="checkbox"?(b+=d?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,d?"ui-icon-blank":"ui-icon-check")):b+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",b),d||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):this.icon!==void 0&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var d=this.label.contents().not(this.element[0]);this.icon&&(d=d.not(this.icon[0])),this.iconSpace&&(d=d.not(this.iconSpace[0])),d.remove(),this.label.append(this.options.label)},refresh:function(){var d=this.element[0].checked,b=this.element[0].disabled;this._updateIcon(d),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",d),this.options.label!==null&&this._updateLabel(),b!==this.options.disabled&&this._setOptions({disabled:b})}}]),g.ui.checkboxradio;/*!
 * jQuery UI Button 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.button",{version:"1.13.2",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var d,b=this._super()||{};return this.isInput=this.element.is("input"),d=this.element[0].disabled,d!=null&&(b.disabled=d),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(b.label=this.originalLabel),b},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),this.options.disabled==null&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(d){d.keyCode===g.ui.keyCode.SPACE&&(d.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),!this.options.showLabel&&!this.title&&this.element.attr("title",this.options.label)},_updateIcon:function(d,b){var S=d!=="iconPosition",k=S?this.options.iconPosition:b,R=k==="top"||k==="bottom";this.icon?S&&this._removeClass(this.icon,null,this.options.icon):(this.icon=g("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),S&&this._addClass(this.icon,null,b),this._attachIcon(k),R?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=g("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(k))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(d){this.icon[/^(?:end|bottom)/.test(d)?"before":"after"](this.iconSpace)},_attachIcon:function(d){this.element[/^(?:end|bottom)/.test(d)?"append":"prepend"](this.icon)},_setOptions:function(d){var b=d.showLabel===void 0?this.options.showLabel:d.showLabel,S=d.icon===void 0?this.options.icon:d.icon;!b&&!S&&(d.showLabel=!0),this._super(d)},_setOption:function(d,b){d==="icon"&&(b?this._updateIcon(d,b):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),d==="iconPosition"&&this._updateIcon(d,b),d==="showLabel"&&(this._toggleClass("ui-button-icon-only",null,!b),this._updateTooltip()),d==="label"&&(this.isInput?this.element.val(b):(this.element.html(b),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(d,b),d==="disabled"&&(this._toggleClass(null,"ui-state-disabled",b),this.element[0].disabled=b,b&&this.element.trigger("blur"))},refresh:function(){var d=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");d!==this.options.disabled&&this._setOptions({disabled:d}),this._updateTooltip()}}),g.uiBackCompat!==!1&&(g.widget("ui.button",g.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),!this.options.icon&&(this.options.icons.primary||this.options.icons.secondary)?this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"):this.options.icon&&(this.options.icons.primary=this.options.icon),this._super()},_setOption:function(d,b){if(d==="text"){this._super("showLabel",b);return}d==="showLabel"&&(this.options.text=b),d==="icon"&&(this.options.icons.primary=b),d==="icons"&&(b.primary?(this._super("icon",b.primary),this._super("iconPosition","beginning")):b.secondary&&(this._super("icon",b.secondary),this._super("iconPosition","end"))),this._superApply(arguments)}}),g.fn.button=function(d){return function(b){var S=typeof b=="string",k=Array.prototype.slice.call(arguments,1),R=this;return S?!this.length&&b==="instance"?R=void 0:this.each(function(){var W,se=g(this).attr("type"),le=se!=="checkbox"&&se!=="radio"?"button":"checkboxradio",fe=g.data(this,"ui-"+le);if(b==="instance")return R=fe,!1;if(!fe)return g.error("cannot call methods on button prior to initialization; attempted to call method '"+b+"'");if(typeof fe[b]!="function"||b.charAt(0)==="_")return g.error("no such method '"+b+"' for button widget instance");if(W=fe[b].apply(fe,k),W!==fe&&W!==void 0)return R=W&&W.jquery?R.pushStack(W.get()):W,!1}):(k.length&&(b=g.widget.extend.apply(null,[b].concat(k))),this.each(function(){var W=g(this).attr("type"),se=W!=="checkbox"&&W!=="radio"?"button":"checkboxradio",le=g.data(this,"ui-"+se);if(le)le.option(b||{}),le._init&&le._init();else{if(se==="button"){d.call(g(this),b);return}g(this).checkboxradio(g.extend({icon:!1},b))}})),R}}(g.fn.button),g.fn.buttonset=function(){return g.ui.controlgroup||g.error("Controlgroup widget missing"),arguments[0]==="option"&&arguments[1]==="items"&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):arguments[0]==="option"&&arguments[1]==="items"?this.controlgroup.apply(this,[arguments[0],"items.button"]):(typeof arguments[0]=="object"&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))}),g.ui.button;/*!
 * jQuery UI Datepicker 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.extend(g.ui,{datepicker:{version:"1.13.2"}});var Pt;function Yt(d){for(var b,S;d.length&&d[0]!==document;){if(b=d.css("position"),(b==="absolute"||b==="relative"||b==="fixed")&&(S=parseInt(d.css("zIndex"),10),!isNaN(S)&&S!==0))return S;d=d.parent()}return 0}function Ai(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:"",selectMonthLabel:"Select month",selectYearLabel:"Select year"},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,onUpdateDatepicker:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},g.extend(this._defaults,this.regional[""]),this.regional.en=g.extend(!0,{},this.regional[""]),this.regional["en-US"]=g.extend(!0,{},this.regional.en),this.dpDiv=Ri(g("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}g.extend(Ai.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(d){return Li(this._defaults,d||{}),this},_attachDatepicker:function(d,b){var S,k,R;S=d.nodeName.toLowerCase(),k=S==="div"||S==="span",d.id||(this.uuid+=1,d.id="dp"+this.uuid),R=this._newInst(g(d),k),R.settings=g.extend({},b||{}),S==="input"?this._connectDatepicker(d,R):k&&this._inlineDatepicker(d,R)},_newInst:function(d,b){var S=d[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:S,input:d,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,dpDiv:b?Ri(g("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(d,b){var S=g(d);b.append=g([]),b.trigger=g([]),!S.hasClass(this.markerClassName)&&(this._attachments(S,b),S.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(b),g.data(d,"datepicker",b),b.settings.disabled&&this._disableDatepicker(d))},_attachments:function(d,b){var S,k,R,W=this._get(b,"appendText"),se=this._get(b,"isRTL");b.append&&b.append.remove(),W&&(b.append=g("<span>").addClass(this._appendClass).text(W),d[se?"before":"after"](b.append)),d.off("focus",this._showDatepicker),b.trigger&&b.trigger.remove(),S=this._get(b,"showOn"),(S==="focus"||S==="both")&&d.on("focus",this._showDatepicker),(S==="button"||S==="both")&&(k=this._get(b,"buttonText"),R=this._get(b,"buttonImage"),this._get(b,"buttonImageOnly")?b.trigger=g("<img>").addClass(this._triggerClass).attr({src:R,alt:k,title:k}):(b.trigger=g("<button type='button'>").addClass(this._triggerClass),R?b.trigger.html(g("<img>").attr({src:R,alt:k,title:k})):b.trigger.text(k)),d[se?"before":"after"](b.trigger),b.trigger.on("click",function(){return g.datepicker._datepickerShowing&&g.datepicker._lastInput===d[0]?g.datepicker._hideDatepicker():(g.datepicker._datepickerShowing&&g.datepicker._lastInput!==d[0]&&g.datepicker._hideDatepicker(),g.datepicker._showDatepicker(d[0])),!1}))},_autoSize:function(d){if(this._get(d,"autoSize")&&!d.inline){var b,S,k,R,W=new Date(2009,11,20),se=this._get(d,"dateFormat");se.match(/[DM]/)&&(b=function(le){for(S=0,k=0,R=0;R<le.length;R++)le[R].length>S&&(S=le[R].length,k=R);return k},W.setMonth(b(this._get(d,se.match(/MM/)?"monthNames":"monthNamesShort"))),W.setDate(b(this._get(d,se.match(/DD/)?"dayNames":"dayNamesShort"))+20-W.getDay())),d.input.attr("size",this._formatDate(d,W).length)}},_inlineDatepicker:function(d,b){var S=g(d);S.hasClass(this.markerClassName)||(S.addClass(this.markerClassName).append(b.dpDiv),g.data(d,"datepicker",b),this._setDate(b,this._getDefaultDate(b),!0),this._updateDatepicker(b),this._updateAlternate(b),b.settings.disabled&&this._disableDatepicker(d),b.dpDiv.css("display","block"))},_dialogDatepicker:function(d,b,S,k,R){var W,se,le,fe,be,Te=this._dialogInst;return Te||(this.uuid+=1,W="dp"+this.uuid,this._dialogInput=g("<input type='text' id='"+W+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),g("body").append(this._dialogInput),Te=this._dialogInst=this._newInst(this._dialogInput,!1),Te.settings={},g.data(this._dialogInput[0],"datepicker",Te)),Li(Te.settings,k||{}),b=b&&b.constructor===Date?this._formatDate(Te,b):b,this._dialogInput.val(b),this._pos=R?R.length?R:[R.pageX,R.pageY]:null,this._pos||(se=document.documentElement.clientWidth,le=document.documentElement.clientHeight,fe=document.documentElement.scrollLeft||document.body.scrollLeft,be=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[se/2-100+fe,le/2-150+be]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),Te.settings.onSelect=S,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),g.blockUI&&g.blockUI(this.dpDiv),g.data(this._dialogInput[0],"datepicker",Te),this},_destroyDatepicker:function(d){var b,S=g(d),k=g.data(d,"datepicker");S.hasClass(this.markerClassName)&&(b=d.nodeName.toLowerCase(),g.removeData(d,"datepicker"),b==="input"?(k.append.remove(),k.trigger.remove(),S.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):(b==="div"||b==="span")&&S.removeClass(this.markerClassName).empty(),Pt===k&&(Pt=null,this._curInst=null))},_enableDatepicker:function(d){var b,S,k=g(d),R=g.data(d,"datepicker");k.hasClass(this.markerClassName)&&(b=d.nodeName.toLowerCase(),b==="input"?(d.disabled=!1,R.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):(b==="div"||b==="span")&&(S=k.children("."+this._inlineClass),S.children().removeClass("ui-state-disabled"),S.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=g.map(this._disabledInputs,function(W){return W===d?null:W}))},_disableDatepicker:function(d){var b,S,k=g(d),R=g.data(d,"datepicker");k.hasClass(this.markerClassName)&&(b=d.nodeName.toLowerCase(),b==="input"?(d.disabled=!0,R.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):(b==="div"||b==="span")&&(S=k.children("."+this._inlineClass),S.children().addClass("ui-state-disabled"),S.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=g.map(this._disabledInputs,function(W){return W===d?null:W}),this._disabledInputs[this._disabledInputs.length]=d)},_isDisabledDatepicker:function(d){if(!d)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]===d)return!0;return!1},_getInst:function(d){try{return g.data(d,"datepicker")}catch{throw"Missing instance data for this datepicker"}},_optionDatepicker:function(d,b,S){var k,R,W,se,le=this._getInst(d);if(arguments.length===2&&typeof b=="string")return b==="defaults"?g.extend({},g.datepicker._defaults):le?b==="all"?g.extend({},le.settings):this._get(le,b):null;k=b||{},typeof b=="string"&&(k={},k[b]=S),le&&(this._curInst===le&&this._hideDatepicker(),R=this._getDateDatepicker(d,!0),W=this._getMinMaxDate(le,"min"),se=this._getMinMaxDate(le,"max"),Li(le.settings,k),W!==null&&k.dateFormat!==void 0&&k.minDate===void 0&&(le.settings.minDate=this._formatDate(le,W)),se!==null&&k.dateFormat!==void 0&&k.maxDate===void 0&&(le.settings.maxDate=this._formatDate(le,se)),"disabled"in k&&(k.disabled?this._disableDatepicker(d):this._enableDatepicker(d)),this._attachments(g(d),le),this._autoSize(le),this._setDate(le,R),this._updateAlternate(le),this._updateDatepicker(le))},_changeDatepicker:function(d,b,S){this._optionDatepicker(d,b,S)},_refreshDatepicker:function(d){var b=this._getInst(d);b&&this._updateDatepicker(b)},_setDateDatepicker:function(d,b){var S=this._getInst(d);S&&(this._setDate(S,b),this._updateDatepicker(S),this._updateAlternate(S))},_getDateDatepicker:function(d,b){var S=this._getInst(d);return S&&!S.inline&&this._setDateFromField(S,b),S?this._getDate(S):null},_doKeyDown:function(d){var b,S,k,R=g.datepicker._getInst(d.target),W=!0,se=R.dpDiv.is(".ui-datepicker-rtl");if(R._keyEvent=!0,g.datepicker._datepickerShowing)switch(d.keyCode){case 9:g.datepicker._hideDatepicker(),W=!1;break;case 13:return k=g("td."+g.datepicker._dayOverClass+":not(."+g.datepicker._currentClass+")",R.dpDiv),k[0]&&g.datepicker._selectDay(d.target,R.selectedMonth,R.selectedYear,k[0]),b=g.datepicker._get(R,"onSelect"),b?(S=g.datepicker._formatDate(R),b.apply(R.input?R.input[0]:null,[S,R])):g.datepicker._hideDatepicker(),!1;case 27:g.datepicker._hideDatepicker();break;case 33:g.datepicker._adjustDate(d.target,d.ctrlKey?-g.datepicker._get(R,"stepBigMonths"):-g.datepicker._get(R,"stepMonths"),"M");break;case 34:g.datepicker._adjustDate(d.target,d.ctrlKey?+g.datepicker._get(R,"stepBigMonths"):+g.datepicker._get(R,"stepMonths"),"M");break;case 35:(d.ctrlKey||d.metaKey)&&g.datepicker._clearDate(d.target),W=d.ctrlKey||d.metaKey;break;case 36:(d.ctrlKey||d.metaKey)&&g.datepicker._gotoToday(d.target),W=d.ctrlKey||d.metaKey;break;case 37:(d.ctrlKey||d.metaKey)&&g.datepicker._adjustDate(d.target,se?1:-1,"D"),W=d.ctrlKey||d.metaKey,d.originalEvent.altKey&&g.datepicker._adjustDate(d.target,d.ctrlKey?-g.datepicker._get(R,"stepBigMonths"):-g.datepicker._get(R,"stepMonths"),"M");break;case 38:(d.ctrlKey||d.metaKey)&&g.datepicker._adjustDate(d.target,-7,"D"),W=d.ctrlKey||d.metaKey;break;case 39:(d.ctrlKey||d.metaKey)&&g.datepicker._adjustDate(d.target,se?-1:1,"D"),W=d.ctrlKey||d.metaKey,d.originalEvent.altKey&&g.datepicker._adjustDate(d.target,d.ctrlKey?+g.datepicker._get(R,"stepBigMonths"):+g.datepicker._get(R,"stepMonths"),"M");break;case 40:(d.ctrlKey||d.metaKey)&&g.datepicker._adjustDate(d.target,7,"D"),W=d.ctrlKey||d.metaKey;break;default:W=!1}else d.keyCode===36&&d.ctrlKey?g.datepicker._showDatepicker(this):W=!1;W&&(d.preventDefault(),d.stopPropagation())},_doKeyPress:function(d){var b,S,k=g.datepicker._getInst(d.target);if(g.datepicker._get(k,"constrainInput"))return b=g.datepicker._possibleChars(g.datepicker._get(k,"dateFormat")),S=String.fromCharCode(d.charCode==null?d.keyCode:d.charCode),d.ctrlKey||d.metaKey||S<" "||!b||b.indexOf(S)>-1},_doKeyUp:function(d){var b,S=g.datepicker._getInst(d.target);if(S.input.val()!==S.lastVal)try{b=g.datepicker.parseDate(g.datepicker._get(S,"dateFormat"),S.input?S.input.val():null,g.datepicker._getFormatConfig(S)),b&&(g.datepicker._setDateFromField(S),g.datepicker._updateAlternate(S),g.datepicker._updateDatepicker(S))}catch{}return!0},_showDatepicker:function(d){if(d=d.target||d,d.nodeName.toLowerCase()!=="input"&&(d=g("input",d.parentNode)[0]),!(g.datepicker._isDisabledDatepicker(d)||g.datepicker._lastInput===d)){var b,S,k,R,W,se,le;b=g.datepicker._getInst(d),g.datepicker._curInst&&g.datepicker._curInst!==b&&(g.datepicker._curInst.dpDiv.stop(!0,!0),b&&g.datepicker._datepickerShowing&&g.datepicker._hideDatepicker(g.datepicker._curInst.input[0])),S=g.datepicker._get(b,"beforeShow"),k=S?S.apply(d,[d,b]):{},k!==!1&&(Li(b.settings,k),b.lastVal=null,g.datepicker._lastInput=d,g.datepicker._setDateFromField(b),g.datepicker._inDialog&&(d.value=""),g.datepicker._pos||(g.datepicker._pos=g.datepicker._findPos(d),g.datepicker._pos[1]+=d.offsetHeight),R=!1,g(d).parents().each(function(){return R|=g(this).css("position")==="fixed",!R}),W={left:g.datepicker._pos[0],top:g.datepicker._pos[1]},g.datepicker._pos=null,b.dpDiv.empty(),b.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),g.datepicker._updateDatepicker(b),W=g.datepicker._checkOffset(b,W,R),b.dpDiv.css({position:g.datepicker._inDialog&&g.blockUI?"static":R?"fixed":"absolute",display:"none",left:W.left+"px",top:W.top+"px"}),b.inline||(se=g.datepicker._get(b,"showAnim"),le=g.datepicker._get(b,"duration"),b.dpDiv.css("z-index",Yt(g(d))+1),g.datepicker._datepickerShowing=!0,g.effects&&g.effects.effect[se]?b.dpDiv.show(se,g.datepicker._get(b,"showOptions"),le):b.dpDiv[se||"show"](se?le:null),g.datepicker._shouldFocusInput(b)&&b.input.trigger("focus"),g.datepicker._curInst=b))}},_updateDatepicker:function(d){this.maxRows=4,Pt=d,d.dpDiv.empty().append(this._generateHTML(d)),this._attachHandlers(d);var b,S=this._getNumberOfMonths(d),k=S[1],R=17,W=d.dpDiv.find("."+this._dayOverClass+" a"),se=g.datepicker._get(d,"onUpdateDatepicker");W.length>0&&Ei.apply(W.get(0)),d.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),k>1&&d.dpDiv.addClass("ui-datepicker-multi-"+k).css("width",R*k+"em"),d.dpDiv[(S[0]!==1||S[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi"),d.dpDiv[(this._get(d,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),d===g.datepicker._curInst&&g.datepicker._datepickerShowing&&g.datepicker._shouldFocusInput(d)&&d.input.trigger("focus"),d.yearshtml&&(b=d.yearshtml,setTimeout(function(){b===d.yearshtml&&d.yearshtml&&d.dpDiv.find("select.ui-datepicker-year").first().replaceWith(d.yearshtml),b=d.yearshtml=null},0)),se&&se.apply(d.input?d.input[0]:null,[d])},_shouldFocusInput:function(d){return d.input&&d.input.is(":visible")&&!d.input.is(":disabled")&&!d.input.is(":focus")},_checkOffset:function(d,b,S){var k=d.dpDiv.outerWidth(),R=d.dpDiv.outerHeight(),W=d.input?d.input.outerWidth():0,se=d.input?d.input.outerHeight():0,le=document.documentElement.clientWidth+(S?0:g(document).scrollLeft()),fe=document.documentElement.clientHeight+(S?0:g(document).scrollTop());return b.left-=this._get(d,"isRTL")?k-W:0,b.left-=S&&b.left===d.input.offset().left?g(document).scrollLeft():0,b.top-=S&&b.top===d.input.offset().top+se?g(document).scrollTop():0,b.left-=Math.min(b.left,b.left+k>le&&le>k?Math.abs(b.left+k-le):0),b.top-=Math.min(b.top,b.top+R>fe&&fe>R?Math.abs(R+se):0),b},_findPos:function(d){for(var b,S=this._getInst(d),k=this._get(S,"isRTL");d&&(d.type==="hidden"||d.nodeType!==1||g.expr.pseudos.hidden(d));)d=d[k?"previousSibling":"nextSibling"];return b=g(d).offset(),[b.left,b.top]},_hideDatepicker:function(d){var b,S,k,R,W=this._curInst;!W||d&&W!==g.data(d,"datepicker")||this._datepickerShowing&&(b=this._get(W,"showAnim"),S=this._get(W,"duration"),k=function(){g.datepicker._tidyDialog(W)},g.effects&&(g.effects.effect[b]||g.effects[b])?W.dpDiv.hide(b,g.datepicker._get(W,"showOptions"),S,k):W.dpDiv[b==="slideDown"?"slideUp":b==="fadeIn"?"fadeOut":"hide"](b?S:null,k),b||k(),this._datepickerShowing=!1,R=this._get(W,"onClose"),R&&R.apply(W.input?W.input[0]:null,[W.input?W.input.val():"",W]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),g.blockUI&&(g.unblockUI(),g("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(d){d.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(d){if(g.datepicker._curInst){var b=g(d.target),S=g.datepicker._getInst(b[0]);(b[0].id!==g.datepicker._mainDivId&&b.parents("#"+g.datepicker._mainDivId).length===0&&!b.hasClass(g.datepicker.markerClassName)&&!b.closest("."+g.datepicker._triggerClass).length&&g.datepicker._datepickerShowing&&!(g.datepicker._inDialog&&g.blockUI)||b.hasClass(g.datepicker.markerClassName)&&g.datepicker._curInst!==S)&&g.datepicker._hideDatepicker()}},_adjustDate:function(d,b,S){var k=g(d),R=this._getInst(k[0]);this._isDisabledDatepicker(k[0])||(this._adjustInstDate(R,b,S),this._updateDatepicker(R))},_gotoToday:function(d){var b,S=g(d),k=this._getInst(S[0]);this._get(k,"gotoCurrent")&&k.currentDay?(k.selectedDay=k.currentDay,k.drawMonth=k.selectedMonth=k.currentMonth,k.drawYear=k.selectedYear=k.currentYear):(b=new Date,k.selectedDay=b.getDate(),k.drawMonth=k.selectedMonth=b.getMonth(),k.drawYear=k.selectedYear=b.getFullYear()),this._notifyChange(k),this._adjustDate(S)},_selectMonthYear:function(d,b,S){var k=g(d),R=this._getInst(k[0]);R["selected"+(S==="M"?"Month":"Year")]=R["draw"+(S==="M"?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10),this._notifyChange(R),this._adjustDate(k)},_selectDay:function(d,b,S,k){var R,W=g(d);g(k).hasClass(this._unselectableClass)||this._isDisabledDatepicker(W[0])||(R=this._getInst(W[0]),R.selectedDay=R.currentDay=parseInt(g("a",k).attr("data-date")),R.selectedMonth=R.currentMonth=b,R.selectedYear=R.currentYear=S,this._selectDate(d,this._formatDate(R,R.currentDay,R.currentMonth,R.currentYear)))},_clearDate:function(d){var b=g(d);this._selectDate(b,"")},_selectDate:function(d,b){var S,k=g(d),R=this._getInst(k[0]);b=b??this._formatDate(R),R.input&&R.input.val(b),this._updateAlternate(R),S=this._get(R,"onSelect"),S?S.apply(R.input?R.input[0]:null,[b,R]):R.input&&R.input.trigger("change"),R.inline?this._updateDatepicker(R):(this._hideDatepicker(),this._lastInput=R.input[0],typeof R.input[0]!="object"&&R.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(d){var b,S,k,R=this._get(d,"altField");R&&(b=this._get(d,"altFormat")||this._get(d,"dateFormat"),S=this._getDate(d),k=this.formatDate(b,S,this._getFormatConfig(d)),g(document).find(R).val(k))},noWeekends:function(d){var b=d.getDay();return[b>0&&b<6,""]},iso8601Week:function(d){var b,S=new Date(d.getTime());return S.setDate(S.getDate()+4-(S.getDay()||7)),b=S.getTime(),S.setMonth(0),S.setDate(1),Math.floor(Math.round((b-S)/864e5)/7)+1},parseDate:function(d,b,S){if(d==null||b==null)throw"Invalid arguments";if(b=typeof b=="object"?b.toString():b+"",b==="")return null;var k,R,W,se=0,le=(S?S.shortYearCutoff:null)||this._defaults.shortYearCutoff,fe=typeof le!="string"?le:new Date().getFullYear()%100+parseInt(le,10),be=(S?S.dayNamesShort:null)||this._defaults.dayNamesShort,Te=(S?S.dayNames:null)||this._defaults.dayNames,Ve=(S?S.monthNamesShort:null)||this._defaults.monthNamesShort,Ue=(S?S.monthNames:null)||this._defaults.monthNames,me=-1,ke=-1,qe=-1,lt=-1,pt=!1,Ft,zt=function(ri){var ci=k+1<d.length&&d.charAt(k+1)===ri;return ci&&k++,ci},Nt=function(ri){var ci=zt(ri),wt=ri==="@"?14:ri==="!"?20:ri==="y"&&ci?4:ri==="o"?3:2,di=ri==="y"?wt:1,ii=new RegExp("^\\d{"+di+","+wt+"}"),Hi=b.substring(se).match(ii);if(!Hi)throw"Missing number at position "+se;return se+=Hi[0].length,parseInt(Hi[0],10)},Mt=function(ri,ci,wt){var di=-1,ii=g.map(zt(ri)?wt:ci,function(Hi,Vi){return[[Vi,Hi]]}).sort(function(Hi,Vi){return-(Hi[1].length-Vi[1].length)});if(g.each(ii,function(Hi,Vi){var Ot=Vi[1];if(b.substr(se,Ot.length).toLowerCase()===Ot.toLowerCase())return di=Vi[0],se+=Ot.length,!1}),di!==-1)return di+1;throw"Unknown name at position "+se},$t=function(){if(b.charAt(se)!==d.charAt(k))throw"Unexpected literal at position "+se;se++};for(k=0;k<d.length;k++)if(pt)d.charAt(k)==="'"&&!zt("'")?pt=!1:$t();else switch(d.charAt(k)){case"d":qe=Nt("d");break;case"D":Mt("D",be,Te);break;case"o":lt=Nt("o");break;case"m":ke=Nt("m");break;case"M":ke=Mt("M",Ve,Ue);break;case"y":me=Nt("y");break;case"@":Ft=new Date(Nt("@")),me=Ft.getFullYear(),ke=Ft.getMonth()+1,qe=Ft.getDate();break;case"!":Ft=new Date((Nt("!")-this._ticksTo1970)/1e4),me=Ft.getFullYear(),ke=Ft.getMonth()+1,qe=Ft.getDate();break;case"'":zt("'")?$t():pt=!0;break;default:$t()}if(se<b.length&&(W=b.substr(se),!/^\s+/.test(W)))throw"Extra/unparsed characters found in date: "+W;if(me===-1?me=new Date().getFullYear():me<100&&(me+=new Date().getFullYear()-new Date().getFullYear()%100+(me<=fe?0:-100)),lt>-1){ke=1,qe=lt;do{if(R=this._getDaysInMonth(me,ke-1),qe<=R)break;ke++,qe-=R}while(!0)}if(Ft=this._daylightSavingAdjust(new Date(me,ke-1,qe)),Ft.getFullYear()!==me||Ft.getMonth()+1!==ke||Ft.getDate()!==qe)throw"Invalid date";return Ft},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(1969*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*1e7,formatDate:function(d,b,S){if(!b)return"";var k,R=(S?S.dayNamesShort:null)||this._defaults.dayNamesShort,W=(S?S.dayNames:null)||this._defaults.dayNames,se=(S?S.monthNamesShort:null)||this._defaults.monthNamesShort,le=(S?S.monthNames:null)||this._defaults.monthNames,fe=function(me){var ke=k+1<d.length&&d.charAt(k+1)===me;return ke&&k++,ke},be=function(me,ke,qe){var lt=""+ke;if(fe(me))for(;lt.length<qe;)lt="0"+lt;return lt},Te=function(me,ke,qe,lt){return fe(me)?lt[ke]:qe[ke]},Ve="",Ue=!1;if(b)for(k=0;k<d.length;k++)if(Ue)d.charAt(k)==="'"&&!fe("'")?Ue=!1:Ve+=d.charAt(k);else switch(d.charAt(k)){case"d":Ve+=be("d",b.getDate(),2);break;case"D":Ve+=Te("D",b.getDay(),R,W);break;case"o":Ve+=be("o",Math.round((new Date(b.getFullYear(),b.getMonth(),b.getDate()).getTime()-new Date(b.getFullYear(),0,0).getTime())/864e5),3);break;case"m":Ve+=be("m",b.getMonth()+1,2);break;case"M":Ve+=Te("M",b.getMonth(),se,le);break;case"y":Ve+=fe("y")?b.getFullYear():(b.getFullYear()%100<10?"0":"")+b.getFullYear()%100;break;case"@":Ve+=b.getTime();break;case"!":Ve+=b.getTime()*1e4+this._ticksTo1970;break;case"'":fe("'")?Ve+="'":Ue=!0;break;default:Ve+=d.charAt(k)}return Ve},_possibleChars:function(d){var b,S="",k=!1,R=function(W){var se=b+1<d.length&&d.charAt(b+1)===W;return se&&b++,se};for(b=0;b<d.length;b++)if(k)d.charAt(b)==="'"&&!R("'")?k=!1:S+=d.charAt(b);else switch(d.charAt(b)){case"d":case"m":case"y":case"@":S+="0123456789";break;case"D":case"M":return null;case"'":R("'")?S+="'":k=!0;break;default:S+=d.charAt(b)}return S},_get:function(d,b){return d.settings[b]!==void 0?d.settings[b]:this._defaults[b]},_setDateFromField:function(d,b){if(d.input.val()!==d.lastVal){var S=this._get(d,"dateFormat"),k=d.lastVal=d.input?d.input.val():null,R=this._getDefaultDate(d),W=R,se=this._getFormatConfig(d);try{W=this.parseDate(S,k,se)||R}catch{k=b?"":k}d.selectedDay=W.getDate(),d.drawMonth=d.selectedMonth=W.getMonth(),d.drawYear=d.selectedYear=W.getFullYear(),d.currentDay=k?W.getDate():0,d.currentMonth=k?W.getMonth():0,d.currentYear=k?W.getFullYear():0,this._adjustInstDate(d)}},_getDefaultDate:function(d){return this._restrictMinMax(d,this._determineDate(d,this._get(d,"defaultDate"),new Date))},_determineDate:function(d,b,S){var k=function(se){var le=new Date;return le.setDate(le.getDate()+se),le},R=function(se){try{return g.datepicker.parseDate(g.datepicker._get(d,"dateFormat"),se,g.datepicker._getFormatConfig(d))}catch{}for(var le=(se.toLowerCase().match(/^c/)?g.datepicker._getDate(d):null)||new Date,fe=le.getFullYear(),be=le.getMonth(),Te=le.getDate(),Ve=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,Ue=Ve.exec(se);Ue;){switch(Ue[2]||"d"){case"d":case"D":Te+=parseInt(Ue[1],10);break;case"w":case"W":Te+=parseInt(Ue[1],10)*7;break;case"m":case"M":be+=parseInt(Ue[1],10),Te=Math.min(Te,g.datepicker._getDaysInMonth(fe,be));break;case"y":case"Y":fe+=parseInt(Ue[1],10),Te=Math.min(Te,g.datepicker._getDaysInMonth(fe,be));break}Ue=Ve.exec(se)}return new Date(fe,be,Te)},W=b==null||b===""?S:typeof b=="string"?R(b):typeof b=="number"?isNaN(b)?S:k(b):new Date(b.getTime());return W=W&&W.toString()==="Invalid Date"?S:W,W&&(W.setHours(0),W.setMinutes(0),W.setSeconds(0),W.setMilliseconds(0)),this._daylightSavingAdjust(W)},_daylightSavingAdjust:function(d){return d?(d.setHours(d.getHours()>12?d.getHours()+2:0),d):null},_setDate:function(d,b,S){var k=!b,R=d.selectedMonth,W=d.selectedYear,se=this._restrictMinMax(d,this._determineDate(d,b,new Date));d.selectedDay=d.currentDay=se.getDate(),d.drawMonth=d.selectedMonth=d.currentMonth=se.getMonth(),d.drawYear=d.selectedYear=d.currentYear=se.getFullYear(),(R!==d.selectedMonth||W!==d.selectedYear)&&!S&&this._notifyChange(d),this._adjustInstDate(d),d.input&&d.input.val(k?"":this._formatDate(d))},_getDate:function(d){var b=!d.currentYear||d.input&&d.input.val()===""?null:this._daylightSavingAdjust(new Date(d.currentYear,d.currentMonth,d.currentDay));return b},_attachHandlers:function(d){var b=this._get(d,"stepMonths"),S="#"+d.id.replace(/\\\\/g,"\\");d.dpDiv.find("[data-handler]").map(function(){var k={prev:function(){g.datepicker._adjustDate(S,-b,"M")},next:function(){g.datepicker._adjustDate(S,+b,"M")},hide:function(){g.datepicker._hideDatepicker()},today:function(){g.datepicker._gotoToday(S)},selectDay:function(){return g.datepicker._selectDay(S,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return g.datepicker._selectMonthYear(S,this,"M"),!1},selectYear:function(){return g.datepicker._selectMonthYear(S,this,"Y"),!1}};g(this).on(this.getAttribute("data-event"),k[this.getAttribute("data-handler")])})},_generateHTML:function(d){var b,S,k,R,W,se,le,fe,be,Te,Ve,Ue,me,ke,qe,lt,pt,Ft,zt,Nt,Mt,$t,ri,ci,wt,di,ii,Hi,Vi,Ot,_i,Ti,Wi,Zt,mi,bi,$i,tr,Ar,Tr=new Date,ji=this._daylightSavingAdjust(new Date(Tr.getFullYear(),Tr.getMonth(),Tr.getDate())),Ii=this._get(d,"isRTL"),Qs=this._get(d,"showButtonPanel"),$r=this._get(d,"hideIfNoPrevNext"),it=this._get(d,"navigationAsDateFormat"),Ie=this._getNumberOfMonths(d),ce=this._get(d,"showCurrentAtPos"),ye=this._get(d,"stepMonths"),xe=Ie[0]!==1||Ie[1]!==1,Me=this._daylightSavingAdjust(d.currentDay?new Date(d.currentYear,d.currentMonth,d.currentDay):new Date(9999,9,9)),Ge=this._getMinMaxDate(d,"min"),Le=this._getMinMaxDate(d,"max"),Ke=d.drawMonth-ce,st=d.drawYear;if(Ke<0&&(Ke+=12,st--),Le)for(b=this._daylightSavingAdjust(new Date(Le.getFullYear(),Le.getMonth()-Ie[0]*Ie[1]+1,Le.getDate())),b=Ge&&b<Ge?Ge:b;this._daylightSavingAdjust(new Date(st,Ke,1))>b;)Ke--,Ke<0&&(Ke=11,st--);for(d.drawMonth=Ke,d.drawYear=st,S=this._get(d,"prevText"),S=it?this.formatDate(S,this._daylightSavingAdjust(new Date(st,Ke-ye,1)),this._getFormatConfig(d)):S,this._canAdjustMonth(d,-1,st,Ke)?k=g("<a>").attr({class:"ui-datepicker-prev ui-corner-all","data-handler":"prev","data-event":"click",title:S}).append(g("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(Ii?"e":"w")).text(S))[0].outerHTML:$r?k="":k=g("<a>").attr({class:"ui-datepicker-prev ui-corner-all ui-state-disabled",title:S}).append(g("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(Ii?"e":"w")).text(S))[0].outerHTML,R=this._get(d,"nextText"),R=it?this.formatDate(R,this._daylightSavingAdjust(new Date(st,Ke+ye,1)),this._getFormatConfig(d)):R,this._canAdjustMonth(d,1,st,Ke)?W=g("<a>").attr({class:"ui-datepicker-next ui-corner-all","data-handler":"next","data-event":"click",title:R}).append(g("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(Ii?"w":"e")).text(R))[0].outerHTML:$r?W="":W=g("<a>").attr({class:"ui-datepicker-next ui-corner-all ui-state-disabled",title:R}).append(g("<span>").attr("class","ui-icon ui-icon-circle-triangle-"+(Ii?"w":"e")).text(R))[0].outerHTML,se=this._get(d,"currentText"),le=this._get(d,"gotoCurrent")&&d.currentDay?Me:ji,se=it?this.formatDate(se,le,this._getFormatConfig(d)):se,fe="",d.inline||(fe=g("<button>").attr({type:"button",class:"ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all","data-handler":"hide","data-event":"click"}).text(this._get(d,"closeText"))[0].outerHTML),be="",Qs&&(be=g("<div class='ui-datepicker-buttonpane ui-widget-content'>").append(Ii?fe:"").append(this._isInRange(d,le)?g("<button>").attr({type:"button",class:"ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all","data-handler":"today","data-event":"click"}).text(se):"").append(Ii?"":fe)[0].outerHTML),Te=parseInt(this._get(d,"firstDay"),10),Te=isNaN(Te)?0:Te,Ve=this._get(d,"showWeek"),Ue=this._get(d,"dayNames"),me=this._get(d,"dayNamesMin"),ke=this._get(d,"monthNames"),qe=this._get(d,"monthNamesShort"),lt=this._get(d,"beforeShowDay"),pt=this._get(d,"showOtherMonths"),Ft=this._get(d,"selectOtherMonths"),zt=this._getDefaultDate(d),Nt="",$t=0;$t<Ie[0];$t++){for(ri="",this.maxRows=4,ci=0;ci<Ie[1];ci++){if(wt=this._daylightSavingAdjust(new Date(st,Ke,d.selectedDay)),di=" ui-corner-all",ii="",xe){if(ii+="<div class='ui-datepicker-group",Ie[1]>1)switch(ci){case 0:ii+=" ui-datepicker-group-first",di=" ui-corner-"+(Ii?"right":"left");break;case Ie[1]-1:ii+=" ui-datepicker-group-last",di=" ui-corner-"+(Ii?"left":"right");break;default:ii+=" ui-datepicker-group-middle",di="";break}ii+="'>"}for(ii+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+di+"'>"+(/all|left/.test(di)&&$t===0?Ii?W:k:"")+(/all|right/.test(di)&&$t===0?Ii?k:W:"")+this._generateMonthYearHeader(d,Ke,st,Ge,Le,$t>0||ci>0,ke,qe)+"</div><table class='ui-datepicker-calendar'><thead><tr>",Hi=Ve?"<th class='ui-datepicker-week-col'>"+this._get(d,"weekHeader")+"</th>":"",Mt=0;Mt<7;Mt++)Vi=(Mt+Te)%7,Hi+="<th scope='col'"+((Mt+Te+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+Ue[Vi]+"'>"+me[Vi]+"</span></th>";for(ii+=Hi+"</tr></thead><tbody>",Ot=this._getDaysInMonth(st,Ke),st===d.selectedYear&&Ke===d.selectedMonth&&(d.selectedDay=Math.min(d.selectedDay,Ot)),_i=(this._getFirstDayOfMonth(st,Ke)-Te+7)%7,Ti=Math.ceil((_i+Ot)/7),Wi=xe&&this.maxRows>Ti?this.maxRows:Ti,this.maxRows=Wi,Zt=this._daylightSavingAdjust(new Date(st,Ke,1-_i)),mi=0;mi<Wi;mi++){for(ii+="<tr>",bi=Ve?"<td class='ui-datepicker-week-col'>"+this._get(d,"calculateWeek")(Zt)+"</td>":"",Mt=0;Mt<7;Mt++)$i=lt?lt.apply(d.input?d.input[0]:null,[Zt]):[!0,""],tr=Zt.getMonth()!==Ke,Ar=tr&&!Ft||!$i[0]||Ge&&Zt<Ge||Le&&Zt>Le,bi+="<td class='"+((Mt+Te+6)%7>=5?" ui-datepicker-week-end":"")+(tr?" ui-datepicker-other-month":"")+(Zt.getTime()===wt.getTime()&&Ke===d.selectedMonth&&d._keyEvent||zt.getTime()===Zt.getTime()&&zt.getTime()===wt.getTime()?" "+this._dayOverClass:"")+(Ar?" "+this._unselectableClass+" ui-state-disabled":"")+(tr&&!pt?"":" "+$i[1]+(Zt.getTime()===Me.getTime()?" "+this._currentClass:"")+(Zt.getTime()===ji.getTime()?" ui-datepicker-today":""))+"'"+((!tr||pt)&&$i[2]?" title='"+$i[2].replace(/'/g,"&#39;")+"'":"")+(Ar?"":" data-handler='selectDay' data-event='click' data-month='"+Zt.getMonth()+"' data-year='"+Zt.getFullYear()+"'")+">"+(tr&&!pt?"&#xa0;":Ar?"<span class='ui-state-default'>"+Zt.getDate()+"</span>":"<a class='ui-state-default"+(Zt.getTime()===ji.getTime()?" ui-state-highlight":"")+(Zt.getTime()===Me.getTime()?" ui-state-active":"")+(tr?" ui-priority-secondary":"")+"' href='#' aria-current='"+(Zt.getTime()===Me.getTime()?"true":"false")+"' data-date='"+Zt.getDate()+"'>"+Zt.getDate()+"</a>")+"</td>",Zt.setDate(Zt.getDate()+1),Zt=this._daylightSavingAdjust(Zt);ii+=bi+"</tr>"}Ke++,Ke>11&&(Ke=0,st++),ii+="</tbody></table>"+(xe?"</div>"+(Ie[0]>0&&ci===Ie[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),ri+=ii}Nt+=ri}return Nt+=be,d._keyEvent=!1,Nt},_generateMonthYearHeader:function(d,b,S,k,R,W,se,le){var fe,be,Te,Ve,Ue,me,ke,qe,lt=this._get(d,"changeMonth"),pt=this._get(d,"changeYear"),Ft=this._get(d,"showMonthAfterYear"),zt=this._get(d,"selectMonthLabel"),Nt=this._get(d,"selectYearLabel"),Mt="<div class='ui-datepicker-title'>",$t="";if(W||!lt)$t+="<span class='ui-datepicker-month'>"+se[b]+"</span>";else{for(fe=k&&k.getFullYear()===S,be=R&&R.getFullYear()===S,$t+="<select class='ui-datepicker-month' aria-label='"+zt+"' data-handler='selectMonth' data-event='change'>",Te=0;Te<12;Te++)(!fe||Te>=k.getMonth())&&(!be||Te<=R.getMonth())&&($t+="<option value='"+Te+"'"+(Te===b?" selected='selected'":"")+">"+le[Te]+"</option>");$t+="</select>"}if(Ft||(Mt+=$t+(W||!(lt&&pt)?"&#xa0;":"")),!d.yearshtml)if(d.yearshtml="",W||!pt)Mt+="<span class='ui-datepicker-year'>"+S+"</span>";else{for(Ve=this._get(d,"yearRange").split(":"),Ue=new Date().getFullYear(),me=function(ri){var ci=ri.match(/c[+\-].*/)?S+parseInt(ri.substring(1),10):ri.match(/[+\-].*/)?Ue+parseInt(ri,10):parseInt(ri,10);return isNaN(ci)?Ue:ci},ke=me(Ve[0]),qe=Math.max(ke,me(Ve[1]||"")),ke=k?Math.max(ke,k.getFullYear()):ke,qe=R?Math.min(qe,R.getFullYear()):qe,d.yearshtml+="<select class='ui-datepicker-year' aria-label='"+Nt+"' data-handler='selectYear' data-event='change'>";ke<=qe;ke++)d.yearshtml+="<option value='"+ke+"'"+(ke===S?" selected='selected'":"")+">"+ke+"</option>";d.yearshtml+="</select>",Mt+=d.yearshtml,d.yearshtml=null}return Mt+=this._get(d,"yearSuffix"),Ft&&(Mt+=(W||!(lt&&pt)?"&#xa0;":"")+$t),Mt+="</div>",Mt},_adjustInstDate:function(d,b,S){var k=d.selectedYear+(S==="Y"?b:0),R=d.selectedMonth+(S==="M"?b:0),W=Math.min(d.selectedDay,this._getDaysInMonth(k,R))+(S==="D"?b:0),se=this._restrictMinMax(d,this._daylightSavingAdjust(new Date(k,R,W)));d.selectedDay=se.getDate(),d.drawMonth=d.selectedMonth=se.getMonth(),d.drawYear=d.selectedYear=se.getFullYear(),(S==="M"||S==="Y")&&this._notifyChange(d)},_restrictMinMax:function(d,b){var S=this._getMinMaxDate(d,"min"),k=this._getMinMaxDate(d,"max"),R=S&&b<S?S:b;return k&&R>k?k:R},_notifyChange:function(d){var b=this._get(d,"onChangeMonthYear");b&&b.apply(d.input?d.input[0]:null,[d.selectedYear,d.selectedMonth+1,d])},_getNumberOfMonths:function(d){var b=this._get(d,"numberOfMonths");return b==null?[1,1]:typeof b=="number"?[1,b]:b},_getMinMaxDate:function(d,b){return this._determineDate(d,this._get(d,b+"Date"),null)},_getDaysInMonth:function(d,b){return 32-this._daylightSavingAdjust(new Date(d,b,32)).getDate()},_getFirstDayOfMonth:function(d,b){return new Date(d,b,1).getDay()},_canAdjustMonth:function(d,b,S,k){var R=this._getNumberOfMonths(d),W=this._daylightSavingAdjust(new Date(S,k+(b<0?b:R[0]*R[1]),1));return b<0&&W.setDate(this._getDaysInMonth(W.getFullYear(),W.getMonth())),this._isInRange(d,W)},_isInRange:function(d,b){var S,k,R=this._getMinMaxDate(d,"min"),W=this._getMinMaxDate(d,"max"),se=null,le=null,fe=this._get(d,"yearRange");return fe&&(S=fe.split(":"),k=new Date().getFullYear(),se=parseInt(S[0],10),le=parseInt(S[1],10),S[0].match(/[+\-].*/)&&(se+=k),S[1].match(/[+\-].*/)&&(le+=k)),(!R||b.getTime()>=R.getTime())&&(!W||b.getTime()<=W.getTime())&&(!se||b.getFullYear()>=se)&&(!le||b.getFullYear()<=le)},_getFormatConfig:function(d){var b=this._get(d,"shortYearCutoff");return b=typeof b!="string"?b:new Date().getFullYear()%100+parseInt(b,10),{shortYearCutoff:b,dayNamesShort:this._get(d,"dayNamesShort"),dayNames:this._get(d,"dayNames"),monthNamesShort:this._get(d,"monthNamesShort"),monthNames:this._get(d,"monthNames")}},_formatDate:function(d,b,S,k){b||(d.currentDay=d.selectedDay,d.currentMonth=d.selectedMonth,d.currentYear=d.selectedYear);var R=b?typeof b=="object"?b:this._daylightSavingAdjust(new Date(k,S,b)):this._daylightSavingAdjust(new Date(d.currentYear,d.currentMonth,d.currentDay));return this.formatDate(this._get(d,"dateFormat"),R,this._getFormatConfig(d))}});function Ri(d){var b="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return d.on("mouseout",b,function(){g(this).removeClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&g(this).removeClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&g(this).removeClass("ui-datepicker-next-hover")}).on("mouseover",b,Ei)}function Ei(){g.datepicker._isDisabledDatepicker(Pt.inline?Pt.dpDiv.parent()[0]:Pt.input[0])||(g(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),g(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&g(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&g(this).addClass("ui-datepicker-next-hover"))}function Li(d,b){g.extend(d,b);for(var S in b)b[S]==null&&(d[S]=b[S]);return d}g.fn.datepicker=function(d){if(!this.length)return this;g.datepicker.initialized||(g(document).on("mousedown",g.datepicker._checkExternalClick),g.datepicker.initialized=!0),g("#"+g.datepicker._mainDivId).length===0&&g("body").append(g.datepicker.dpDiv);var b=Array.prototype.slice.call(arguments,1);return typeof d=="string"&&(d==="isDisabled"||d==="getDate"||d==="widget")?g.datepicker["_"+d+"Datepicker"].apply(g.datepicker,[this[0]].concat(b)):d==="option"&&arguments.length===2&&typeof arguments[1]=="string"?g.datepicker["_"+d+"Datepicker"].apply(g.datepicker,[this[0]].concat(b)):this.each(function(){typeof d=="string"?g.datepicker["_"+d+"Datepicker"].apply(g.datepicker,[this].concat(b)):g.datepicker._attachDatepicker(this,d)})},g.datepicker=new Ai,g.datepicker.initialized=!1,g.datepicker.uuid=new Date().getTime(),g.datepicker.version="1.13.2",g.datepicker,g.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());/*!
 * jQuery UI Mouse 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */var Yi=!1;g(document).on("mouseup",function(){Yi=!1}),g.widget("ui.mouse",{version:"1.13.2",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var d=this;this.element.on("mousedown."+this.widgetName,function(b){return d._mouseDown(b)}).on("click."+this.widgetName,function(b){if(g.data(b.target,d.widgetName+".preventClickEvent")===!0)return g.removeData(b.target,d.widgetName+".preventClickEvent"),b.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(d){if(!Yi){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(d),this._mouseDownEvent=d;var b=this,S=d.which===1,k=typeof this.options.cancel=="string"&&d.target.nodeName?g(d.target).closest(this.options.cancel).length:!1;return!S||k||!this._mouseCapture(d)?!0:(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){b.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(d)&&this._mouseDelayMet(d)&&(this._mouseStarted=this._mouseStart(d)!==!1,!this._mouseStarted)?(d.preventDefault(),!0):(g.data(d.target,this.widgetName+".preventClickEvent")===!0&&g.removeData(d.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(R){return b._mouseMove(R)},this._mouseUpDelegate=function(R){return b._mouseUp(R)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),d.preventDefault(),Yi=!0,!0))}},_mouseMove:function(d){if(this._mouseMoved){if(g.ui.ie&&(!document.documentMode||document.documentMode<9)&&!d.button)return this._mouseUp(d);if(!d.which){if(d.originalEvent.altKey||d.originalEvent.ctrlKey||d.originalEvent.metaKey||d.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(d)}}return(d.which||d.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(d),d.preventDefault()):(this._mouseDistanceMet(d)&&this._mouseDelayMet(d)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,d)!==!1,this._mouseStarted?this._mouseDrag(d):this._mouseUp(d)),!this._mouseStarted)},_mouseUp:function(d){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,d.target===this._mouseDownEvent.target&&g.data(d.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(d)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,Yi=!1,d.preventDefault()},_mouseDistanceMet:function(d){return Math.max(Math.abs(this._mouseDownEvent.pageX-d.pageX),Math.abs(this._mouseDownEvent.pageY-d.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),g.ui.plugin={add:function(d,b,S){var k,R=g.ui[d].prototype;for(k in S)R.plugins[k]=R.plugins[k]||[],R.plugins[k].push([b,S[k]])},call:function(d,b,S,k){var R,W=d.plugins[b];if(W&&!(!k&&(!d.element[0].parentNode||d.element[0].parentNode.nodeType===11)))for(R=0;R<W.length;R++)d.options[W[R][0]]&&W[R][1].apply(d.element,S)}},g.ui.safeBlur=function(d){d&&d.nodeName.toLowerCase()!=="body"&&g(d).trigger("blur")};/*!
 * jQuery UI Draggable 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.draggable",g.ui.mouse,{version:"1.13.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){this.options.helper==="original"&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(d,b){this._super(d,b),d==="handle"&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){if((this.helper||this.element).is(".ui-draggable-dragging")){this.destroyOnClear=!0;return}this._removeHandleClassName(),this._mouseDestroy()},_mouseCapture:function(d){var b=this.options;return this.helper||b.disabled||g(d.target).closest(".ui-resizable-handle").length>0||(this.handle=this._getHandle(d),!this.handle)?!1:(this._blurActiveElement(d),this._blockFrames(b.iframeFix===!0?"iframe":b.iframeFix),!0)},_blockFrames:function(d){this.iframeBlocks=this.document.find(d).map(function(){var b=g(this);return g("<div>").css("position","absolute").appendTo(b.parent()).outerWidth(b.outerWidth()).outerHeight(b.outerHeight()).offset(b.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(d){var b=g.ui.safeActiveElement(this.document[0]),S=g(d.target);S.closest(b).length||g.ui.safeBlur(b)},_mouseStart:function(d){var b=this.options;return this.helper=this._createHelper(d),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),g.ui.ddmanager&&(g.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return g(this).css("position")==="fixed"}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(d),this.originalPosition=this.position=this._generatePosition(d,!1),this.originalPageX=d.pageX,this.originalPageY=d.pageY,b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt),this._setContainment(),this._trigger("start",d)===!1?(this._clear(),!1):(this._cacheHelperProportions(),g.ui.ddmanager&&!b.dropBehaviour&&g.ui.ddmanager.prepareOffsets(this,d),this._mouseDrag(d,!0),g.ui.ddmanager&&g.ui.ddmanager.dragStart(this,d),!0)},_refreshOffsets:function(d){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:d.pageX-this.offset.left,top:d.pageY-this.offset.top}},_mouseDrag:function(d,b){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(d,!0),this.positionAbs=this._convertPositionTo("absolute"),!b){var S=this._uiHash();if(this._trigger("drag",d,S)===!1)return this._mouseUp(new g.Event("mouseup",d)),!1;this.position=S.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",g.ui.ddmanager&&g.ui.ddmanager.drag(this,d),!1},_mouseStop:function(d){var b=this,S=!1;return g.ui.ddmanager&&!this.options.dropBehaviour&&(S=g.ui.ddmanager.drop(this,d)),this.dropped&&(S=this.dropped,this.dropped=!1),this.options.revert==="invalid"&&!S||this.options.revert==="valid"&&S||this.options.revert===!0||typeof this.options.revert=="function"&&this.options.revert.call(this.element,S)?g(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){b._trigger("stop",d)!==!1&&b._clear()}):this._trigger("stop",d)!==!1&&this._clear(),!1},_mouseUp:function(d){return this._unblockFrames(),g.ui.ddmanager&&g.ui.ddmanager.dragStop(this,d),this.handleElement.is(d.target)&&this.element.trigger("focus"),g.ui.mouse.prototype._mouseUp.call(this,d)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new g.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(d){return this.options.handle?!!g(d.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(d){var b=this.options,S=typeof b.helper=="function",k=S?g(b.helper.apply(this.element[0],[d])):b.helper==="clone"?this.element.clone().removeAttr("id"):this.element;return k.parents("body").length||k.appendTo(b.appendTo==="parent"?this.element[0].parentNode:b.appendTo),S&&k[0]===this.element[0]&&this._setPositionRelative(),k[0]!==this.element[0]&&!/(fixed|absolute)/.test(k.css("position"))&&k.css("position","absolute"),k},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(d){typeof d=="string"&&(d=d.split(" ")),Array.isArray(d)&&(d={left:+d[0],top:+d[1]||0}),"left"in d&&(this.offset.click.left=d.left+this.margins.left),"right"in d&&(this.offset.click.left=this.helperProportions.width-d.right+this.margins.left),"top"in d&&(this.offset.click.top=d.top+this.margins.top),"bottom"in d&&(this.offset.click.top=this.helperProportions.height-d.bottom+this.margins.top)},_isRootNode:function(d){return/(html|body)/i.test(d.tagName)||d===this.document[0]},_getParentOffset:function(){var d=this.offsetParent.offset(),b=this.document[0];return this.cssPosition==="absolute"&&this.scrollParent[0]!==b&&g.contains(this.scrollParent[0],this.offsetParent[0])&&(d.left+=this.scrollParent.scrollLeft(),d.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(d={top:0,left:0}),{top:d.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:d.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition!=="relative")return{top:0,left:0};var d=this.element.position(),b=this._isRootNode(this.scrollParent[0]);return{top:d.top-(parseInt(this.helper.css("top"),10)||0)+(b?0:this.scrollParent.scrollTop()),left:d.left-(parseInt(this.helper.css("left"),10)||0)+(b?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var d,b,S,k=this.options,R=this.document[0];if(this.relativeContainer=null,!k.containment){this.containment=null;return}if(k.containment==="window"){this.containment=[g(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,g(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,g(window).scrollLeft()+g(window).width()-this.helperProportions.width-this.margins.left,g(window).scrollTop()+(g(window).height()||R.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(k.containment==="document"){this.containment=[0,0,g(R).width()-this.helperProportions.width-this.margins.left,(g(R).height()||R.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(k.containment.constructor===Array){this.containment=k.containment;return}k.containment==="parent"&&(k.containment=this.helper[0].parentNode),b=g(k.containment),S=b[0],S&&(d=/(scroll|auto)/.test(b.css("overflow")),this.containment=[(parseInt(b.css("borderLeftWidth"),10)||0)+(parseInt(b.css("paddingLeft"),10)||0),(parseInt(b.css("borderTopWidth"),10)||0)+(parseInt(b.css("paddingTop"),10)||0),(d?Math.max(S.scrollWidth,S.offsetWidth):S.offsetWidth)-(parseInt(b.css("borderRightWidth"),10)||0)-(parseInt(b.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(d?Math.max(S.scrollHeight,S.offsetHeight):S.offsetHeight)-(parseInt(b.css("borderBottomWidth"),10)||0)-(parseInt(b.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=b)},_convertPositionTo:function(d,b){b||(b=this.position);var S=d==="absolute"?1:-1,k=this._isRootNode(this.scrollParent[0]);return{top:b.top+this.offset.relative.top*S+this.offset.parent.top*S-(this.cssPosition==="fixed"?-this.offset.scroll.top:k?0:this.offset.scroll.top)*S,left:b.left+this.offset.relative.left*S+this.offset.parent.left*S-(this.cssPosition==="fixed"?-this.offset.scroll.left:k?0:this.offset.scroll.left)*S}},_generatePosition:function(d,b){var S,k,R,W,se=this.options,le=this._isRootNode(this.scrollParent[0]),fe=d.pageX,be=d.pageY;return(!le||!this.offset.scroll)&&(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),b&&(this.containment&&(this.relativeContainer?(k=this.relativeContainer.offset(),S=[this.containment[0]+k.left,this.containment[1]+k.top,this.containment[2]+k.left,this.containment[3]+k.top]):S=this.containment,d.pageX-this.offset.click.left<S[0]&&(fe=S[0]+this.offset.click.left),d.pageY-this.offset.click.top<S[1]&&(be=S[1]+this.offset.click.top),d.pageX-this.offset.click.left>S[2]&&(fe=S[2]+this.offset.click.left),d.pageY-this.offset.click.top>S[3]&&(be=S[3]+this.offset.click.top)),se.grid&&(R=se.grid[1]?this.originalPageY+Math.round((be-this.originalPageY)/se.grid[1])*se.grid[1]:this.originalPageY,be=S?R-this.offset.click.top>=S[1]||R-this.offset.click.top>S[3]?R:R-this.offset.click.top>=S[1]?R-se.grid[1]:R+se.grid[1]:R,W=se.grid[0]?this.originalPageX+Math.round((fe-this.originalPageX)/se.grid[0])*se.grid[0]:this.originalPageX,fe=S?W-this.offset.click.left>=S[0]||W-this.offset.click.left>S[2]?W:W-this.offset.click.left>=S[0]?W-se.grid[0]:W+se.grid[0]:W),se.axis==="y"&&(fe=this.originalPageX),se.axis==="x"&&(be=this.originalPageY)),{top:be-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.offset.scroll.top:le?0:this.offset.scroll.top),left:fe-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.offset.scroll.left:le?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(d,b,S){return S=S||this._uiHash(),g.ui.plugin.call(this,d,[b,S,this],!0),/^(drag|start|stop)/.test(d)&&(this.positionAbs=this._convertPositionTo("absolute"),S.offset=this.positionAbs),g.Widget.prototype._trigger.call(this,d,b,S)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),g.ui.plugin.add("draggable","connectToSortable",{start:function(d,b,S){var k=g.extend({},b,{item:S.element});S.sortables=[],g(S.options.connectToSortable).each(function(){var R=g(this).sortable("instance");R&&!R.options.disabled&&(S.sortables.push(R),R.refreshPositions(),R._trigger("activate",d,k))})},stop:function(d,b,S){var k=g.extend({},b,{item:S.element});S.cancelHelperRemoval=!1,g.each(S.sortables,function(){var R=this;R.isOver?(R.isOver=0,S.cancelHelperRemoval=!0,R.cancelHelperRemoval=!1,R._storedCSS={position:R.placeholder.css("position"),top:R.placeholder.css("top"),left:R.placeholder.css("left")},R._mouseStop(d),R.options.helper=R.options._helper):(R.cancelHelperRemoval=!0,R._trigger("deactivate",d,k))})},drag:function(d,b,S){g.each(S.sortables,function(){var k=!1,R=this;R.positionAbs=S.positionAbs,R.helperProportions=S.helperProportions,R.offset.click=S.offset.click,R._intersectsWith(R.containerCache)&&(k=!0,g.each(S.sortables,function(){return this.positionAbs=S.positionAbs,this.helperProportions=S.helperProportions,this.offset.click=S.offset.click,this!==R&&this._intersectsWith(this.containerCache)&&g.contains(R.element[0],this.element[0])&&(k=!1),k})),k?(R.isOver||(R.isOver=1,S._parent=b.helper.parent(),R.currentItem=b.helper.appendTo(R.element).data("ui-sortable-item",!0),R.options._helper=R.options.helper,R.options.helper=function(){return b.helper[0]},d.target=R.currentItem[0],R._mouseCapture(d,!0),R._mouseStart(d,!0,!0),R.offset.click.top=S.offset.click.top,R.offset.click.left=S.offset.click.left,R.offset.parent.left-=S.offset.parent.left-R.offset.parent.left,R.offset.parent.top-=S.offset.parent.top-R.offset.parent.top,S._trigger("toSortable",d),S.dropped=R.element,g.each(S.sortables,function(){this.refreshPositions()}),S.currentItem=S.element,R.fromOutside=S),R.currentItem&&(R._mouseDrag(d),b.position=R.position)):R.isOver&&(R.isOver=0,R.cancelHelperRemoval=!0,R.options._revert=R.options.revert,R.options.revert=!1,R._trigger("out",d,R._uiHash(R)),R._mouseStop(d,!0),R.options.revert=R.options._revert,R.options.helper=R.options._helper,R.placeholder&&R.placeholder.remove(),b.helper.appendTo(S._parent),S._refreshOffsets(d),b.position=S._generatePosition(d,!0),S._trigger("fromSortable",d),S.dropped=!1,g.each(S.sortables,function(){this.refreshPositions()}))})}}),g.ui.plugin.add("draggable","cursor",{start:function(d,b,S){var k=g("body"),R=S.options;k.css("cursor")&&(R._cursor=k.css("cursor")),k.css("cursor",R.cursor)},stop:function(d,b,S){var k=S.options;k._cursor&&g("body").css("cursor",k._cursor)}}),g.ui.plugin.add("draggable","opacity",{start:function(d,b,S){var k=g(b.helper),R=S.options;k.css("opacity")&&(R._opacity=k.css("opacity")),k.css("opacity",R.opacity)},stop:function(d,b,S){var k=S.options;k._opacity&&g(b.helper).css("opacity",k._opacity)}}),g.ui.plugin.add("draggable","scroll",{start:function(d,b,S){S.scrollParentNotHidden||(S.scrollParentNotHidden=S.helper.scrollParent(!1)),S.scrollParentNotHidden[0]!==S.document[0]&&S.scrollParentNotHidden[0].tagName!=="HTML"&&(S.overflowOffset=S.scrollParentNotHidden.offset())},drag:function(d,b,S){var k=S.options,R=!1,W=S.scrollParentNotHidden[0],se=S.document[0];W!==se&&W.tagName!=="HTML"?((!k.axis||k.axis!=="x")&&(S.overflowOffset.top+W.offsetHeight-d.pageY<k.scrollSensitivity?W.scrollTop=R=W.scrollTop+k.scrollSpeed:d.pageY-S.overflowOffset.top<k.scrollSensitivity&&(W.scrollTop=R=W.scrollTop-k.scrollSpeed)),(!k.axis||k.axis!=="y")&&(S.overflowOffset.left+W.offsetWidth-d.pageX<k.scrollSensitivity?W.scrollLeft=R=W.scrollLeft+k.scrollSpeed:d.pageX-S.overflowOffset.left<k.scrollSensitivity&&(W.scrollLeft=R=W.scrollLeft-k.scrollSpeed))):((!k.axis||k.axis!=="x")&&(d.pageY-g(se).scrollTop()<k.scrollSensitivity?R=g(se).scrollTop(g(se).scrollTop()-k.scrollSpeed):g(window).height()-(d.pageY-g(se).scrollTop())<k.scrollSensitivity&&(R=g(se).scrollTop(g(se).scrollTop()+k.scrollSpeed))),(!k.axis||k.axis!=="y")&&(d.pageX-g(se).scrollLeft()<k.scrollSensitivity?R=g(se).scrollLeft(g(se).scrollLeft()-k.scrollSpeed):g(window).width()-(d.pageX-g(se).scrollLeft())<k.scrollSensitivity&&(R=g(se).scrollLeft(g(se).scrollLeft()+k.scrollSpeed)))),R!==!1&&g.ui.ddmanager&&!k.dropBehaviour&&g.ui.ddmanager.prepareOffsets(S,d)}}),g.ui.plugin.add("draggable","snap",{start:function(d,b,S){var k=S.options;S.snapElements=[],g(k.snap.constructor!==String?k.snap.items||":data(ui-draggable)":k.snap).each(function(){var R=g(this),W=R.offset();this!==S.element[0]&&S.snapElements.push({item:this,width:R.outerWidth(),height:R.outerHeight(),top:W.top,left:W.left})})},drag:function(d,b,S){var k,R,W,se,le,fe,be,Te,Ve,Ue,me=S.options,ke=me.snapTolerance,qe=b.offset.left,lt=qe+S.helperProportions.width,pt=b.offset.top,Ft=pt+S.helperProportions.height;for(Ve=S.snapElements.length-1;Ve>=0;Ve--){if(le=S.snapElements[Ve].left-S.margins.left,fe=le+S.snapElements[Ve].width,be=S.snapElements[Ve].top-S.margins.top,Te=be+S.snapElements[Ve].height,lt<le-ke||qe>fe+ke||Ft<be-ke||pt>Te+ke||!g.contains(S.snapElements[Ve].item.ownerDocument,S.snapElements[Ve].item)){S.snapElements[Ve].snapping&&S.options.snap.release&&S.options.snap.release.call(S.element,d,g.extend(S._uiHash(),{snapItem:S.snapElements[Ve].item})),S.snapElements[Ve].snapping=!1;continue}me.snapMode!=="inner"&&(k=Math.abs(be-Ft)<=ke,R=Math.abs(Te-pt)<=ke,W=Math.abs(le-lt)<=ke,se=Math.abs(fe-qe)<=ke,k&&(b.position.top=S._convertPositionTo("relative",{top:be-S.helperProportions.height,left:0}).top),R&&(b.position.top=S._convertPositionTo("relative",{top:Te,left:0}).top),W&&(b.position.left=S._convertPositionTo("relative",{top:0,left:le-S.helperProportions.width}).left),se&&(b.position.left=S._convertPositionTo("relative",{top:0,left:fe}).left)),Ue=k||R||W||se,me.snapMode!=="outer"&&(k=Math.abs(be-pt)<=ke,R=Math.abs(Te-Ft)<=ke,W=Math.abs(le-qe)<=ke,se=Math.abs(fe-lt)<=ke,k&&(b.position.top=S._convertPositionTo("relative",{top:be,left:0}).top),R&&(b.position.top=S._convertPositionTo("relative",{top:Te-S.helperProportions.height,left:0}).top),W&&(b.position.left=S._convertPositionTo("relative",{top:0,left:le}).left),se&&(b.position.left=S._convertPositionTo("relative",{top:0,left:fe-S.helperProportions.width}).left)),!S.snapElements[Ve].snapping&&(k||R||W||se||Ue)&&S.options.snap.snap&&S.options.snap.snap.call(S.element,d,g.extend(S._uiHash(),{snapItem:S.snapElements[Ve].item})),S.snapElements[Ve].snapping=k||R||W||se||Ue}}}),g.ui.plugin.add("draggable","stack",{start:function(d,b,S){var k,R=S.options,W=g.makeArray(g(R.stack)).sort(function(se,le){return(parseInt(g(se).css("zIndex"),10)||0)-(parseInt(g(le).css("zIndex"),10)||0)});W.length&&(k=parseInt(g(W[0]).css("zIndex"),10)||0,g(W).each(function(se){g(this).css("zIndex",k+se)}),this.css("zIndex",k+W.length))}}),g.ui.plugin.add("draggable","zIndex",{start:function(d,b,S){var k=g(b.helper),R=S.options;k.css("zIndex")&&(R._zIndex=k.css("zIndex")),k.css("zIndex",R.zIndex)},stop:function(d,b,S){var k=S.options;k._zIndex&&g(b.helper).css("zIndex",k._zIndex)}}),g.ui.draggable;/*!
 * jQuery UI Resizable 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.resizable",g.ui.mouse,{version:"1.13.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(d){return parseFloat(d)||0},_isNumber:function(d){return!isNaN(parseFloat(d))},_hasScroll:function(d,b){if(g(d).css("overflow")==="hidden")return!1;var S=b&&b==="left"?"scrollLeft":"scrollTop",k=!1;if(d[S]>0)return!0;try{d[S]=1,k=d[S]>0,d[S]=0}catch{}return k},_create:function(){var d,b=this.options,S=this;this._addClass("ui-resizable"),g.extend(this,{_aspectRatio:!!b.aspectRatio,aspectRatio:b.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:b.helper||b.ghost||b.animate?b.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(g("<div class='ui-wrapper'></div>").css({overflow:"hidden",position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,d={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(d),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(d),this._proportionallyResize()),this._setupHandles(),b.autoHide&&g(this.element).on("mouseenter",function(){b.disabled||(S._removeClass("ui-resizable-autohide"),S._handles.show())}).on("mouseleave",function(){b.disabled||S.resizing||(S._addClass("ui-resizable-autohide"),S._handles.hide())}),this._mouseInit()},_destroy:function(){this._mouseDestroy(),this._addedHandles.remove();var d,b=function(S){g(S).removeData("resizable").removeData("ui-resizable").off(".resizable")};return this.elementIsWrapper&&(b(this.element),d=this.element,this.originalElement.css({position:d.css("position"),width:d.outerWidth(),height:d.outerHeight(),top:d.css("top"),left:d.css("left")}).insertAfter(d),d.remove()),this.originalElement.css("resize",this.originalResizeStyle),b(this.originalElement),this},_setOption:function(d,b){switch(this._super(d,b),d){case"handles":this._removeHandles(),this._setupHandles();break;case"aspectRatio":this._aspectRatio=!!b;break}},_setupHandles:function(){var d=this.options,b,S,k,R,W,se=this;if(this.handles=d.handles||(g(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=g(),this._addedHandles=g(),this.handles.constructor===String)for(this.handles==="all"&&(this.handles="n,e,s,w,se,sw,ne,nw"),k=this.handles.split(","),this.handles={},S=0;S<k.length;S++)b=String.prototype.trim.call(k[S]),R="ui-resizable-"+b,W=g("<div>"),this._addClass(W,"ui-resizable-handle "+R),W.css({zIndex:d.zIndex}),this.handles[b]=".ui-resizable-"+b,this.element.children(this.handles[b]).length||(this.element.append(W),this._addedHandles=this._addedHandles.add(W));this._renderAxis=function(le){var fe,be,Te,Ve;le=le||this.element;for(fe in this.handles)this.handles[fe].constructor===String?this.handles[fe]=this.element.children(this.handles[fe]).first().show():(this.handles[fe].jquery||this.handles[fe].nodeType)&&(this.handles[fe]=g(this.handles[fe]),this._on(this.handles[fe],{mousedown:se._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(be=g(this.handles[fe],this.element),Ve=/sw|ne|nw|se|n|s/.test(fe)?be.outerHeight():be.outerWidth(),Te=["padding",/ne|nw|n/.test(fe)?"Top":/se|sw|s/.test(fe)?"Bottom":/^e$/.test(fe)?"Right":"Left"].join(""),le.css(Te,Ve),this._proportionallyResize()),this._handles=this._handles.add(this.handles[fe])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",function(){se.resizing||(this.className&&(W=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),se.axis=W&&W[1]?W[1]:"se")}),d.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._addedHandles.remove()},_mouseCapture:function(d){var b,S,k=!1;for(b in this.handles)S=g(this.handles[b])[0],(S===d.target||g.contains(S,d.target))&&(k=!0);return!this.options.disabled&&k},_mouseStart:function(d){var b,S,k,R=this.options,W=this.element;return this.resizing=!0,this._renderProxy(),b=this._num(this.helper.css("left")),S=this._num(this.helper.css("top")),R.containment&&(b+=g(R.containment).scrollLeft()||0,S+=g(R.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:b,top:S},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:W.width(),height:W.height()},this.originalSize=this._helper?{width:W.outerWidth(),height:W.outerHeight()}:{width:W.width(),height:W.height()},this.sizeDiff={width:W.outerWidth()-W.width(),height:W.outerHeight()-W.height()},this.originalPosition={left:b,top:S},this.originalMousePosition={left:d.pageX,top:d.pageY},this.aspectRatio=typeof R.aspectRatio=="number"?R.aspectRatio:this.originalSize.width/this.originalSize.height||1,k=g(".ui-resizable-"+this.axis).css("cursor"),g("body").css("cursor",k==="auto"?this.axis+"-resize":k),this._addClass("ui-resizable-resizing"),this._propagate("start",d),!0},_mouseDrag:function(d){var b,S,k=this.originalMousePosition,R=this.axis,W=d.pageX-k.left||0,se=d.pageY-k.top||0,le=this._change[R];return this._updatePrevProperties(),le&&(b=le.apply(this,[d,W,se]),this._updateVirtualBoundaries(d.shiftKey),(this._aspectRatio||d.shiftKey)&&(b=this._updateRatio(b,d)),b=this._respectSize(b,d),this._updateCache(b),this._propagate("resize",d),S=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),g.isEmptyObject(S)||(this._updatePrevProperties(),this._trigger("resize",d,this.ui()),this._applyChanges())),!1},_mouseStop:function(d){this.resizing=!1;var b,S,k,R,W,se,le,fe=this.options,be=this;return this._helper&&(b=this._proportionallyResizeElements,S=b.length&&/textarea/i.test(b[0].nodeName),k=S&&this._hasScroll(b[0],"left")?0:be.sizeDiff.height,R=S?0:be.sizeDiff.width,W={width:be.helper.width()-R,height:be.helper.height()-k},se=parseFloat(be.element.css("left"))+(be.position.left-be.originalPosition.left)||null,le=parseFloat(be.element.css("top"))+(be.position.top-be.originalPosition.top)||null,fe.animate||this.element.css(g.extend(W,{top:le,left:se})),be.helper.height(be.size.height),be.helper.width(be.size.width),this._helper&&!fe.animate&&this._proportionallyResize()),g("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",d),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var d={};return this.position.top!==this.prevPosition.top&&(d.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(d.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(d.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(d.height=this.size.height+"px"),this.helper.css(d),d},_updateVirtualBoundaries:function(d){var b,S,k,R,W,se=this.options;W={minWidth:this._isNumber(se.minWidth)?se.minWidth:0,maxWidth:this._isNumber(se.maxWidth)?se.maxWidth:1/0,minHeight:this._isNumber(se.minHeight)?se.minHeight:0,maxHeight:this._isNumber(se.maxHeight)?se.maxHeight:1/0},(this._aspectRatio||d)&&(b=W.minHeight*this.aspectRatio,k=W.minWidth/this.aspectRatio,S=W.maxHeight*this.aspectRatio,R=W.maxWidth/this.aspectRatio,b>W.minWidth&&(W.minWidth=b),k>W.minHeight&&(W.minHeight=k),S<W.maxWidth&&(W.maxWidth=S),R<W.maxHeight&&(W.maxHeight=R)),this._vBoundaries=W},_updateCache:function(d){this.offset=this.helper.offset(),this._isNumber(d.left)&&(this.position.left=d.left),this._isNumber(d.top)&&(this.position.top=d.top),this._isNumber(d.height)&&(this.size.height=d.height),this._isNumber(d.width)&&(this.size.width=d.width)},_updateRatio:function(d){var b=this.position,S=this.size,k=this.axis;return this._isNumber(d.height)?d.width=d.height*this.aspectRatio:this._isNumber(d.width)&&(d.height=d.width/this.aspectRatio),k==="sw"&&(d.left=b.left+(S.width-d.width),d.top=null),k==="nw"&&(d.top=b.top+(S.height-d.height),d.left=b.left+(S.width-d.width)),d},_respectSize:function(d){var b=this._vBoundaries,S=this.axis,k=this._isNumber(d.width)&&b.maxWidth&&b.maxWidth<d.width,R=this._isNumber(d.height)&&b.maxHeight&&b.maxHeight<d.height,W=this._isNumber(d.width)&&b.minWidth&&b.minWidth>d.width,se=this._isNumber(d.height)&&b.minHeight&&b.minHeight>d.height,le=this.originalPosition.left+this.originalSize.width,fe=this.originalPosition.top+this.originalSize.height,be=/sw|nw|w/.test(S),Te=/nw|ne|n/.test(S);return W&&(d.width=b.minWidth),se&&(d.height=b.minHeight),k&&(d.width=b.maxWidth),R&&(d.height=b.maxHeight),W&&be&&(d.left=le-b.minWidth),k&&be&&(d.left=le-b.maxWidth),se&&Te&&(d.top=fe-b.minHeight),R&&Te&&(d.top=fe-b.maxHeight),!d.width&&!d.height&&!d.left&&d.top?d.top=null:!d.width&&!d.height&&!d.top&&d.left&&(d.left=null),d},_getPaddingPlusBorderDimensions:function(d){for(var b=0,S=[],k=[d.css("borderTopWidth"),d.css("borderRightWidth"),d.css("borderBottomWidth"),d.css("borderLeftWidth")],R=[d.css("paddingTop"),d.css("paddingRight"),d.css("paddingBottom"),d.css("paddingLeft")];b<4;b++)S[b]=parseFloat(k[b])||0,S[b]+=parseFloat(R[b])||0;return{height:S[0]+S[2],width:S[1]+S[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var d,b=0,S=this.helper||this.element;b<this._proportionallyResizeElements.length;b++)d=this._proportionallyResizeElements[b],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(d)),d.css({height:S.height()-this.outerDimensions.height||0,width:S.width()-this.outerDimensions.width||0})},_renderProxy:function(){var d=this.element,b=this.options;this.elementOffset=d.offset(),this._helper?(this.helper=this.helper||g("<div></div>").css({overflow:"hidden"}),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++b.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(d,b){return{width:this.originalSize.width+b}},w:function(d,b){var S=this.originalSize,k=this.originalPosition;return{left:k.left+b,width:S.width-b}},n:function(d,b,S){var k=this.originalSize,R=this.originalPosition;return{top:R.top+S,height:k.height-S}},s:function(d,b,S){return{height:this.originalSize.height+S}},se:function(d,b,S){return g.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[d,b,S]))},sw:function(d,b,S){return g.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[d,b,S]))},ne:function(d,b,S){return g.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[d,b,S]))},nw:function(d,b,S){return g.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[d,b,S]))}},_propagate:function(d,b){g.ui.plugin.call(this,d,[b,this.ui()]),d!=="resize"&&this._trigger(d,b,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),g.ui.plugin.add("resizable","animate",{stop:function(d){var b=g(this).resizable("instance"),S=b.options,k=b._proportionallyResizeElements,R=k.length&&/textarea/i.test(k[0].nodeName),W=R&&b._hasScroll(k[0],"left")?0:b.sizeDiff.height,se=R?0:b.sizeDiff.width,le={width:b.size.width-se,height:b.size.height-W},fe=parseFloat(b.element.css("left"))+(b.position.left-b.originalPosition.left)||null,be=parseFloat(b.element.css("top"))+(b.position.top-b.originalPosition.top)||null;b.element.animate(g.extend(le,be&&fe?{top:be,left:fe}:{}),{duration:S.animateDuration,easing:S.animateEasing,step:function(){var Te={width:parseFloat(b.element.css("width")),height:parseFloat(b.element.css("height")),top:parseFloat(b.element.css("top")),left:parseFloat(b.element.css("left"))};k&&k.length&&g(k[0]).css({width:Te.width,height:Te.height}),b._updateCache(Te),b._propagate("resize",d)}})}}),g.ui.plugin.add("resizable","containment",{start:function(){var d,b,S,k,R,W,se,le=g(this).resizable("instance"),fe=le.options,be=le.element,Te=fe.containment,Ve=Te instanceof g?Te.get(0):/parent/.test(Te)?be.parent().get(0):Te;Ve&&(le.containerElement=g(Ve),/document/.test(Te)||Te===document?(le.containerOffset={left:0,top:0},le.containerPosition={left:0,top:0},le.parentData={element:g(document),left:0,top:0,width:g(document).width(),height:g(document).height()||document.body.parentNode.scrollHeight}):(d=g(Ve),b=[],g(["Top","Right","Left","Bottom"]).each(function(Ue,me){b[Ue]=le._num(d.css("padding"+me))}),le.containerOffset=d.offset(),le.containerPosition=d.position(),le.containerSize={height:d.innerHeight()-b[3],width:d.innerWidth()-b[1]},S=le.containerOffset,k=le.containerSize.height,R=le.containerSize.width,W=le._hasScroll(Ve,"left")?Ve.scrollWidth:R,se=le._hasScroll(Ve)?Ve.scrollHeight:k,le.parentData={element:Ve,left:S.left,top:S.top,width:W,height:se}))},resize:function(d){var b,S,k,R,W=g(this).resizable("instance"),se=W.options,le=W.containerOffset,fe=W.position,be=W._aspectRatio||d.shiftKey,Te={top:0,left:0},Ve=W.containerElement,Ue=!0;Ve[0]!==document&&/static/.test(Ve.css("position"))&&(Te=le),fe.left<(W._helper?le.left:0)&&(W.size.width=W.size.width+(W._helper?W.position.left-le.left:W.position.left-Te.left),be&&(W.size.height=W.size.width/W.aspectRatio,Ue=!1),W.position.left=se.helper?le.left:0),fe.top<(W._helper?le.top:0)&&(W.size.height=W.size.height+(W._helper?W.position.top-le.top:W.position.top),be&&(W.size.width=W.size.height*W.aspectRatio,Ue=!1),W.position.top=W._helper?le.top:0),k=W.containerElement.get(0)===W.element.parent().get(0),R=/relative|absolute/.test(W.containerElement.css("position")),k&&R?(W.offset.left=W.parentData.left+W.position.left,W.offset.top=W.parentData.top+W.position.top):(W.offset.left=W.element.offset().left,W.offset.top=W.element.offset().top),b=Math.abs(W.sizeDiff.width+(W._helper?W.offset.left-Te.left:W.offset.left-le.left)),S=Math.abs(W.sizeDiff.height+(W._helper?W.offset.top-Te.top:W.offset.top-le.top)),b+W.size.width>=W.parentData.width&&(W.size.width=W.parentData.width-b,be&&(W.size.height=W.size.width/W.aspectRatio,Ue=!1)),S+W.size.height>=W.parentData.height&&(W.size.height=W.parentData.height-S,be&&(W.size.width=W.size.height*W.aspectRatio,Ue=!1)),Ue||(W.position.left=W.prevPosition.left,W.position.top=W.prevPosition.top,W.size.width=W.prevSize.width,W.size.height=W.prevSize.height)},stop:function(){var d=g(this).resizable("instance"),b=d.options,S=d.containerOffset,k=d.containerPosition,R=d.containerElement,W=g(d.helper),se=W.offset(),le=W.outerWidth()-d.sizeDiff.width,fe=W.outerHeight()-d.sizeDiff.height;d._helper&&!b.animate&&/relative/.test(R.css("position"))&&g(this).css({left:se.left-k.left-S.left,width:le,height:fe}),d._helper&&!b.animate&&/static/.test(R.css("position"))&&g(this).css({left:se.left-k.left-S.left,width:le,height:fe})}}),g.ui.plugin.add("resizable","alsoResize",{start:function(){var d=g(this).resizable("instance"),b=d.options;g(b.alsoResize).each(function(){var S=g(this);S.data("ui-resizable-alsoresize",{width:parseFloat(S.width()),height:parseFloat(S.height()),left:parseFloat(S.css("left")),top:parseFloat(S.css("top"))})})},resize:function(d,b){var S=g(this).resizable("instance"),k=S.options,R=S.originalSize,W=S.originalPosition,se={height:S.size.height-R.height||0,width:S.size.width-R.width||0,top:S.position.top-W.top||0,left:S.position.left-W.left||0};g(k.alsoResize).each(function(){var le=g(this),fe=g(this).data("ui-resizable-alsoresize"),be={},Te=le.parents(b.originalElement[0]).length?["width","height"]:["width","height","top","left"];g.each(Te,function(Ve,Ue){var me=(fe[Ue]||0)+(se[Ue]||0);me&&me>=0&&(be[Ue]=me||null)}),le.css(be)})},stop:function(){g(this).removeData("ui-resizable-alsoresize")}}),g.ui.plugin.add("resizable","ghost",{start:function(){var d=g(this).resizable("instance"),b=d.size;d.ghost=d.originalElement.clone(),d.ghost.css({opacity:.25,display:"block",position:"relative",height:b.height,width:b.width,margin:0,left:0,top:0}),d._addClass(d.ghost,"ui-resizable-ghost"),g.uiBackCompat!==!1&&typeof d.options.ghost=="string"&&d.ghost.addClass(this.options.ghost),d.ghost.appendTo(d.helper)},resize:function(){var d=g(this).resizable("instance");d.ghost&&d.ghost.css({position:"relative",height:d.size.height,width:d.size.width})},stop:function(){var d=g(this).resizable("instance");d.ghost&&d.helper&&d.helper.get(0).removeChild(d.ghost.get(0))}}),g.ui.plugin.add("resizable","grid",{resize:function(){var d,b=g(this).resizable("instance"),S=b.options,k=b.size,R=b.originalSize,W=b.originalPosition,se=b.axis,le=typeof S.grid=="number"?[S.grid,S.grid]:S.grid,fe=le[0]||1,be=le[1]||1,Te=Math.round((k.width-R.width)/fe)*fe,Ve=Math.round((k.height-R.height)/be)*be,Ue=R.width+Te,me=R.height+Ve,ke=S.maxWidth&&S.maxWidth<Ue,qe=S.maxHeight&&S.maxHeight<me,lt=S.minWidth&&S.minWidth>Ue,pt=S.minHeight&&S.minHeight>me;S.grid=le,lt&&(Ue+=fe),pt&&(me+=be),ke&&(Ue-=fe),qe&&(me-=be),/^(se|s|e)$/.test(se)?(b.size.width=Ue,b.size.height=me):/^(ne)$/.test(se)?(b.size.width=Ue,b.size.height=me,b.position.top=W.top-Ve):/^(sw)$/.test(se)?(b.size.width=Ue,b.size.height=me,b.position.left=W.left-Te):((me-be<=0||Ue-fe<=0)&&(d=b._getPaddingPlusBorderDimensions(this)),me-be>0?(b.size.height=me,b.position.top=W.top-Ve):(me=be-d.height,b.size.height=me,b.position.top=W.top+R.height-me),Ue-fe>0?(b.size.width=Ue,b.position.left=W.left-Te):(Ue=fe-d.width,b.size.width=Ue,b.position.left=W.left+R.width-Ue))}}),g.ui.resizable;/*!
 * jQuery UI Dialog 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.dialog",{version:"1.13.2",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(d){var b=g(this).css(d).offset().top;b<0&&g(this).css("top",d.top-b)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title==null&&this.originalTitle!=null&&(this.options.title=this.originalTitle),this.options.disabled&&(this.options.disabled=!1),this._createWrapper(),this.element.show().removeAttr("title").appendTo(this.uiDialog),this._addClass("ui-dialog-content","ui-widget-content"),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&g.fn.draggable&&this._makeDraggable(),this.options.resizable&&g.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var d=this.options.appendTo;return d&&(d.jquery||d.nodeType)?g(d):this.document.find(d||"body").eq(0)},_destroy:function(){var d,b=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().css(this.originalCss).detach(),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),d=b.parent.children().eq(b.index),d.length&&d[0]!==this.element[0]?d.before(this.element):b.parent.append(this.element)},widget:function(){return this.uiDialog},disable:g.noop,enable:g.noop,close:function(d){var b=this;!this._isOpen||this._trigger("beforeClose",d)===!1||(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||g.ui.safeBlur(g.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,function(){b._trigger("close",d)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(d,b){var S=!1,k=this.uiDialog.siblings(".ui-front:visible").map(function(){return+g(this).css("z-index")}).get(),R=Math.max.apply(null,k);return R>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",R+1),S=!0),S&&!b&&this._trigger("focus",d),S},open:function(){var d=this;if(this._isOpen){this._moveToTop()&&this._focusTabbable();return}this._isOpen=!0,this.opener=g(g.ui.safeActiveElement(this.document[0])),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){d._focusTabbable(),d._trigger("focus")}),this._makeFocusTarget(),this._trigger("open")},_focusTabbable:function(){var d=this._focusedElement;d||(d=this.element.find("[autofocus]")),d.length||(d=this.element.find(":tabbable")),d.length||(d=this.uiDialogButtonPane.find(":tabbable")),d.length||(d=this.uiDialogTitlebarClose.filter(":tabbable")),d.length||(d=this.uiDialog),d.eq(0).trigger("focus")},_restoreTabbableFocus:function(){var d=g.ui.safeActiveElement(this.document[0]),b=this.uiDialog[0]===d||g.contains(this.uiDialog[0],d);b||this._focusTabbable()},_keepFocus:function(d){d.preventDefault(),this._restoreTabbableFocus(),this._delay(this._restoreTabbableFocus)},_createWrapper:function(){this.uiDialog=g("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front"),this._on(this.uiDialog,{keydown:function(d){if(this.options.closeOnEscape&&!d.isDefaultPrevented()&&d.keyCode&&d.keyCode===g.ui.keyCode.ESCAPE){d.preventDefault(),this.close(d);return}if(!(d.keyCode!==g.ui.keyCode.TAB||d.isDefaultPrevented())){var b=this.uiDialog.find(":tabbable"),S=b.first(),k=b.last();(d.target===k[0]||d.target===this.uiDialog[0])&&!d.shiftKey?(this._delay(function(){S.trigger("focus")}),d.preventDefault()):(d.target===S[0]||d.target===this.uiDialog[0])&&d.shiftKey&&(this._delay(function(){k.trigger("focus")}),d.preventDefault())}},mousedown:function(d){this._moveToTop(d)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var d;this.uiDialogTitlebar=g("<div>"),this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix"),this._on(this.uiDialogTitlebar,{mousedown:function(b){g(b.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}}),this.uiDialogTitlebarClose=g("<button type='button'></button>").button({label:g("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:!1}).appendTo(this.uiDialogTitlebar),this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close"),this._on(this.uiDialogTitlebarClose,{click:function(b){b.preventDefault(),this.close(b)}}),d=g("<span>").uniqueId().prependTo(this.uiDialogTitlebar),this._addClass(d,"ui-dialog-title"),this._title(d),this.uiDialogTitlebar.prependTo(this.uiDialog),this.uiDialog.attr({"aria-labelledby":d.attr("id")})},_title:function(d){this.options.title?d.text(this.options.title):d.html("&#160;")},_createButtonPane:function(){this.uiDialogButtonPane=g("<div>"),this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix"),this.uiButtonSet=g("<div>").appendTo(this.uiDialogButtonPane),this._addClass(this.uiButtonSet,"ui-dialog-buttonset"),this._createButtons()},_createButtons:function(){var d=this,b=this.options.buttons;if(this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),g.isEmptyObject(b)||Array.isArray(b)&&!b.length){this._removeClass(this.uiDialog,"ui-dialog-buttons");return}g.each(b,function(S,k){var R,W;k=typeof k=="function"?{click:k,text:S}:k,k=g.extend({type:"button"},k),R=k.click,W={icon:k.icon,iconPosition:k.iconPosition,showLabel:k.showLabel,icons:k.icons,text:k.text},delete k.click,delete k.icon,delete k.iconPosition,delete k.showLabel,delete k.icons,typeof k.text=="boolean"&&delete k.text,g("<button></button>",k).button(W).appendTo(d.uiButtonSet).on("click",function(){R.apply(d.element[0],arguments)})}),this._addClass(this.uiDialog,"ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){var d=this,b=this.options;function S(k){return{position:k.position,offset:k.offset}}this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(k,R){d._addClass(g(this),"ui-dialog-dragging"),d._blockFrames(),d._trigger("dragStart",k,S(R))},drag:function(k,R){d._trigger("drag",k,S(R))},stop:function(k,R){var W=R.offset.left-d.document.scrollLeft(),se=R.offset.top-d.document.scrollTop();b.position={my:"left top",at:"left"+(W>=0?"+":"")+W+" top"+(se>=0?"+":"")+se,of:d.window},d._removeClass(g(this),"ui-dialog-dragging"),d._unblockFrames(),d._trigger("dragStop",k,S(R))}})},_makeResizable:function(){var d=this,b=this.options,S=b.resizable,k=this.uiDialog.css("position"),R=typeof S=="string"?S:"n,e,s,w,se,sw,ne,nw";function W(se){return{originalPosition:se.originalPosition,originalSize:se.originalSize,position:se.position,size:se.size}}this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:b.maxWidth,maxHeight:b.maxHeight,minWidth:b.minWidth,minHeight:this._minHeight(),handles:R,start:function(se,le){d._addClass(g(this),"ui-dialog-resizing"),d._blockFrames(),d._trigger("resizeStart",se,W(le))},resize:function(se,le){d._trigger("resize",se,W(le))},stop:function(se,le){var fe=d.uiDialog.offset(),be=fe.left-d.document.scrollLeft(),Te=fe.top-d.document.scrollTop();b.height=d.uiDialog.height(),b.width=d.uiDialog.width(),b.position={my:"left top",at:"left"+(be>=0?"+":"")+be+" top"+(Te>=0?"+":"")+Te,of:d.window},d._removeClass(g(this),"ui-dialog-resizing"),d._unblockFrames(),d._trigger("resizeStop",se,W(le))}}).css("position",k)},_trackFocus:function(){this._on(this.widget(),{focusin:function(d){this._makeFocusTarget(),this._focusedElement=g(d.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var d=this._trackingInstances(),b=g.inArray(this,d);b!==-1&&d.splice(b,1)},_trackingInstances:function(){var d=this.document.data("ui-dialog-instances");return d||(d=[],this.document.data("ui-dialog-instances",d)),d},_minHeight:function(){var d=this.options;return d.height==="auto"?d.minHeight:Math.min(d.minHeight,d.height)},_position:function(){var d=this.uiDialog.is(":visible");d||this.uiDialog.show(),this.uiDialog.position(this.options.position),d||this.uiDialog.hide()},_setOptions:function(d){var b=this,S=!1,k={};g.each(d,function(R,W){b._setOption(R,W),R in b.sizeRelatedOptions&&(S=!0),R in b.resizableRelatedOptions&&(k[R]=W)}),S&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",k)},_setOption:function(d,b){var S,k,R=this.uiDialog;d!=="disabled"&&(this._super(d,b),d==="appendTo"&&this.uiDialog.appendTo(this._appendTo()),d==="buttons"&&this._createButtons(),d==="closeText"&&this.uiDialogTitlebarClose.button({label:g("<a>").text(""+this.options.closeText).html()}),d==="draggable"&&(S=R.is(":data(ui-draggable)"),S&&!b&&R.draggable("destroy"),!S&&b&&this._makeDraggable()),d==="position"&&this._position(),d==="resizable"&&(k=R.is(":data(ui-resizable)"),k&&!b&&R.resizable("destroy"),k&&typeof b=="string"&&R.resizable("option","handles",b),!k&&b!==!1&&this._makeResizable()),d==="title"&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var d,b,S,k=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),k.minWidth>k.width&&(k.width=k.minWidth),d=this.uiDialog.css({height:"auto",width:k.width}).outerHeight(),b=Math.max(0,k.minHeight-d),S=typeof k.maxHeight=="number"?Math.max(0,k.maxHeight-d):"none",k.height==="auto"?this.element.css({minHeight:b,maxHeight:S,height:"auto"}):this.element.height(Math.max(0,k.height-d)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var d=g(this);return g("<div>").css({position:"absolute",width:d.outerWidth(),height:d.outerHeight()}).appendTo(d.parent()).offset(d.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(d){return g(d.target).closest(".ui-dialog").length?!0:!!g(d.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var d=g.fn.jquery.substring(0,4),b=!0;this._delay(function(){b=!1}),this.document.data("ui-dialog-overlays")||this.document.on("focusin.ui-dialog",(function(S){if(!b){var k=this._trackingInstances()[0];k._allowInteraction(S)||(S.preventDefault(),k._focusTabbable(),(d==="3.4."||d==="3.5.")&&k._delay(k._restoreTabbableFocus))}}).bind(this)),this.overlay=g("<div>").appendTo(this._appendTo()),this._addClass(this.overlay,null,"ui-widget-overlay ui-front"),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var d=this.document.data("ui-dialog-overlays")-1;d?this.document.data("ui-dialog-overlays",d):(this.document.off("focusin.ui-dialog"),this.document.removeData("ui-dialog-overlays")),this.overlay.remove(),this.overlay=null}}}),g.uiBackCompat!==!1&&g.widget("ui.dialog",g.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super(),this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(d,b){d==="dialogClass"&&this.uiDialog.removeClass(this.options.dialogClass).addClass(b),this._superApply(arguments)}}),g.ui.dialog;/*!
 * jQuery UI Droppable 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.droppable",{version:"1.13.2",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var d,b=this.options,S=b.accept;this.isover=!1,this.isout=!0,this.accept=typeof S=="function"?S:function(k){return k.is(S)},this.proportions=function(){if(arguments.length)d=arguments[0];else return d||(d={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight})},this._addToManager(b.scope),b.addClasses&&this._addClass("ui-droppable")},_addToManager:function(d){g.ui.ddmanager.droppables[d]=g.ui.ddmanager.droppables[d]||[],g.ui.ddmanager.droppables[d].push(this)},_splice:function(d){for(var b=0;b<d.length;b++)d[b]===this&&d.splice(b,1)},_destroy:function(){var d=g.ui.ddmanager.droppables[this.options.scope];this._splice(d)},_setOption:function(d,b){if(d==="accept")this.accept=typeof b=="function"?b:function(k){return k.is(b)};else if(d==="scope"){var S=g.ui.ddmanager.droppables[this.options.scope];this._splice(S),this._addToManager(b)}this._super(d,b)},_activate:function(d){var b=g.ui.ddmanager.current;this._addActiveClass(),b&&this._trigger("activate",d,this.ui(b))},_deactivate:function(d){var b=g.ui.ddmanager.current;this._removeActiveClass(),b&&this._trigger("deactivate",d,this.ui(b))},_over:function(d){var b=g.ui.ddmanager.current;!b||(b.currentItem||b.element)[0]===this.element[0]||this.accept.call(this.element[0],b.currentItem||b.element)&&(this._addHoverClass(),this._trigger("over",d,this.ui(b)))},_out:function(d){var b=g.ui.ddmanager.current;!b||(b.currentItem||b.element)[0]===this.element[0]||this.accept.call(this.element[0],b.currentItem||b.element)&&(this._removeHoverClass(),this._trigger("out",d,this.ui(b)))},_drop:function(d,b){var S=b||g.ui.ddmanager.current,k=!1;return!S||(S.currentItem||S.element)[0]===this.element[0]||(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var R=g(this).droppable("instance");if(R.options.greedy&&!R.options.disabled&&R.options.scope===S.options.scope&&R.accept.call(R.element[0],S.currentItem||S.element)&&g.ui.intersect(S,g.extend(R,{offset:R.element.offset()}),R.options.tolerance,d))return k=!0,!1}),k)?!1:this.accept.call(this.element[0],S.currentItem||S.element)?(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",d,this.ui(S)),this.element):!1},ui:function(d){return{draggable:d.currentItem||d.element,helper:d.helper,position:d.position,offset:d.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}}),g.ui.intersect=function(){function d(b,S,k){return b>=S&&b<S+k}return function(b,S,k,R){if(!S.offset)return!1;var W=(b.positionAbs||b.position.absolute).left+b.margins.left,se=(b.positionAbs||b.position.absolute).top+b.margins.top,le=W+b.helperProportions.width,fe=se+b.helperProportions.height,be=S.offset.left,Te=S.offset.top,Ve=be+S.proportions().width,Ue=Te+S.proportions().height;switch(k){case"fit":return be<=W&&le<=Ve&&Te<=se&&fe<=Ue;case"intersect":return be<W+b.helperProportions.width/2&&le-b.helperProportions.width/2<Ve&&Te<se+b.helperProportions.height/2&&fe-b.helperProportions.height/2<Ue;case"pointer":return d(R.pageY,Te,S.proportions().height)&&d(R.pageX,be,S.proportions().width);case"touch":return(se>=Te&&se<=Ue||fe>=Te&&fe<=Ue||se<Te&&fe>Ue)&&(W>=be&&W<=Ve||le>=be&&le<=Ve||W<be&&le>Ve);default:return!1}}}(),g.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(d,b){var S,k,R=g.ui.ddmanager.droppables[d.options.scope]||[],W=b?b.type:null,se=(d.currentItem||d.element).find(":data(ui-droppable)").addBack();e:for(S=0;S<R.length;S++)if(!(R[S].options.disabled||d&&!R[S].accept.call(R[S].element[0],d.currentItem||d.element))){for(k=0;k<se.length;k++)if(se[k]===R[S].element[0]){R[S].proportions().height=0;continue e}R[S].visible=R[S].element.css("display")!=="none",R[S].visible&&(W==="mousedown"&&R[S]._activate.call(R[S],b),R[S].offset=R[S].element.offset(),R[S].proportions({width:R[S].element[0].offsetWidth,height:R[S].element[0].offsetHeight}))}},drop:function(d,b){var S=!1;return g.each((g.ui.ddmanager.droppables[d.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&g.ui.intersect(d,this,this.options.tolerance,b)&&(S=this._drop.call(this,b)||S),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],d.currentItem||d.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,b)))}),S},dragStart:function(d,b){d.element.parentsUntil("body").on("scroll.droppable",function(){d.options.refreshPositions||g.ui.ddmanager.prepareOffsets(d,b)})},drag:function(d,b){d.options.refreshPositions&&g.ui.ddmanager.prepareOffsets(d,b),g.each(g.ui.ddmanager.droppables[d.options.scope]||[],function(){if(!(this.options.disabled||this.greedyChild||!this.visible)){var S,k,R,W=g.ui.intersect(d,this,this.options.tolerance,b),se=!W&&this.isover?"isout":W&&!this.isover?"isover":null;se&&(this.options.greedy&&(k=this.options.scope,R=this.element.parents(":data(ui-droppable)").filter(function(){return g(this).droppable("instance").options.scope===k}),R.length&&(S=g(R[0]).droppable("instance"),S.greedyChild=se==="isover")),S&&se==="isover"&&(S.isover=!1,S.isout=!0,S._out.call(S,b)),this[se]=!0,this[se==="isout"?"isover":"isout"]=!1,this[se==="isover"?"_over":"_out"].call(this,b),S&&se==="isout"&&(S.isout=!1,S.isover=!0,S._over.call(S,b)))}})},dragStop:function(d,b){d.element.parentsUntil("body").off("scroll.droppable"),d.options.refreshPositions||g.ui.ddmanager.prepareOffsets(d,b)}},g.uiBackCompat!==!1&&g.widget("ui.droppable",g.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),g.ui.droppable;/*!
 * jQuery UI Progressbar 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.progressbar",{version:"1.13.2",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.attr({role:"progressbar","aria-valuemin":this.min}),this._addClass("ui-progressbar","ui-widget ui-widget-content"),this.valueDiv=g("<div>").appendTo(this.element),this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header"),this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow"),this.valueDiv.remove()},value:function(d){if(d===void 0)return this.options.value;this.options.value=this._constrainedValue(d),this._refreshValue()},_constrainedValue:function(d){return d===void 0&&(d=this.options.value),this.indeterminate=d===!1,typeof d!="number"&&(d=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,d))},_setOptions:function(d){var b=d.value;delete d.value,this._super(d),this.options.value=this._constrainedValue(b),this._refreshValue()},_setOption:function(d,b){d==="max"&&(b=Math.max(this.min,b)),this._super(d,b)},_setOptionDisabled:function(d){this._super(d),this.element.attr("aria-disabled",d),this._toggleClass(null,"ui-state-disabled",!!d)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var d=this.options.value,b=this._percentage();this.valueDiv.toggle(this.indeterminate||d>this.min).width(b.toFixed(0)+"%"),this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,d===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=g("<div>").appendTo(this.valueDiv),this._addClass(this.overlayDiv,"ui-progressbar-overlay"))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":d}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==d&&(this.oldValue=d,this._trigger("change")),d===this.options.max&&this._trigger("complete")}});/*!
 * jQuery UI Selectable 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.selectable",g.ui.mouse,{version:"1.13.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var d=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){d.elementPos=g(d.element[0]).offset(),d.selectees=g(d.options.filter,d.element[0]),d._addClass(d.selectees,"ui-selectee"),d.selectees.each(function(){var b=g(this),S=b.offset(),k={left:S.left-d.elementPos.left,top:S.top-d.elementPos.top};g.data(this,"selectable-item",{element:this,$element:b,left:k.left,top:k.top,right:k.left+b.outerWidth(),bottom:k.top+b.outerHeight(),startselected:!1,selected:b.hasClass("ui-selected"),selecting:b.hasClass("ui-selecting"),unselecting:b.hasClass("ui-unselecting")})})},this.refresh(),this._mouseInit(),this.helper=g("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(d){var b=this,S=this.options;this.opos=[d.pageX,d.pageY],this.elementPos=g(this.element[0]).offset(),!this.options.disabled&&(this.selectees=g(S.filter,this.element[0]),this._trigger("start",d),g(S.appendTo).append(this.helper),this.helper.css({left:d.pageX,top:d.pageY,width:0,height:0}),S.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var k=g.data(this,"selectable-item");k.startselected=!0,!d.metaKey&&!d.ctrlKey&&(b._removeClass(k.$element,"ui-selected"),k.selected=!1,b._addClass(k.$element,"ui-unselecting"),k.unselecting=!0,b._trigger("unselecting",d,{unselecting:k.element}))}),g(d.target).parents().addBack().each(function(){var k,R=g.data(this,"selectable-item");if(R)return k=!d.metaKey&&!d.ctrlKey||!R.$element.hasClass("ui-selected"),b._removeClass(R.$element,k?"ui-unselecting":"ui-selected")._addClass(R.$element,k?"ui-selecting":"ui-unselecting"),R.unselecting=!k,R.selecting=k,R.selected=k,k?b._trigger("selecting",d,{selecting:R.element}):b._trigger("unselecting",d,{unselecting:R.element}),!1}))},_mouseDrag:function(d){if(this.dragged=!0,!this.options.disabled){var b,S=this,k=this.options,R=this.opos[0],W=this.opos[1],se=d.pageX,le=d.pageY;return R>se&&(b=se,se=R,R=b),W>le&&(b=le,le=W,W=b),this.helper.css({left:R,top:W,width:se-R,height:le-W}),this.selectees.each(function(){var fe=g.data(this,"selectable-item"),be=!1,Te={};!fe||fe.element===S.element[0]||(Te.left=fe.left+S.elementPos.left,Te.right=fe.right+S.elementPos.left,Te.top=fe.top+S.elementPos.top,Te.bottom=fe.bottom+S.elementPos.top,k.tolerance==="touch"?be=!(Te.left>se||Te.right<R||Te.top>le||Te.bottom<W):k.tolerance==="fit"&&(be=Te.left>R&&Te.right<se&&Te.top>W&&Te.bottom<le),be?(fe.selected&&(S._removeClass(fe.$element,"ui-selected"),fe.selected=!1),fe.unselecting&&(S._removeClass(fe.$element,"ui-unselecting"),fe.unselecting=!1),fe.selecting||(S._addClass(fe.$element,"ui-selecting"),fe.selecting=!0,S._trigger("selecting",d,{selecting:fe.element}))):(fe.selecting&&((d.metaKey||d.ctrlKey)&&fe.startselected?(S._removeClass(fe.$element,"ui-selecting"),fe.selecting=!1,S._addClass(fe.$element,"ui-selected"),fe.selected=!0):(S._removeClass(fe.$element,"ui-selecting"),fe.selecting=!1,fe.startselected&&(S._addClass(fe.$element,"ui-unselecting"),fe.unselecting=!0),S._trigger("unselecting",d,{unselecting:fe.element}))),fe.selected&&!d.metaKey&&!d.ctrlKey&&!fe.startselected&&(S._removeClass(fe.$element,"ui-selected"),fe.selected=!1,S._addClass(fe.$element,"ui-unselecting"),fe.unselecting=!0,S._trigger("unselecting",d,{unselecting:fe.element}))))}),!1}},_mouseStop:function(d){var b=this;return this.dragged=!1,g(".ui-unselecting",this.element[0]).each(function(){var S=g.data(this,"selectable-item");b._removeClass(S.$element,"ui-unselecting"),S.unselecting=!1,S.startselected=!1,b._trigger("unselected",d,{unselected:S.element})}),g(".ui-selecting",this.element[0]).each(function(){var S=g.data(this,"selectable-item");b._removeClass(S.$element,"ui-selecting")._addClass(S.$element,"ui-selected"),S.selecting=!1,S.selected=!0,S.startselected=!0,b._trigger("selected",d,{selected:S.element})}),this._trigger("stop",d),this.helper.remove(),!1}});/*!
 * jQuery UI Selectmenu 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.selectmenu",[g.ui.formResetMixin,{version:"1.13.2",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var d=this.element.uniqueId().attr("id");this.ids={element:d,button:d+"-button",menu:d+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=g()},_drawButton:function(){var d,b=this,S=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),this._on(this.labels,{click:function(k){this.button.trigger("focus"),k.preventDefault()}}),this.element.hide(),this.button=g("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),d=g("<span>").appendTo(this.button),this._addClass(d,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(S).appendTo(this.button),this.options.width!==!1&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){b._rendered||b._refreshMenu()})},_drawMenu:function(){var d=this;this.menu=g("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=g("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(b,S){b.preventDefault(),d._setSelection(),d._select(S.item.data("ui-selectmenu-item"),b)},focus:function(b,S){var k=S.item.data("ui-selectmenu-item");d.focusIndex!=null&&k.index!==d.focusIndex&&(d._trigger("focus",b,{item:k}),d.isOpen||d._select(k,b)),d.focusIndex=k.index,d.button.attr("aria-activedescendant",d.menuItems.eq(k.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),this.options.width===null&&this._resizeButton()},_refreshMenu:function(){var d,b=this.element.find("option");this.menu.empty(),this._parseOptions(b),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,b.length&&(d=this._getSelectedItem(),this.menuInstance.focus(null,d),this._setAria(d.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(d){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",d)))},_position:function(){this.menuWrap.position(g.extend({of:this.button},this.options.position))},close:function(d){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",d))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(d){var b=g("<span>");return this._setText(b,d.label),this._addClass(b,"ui-selectmenu-text"),b},_renderMenu:function(d,b){var S=this,k="";g.each(b,function(R,W){var se;W.optgroup!==k&&(se=g("<li>",{text:W.optgroup}),S._addClass(se,"ui-selectmenu-optgroup","ui-menu-divider"+(W.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),se.appendTo(d),k=W.optgroup),S._renderItemData(d,W)})},_renderItemData:function(d,b){return this._renderItem(d,b).data("ui-selectmenu-item",b)},_renderItem:function(d,b){var S=g("<li>"),k=g("<div>",{title:b.element.attr("title")});return b.disabled&&this._addClass(S,null,"ui-state-disabled"),this._setText(k,b.label),S.append(k).appendTo(d)},_setText:function(d,b){b?d.text(b):d.html("&#160;")},_move:function(d,b){var S,k,R=".ui-menu-item";this.isOpen?S=this.menuItems.eq(this.focusIndex).parent("li"):(S=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),R+=":not(.ui-state-disabled)"),d==="first"||d==="last"?k=S[d==="first"?"prevAll":"nextAll"](R).eq(-1):k=S[d+"All"](R).eq(0),k.length&&this.menuInstance.focus(b,k)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(d){this[this.isOpen?"close":"open"](d)},_setSelection:function(){var d;this.range&&(window.getSelection?(d=window.getSelection(),d.removeAllRanges(),d.addRange(this.range)):this.range.select(),this.button.trigger("focus"))},_documentClick:{mousedown:function(d){this.isOpen&&(g(d.target).closest(".ui-selectmenu-menu, #"+g.escapeSelector(this.ids.button)).length||this.close(d))}},_buttonEvents:{mousedown:function(){var d;window.getSelection?(d=window.getSelection(),d.rangeCount&&(this.range=d.getRangeAt(0))):this.range=document.selection.createRange()},click:function(d){this._setSelection(),this._toggle(d)},keydown:function(d){var b=!0;switch(d.keyCode){case g.ui.keyCode.TAB:case g.ui.keyCode.ESCAPE:this.close(d),b=!1;break;case g.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(d);break;case g.ui.keyCode.UP:d.altKey?this._toggle(d):this._move("prev",d);break;case g.ui.keyCode.DOWN:d.altKey?this._toggle(d):this._move("next",d);break;case g.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(d):this._toggle(d);break;case g.ui.keyCode.LEFT:this._move("prev",d);break;case g.ui.keyCode.RIGHT:this._move("next",d);break;case g.ui.keyCode.HOME:case g.ui.keyCode.PAGE_UP:this._move("first",d);break;case g.ui.keyCode.END:case g.ui.keyCode.PAGE_DOWN:this._move("last",d);break;default:this.menu.trigger(d),b=!1}b&&d.preventDefault()}},_selectFocusedItem:function(d){var b=this.menuItems.eq(this.focusIndex).parent("li");b.hasClass("ui-state-disabled")||this._select(b.data("ui-selectmenu-item"),d)},_select:function(d,b){var S=this.element[0].selectedIndex;this.element[0].selectedIndex=d.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(d)),this._setAria(d),this._trigger("select",b,{item:d}),d.index!==S&&this._trigger("change",b,{item:d}),this.close(b)},_setAria:function(d){var b=this.menuItems.eq(d.index).attr("id");this.button.attr({"aria-labelledby":b,"aria-activedescendant":b}),this.menu.attr("aria-activedescendant",b)},_setOption:function(d,b){if(d==="icons"){var S=this.button.find("span.ui-icon");this._removeClass(S,null,this.options.icons.button)._addClass(S,null,b.button)}this._super(d,b),d==="appendTo"&&this.menuWrap.appendTo(this._appendTo()),d==="width"&&this._resizeButton()},_setOptionDisabled:function(d){this._super(d),this.menuInstance.option("disabled",d),this.button.attr("aria-disabled",d),this._toggleClass(this.button,null,"ui-state-disabled",d),this.element.prop("disabled",d),d?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var d=this.options.appendTo;return d&&(d=d.jquery||d.nodeType?g(d):this.document.find(d).eq(0)),(!d||!d[0])&&(d=this.element.closest(".ui-front, dialog")),d.length||(d=this.document[0].body),d},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var d=this.options.width;if(d===!1){this.button.css("width","");return}d===null&&(d=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(d)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var d=this._super();return d.disabled=this.element.prop("disabled"),d},_parseOptions:function(d){var b=this,S=[];d.each(function(k,R){R.hidden||S.push(b._parseOption(g(R),k))}),this.items=S},_parseOption:function(d,b){var S=d.parent("optgroup");return{element:d,index:b,value:d.val(),label:d.text(),optgroup:S.attr("label")||"",disabled:S.prop("disabled")||d.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}]);/*!
 * jQuery UI Slider 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.slider",g.ui.mouse,{version:"1.13.2",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var d,b,S=this.options,k=this.element.find(".ui-slider-handle"),R="<span tabindex='0'></span>",W=[];for(b=S.values&&S.values.length||1,k.length>b&&(k.slice(b).remove(),k=k.slice(0,b)),d=k.length;d<b;d++)W.push(R);this.handles=k.add(g(W.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(se){g(this).data("ui-slider-handle-index",se).attr("tabIndex",0)})},_createRange:function(){var d=this.options;d.range?(d.range===!0&&(d.values?d.values.length&&d.values.length!==2?d.values=[d.values[0],d.values[0]]:Array.isArray(d.values)&&(d.values=d.values.slice(0)):d.values=[this._valueMin(),this._valueMin()]),!this.range||!this.range.length?(this.range=g("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")):(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})),(d.range==="min"||d.range==="max")&&this._addClass(this.range,"ui-slider-range-"+d.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(d){var b,S,k,R,W,se,le,fe,be=this,Te=this.options;return Te.disabled||(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),b={x:d.pageX,y:d.pageY},S=this._normValueFromMouse(b),k=this._valueMax()-this._valueMin()+1,this.handles.each(function(Ve){var Ue=Math.abs(S-be.values(Ve));(k>Ue||k===Ue&&(Ve===be._lastChangedValue||be.values(Ve)===Te.min))&&(k=Ue,R=g(this),W=Ve)}),se=this._start(d,W),se===!1)?!1:(this._mouseSliding=!0,this._handleIndex=W,this._addClass(R,null,"ui-state-active"),R.trigger("focus"),le=R.offset(),fe=!g(d.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=fe?{left:0,top:0}:{left:d.pageX-le.left-R.width()/2,top:d.pageY-le.top-R.height()/2-(parseInt(R.css("borderTopWidth"),10)||0)-(parseInt(R.css("borderBottomWidth"),10)||0)+(parseInt(R.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(d,W,S),this._animateOff=!0,!0)},_mouseStart:function(){return!0},_mouseDrag:function(d){var b={x:d.pageX,y:d.pageY},S=this._normValueFromMouse(b);return this._slide(d,this._handleIndex,S),!1},_mouseStop:function(d){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(d,this._handleIndex),this._change(d,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(d){var b,S,k,R,W;return this.orientation==="horizontal"?(b=this.elementSize.width,S=d.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,S=d.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),k=S/b,k>1&&(k=1),k<0&&(k=0),this.orientation==="vertical"&&(k=1-k),R=this._valueMax()-this._valueMin(),W=this._valueMin()+k*R,this._trimAlignValue(W)},_uiHash:function(d,b,S){var k={handle:this.handles[d],handleIndex:d,value:b!==void 0?b:this.value()};return this._hasMultipleValues()&&(k.value=b!==void 0?b:this.values(d),k.values=S||this.values()),k},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(d,b){return this._trigger("start",d,this._uiHash(b))},_slide:function(d,b,S){var k,R,W=this.value(),se=this.values();this._hasMultipleValues()&&(R=this.values(b?0:1),W=this.values(b),this.options.values.length===2&&this.options.range===!0&&(S=b===0?Math.min(R,S):Math.max(R,S)),se[b]=S),S!==W&&(k=this._trigger("slide",d,this._uiHash(b,S,se)),k!==!1&&(this._hasMultipleValues()?this.values(b,S):this.value(S)))},_stop:function(d,b){this._trigger("stop",d,this._uiHash(b))},_change:function(d,b){!this._keySliding&&!this._mouseSliding&&(this._lastChangedValue=b,this._trigger("change",d,this._uiHash(b)))},value:function(d){if(arguments.length){this.options.value=this._trimAlignValue(d),this._refreshValue(),this._change(null,0);return}return this._value()},values:function(d,b){var S,k,R;if(arguments.length>1){this.options.values[d]=this._trimAlignValue(b),this._refreshValue(),this._change(null,d);return}if(arguments.length)if(Array.isArray(arguments[0])){for(S=this.options.values,k=arguments[0],R=0;R<S.length;R+=1)S[R]=this._trimAlignValue(k[R]),this._change(null,R);this._refreshValue()}else return this._hasMultipleValues()?this._values(d):this.value();else return this._values()},_setOption:function(d,b){var S,k=0;switch(d==="range"&&this.options.range===!0&&(b==="min"?(this.options.value=this._values(0),this.options.values=null):b==="max"&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),Array.isArray(this.options.values)&&(k=this.options.values.length),this._super(d,b),d){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(b),this.handles.css(b==="horizontal"?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),S=k-1;S>=0;S--)this._change(null,S);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1;break}},_setOptionDisabled:function(d){this._super(d),this._toggleClass(null,"ui-state-disabled",!!d)},_value:function(){var d=this.options.value;return d=this._trimAlignValue(d),d},_values:function(d){var b,S,k;if(arguments.length)return b=this.options.values[d],b=this._trimAlignValue(b),b;if(this._hasMultipleValues()){for(S=this.options.values.slice(),k=0;k<S.length;k+=1)S[k]=this._trimAlignValue(S[k]);return S}else return[]},_trimAlignValue:function(d){if(d<=this._valueMin())return this._valueMin();if(d>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,S=(d-this._valueMin())%b,k=d-S;return Math.abs(S)*2>=b&&(k+=S>0?b:-b),parseFloat(k.toFixed(5))},_calculateNewMax:function(){var d=this.options.max,b=this._valueMin(),S=this.options.step,k=Math.round((d-b)/S)*S;d=k+b,d>this.options.max&&(d-=S),this.max=parseFloat(d.toFixed(this._precision()))},_precision:function(){var d=this._precisionOf(this.options.step);return this.options.min!==null&&(d=Math.max(d,this._precisionOf(this.options.min))),d},_precisionOf:function(d){var b=d.toString(),S=b.indexOf(".");return S===-1?0:b.length-S-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(d){d==="vertical"&&this.range.css({width:"",left:""}),d==="horizontal"&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var d,b,S,k,R,W=this.options.range,se=this.options,le=this,fe=this._animateOff?!1:se.animate,be={};this._hasMultipleValues()?this.handles.each(function(Te){b=(le.values(Te)-le._valueMin())/(le._valueMax()-le._valueMin())*100,be[le.orientation==="horizontal"?"left":"bottom"]=b+"%",g(this).stop(1,1)[fe?"animate":"css"](be,se.animate),le.options.range===!0&&(le.orientation==="horizontal"?(Te===0&&le.range.stop(1,1)[fe?"animate":"css"]({left:b+"%"},se.animate),Te===1&&le.range[fe?"animate":"css"]({width:b-d+"%"},{queue:!1,duration:se.animate})):(Te===0&&le.range.stop(1,1)[fe?"animate":"css"]({bottom:b+"%"},se.animate),Te===1&&le.range[fe?"animate":"css"]({height:b-d+"%"},{queue:!1,duration:se.animate}))),d=b}):(S=this.value(),k=this._valueMin(),R=this._valueMax(),b=R!==k?(S-k)/(R-k)*100:0,be[this.orientation==="horizontal"?"left":"bottom"]=b+"%",this.handle.stop(1,1)[fe?"animate":"css"](be,se.animate),W==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[fe?"animate":"css"]({width:b+"%"},se.animate),W==="max"&&this.orientation==="horizontal"&&this.range.stop(1,1)[fe?"animate":"css"]({width:100-b+"%"},se.animate),W==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[fe?"animate":"css"]({height:b+"%"},se.animate),W==="max"&&this.orientation==="vertical"&&this.range.stop(1,1)[fe?"animate":"css"]({height:100-b+"%"},se.animate))},_handleEvents:{keydown:function(d){var b,S,k,R,W=g(d.target).data("ui-slider-handle-index");switch(d.keyCode){case g.ui.keyCode.HOME:case g.ui.keyCode.END:case g.ui.keyCode.PAGE_UP:case g.ui.keyCode.PAGE_DOWN:case g.ui.keyCode.UP:case g.ui.keyCode.RIGHT:case g.ui.keyCode.DOWN:case g.ui.keyCode.LEFT:if(d.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(g(d.target),null,"ui-state-active"),b=this._start(d,W),b===!1))return;break}switch(R=this.options.step,this._hasMultipleValues()?S=k=this.values(W):S=k=this.value(),d.keyCode){case g.ui.keyCode.HOME:k=this._valueMin();break;case g.ui.keyCode.END:k=this._valueMax();break;case g.ui.keyCode.PAGE_UP:k=this._trimAlignValue(S+(this._valueMax()-this._valueMin())/this.numPages);break;case g.ui.keyCode.PAGE_DOWN:k=this._trimAlignValue(S-(this._valueMax()-this._valueMin())/this.numPages);break;case g.ui.keyCode.UP:case g.ui.keyCode.RIGHT:if(S===this._valueMax())return;k=this._trimAlignValue(S+R);break;case g.ui.keyCode.DOWN:case g.ui.keyCode.LEFT:if(S===this._valueMin())return;k=this._trimAlignValue(S-R);break}this._slide(d,W,k)},keyup:function(d){var b=g(d.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(d,b),this._change(d,b),this._removeClass(g(d.target),null,"ui-state-active"))}}});/*!
 * jQuery UI Sortable 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.sortable",g.ui.mouse,{version:"1.13.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(d,b,S){return d>=b&&d<b+S},_isFloating:function(d){return/left|right/.test(d.css("float"))||/inline|table-cell/.test(d.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(d,b){this._super(d,b),d==="handle"&&this._setHandleClassName()},_setHandleClassName:function(){var d=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),g.each(this.items,function(){d._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var d=this.items.length-1;d>=0;d--)this.items[d].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(d,b){var S=null,k=!1,R=this;return this.reverting||this.options.disabled||this.options.type==="static"||(this._refreshItems(d),g(d.target).parents().each(function(){if(g.data(this,R.widgetName+"-item")===R)return S=g(this),!1}),g.data(d.target,R.widgetName+"-item")===R&&(S=g(d.target)),!S)||this.options.handle&&!b&&(g(this.options.handle,S).find("*").addBack().each(function(){this===d.target&&(k=!0)}),!k)?!1:(this.currentItem=S,this._removeCurrentsFromItems(),!0)},_mouseStart:function(d,b,S){var k,R,W=this.options;if(this.currentContainer=this,this.refreshPositions(),this.appendTo=g(W.appendTo!=="parent"?W.appendTo:this.currentItem.parent()),this.helper=this._createHelper(d),this._cacheHelperProportions(),this._cacheMargins(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},g.extend(this.offset,{click:{left:d.pageX-this.offset.left,top:d.pageY-this.offset.top},relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),W.cursorAt&&this._adjustOffsetFromHelper(W.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),this.scrollParent=this.placeholder.scrollParent(),g.extend(this.offset,{parent:this._getParentOffset()}),W.containment&&this._setContainment(),W.cursor&&W.cursor!=="auto"&&(R=this.document.find("body"),this.storedCursor=R.css("cursor"),R.css("cursor",W.cursor),this.storedStylesheet=g("<style>*{ cursor: "+W.cursor+" !important; }</style>").appendTo(R)),W.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",W.zIndex)),W.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",W.opacity)),this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",d,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!S)for(k=this.containers.length-1;k>=0;k--)this.containers[k]._trigger("activate",d,this._uiHash(this));return g.ui.ddmanager&&(g.ui.ddmanager.current=this),g.ui.ddmanager&&!W.dropBehaviour&&g.ui.ddmanager.prepareOffsets(this,d),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this.helper.parent().is(this.appendTo)||(this.helper.detach().appendTo(this.appendTo),this.offset.parent=this._getParentOffset()),this.position=this.originalPosition=this._generatePosition(d),this.originalPageX=d.pageX,this.originalPageY=d.pageY,this.lastPositionAbs=this.positionAbs=this._convertPositionTo("absolute"),this._mouseDrag(d),!0},_scroll:function(d){var b=this.options,S=!1;return this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-d.pageY<b.scrollSensitivity?this.scrollParent[0].scrollTop=S=this.scrollParent[0].scrollTop+b.scrollSpeed:d.pageY-this.overflowOffset.top<b.scrollSensitivity&&(this.scrollParent[0].scrollTop=S=this.scrollParent[0].scrollTop-b.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-d.pageX<b.scrollSensitivity?this.scrollParent[0].scrollLeft=S=this.scrollParent[0].scrollLeft+b.scrollSpeed:d.pageX-this.overflowOffset.left<b.scrollSensitivity&&(this.scrollParent[0].scrollLeft=S=this.scrollParent[0].scrollLeft-b.scrollSpeed)):(d.pageY-this.document.scrollTop()<b.scrollSensitivity?S=this.document.scrollTop(this.document.scrollTop()-b.scrollSpeed):this.window.height()-(d.pageY-this.document.scrollTop())<b.scrollSensitivity&&(S=this.document.scrollTop(this.document.scrollTop()+b.scrollSpeed)),d.pageX-this.document.scrollLeft()<b.scrollSensitivity?S=this.document.scrollLeft(this.document.scrollLeft()-b.scrollSpeed):this.window.width()-(d.pageX-this.document.scrollLeft())<b.scrollSensitivity&&(S=this.document.scrollLeft(this.document.scrollLeft()+b.scrollSpeed))),S},_mouseDrag:function(d){var b,S,k,R,W=this.options;for(this.position=this._generatePosition(d),this.positionAbs=this._convertPositionTo("absolute"),(!this.options.axis||this.options.axis!=="y")&&(this.helper[0].style.left=this.position.left+"px"),(!this.options.axis||this.options.axis!=="x")&&(this.helper[0].style.top=this.position.top+"px"),W.scroll&&this._scroll(d)!==!1&&(this._refreshItemPositions(!0),g.ui.ddmanager&&!W.dropBehaviour&&g.ui.ddmanager.prepareOffsets(this,d)),this.dragDirection={vertical:this._getDragVerticalDirection(),horizontal:this._getDragHorizontalDirection()},b=this.items.length-1;b>=0;b--)if(S=this.items[b],k=S.item[0],R=this._intersectsWithPointer(S),!!R&&S.instance===this.currentContainer&&k!==this.currentItem[0]&&this.placeholder[R===1?"next":"prev"]()[0]!==k&&!g.contains(this.placeholder[0],k)&&(this.options.type!=="semi-dynamic"||!g.contains(this.element[0],k))){if(this.direction=R===1?"down":"up",this.options.tolerance==="pointer"||this._intersectsWithSides(S))this._rearrange(d,S);else break;this._trigger("change",d,this._uiHash());break}return this._contactContainers(d),g.ui.ddmanager&&g.ui.ddmanager.drag(this,d),this._trigger("sort",d,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(d,b){if(d){if(g.ui.ddmanager&&!this.options.dropBehaviour&&g.ui.ddmanager.drop(this,d),this.options.revert){var S=this,k=this.placeholder.offset(),R=this.options.axis,W={};(!R||R==="x")&&(W.left=k.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),(!R||R==="y")&&(W.top=k.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,g(this.helper).animate(W,parseInt(this.options.revert,10)||500,function(){S._clear(d)})}else this._clear(d,b);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new g.Event("mouseup",{target:null})),this.options.helper==="original"?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var d=this.containers.length-1;d>=0;d--)this.containers[d]._trigger("deactivate",null,this._uiHash(this)),this.containers[d].containerCache.over&&(this.containers[d]._trigger("out",null,this._uiHash(this)),this.containers[d].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),g.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?g(this.domPosition.prev).after(this.currentItem):g(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(d){var b=this._getItemsAsjQuery(d&&d.connected),S=[];return d=d||{},g(b).each(function(){var k=(g(d.item||this).attr(d.attribute||"id")||"").match(d.expression||/(.+)[\-=_](.+)/);k&&S.push((d.key||k[1]+"[]")+"="+(d.key&&d.expression?k[1]:k[2]))}),!S.length&&d.key&&S.push(d.key+"="),S.join("&")},toArray:function(d){var b=this._getItemsAsjQuery(d&&d.connected),S=[];return d=d||{},b.each(function(){S.push(g(d.item||this).attr(d.attribute||"id")||"")}),S},_intersectsWith:function(d){var b=this.positionAbs.left,S=b+this.helperProportions.width,k=this.positionAbs.top,R=k+this.helperProportions.height,W=d.left,se=W+d.width,le=d.top,fe=le+d.height,be=this.offset.click.top,Te=this.offset.click.left,Ve=this.options.axis==="x"||k+be>le&&k+be<fe,Ue=this.options.axis==="y"||b+Te>W&&b+Te<se,me=Ve&&Ue;return this.options.tolerance==="pointer"||this.options.forcePointerForContainers||this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>d[this.floating?"width":"height"]?me:W<b+this.helperProportions.width/2&&S-this.helperProportions.width/2<se&&le<k+this.helperProportions.height/2&&R-this.helperProportions.height/2<fe},_intersectsWithPointer:function(d){var b,S,k=this.options.axis==="x"||this._isOverAxis(this.positionAbs.top+this.offset.click.top,d.top,d.height),R=this.options.axis==="y"||this._isOverAxis(this.positionAbs.left+this.offset.click.left,d.left,d.width),W=k&&R;return W?(b=this.dragDirection.vertical,S=this.dragDirection.horizontal,this.floating?S==="right"||b==="down"?2:1:b&&(b==="down"?2:1)):!1},_intersectsWithSides:function(d){var b=this._isOverAxis(this.positionAbs.top+this.offset.click.top,d.top+d.height/2,d.height),S=this._isOverAxis(this.positionAbs.left+this.offset.click.left,d.left+d.width/2,d.width),k=this.dragDirection.vertical,R=this.dragDirection.horizontal;return this.floating&&R?R==="right"&&S||R==="left"&&!S:k&&(k==="down"&&b||k==="up"&&!b)},_getDragVerticalDirection:function(){var d=this.positionAbs.top-this.lastPositionAbs.top;return d!==0&&(d>0?"down":"up")},_getDragHorizontalDirection:function(){var d=this.positionAbs.left-this.lastPositionAbs.left;return d!==0&&(d>0?"right":"left")},refresh:function(d){return this._refreshItems(d),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var d=this.options;return d.connectWith.constructor===String?[d.connectWith]:d.connectWith},_getItemsAsjQuery:function(d){var b,S,k,R,W=[],se=[],le=this._connectWith();if(le&&d)for(b=le.length-1;b>=0;b--)for(k=g(le[b],this.document[0]),S=k.length-1;S>=0;S--)R=g.data(k[S],this.widgetFullName),R&&R!==this&&!R.options.disabled&&se.push([typeof R.options.items=="function"?R.options.items.call(R.element):g(R.options.items,R.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),R]);se.push([typeof this.options.items=="function"?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):g(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);function fe(){W.push(this)}for(b=se.length-1;b>=0;b--)se[b][0].each(fe);return g(W)},_removeCurrentsFromItems:function(){var d=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=g.grep(this.items,function(b){for(var S=0;S<d.length;S++)if(d[S]===b.item[0])return!1;return!0})},_refreshItems:function(d){this.items=[],this.containers=[this];var b,S,k,R,W,se,le,fe,be=this.items,Te=[[typeof this.options.items=="function"?this.options.items.call(this.element[0],d,{item:this.currentItem}):g(this.options.items,this.element),this]],Ve=this._connectWith();if(Ve&&this.ready)for(b=Ve.length-1;b>=0;b--)for(k=g(Ve[b],this.document[0]),S=k.length-1;S>=0;S--)R=g.data(k[S],this.widgetFullName),R&&R!==this&&!R.options.disabled&&(Te.push([typeof R.options.items=="function"?R.options.items.call(R.element[0],d,{item:this.currentItem}):g(R.options.items,R.element),R]),this.containers.push(R));for(b=Te.length-1;b>=0;b--)for(W=Te[b][1],se=Te[b][0],S=0,fe=se.length;S<fe;S++)le=g(se[S]),le.data(this.widgetName+"-item",W),be.push({item:le,instance:W,width:0,height:0,left:0,top:0})},_refreshItemPositions:function(d){var b,S,k,R;for(b=this.items.length-1;b>=0;b--)S=this.items[b],!(this.currentContainer&&S.instance!==this.currentContainer&&S.item[0]!==this.currentItem[0])&&(k=this.options.toleranceElement?g(this.options.toleranceElement,S.item):S.item,d||(S.width=k.outerWidth(),S.height=k.outerHeight()),R=k.offset(),S.left=R.left,S.top=R.top)},refreshPositions:function(d){this.floating=this.items.length?this.options.axis==="x"||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset()),this._refreshItemPositions(d);var b,S;if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(b=this.containers.length-1;b>=0;b--)S=this.containers[b].element.offset(),this.containers[b].containerCache.left=S.left,this.containers[b].containerCache.top=S.top,this.containers[b].containerCache.width=this.containers[b].element.outerWidth(),this.containers[b].containerCache.height=this.containers[b].element.outerHeight();return this},_createPlaceholder:function(d){d=d||this;var b,S,k=d.options;(!k.placeholder||k.placeholder.constructor===String)&&(b=k.placeholder,S=d.currentItem[0].nodeName.toLowerCase(),k.placeholder={element:function(){var R=g("<"+S+">",d.document[0]);return d._addClass(R,"ui-sortable-placeholder",b||d.currentItem[0].className)._removeClass(R,"ui-sortable-helper"),S==="tbody"?d._createTrPlaceholder(d.currentItem.find("tr").eq(0),g("<tr>",d.document[0]).appendTo(R)):S==="tr"?d._createTrPlaceholder(d.currentItem,R):S==="img"&&R.attr("src",d.currentItem.attr("src")),b||R.css("visibility","hidden"),R},update:function(R,W){b&&!k.forcePlaceholderSize||((!W.height()||k.forcePlaceholderSize&&(S==="tbody"||S==="tr"))&&W.height(d.currentItem.innerHeight()-parseInt(d.currentItem.css("paddingTop")||0,10)-parseInt(d.currentItem.css("paddingBottom")||0,10)),W.width()||W.width(d.currentItem.innerWidth()-parseInt(d.currentItem.css("paddingLeft")||0,10)-parseInt(d.currentItem.css("paddingRight")||0,10)))}}),d.placeholder=g(k.placeholder.element.call(d.element,d.currentItem)),d.currentItem.after(d.placeholder),k.placeholder.update(d,d.placeholder)},_createTrPlaceholder:function(d,b){var S=this;d.children().each(function(){g("<td>&#160;</td>",S.document[0]).attr("colspan",g(this).attr("colspan")||1).appendTo(b)})},_contactContainers:function(d){var b,S,k,R,W,se,le,fe,be,Te,Ve=null,Ue=null;for(b=this.containers.length-1;b>=0;b--)if(!g.contains(this.currentItem[0],this.containers[b].element[0]))if(this._intersectsWith(this.containers[b].containerCache)){if(Ve&&g.contains(this.containers[b].element[0],Ve.element[0]))continue;Ve=this.containers[b],Ue=b}else this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",d,this._uiHash(this)),this.containers[b].containerCache.over=0);if(Ve)if(this.containers.length===1)this.containers[Ue].containerCache.over||(this.containers[Ue]._trigger("over",d,this._uiHash(this)),this.containers[Ue].containerCache.over=1);else{for(k=1e4,R=null,be=Ve.floating||this._isFloating(this.currentItem),W=be?"left":"top",se=be?"width":"height",Te=be?"pageX":"pageY",S=this.items.length-1;S>=0;S--)g.contains(this.containers[Ue].element[0],this.items[S].item[0])&&this.items[S].item[0]!==this.currentItem[0]&&(le=this.items[S].item.offset()[W],fe=!1,d[Te]-le>this.items[S][se]/2&&(fe=!0),Math.abs(d[Te]-le)<k&&(k=Math.abs(d[Te]-le),R=this.items[S],this.direction=fe?"up":"down"));if(!R&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[Ue]){this.currentContainer.containerCache.over||(this.containers[Ue]._trigger("over",d,this._uiHash()),this.currentContainer.containerCache.over=1);return}R?this._rearrange(d,R,null,!0):this._rearrange(d,null,this.containers[Ue].element,!0),this._trigger("change",d,this._uiHash()),this.containers[Ue]._trigger("change",d,this._uiHash(this)),this.currentContainer=this.containers[Ue],this.options.placeholder.update(this.currentContainer,this.placeholder),this.scrollParent=this.placeholder.scrollParent(),this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this.containers[Ue]._trigger("over",d,this._uiHash(this)),this.containers[Ue].containerCache.over=1}},_createHelper:function(d){var b=this.options,S=typeof b.helper=="function"?g(b.helper.apply(this.element[0],[d,this.currentItem])):b.helper==="clone"?this.currentItem.clone():this.currentItem;return S.parents("body").length||this.appendTo[0].appendChild(S[0]),S[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!S[0].style.width||b.forceHelperSize)&&S.width(this.currentItem.width()),(!S[0].style.height||b.forceHelperSize)&&S.height(this.currentItem.height()),S},_adjustOffsetFromHelper:function(d){typeof d=="string"&&(d=d.split(" ")),Array.isArray(d)&&(d={left:+d[0],top:+d[1]||0}),"left"in d&&(this.offset.click.left=d.left+this.margins.left),"right"in d&&(this.offset.click.left=this.helperProportions.width-d.right+this.margins.left),"top"in d&&(this.offset.click.top=d.top+this.margins.top),"bottom"in d&&(this.offset.click.top=this.helperProportions.height-d.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var d=this.offsetParent.offset();return this.cssPosition==="absolute"&&this.scrollParent[0]!==this.document[0]&&g.contains(this.scrollParent[0],this.offsetParent[0])&&(d.left+=this.scrollParent.scrollLeft(),d.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&g.ui.ie)&&(d={top:0,left:0}),{top:d.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:d.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var d=this.currentItem.position();return{top:d.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:d.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var d,b,S,k=this.options;k.containment==="parent"&&(k.containment=this.helper[0].parentNode),(k.containment==="document"||k.containment==="window")&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,k.containment==="document"?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,(k.containment==="document"?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(k.containment)||(d=g(k.containment)[0],b=g(k.containment).offset(),S=g(d).css("overflow")!=="hidden",this.containment=[b.left+(parseInt(g(d).css("borderLeftWidth"),10)||0)+(parseInt(g(d).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt(g(d).css("borderTopWidth"),10)||0)+(parseInt(g(d).css("paddingTop"),10)||0)-this.margins.top,b.left+(S?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(g(d).css("borderLeftWidth"),10)||0)-(parseInt(g(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(S?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(g(d).css("borderTopWidth"),10)||0)-(parseInt(g(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(d,b){b||(b=this.position);var S=d==="absolute"?1:-1,k=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==this.document[0]&&g.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,R=/(html|body)/i.test(k[0].tagName);return{top:b.top+this.offset.relative.top*S+this.offset.parent.top*S-(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():R?0:k.scrollTop())*S,left:b.left+this.offset.relative.left*S+this.offset.parent.left*S-(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():R?0:k.scrollLeft())*S}},_generatePosition:function(d){var b,S,k=this.options,R=d.pageX,W=d.pageY,se=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==this.document[0]&&g.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,le=/(html|body)/i.test(se[0].tagName);return this.cssPosition==="relative"&&!(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(d.pageX-this.offset.click.left<this.containment[0]&&(R=this.containment[0]+this.offset.click.left),d.pageY-this.offset.click.top<this.containment[1]&&(W=this.containment[1]+this.offset.click.top),d.pageX-this.offset.click.left>this.containment[2]&&(R=this.containment[2]+this.offset.click.left),d.pageY-this.offset.click.top>this.containment[3]&&(W=this.containment[3]+this.offset.click.top)),k.grid&&(b=this.originalPageY+Math.round((W-this.originalPageY)/k.grid[1])*k.grid[1],W=this.containment?b-this.offset.click.top>=this.containment[1]&&b-this.offset.click.top<=this.containment[3]?b:b-this.offset.click.top>=this.containment[1]?b-k.grid[1]:b+k.grid[1]:b,S=this.originalPageX+Math.round((R-this.originalPageX)/k.grid[0])*k.grid[0],R=this.containment?S-this.offset.click.left>=this.containment[0]&&S-this.offset.click.left<=this.containment[2]?S:S-this.offset.click.left>=this.containment[0]?S-k.grid[0]:S+k.grid[0]:S)),{top:W-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():le?0:se.scrollTop()),left:R-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():le?0:se.scrollLeft())}},_rearrange:function(d,b,S,k){S?S[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],this.direction==="down"?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var R=this.counter;this._delay(function(){R===this.counter&&this.refreshPositions(!k)})},_clear:function(d,b){this.reverting=!1;var S,k=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(S in this._storedCSS)(this._storedCSS[S]==="auto"||this._storedCSS[S]==="static")&&(this._storedCSS[S]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!b&&k.push(function(W){this._trigger("receive",W,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!b&&k.push(function(W){this._trigger("update",W,this._uiHash())}),this!==this.currentContainer&&(b||(k.push(function(W){this._trigger("remove",W,this._uiHash())}),k.push((function(W){return function(se){W._trigger("receive",se,this._uiHash(this))}}).call(this,this.currentContainer)),k.push((function(W){return function(se){W._trigger("update",se,this._uiHash(this))}}).call(this,this.currentContainer))));function R(W,se,le){return function(fe){le._trigger(W,fe,se._uiHash(se))}}for(S=this.containers.length-1;S>=0;S--)b||k.push(R("deactivate",this,this.containers[S])),this.containers[S].containerCache.over&&(k.push(R("out",this,this.containers[S])),this.containers[S].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex),this.dragging=!1,b||this._trigger("beforeStop",d,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!b){for(S=0;S<k.length;S++)k[S].call(this,d);this._trigger("stop",d,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){g.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(d){var b=d||this;return{helper:b.helper,placeholder:b.placeholder||g([]),position:b.position,originalPosition:b.originalPosition,offset:b.positionAbs,item:b.currentItem,sender:d?d.element:null}}});/*!
 * jQuery UI Spinner 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */function vi(d){return function(){var b=this.element.val();d.apply(this,arguments),this._refresh(),b!==this.element.val()&&this._trigger("change")}}g.widget("ui.spinner",{version:"1.13.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this.value()!==""&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var d=this._super(),b=this.element;return g.each(["min","max","step"],function(S,k){var R=b.attr(k);R!=null&&R.length&&(d[k]=R)}),d},_events:{keydown:function(d){this._start(d)&&this._keydown(d)&&d.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(d){if(this.cancelBlur){delete this.cancelBlur;return}this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",d)},mousewheel:function(d,b){var S=g.ui.safeActiveElement(this.document[0]),k=this.element[0]===S;if(!(!k||!b)){if(!this.spinning&&!this._start(d))return!1;this._spin((b>0?1:-1)*this.options.step,d),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(d)},100),d.preventDefault()}},"mousedown .ui-spinner-button":function(d){var b;b=this.element[0]===g.ui.safeActiveElement(this.document[0])?this.previous:this.element.val();function S(){var k=this.element[0]===g.ui.safeActiveElement(this.document[0]);k||(this.element.trigger("focus"),this.previous=b,this._delay(function(){this.previous=b}))}d.preventDefault(),S.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,S.call(this)}),this._start(d)!==!1&&this._repeat(null,g(d.currentTarget).hasClass("ui-spinner-up")?1:-1,d)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(d){if(g(d.currentTarget).hasClass("ui-state-active")){if(this._start(d)===!1)return!1;this._repeat(null,g(d.currentTarget).hasClass("ui-spinner-up")?1:-1,d)}},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(this.uiSpinner.height()*.5)&&this.uiSpinner.height()>0&&this.uiSpinner.height(this.uiSpinner.height())},_keydown:function(d){var b=this.options,S=g.ui.keyCode;switch(d.keyCode){case S.UP:return this._repeat(null,1,d),!0;case S.DOWN:return this._repeat(null,-1,d),!0;case S.PAGE_UP:return this._repeat(null,b.page,d),!0;case S.PAGE_DOWN:return this._repeat(null,-b.page,d),!0}return!1},_start:function(d){return!this.spinning&&this._trigger("start",d)===!1?!1:(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(d,b,S){d=d||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,b,S)},d),this._spin(b*this.options.step,S)},_spin:function(d,b){var S=this.value()||0;this.counter||(this.counter=1),S=this._adjustValue(S+d*this._increment(this.counter)),(!this.spinning||this._trigger("spin",b,{value:S})!==!1)&&(this._value(S),this.counter++)},_increment:function(d){var b=this.options.incremental;return b?typeof b=="function"?b(d):Math.floor(d*d*d/5e4-d*d/500+17*d/200+1):1},_precision:function(){var d=this._precisionOf(this.options.step);return this.options.min!==null&&(d=Math.max(d,this._precisionOf(this.options.min))),d},_precisionOf:function(d){var b=d.toString(),S=b.indexOf(".");return S===-1?0:b.length-S-1},_adjustValue:function(d){var b,S,k=this.options;return b=k.min!==null?k.min:0,S=d-b,S=Math.round(S/k.step)*k.step,d=b+S,d=parseFloat(d.toFixed(this._precision())),k.max!==null&&d>k.max?k.max:k.min!==null&&d<k.min?k.min:d},_stop:function(d){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",d))},_setOption:function(d,b){var S,k,R;if(d==="culture"||d==="numberFormat"){S=this._parse(this.element.val()),this.options[d]=b,this.element.val(this._format(S));return}(d==="max"||d==="min"||d==="step")&&typeof b=="string"&&(b=this._parse(b)),d==="icons"&&(k=this.buttons.first().find(".ui-icon"),this._removeClass(k,null,this.options.icons.up),this._addClass(k,null,b.up),R=this.buttons.last().find(".ui-icon"),this._removeClass(R,null,this.options.icons.down),this._addClass(R,null,b.down)),this._super(d,b)},_setOptionDisabled:function(d){this._super(d),this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!d),this.element.prop("disabled",!!d),this.buttons.button(d?"disable":"enable")},_setOptions:vi(function(d){this._super(d)}),_parse:function(d){return typeof d=="string"&&d!==""&&(d=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(d,10,this.options.culture):+d),d===""||isNaN(d)?null:d},_format:function(d){return d===""?"":window.Globalize&&this.options.numberFormat?Globalize.format(d,this.options.numberFormat,this.options.culture):d},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var d=this.value();return d===null?!1:d===this._adjustValue(d)},_value:function(d,b){var S;d!==""&&(S=this._parse(d),S!==null&&(b||(S=this._adjustValue(S)),d=this._format(S))),this.element.val(d),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:vi(function(d){this._stepUp(d)}),_stepUp:function(d){this._start()&&(this._spin((d||1)*this.options.step),this._stop())},stepDown:vi(function(d){this._stepDown(d)}),_stepDown:function(d){this._start()&&(this._spin((d||1)*-this.options.step),this._stop())},pageUp:vi(function(d){this._stepUp((d||1)*this.options.page)}),pageDown:vi(function(d){this._stepDown((d||1)*this.options.page)}),value:function(d){if(!arguments.length)return this._parse(this.element.val());vi(this._value).call(this,d)},widget:function(){return this.uiSpinner}}),g.uiBackCompat!==!1&&g.widget("ui.spinner",g.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}}),g.ui.spinner;/*!
 * jQuery UI Tabs 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.tabs",{version:"1.13.2",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var d=/#.*$/;return function(b){var S,k;S=b.href.replace(d,""),k=location.href.replace(d,"");try{S=decodeURIComponent(S)}catch{}try{k=decodeURIComponent(k)}catch{}return b.hash.length>1&&S===k}}(),_create:function(){var d=this,b=this.options;this.running=!1,this._addClass("ui-tabs","ui-widget ui-widget-content"),this._toggleClass("ui-tabs-collapsible",null,b.collapsible),this._processTabs(),b.active=this._initialActive(),Array.isArray(b.disabled)&&(b.disabled=g.uniqueSort(b.disabled.concat(g.map(this.tabs.filter(".ui-state-disabled"),function(S){return d.tabs.index(S)}))).sort()),this.options.active!==!1&&this.anchors.length?this.active=this._findActive(b.active):this.active=g(),this._refresh(),this.active.length&&this.load(b.active)},_initialActive:function(){var d=this.options.active,b=this.options.collapsible,S=location.hash.substring(1);return d===null&&(S&&this.tabs.each(function(k,R){if(g(R).attr("aria-controls")===S)return d=k,!1}),d===null&&(d=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(d===null||d===-1)&&(d=this.tabs.length?0:!1)),d!==!1&&(d=this.tabs.index(this.tabs.eq(d)),d===-1&&(d=b?!1:0)),!b&&d===!1&&this.anchors.length&&(d=0),d},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):g()}},_tabKeydown:function(d){var b=g(g.ui.safeActiveElement(this.document[0])).closest("li"),S=this.tabs.index(b),k=!0;if(!this._handlePageNav(d)){switch(d.keyCode){case g.ui.keyCode.RIGHT:case g.ui.keyCode.DOWN:S++;break;case g.ui.keyCode.UP:case g.ui.keyCode.LEFT:k=!1,S--;break;case g.ui.keyCode.END:S=this.anchors.length-1;break;case g.ui.keyCode.HOME:S=0;break;case g.ui.keyCode.SPACE:d.preventDefault(),clearTimeout(this.activating),this._activate(S);return;case g.ui.keyCode.ENTER:d.preventDefault(),clearTimeout(this.activating),this._activate(S===this.options.active?!1:S);return;default:return}d.preventDefault(),clearTimeout(this.activating),S=this._focusNextTab(S,k),!d.ctrlKey&&!d.metaKey&&(b.attr("aria-selected","false"),this.tabs.eq(S).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",S)},this.delay))}},_panelKeydown:function(d){this._handlePageNav(d)||d.ctrlKey&&d.keyCode===g.ui.keyCode.UP&&(d.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(d){if(d.altKey&&d.keyCode===g.ui.keyCode.PAGE_UP)return this._activate(this._focusNextTab(this.options.active-1,!1)),!0;if(d.altKey&&d.keyCode===g.ui.keyCode.PAGE_DOWN)return this._activate(this._focusNextTab(this.options.active+1,!0)),!0},_findNextTab:function(d,b){var S=this.tabs.length-1;function k(){return d>S&&(d=0),d<0&&(d=S),d}for(;g.inArray(k(),this.options.disabled)!==-1;)d=b?d+1:d-1;return d},_focusNextTab:function(d,b){return d=this._findNextTab(d,b),this.tabs.eq(d).trigger("focus"),d},_setOption:function(d,b){if(d==="active"){this._activate(b);return}this._super(d,b),d==="collapsible"&&(this._toggleClass("ui-tabs-collapsible",null,b),!b&&this.options.active===!1&&this._activate(0)),d==="event"&&this._setupEvents(b),d==="heightStyle"&&this._setupHeightStyle(b)},_sanitizeSelector:function(d){return d?d.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var d=this.options,b=this.tablist.children(":has(a[href])");d.disabled=g.map(b.filter(".ui-state-disabled"),function(S){return b.index(S)}),this._processTabs(),d.active===!1||!this.anchors.length?(d.active=!1,this.active=g()):this.active.length&&!g.contains(this.tablist[0],this.active[0])?this.tabs.length===d.disabled.length?(d.active=!1,this.active=g()):this._activate(this._findNextTab(Math.max(0,d.active-1),!1)):d.active=this.tabs.index(this.active),this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var d=this,b=this.tabs,S=this.anchors,k=this.panels;this.tablist=this._getList().attr("role","tablist"),this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header"),this.tablist.on("mousedown"+this.eventNamespace,"> li",function(R){g(this).is(".ui-state-disabled")&&R.preventDefault()}).on("focus"+this.eventNamespace,".ui-tabs-anchor",function(){g(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1}),this._addClass(this.tabs,"ui-tabs-tab","ui-state-default"),this.anchors=this.tabs.map(function(){return g("a",this)[0]}).attr({tabIndex:-1}),this._addClass(this.anchors,"ui-tabs-anchor"),this.panels=g(),this.anchors.each(function(R,W){var se,le,fe,be=g(W).uniqueId().attr("id"),Te=g(W).closest("li"),Ve=Te.attr("aria-controls");d._isLocal(W)?(se=W.hash,fe=se.substring(1),le=d.element.find(d._sanitizeSelector(se))):(fe=Te.attr("aria-controls")||g({}).uniqueId()[0].id,se="#"+fe,le=d.element.find(se),le.length||(le=d._createPanel(fe),le.insertAfter(d.panels[R-1]||d.tablist)),le.attr("aria-live","polite")),le.length&&(d.panels=d.panels.add(le)),Ve&&Te.data("ui-tabs-aria-controls",Ve),Te.attr({"aria-controls":fe,"aria-labelledby":be}),le.attr("aria-labelledby",be)}),this.panels.attr("role","tabpanel"),this._addClass(this.panels,"ui-tabs-panel","ui-widget-content"),b&&(this._off(b.not(this.tabs)),this._off(S.not(this.anchors)),this._off(k.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(d){return g("<div>").attr("id",d).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(d){var b,S,k;for(Array.isArray(d)&&(d.length?d.length===this.anchors.length&&(d=!0):d=!1),k=0;S=this.tabs[k];k++)b=g(S),d===!0||g.inArray(k,d)!==-1?(b.attr("aria-disabled","true"),this._addClass(b,null,"ui-state-disabled")):(b.removeAttr("aria-disabled"),this._removeClass(b,null,"ui-state-disabled"));this.options.disabled=d,this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,d===!0)},_setupEvents:function(d){var b={};d&&g.each(d.split(" "),function(S,k){b[k]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(S){S.preventDefault()}}),this._on(this.anchors,b),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(d){var b,S=this.element.parent();d==="fill"?(b=S.height(),b-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var k=g(this),R=k.css("position");R==="absolute"||R==="fixed"||(b-=k.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){b-=g(this).outerHeight(!0)}),this.panels.each(function(){g(this).height(Math.max(0,b-g(this).innerHeight()+g(this).height()))}).css("overflow","auto")):d==="auto"&&(b=0,this.panels.each(function(){b=Math.max(b,g(this).height("").height())}).height(b))},_eventHandler:function(d){var b=this.options,S=this.active,k=g(d.currentTarget),R=k.closest("li"),W=R[0]===S[0],se=W&&b.collapsible,le=se?g():this._getPanelForTab(R),fe=S.length?this._getPanelForTab(S):g(),be={oldTab:S,oldPanel:fe,newTab:se?g():R,newPanel:le};d.preventDefault(),!(R.hasClass("ui-state-disabled")||R.hasClass("ui-tabs-loading")||this.running||W&&!b.collapsible||this._trigger("beforeActivate",d,be)===!1)&&(b.active=se?!1:this.tabs.index(R),this.active=W?g():R,this.xhr&&this.xhr.abort(),!fe.length&&!le.length&&g.error("jQuery UI Tabs: Mismatching fragment identifier."),le.length&&this.load(this.tabs.index(R),d),this._toggle(d,be))},_toggle:function(d,b){var S=this,k=b.newPanel,R=b.oldPanel;this.running=!0;function W(){S.running=!1,S._trigger("activate",d,b)}function se(){S._addClass(b.newTab.closest("li"),"ui-tabs-active","ui-state-active"),k.length&&S.options.show?S._show(k,S.options.show,W):(k.show(),W())}R.length&&this.options.hide?this._hide(R,this.options.hide,function(){S._removeClass(b.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),se()}):(this._removeClass(b.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),R.hide(),se()),R.attr("aria-hidden","true"),b.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),k.length&&R.length?b.oldTab.attr("tabIndex",-1):k.length&&this.tabs.filter(function(){return g(this).attr("tabIndex")===0}).attr("tabIndex",-1),k.attr("aria-hidden","false"),b.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(d){var b,S=this._findActive(d);S[0]!==this.active[0]&&(S.length||(S=this.active),b=S.find(".ui-tabs-anchor")[0],this._eventHandler({target:b,currentTarget:b,preventDefault:g.noop}))},_findActive:function(d){return d===!1?g():this.tabs.eq(d)},_getIndex:function(d){return typeof d=="string"&&(d=this.anchors.index(this.anchors.filter("[href$='"+g.escapeSelector(d)+"']"))),d},_destroy:function(){this.xhr&&this.xhr.abort(),this.tablist.removeAttr("role").off(this.eventNamespace),this.anchors.removeAttr("role tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){g.data(this,"ui-tabs-destroy")?g(this).remove():g(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")}),this.tabs.each(function(){var d=g(this),b=d.data("ui-tabs-aria-controls");b?d.attr("aria-controls",b).removeData("ui-tabs-aria-controls"):d.removeAttr("aria-controls")}),this.panels.show(),this.options.heightStyle!=="content"&&this.panels.css("height","")},enable:function(d){var b=this.options.disabled;b!==!1&&(d===void 0?b=!1:(d=this._getIndex(d),Array.isArray(b)?b=g.map(b,function(S){return S!==d?S:null}):b=g.map(this.tabs,function(S,k){return k!==d?k:null})),this._setOptionDisabled(b))},disable:function(d){var b=this.options.disabled;if(b!==!0){if(d===void 0)b=!0;else{if(d=this._getIndex(d),g.inArray(d,b)!==-1)return;Array.isArray(b)?b=g.merge([d],b).sort():b=[d]}this._setOptionDisabled(b)}},load:function(d,b){d=this._getIndex(d);var S=this,k=this.tabs.eq(d),R=k.find(".ui-tabs-anchor"),W=this._getPanelForTab(k),se={tab:k,panel:W},le=function(fe,be){be==="abort"&&S.panels.stop(!1,!0),S._removeClass(k,"ui-tabs-loading"),W.removeAttr("aria-busy"),fe===S.xhr&&delete S.xhr};this._isLocal(R[0])||(this.xhr=g.ajax(this._ajaxSettings(R,b,se)),this.xhr&&this.xhr.statusText!=="canceled"&&(this._addClass(k,"ui-tabs-loading"),W.attr("aria-busy","true"),this.xhr.done(function(fe,be,Te){setTimeout(function(){W.html(fe),S._trigger("load",b,se),le(Te,be)},1)}).fail(function(fe,be){setTimeout(function(){le(fe,be)},1)})))},_ajaxSettings:function(d,b,S){var k=this;return{url:d.attr("href").replace(/#.*$/,""),beforeSend:function(R,W){return k._trigger("beforeLoad",b,g.extend({jqXHR:R,ajaxSettings:W},S))}}},_getPanelForTab:function(d){var b=g(d).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+b))}}),g.uiBackCompat!==!1&&g.widget("ui.tabs",g.ui.tabs,{_processTabs:function(){this._superApply(arguments),this._addClass(this.tabs,"ui-tab")}}),g.ui.tabs;/*!
 * jQuery UI Tooltip 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.tooltip",{version:"1.13.2",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var d=g(this).attr("title");return g("<a>").text(d).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,track:!1,close:null,open:null},_addDescribedBy:function(d,b){var S=(d.attr("aria-describedby")||"").split(/\s+/);S.push(b),d.data("ui-tooltip-id",b).attr("aria-describedby",String.prototype.trim.call(S.join(" ")))},_removeDescribedBy:function(d){var b=d.data("ui-tooltip-id"),S=(d.attr("aria-describedby")||"").split(/\s+/),k=g.inArray(b,S);k!==-1&&S.splice(k,1),d.removeData("ui-tooltip-id"),S=String.prototype.trim.call(S.join(" ")),S?d.attr("aria-describedby",S):d.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.liveRegion=g("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this.disabledTitles=g([])},_setOption:function(d,b){var S=this;this._super(d,b),d==="content"&&g.each(this.tooltips,function(k,R){S._updateContent(R.element)})},_setOptionDisabled:function(d){this[d?"_disable":"_enable"]()},_disable:function(){var d=this;g.each(this.tooltips,function(b,S){var k=g.Event("blur");k.target=k.currentTarget=S.element[0],d.close(k,!0)}),this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter(function(){var b=g(this);if(b.is("[title]"))return b.data("ui-tooltip-title",b.attr("title")).removeAttr("title")}))},_enable:function(){this.disabledTitles.each(function(){var d=g(this);d.data("ui-tooltip-title")&&d.attr("title",d.data("ui-tooltip-title"))}),this.disabledTitles=g([])},open:function(d){var b=this,S=g(d?d.target:this.element).closest(this.options.items);!S.length||S.data("ui-tooltip-id")||(S.attr("title")&&S.data("ui-tooltip-title",S.attr("title")),S.data("ui-tooltip-open",!0),d&&d.type==="mouseover"&&S.parents().each(function(){var k=g(this),R;k.data("ui-tooltip-open")&&(R=g.Event("blur"),R.target=R.currentTarget=this,b.close(R,!0)),k.attr("title")&&(k.uniqueId(),b.parents[this.id]={element:this,title:k.attr("title")},k.attr("title",""))}),this._registerCloseHandlers(d,S),this._updateContent(S,d))},_updateContent:function(d,b){var S,k=this.options.content,R=this,W=b?b.type:null;if(typeof k=="string"||k.nodeType||k.jquery)return this._open(b,d,k);S=k.call(d[0],function(se){R._delay(function(){d.data("ui-tooltip-open")&&(b&&(b.type=W),this._open(b,d,se))})}),S&&this._open(b,d,S)},_open:function(d,b,S){var k,R,W,se,le=g.extend({},this.options.position);if(!S)return;if(k=this._find(b),k){k.tooltip.find(".ui-tooltip-content").html(S);return}b.is("[title]")&&(d&&d.type==="mouseover"?b.attr("title",""):b.removeAttr("title")),k=this._tooltip(b),R=k.tooltip,this._addDescribedBy(b,R.attr("id")),R.find(".ui-tooltip-content").html(S),this.liveRegion.children().hide(),se=g("<div>").html(R.find(".ui-tooltip-content").html()),se.removeAttr("name").find("[name]").removeAttr("name"),se.removeAttr("id").find("[id]").removeAttr("id"),se.appendTo(this.liveRegion);function fe(be){le.of=be,!R.is(":hidden")&&R.position(le)}this.options.track&&d&&/^mouse/.test(d.type)?(this._on(this.document,{mousemove:fe}),fe(d)):R.position(g.extend({of:b},this.options.position)),R.hide(),this._show(R,this.options.show),this.options.track&&this.options.show&&this.options.show.delay&&(W=this.delayedShow=setInterval(function(){R.is(":visible")&&(fe(le.of),clearInterval(W))},13)),this._trigger("open",d,{tooltip:R})},_registerCloseHandlers:function(d,b){var S={keyup:function(k){if(k.keyCode===g.ui.keyCode.ESCAPE){var R=g.Event(k);R.currentTarget=b[0],this.close(R,!0)}}};b[0]!==this.element[0]&&(S.remove=function(){var k=this._find(b);k&&this._removeTooltip(k.tooltip)}),(!d||d.type==="mouseover")&&(S.mouseleave="close"),(!d||d.type==="focusin")&&(S.focusout="close"),this._on(!0,b,S)},close:function(d){var b,S=this,k=g(d?d.currentTarget:this.element),R=this._find(k);if(!R){k.removeData("ui-tooltip-open");return}b=R.tooltip,!R.closing&&(clearInterval(this.delayedShow),k.data("ui-tooltip-title")&&!k.attr("title")&&k.attr("title",k.data("ui-tooltip-title")),this._removeDescribedBy(k),R.hiding=!0,b.stop(!0),this._hide(b,this.options.hide,function(){S._removeTooltip(g(this))}),k.removeData("ui-tooltip-open"),this._off(k,"mouseleave focusout keyup"),k[0]!==this.element[0]&&this._off(k,"remove"),this._off(this.document,"mousemove"),d&&d.type==="mouseleave"&&g.each(this.parents,function(W,se){g(se.element).attr("title",se.title),delete S.parents[W]}),R.closing=!0,this._trigger("close",d,{tooltip:b}),R.hiding||(R.closing=!1))},_tooltip:function(d){var b=g("<div>").attr("role","tooltip"),S=g("<div>").appendTo(b),k=b.uniqueId().attr("id");return this._addClass(S,"ui-tooltip-content"),this._addClass(b,"ui-tooltip","ui-widget ui-widget-content"),b.appendTo(this._appendTo(d)),this.tooltips[k]={element:d,tooltip:b}},_find:function(d){var b=d.data("ui-tooltip-id");return b?this.tooltips[b]:null},_removeTooltip:function(d){clearInterval(this.delayedShow),d.remove(),delete this.tooltips[d.attr("id")]},_appendTo:function(d){var b=d.closest(".ui-front, dialog");return b.length||(b=this.document[0].body),b},_destroy:function(){var d=this;g.each(this.tooltips,function(b,S){var k=g.Event("blur"),R=S.element;k.target=k.currentTarget=R[0],d.close(k,!0),g("#"+b).remove(),R.data("ui-tooltip-title")&&(R.attr("title")||R.attr("title",R.data("ui-tooltip-title")),R.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}}),g.uiBackCompat!==!1&&g.widget("ui.tooltip",g.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var d=this._superApply(arguments);return this.options.tooltipClass&&d.tooltip.addClass(this.options.tooltipClass),d}}),g.ui.tooltip});/*! jQuery UI - v1.13.2 - 2022-07-14
* http://jqueryui.com
* Includes: widget.js, position.js, data.js, disable-selection.js, effect.js, effects/effect-blind.js, effects/effect-bounce.js, effects/effect-clip.js, effects/effect-drop.js, effects/effect-explode.js, effects/effect-fade.js, effects/effect-fold.js, effects/effect-highlight.js, effects/effect-puff.js, effects/effect-pulsate.js, effects/effect-scale.js, effects/effect-shake.js, effects/effect-size.js, effects/effect-slide.js, effects/effect-transfer.js, focusable.js, form-reset-mixin.js, jquery-patch.js, keycode.js, labels.js, scroll-parent.js, tabbable.js, unique-id.js, widgets/accordion.js, widgets/autocomplete.js, widgets/button.js, widgets/checkboxradio.js, widgets/controlgroup.js, widgets/datepicker.js, widgets/dialog.js, widgets/draggable.js, widgets/droppable.js, widgets/menu.js, widgets/mouse.js, widgets/progressbar.js, widgets/resizable.js, widgets/selectable.js, widgets/selectmenu.js, widgets/slider.js, widgets/sortable.js, widgets/spinner.js, widgets/tabs.js, widgets/tooltip.js
* Copyright jQuery Foundation and other contributors; Licensed MIT */(function(g){typeof define=="function"&&define.amd?define(["jquery"],g):g($)})(function(g){g.ui=g.ui||{},g.ui.version="1.13.2";/*!
 * jQuery UI Widget 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */var B=0,M=Array.prototype.hasOwnProperty,P=Array.prototype.slice;g.cleanData=function(d){return function(b){var S,k,R;for(R=0;(k=b[R])!=null;R++)S=g._data(k,"events"),S&&S.remove&&g(k).triggerHandler("remove");d(b)}}(g.cleanData),g.widget=function(d,b,S){var k,R,W,se={},le=d.split(".")[0];d=d.split(".")[1];var fe=le+"-"+d;return S||(S=b,b=g.Widget),Array.isArray(S)&&(S=g.extend.apply(null,[{}].concat(S))),g.expr.pseudos[fe.toLowerCase()]=function(be){return!!g.data(be,fe)},g[le]=g[le]||{},k=g[le][d],R=g[le][d]=function(be,Te){if(!this||!this._createWidget)return new R(be,Te);arguments.length&&this._createWidget(be,Te)},g.extend(R,k,{version:S.version,_proto:g.extend({},S),_childConstructors:[]}),W=new b,W.options=g.widget.extend({},W.options),g.each(S,function(be,Te){if(typeof Te!="function"){se[be]=Te;return}se[be]=function(){function Ve(){return b.prototype[be].apply(this,arguments)}function Ue(me){return b.prototype[be].apply(this,me)}return function(){var me=this._super,ke=this._superApply,qe;return this._super=Ve,this._superApply=Ue,qe=Te.apply(this,arguments),this._super=me,this._superApply=ke,qe}}()}),R.prototype=g.widget.extend(W,{widgetEventPrefix:k&&W.widgetEventPrefix||d},se,{constructor:R,namespace:le,widgetName:d,widgetFullName:fe}),k?(g.each(k._childConstructors,function(be,Te){var Ve=Te.prototype;g.widget(Ve.namespace+"."+Ve.widgetName,R,Te._proto)}),delete k._childConstructors):b._childConstructors.push(R),g.widget.bridge(d,R),R},g.widget.extend=function(d){for(var b=P.call(arguments,1),S=0,k=b.length,R,W;S<k;S++)for(R in b[S])W=b[S][R],M.call(b[S],R)&&W!==void 0&&(g.isPlainObject(W)?d[R]=g.isPlainObject(d[R])?g.widget.extend({},d[R],W):g.widget.extend({},W):d[R]=W);return d},g.widget.bridge=function(d,b){var S=b.prototype.widgetFullName||d;g.fn[d]=function(k){var R=typeof k=="string",W=P.call(arguments,1),se=this;return R?!this.length&&k==="instance"?se=void 0:this.each(function(){var le,fe=g.data(this,S);if(k==="instance")return se=fe,!1;if(!fe)return g.error("cannot call methods on "+d+" prior to initialization; attempted to call method '"+k+"'");if(typeof fe[k]!="function"||k.charAt(0)==="_")return g.error("no such method '"+k+"' for "+d+" widget instance");if(le=fe[k].apply(fe,W),le!==fe&&le!==void 0)return se=le&&le.jquery?se.pushStack(le.get()):le,!1}):(W.length&&(k=g.widget.extend.apply(null,[k].concat(W))),this.each(function(){var le=g.data(this,S);le?(le.option(k||{}),le._init&&le._init()):g.data(this,S,new b(k,this))})),se}},g.Widget=function(){},g.Widget._childConstructors=[],g.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(d,b){b=g(b||this.defaultElement||this)[0],this.element=g(b),this.uuid=B++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=g(),this.hoverable=g(),this.focusable=g(),this.classesElementLookup={},b!==this&&(g.data(b,this.widgetFullName,this),this._on(!0,this.element,{remove:function(S){S.target===b&&this.destroy()}}),this.document=g(b.style?b.ownerDocument:b.document||b),this.window=g(this.document[0].defaultView||this.document[0].parentWindow)),this.options=g.widget.extend({},this.options,this._getCreateOptions(),d),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:g.noop,_create:g.noop,_init:g.noop,destroy:function(){var d=this;this._destroy(),g.each(this.classesElementLookup,function(b,S){d._removeClass(S,b)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:g.noop,widget:function(){return this.element},option:function(d,b){var S=d,k,R,W;if(arguments.length===0)return g.widget.extend({},this.options);if(typeof d=="string")if(S={},k=d.split("."),d=k.shift(),k.length){for(R=S[d]=g.widget.extend({},this.options[d]),W=0;W<k.length-1;W++)R[k[W]]=R[k[W]]||{},R=R[k[W]];if(d=k.pop(),arguments.length===1)return R[d]===void 0?null:R[d];R[d]=b}else{if(arguments.length===1)return this.options[d]===void 0?null:this.options[d];S[d]=b}return this._setOptions(S),this},_setOptions:function(d){var b;for(b in d)this._setOption(b,d[b]);return this},_setOption:function(d,b){return d==="classes"&&this._setOptionClasses(b),this.options[d]=b,d==="disabled"&&this._setOptionDisabled(b),this},_setOptionClasses:function(d){var b,S,k;for(b in d)k=this.classesElementLookup[b],!(d[b]===this.options.classes[b]||!k||!k.length)&&(S=g(k.get()),this._removeClass(k,b),S.addClass(this._classes({element:S,keys:b,classes:d,add:!0})))},_setOptionDisabled:function(d){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!d),d&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(d){var b=[],S=this;d=g.extend({element:this.element,classes:this.options.classes||{}},d);function k(){var W=[];d.element.each(function(se,le){var fe=g.map(S.classesElementLookup,function(be){return be}).some(function(be){return be.is(le)});fe||W.push(le)}),S._on(g(W),{remove:"_untrackClassesElement"})}function R(W,se){var le,fe;for(fe=0;fe<W.length;fe++)le=S.classesElementLookup[W[fe]]||g(),d.add?(k(),le=g(g.uniqueSort(le.get().concat(d.element.get())))):le=g(le.not(d.element).get()),S.classesElementLookup[W[fe]]=le,b.push(W[fe]),se&&d.classes[W[fe]]&&b.push(d.classes[W[fe]])}return d.keys&&R(d.keys.match(/\S+/g)||[],!0),d.extra&&R(d.extra.match(/\S+/g)||[]),b.join(" ")},_untrackClassesElement:function(d){var b=this;g.each(b.classesElementLookup,function(S,k){g.inArray(d.target,k)!==-1&&(b.classesElementLookup[S]=g(k.not(d.target).get()))}),this._off(g(d.target))},_removeClass:function(d,b,S){return this._toggleClass(d,b,S,!1)},_addClass:function(d,b,S){return this._toggleClass(d,b,S,!0)},_toggleClass:function(d,b,S,k){k=typeof k=="boolean"?k:S;var R=typeof d=="string"||d===null,W={extra:R?b:S,keys:R?d:b,element:R?this.element:d,add:k};return W.element.toggleClass(this._classes(W),k),this},_on:function(d,b,S){var k,R=this;typeof d!="boolean"&&(S=b,b=d,d=!1),S?(b=k=g(b),this.bindings=this.bindings.add(b)):(S=b,b=this.element,k=this.widget()),g.each(S,function(W,se){function le(){if(!(!d&&(R.options.disabled===!0||g(this).hasClass("ui-state-disabled"))))return(typeof se=="string"?R[se]:se).apply(R,arguments)}typeof se!="string"&&(le.guid=se.guid=se.guid||le.guid||g.guid++);var fe=W.match(/^([\w:-]*)\s*(.*)$/),be=fe[1]+R.eventNamespace,Te=fe[2];Te?k.on(be,Te,le):b.on(be,le)})},_off:function(d,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,d.off(b),this.bindings=g(this.bindings.not(d).get()),this.focusable=g(this.focusable.not(d).get()),this.hoverable=g(this.hoverable.not(d).get())},_delay:function(d,b){function S(){return(typeof d=="string"?k[d]:d).apply(k,arguments)}var k=this;return setTimeout(S,b||0)},_hoverable:function(d){this.hoverable=this.hoverable.add(d),this._on(d,{mouseenter:function(b){this._addClass(g(b.currentTarget),null,"ui-state-hover")},mouseleave:function(b){this._removeClass(g(b.currentTarget),null,"ui-state-hover")}})},_focusable:function(d){this.focusable=this.focusable.add(d),this._on(d,{focusin:function(b){this._addClass(g(b.currentTarget),null,"ui-state-focus")},focusout:function(b){this._removeClass(g(b.currentTarget),null,"ui-state-focus")}})},_trigger:function(d,b,S){var k,R,W=this.options[d];if(S=S||{},b=g.Event(b),b.type=(d===this.widgetEventPrefix?d:this.widgetEventPrefix+d).toLowerCase(),b.target=this.element[0],R=b.originalEvent,R)for(k in R)k in b||(b[k]=R[k]);return this.element.trigger(b,S),!(typeof W=="function"&&W.apply(this.element[0],[b].concat(S))===!1||b.isDefaultPrevented())}},g.each({show:"fadeIn",hide:"fadeOut"},function(d,b){g.Widget.prototype["_"+d]=function(S,k,R){typeof k=="string"&&(k={effect:k});var W,se=k?k===!0||typeof k=="number"?b:k.effect||b:d;k=k||{},typeof k=="number"?k={duration:k}:k===!0&&(k={}),W=!g.isEmptyObject(k),k.complete=R,k.delay&&S.delay(k.delay),W&&g.effects&&g.effects.effect[se]?S[d](k):se!==d&&S[se]?S[se](k.duration,k.easing,R):S.queue(function(le){g(this)[d](),R&&R.call(S[0]),le()})}}),g.widget;/*!
 * jQuery UI Position 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/position/
 */(function(){var d,b=Math.max,S=Math.abs,k=/left|center|right/,R=/top|center|bottom/,W=/[\+\-]\d+(\.[\d]+)?%?/,se=/^\w+/,le=/%$/,fe=g.fn.position;function be(me,ke,qe){return[parseFloat(me[0])*(le.test(me[0])?ke/100:1),parseFloat(me[1])*(le.test(me[1])?qe/100:1)]}function Te(me,ke){return parseInt(g.css(me,ke),10)||0}function Ve(me){return me!=null&&me===me.window}function Ue(me){var ke=me[0];return ke.nodeType===9?{width:me.width(),height:me.height(),offset:{top:0,left:0}}:Ve(ke)?{width:me.width(),height:me.height(),offset:{top:me.scrollTop(),left:me.scrollLeft()}}:ke.preventDefault?{width:0,height:0,offset:{top:ke.pageY,left:ke.pageX}}:{width:me.outerWidth(),height:me.outerHeight(),offset:me.offset()}}g.position={scrollbarWidth:function(){if(d!==void 0)return d;var me,ke,qe=g("<div style='display:block;position:absolute;width:200px;height:200px;overflow:hidden;'><div style='height:300px;width:auto;'></div></div>"),lt=qe.children()[0];return g("body").append(qe),me=lt.offsetWidth,qe.css("overflow","scroll"),ke=lt.offsetWidth,me===ke&&(ke=qe[0].clientWidth),qe.remove(),d=me-ke},getScrollInfo:function(me){var ke=me.isWindow||me.isDocument?"":me.element.css("overflow-x"),qe=me.isWindow||me.isDocument?"":me.element.css("overflow-y"),lt=ke==="scroll"||ke==="auto"&&me.width<me.element[0].scrollWidth,pt=qe==="scroll"||qe==="auto"&&me.height<me.element[0].scrollHeight;return{width:pt?g.position.scrollbarWidth():0,height:lt?g.position.scrollbarWidth():0}},getWithinInfo:function(me){var ke=g(me||window),qe=Ve(ke[0]),lt=!!ke[0]&&ke[0].nodeType===9,pt=!qe&&!lt;return{element:ke,isWindow:qe,isDocument:lt,offset:pt?g(me).offset():{left:0,top:0},scrollLeft:ke.scrollLeft(),scrollTop:ke.scrollTop(),width:ke.outerWidth(),height:ke.outerHeight()}}},g.fn.position=function(me){if(!me||!me.of)return fe.apply(this,arguments);me=g.extend({},me);var ke,qe,lt,pt,Ft,zt,Nt=typeof me.of=="string"?g(document).find(me.of):g(me.of),Mt=g.position.getWithinInfo(me.within),$t=g.position.getScrollInfo(Mt),ri=(me.collision||"flip").split(" "),ci={};return zt=Ue(Nt),Nt[0].preventDefault&&(me.at="left top"),qe=zt.width,lt=zt.height,pt=zt.offset,Ft=g.extend({},pt),g.each(["my","at"],function(){var wt=(me[this]||"").split(" "),di,ii;wt.length===1&&(wt=k.test(wt[0])?wt.concat(["center"]):R.test(wt[0])?["center"].concat(wt):["center","center"]),wt[0]=k.test(wt[0])?wt[0]:"center",wt[1]=R.test(wt[1])?wt[1]:"center",di=W.exec(wt[0]),ii=W.exec(wt[1]),ci[this]=[di?di[0]:0,ii?ii[0]:0],me[this]=[se.exec(wt[0])[0],se.exec(wt[1])[0]]}),ri.length===1&&(ri[1]=ri[0]),me.at[0]==="right"?Ft.left+=qe:me.at[0]==="center"&&(Ft.left+=qe/2),me.at[1]==="bottom"?Ft.top+=lt:me.at[1]==="center"&&(Ft.top+=lt/2),ke=be(ci.at,qe,lt),Ft.left+=ke[0],Ft.top+=ke[1],this.each(function(){var wt,di,ii=g(this),Hi=ii.outerWidth(),Vi=ii.outerHeight(),Ot=Te(this,"marginLeft"),_i=Te(this,"marginTop"),Ti=Hi+Ot+Te(this,"marginRight")+$t.width,Wi=Vi+_i+Te(this,"marginBottom")+$t.height,Zt=g.extend({},Ft),mi=be(ci.my,ii.outerWidth(),ii.outerHeight());me.my[0]==="right"?Zt.left-=Hi:me.my[0]==="center"&&(Zt.left-=Hi/2),me.my[1]==="bottom"?Zt.top-=Vi:me.my[1]==="center"&&(Zt.top-=Vi/2),Zt.left+=mi[0],Zt.top+=mi[1],wt={marginLeft:Ot,marginTop:_i},g.each(["left","top"],function(bi,$i){g.ui.position[ri[bi]]&&g.ui.position[ri[bi]][$i](Zt,{targetWidth:qe,targetHeight:lt,elemWidth:Hi,elemHeight:Vi,collisionPosition:wt,collisionWidth:Ti,collisionHeight:Wi,offset:[ke[0]+mi[0],ke[1]+mi[1]],my:me.my,at:me.at,within:Mt,elem:ii})}),me.using&&(di=function(bi){var $i=pt.left-Zt.left,tr=$i+qe-Hi,Ar=pt.top-Zt.top,Tr=Ar+lt-Vi,ji={target:{element:Nt,left:pt.left,top:pt.top,width:qe,height:lt},element:{element:ii,left:Zt.left,top:Zt.top,width:Hi,height:Vi},horizontal:tr<0?"left":$i>0?"right":"center",vertical:Tr<0?"top":Ar>0?"bottom":"middle"};qe<Hi&&S($i+tr)<qe&&(ji.horizontal="center"),lt<Vi&&S(Ar+Tr)<lt&&(ji.vertical="middle"),b(S($i),S(tr))>b(S(Ar),S(Tr))?ji.important="horizontal":ji.important="vertical",me.using.call(this,bi,ji)}),ii.offset(g.extend(Zt,{using:di}))})},g.ui.position={fit:{left:function(me,ke){var qe=ke.within,lt=qe.isWindow?qe.scrollLeft:qe.offset.left,pt=qe.width,Ft=me.left-ke.collisionPosition.marginLeft,zt=lt-Ft,Nt=Ft+ke.collisionWidth-pt-lt,Mt;ke.collisionWidth>pt?zt>0&&Nt<=0?(Mt=me.left+zt+ke.collisionWidth-pt-lt,me.left+=zt-Mt):Nt>0&&zt<=0?me.left=lt:zt>Nt?me.left=lt+pt-ke.collisionWidth:me.left=lt:zt>0?me.left+=zt:Nt>0?me.left-=Nt:me.left=b(me.left-Ft,me.left)},top:function(me,ke){var qe=ke.within,lt=qe.isWindow?qe.scrollTop:qe.offset.top,pt=ke.within.height,Ft=me.top-ke.collisionPosition.marginTop,zt=lt-Ft,Nt=Ft+ke.collisionHeight-pt-lt,Mt;ke.collisionHeight>pt?zt>0&&Nt<=0?(Mt=me.top+zt+ke.collisionHeight-pt-lt,me.top+=zt-Mt):Nt>0&&zt<=0?me.top=lt:zt>Nt?me.top=lt+pt-ke.collisionHeight:me.top=lt:zt>0?me.top+=zt:Nt>0?me.top-=Nt:me.top=b(me.top-Ft,me.top)}},flip:{left:function(me,ke){var qe=ke.within,lt=qe.offset.left+qe.scrollLeft,pt=qe.width,Ft=qe.isWindow?qe.scrollLeft:qe.offset.left,zt=me.left-ke.collisionPosition.marginLeft,Nt=zt-Ft,Mt=zt+ke.collisionWidth-pt-Ft,$t=ke.my[0]==="left"?-ke.elemWidth:ke.my[0]==="right"?ke.elemWidth:0,ri=ke.at[0]==="left"?ke.targetWidth:ke.at[0]==="right"?-ke.targetWidth:0,ci=-2*ke.offset[0],wt,di;Nt<0?(wt=me.left+$t+ri+ci+ke.collisionWidth-pt-lt,(wt<0||wt<S(Nt))&&(me.left+=$t+ri+ci)):Mt>0&&(di=me.left-ke.collisionPosition.marginLeft+$t+ri+ci-Ft,(di>0||S(di)<Mt)&&(me.left+=$t+ri+ci))},top:function(me,ke){var qe=ke.within,lt=qe.offset.top+qe.scrollTop,pt=qe.height,Ft=qe.isWindow?qe.scrollTop:qe.offset.top,zt=me.top-ke.collisionPosition.marginTop,Nt=zt-Ft,Mt=zt+ke.collisionHeight-pt-Ft,$t=ke.my[1]==="top",ri=$t?-ke.elemHeight:ke.my[1]==="bottom"?ke.elemHeight:0,ci=ke.at[1]==="top"?ke.targetHeight:ke.at[1]==="bottom"?-ke.targetHeight:0,wt=-2*ke.offset[1],di,ii;Nt<0?(ii=me.top+ri+ci+wt+ke.collisionHeight-pt-lt,(ii<0||ii<S(Nt))&&(me.top+=ri+ci+wt)):Mt>0&&(di=me.top-ke.collisionPosition.marginTop+ri+ci+wt-Ft,(di>0||S(di)<Mt)&&(me.top+=ri+ci+wt))}},flipfit:{left:function(){g.ui.position.flip.left.apply(this,arguments),g.ui.position.fit.left.apply(this,arguments)},top:function(){g.ui.position.flip.top.apply(this,arguments),g.ui.position.fit.top.apply(this,arguments)}}}})(),g.ui.position;/*!
 * jQuery UI :data 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.extend(g.expr.pseudos,{data:g.expr.createPseudo?g.expr.createPseudo(function(d){return function(b){return!!g.data(b,d)}}):function(d,b,S){return!!g.data(d,S[3])}});/*!
 * jQuery UI Disable Selection 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.fn.extend({disableSelection:function(){var d="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(d+".ui-disableSelection",function(b){b.preventDefault()})}}(),enableSelection:function(){return this.off(".ui-disableSelection")}});var K=g;/*!
 * jQuery Color Animations v2.2.0
 * https://github.com/jquery/jquery-color
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: Sun May 10 09:02:36 2020 +0200
 */var Y="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",re={},D=re.toString,ne=/^([\-+])=\s*(\d+\.?\d*)/,ae=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(d){return[d[1],d[2],d[3],d[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(d){return[d[1]*2.55,d[2]*2.55,d[3]*2.55,d[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})?/,parse:function(d){return[parseInt(d[1],16),parseInt(d[2],16),parseInt(d[3],16),d[4]?(parseInt(d[4],16)/255).toFixed(2):1]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])?/,parse:function(d){return[parseInt(d[1]+d[1],16),parseInt(d[2]+d[2],16),parseInt(d[3]+d[3],16),d[4]?(parseInt(d[4]+d[4],16)/255).toFixed(2):1]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(d){return[d[1],d[2]/100,d[3]/100,d[4]]}}],ue=K.Color=function(d,b,S,k){return new K.Color.fn.parse(d,b,S,k)},ge={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},Be={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},De=ue.support={},ze=K("<p>")[0],Oe,Je=K.each;ze.style.cssText="background-color:rgba(1,1,1,.5)",De.rgba=ze.style.backgroundColor.indexOf("rgba")>-1,Je(ge,function(d,b){b.cache="_"+d,b.props.alpha={idx:3,type:"percent",def:1}}),K.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(d,b){re["[object "+b+"]"]=b.toLowerCase()});function We(d){return d==null?d+"":typeof d=="object"?re[D.call(d)]||"object":typeof d}function ut(d,b,S){var k=Be[b.type]||{};return d==null?S||!b.def?null:b.def:(d=k.floor?~~d:parseFloat(d),isNaN(d)?b.def:k.mod?(d+k.mod)%k.mod:Math.min(k.max,Math.max(0,d)))}function et(d){var b=ue(),S=b._rgba=[];return d=d.toLowerCase(),Je(ae,function(k,R){var W,se=R.re.exec(d),le=se&&R.parse(se),fe=R.space||"rgba";if(le)return W=b[fe](le),b[ge[fe].cache]=W[ge[fe].cache],S=b._rgba=W._rgba,!1}),S.length?(S.join()==="0,0,0,0"&&K.extend(S,Oe.transparent),b):Oe[d]}ue.fn=K.extend(ue.prototype,{parse:function(d,b,S,k){if(d===void 0)return this._rgba=[null,null,null,null],this;(d.jquery||d.nodeType)&&(d=K(d).css(b),b=void 0);var R=this,W=We(d),se=this._rgba=[];if(b!==void 0&&(d=[d,b,S,k],W="array"),W==="string")return this.parse(et(d)||Oe._default);if(W==="array")return Je(ge.rgba.props,function(le,fe){se[fe.idx]=ut(d[fe.idx],fe)}),this;if(W==="object")return d instanceof ue?Je(ge,function(le,fe){d[fe.cache]&&(R[fe.cache]=d[fe.cache].slice())}):Je(ge,function(le,fe){var be=fe.cache;Je(fe.props,function(Te,Ve){if(!R[be]&&fe.to){if(Te==="alpha"||d[Te]==null)return;R[be]=fe.to(R._rgba)}R[be][Ve.idx]=ut(d[Te],Ve,!0)}),R[be]&&K.inArray(null,R[be].slice(0,3))<0&&(R[be][3]==null&&(R[be][3]=1),fe.from&&(R._rgba=fe.from(R[be])))}),this},is:function(d){var b=ue(d),S=!0,k=this;return Je(ge,function(R,W){var se,le=b[W.cache];return le&&(se=k[W.cache]||W.to&&W.to(k._rgba)||[],Je(W.props,function(fe,be){if(le[be.idx]!=null)return S=le[be.idx]===se[be.idx],S})),S}),S},_space:function(){var d=[],b=this;return Je(ge,function(S,k){b[k.cache]&&d.push(S)}),d.pop()},transition:function(d,b){var S=ue(d),k=S._space(),R=ge[k],W=this.alpha()===0?ue("transparent"):this,se=W[R.cache]||R.to(W._rgba),le=se.slice();return S=S[R.cache],Je(R.props,function(fe,be){var Te=be.idx,Ve=se[Te],Ue=S[Te],me=Be[be.type]||{};Ue!==null&&(Ve===null?le[Te]=Ue:(me.mod&&(Ue-Ve>me.mod/2?Ve+=me.mod:Ve-Ue>me.mod/2&&(Ve-=me.mod)),le[Te]=ut((Ue-Ve)*b+Ve,be)))}),this[k](le)},blend:function(d){if(this._rgba[3]===1)return this;var b=this._rgba.slice(),S=b.pop(),k=ue(d)._rgba;return ue(K.map(b,function(R,W){return(1-S)*k[W]+S*R}))},toRgbaString:function(){var d="rgba(",b=K.map(this._rgba,function(S,k){return S??(k>2?1:0)});return b[3]===1&&(b.pop(),d="rgb("),d+b.join()+")"},toHslaString:function(){var d="hsla(",b=K.map(this.hsla(),function(S,k){return S==null&&(S=k>2?1:0),k&&k<3&&(S=Math.round(S*100)+"%"),S});return b[3]===1&&(b.pop(),d="hsl("),d+b.join()+")"},toHexString:function(d){var b=this._rgba.slice(),S=b.pop();return d&&b.push(~~(S*255)),"#"+K.map(b,function(k){return k=(k||0).toString(16),k.length===1?"0"+k:k}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}}),ue.fn.parse.prototype=ue.fn;function At(d,b,S){return S=(S+1)%1,S*6<1?d+(b-d)*S*6:S*2<1?b:S*3<2?d+(b-d)*(2/3-S)*6:d}ge.hsla.to=function(d){if(d[0]==null||d[1]==null||d[2]==null)return[null,null,null,d[3]];var b=d[0]/255,S=d[1]/255,k=d[2]/255,R=d[3],W=Math.max(b,S,k),se=Math.min(b,S,k),le=W-se,fe=W+se,be=fe*.5,Te,Ve;return se===W?Te=0:b===W?Te=60*(S-k)/le+360:S===W?Te=60*(k-b)/le+120:Te=60*(b-S)/le+240,le===0?Ve=0:be<=.5?Ve=le/fe:Ve=le/(2-fe),[Math.round(Te)%360,Ve,be,R??1]},ge.hsla.from=function(d){if(d[0]==null||d[1]==null||d[2]==null)return[null,null,null,d[3]];var b=d[0]/360,S=d[1],k=d[2],R=d[3],W=k<=.5?k*(1+S):k+S-k*S,se=2*k-W;return[Math.round(At(se,W,b+1/3)*255),Math.round(At(se,W,b)*255),Math.round(At(se,W,b-1/3)*255),R]},Je(ge,function(d,b){var S=b.props,k=b.cache,R=b.to,W=b.from;ue.fn[d]=function(se){if(R&&!this[k]&&(this[k]=R(this._rgba)),se===void 0)return this[k].slice();var le,fe=We(se),be=fe==="array"||fe==="object"?se:arguments,Te=this[k].slice();return Je(S,function(Ve,Ue){var me=be[fe==="object"?Ve:Ue.idx];me==null&&(me=Te[Ue.idx]),Te[Ue.idx]=ut(me,Ue)}),W?(le=ue(W(Te)),le[k]=Te,le):ue(Te)},Je(S,function(se,le){ue.fn[se]||(ue.fn[se]=function(fe){var be,Te,Ve,Ue,me=We(fe);return se==="alpha"?Ue=this._hsla?"hsla":"rgba":Ue=d,be=this[Ue](),Te=be[le.idx],me==="undefined"?Te:(me==="function"&&(fe=fe.call(this,Te),me=We(fe)),fe==null&&le.empty?this:(me==="string"&&(Ve=ne.exec(fe),Ve&&(fe=Te+parseFloat(Ve[2])*(Ve[1]==="+"?1:-1))),be[le.idx]=fe,this[Ue](be)))})})}),ue.hook=function(d){var b=d.split(" ");Je(b,function(S,k){K.cssHooks[k]={set:function(R,W){var se,le,fe="";if(W!=="transparent"&&(We(W)!=="string"||(se=et(W)))){if(W=ue(se||W),!De.rgba&&W._rgba[3]!==1){for(le=k==="backgroundColor"?R.parentNode:R;(fe===""||fe==="transparent")&&le&&le.style;)try{fe=K.css(le,"backgroundColor"),le=le.parentNode}catch{}W=W.blend(fe&&fe!=="transparent"?fe:"_default")}W=W.toRgbaString()}try{R.style[k]=W}catch{}}},K.fx.step[k]=function(R){R.colorInit||(R.start=ue(R.elem,k),R.end=ue(R.end),R.colorInit=!0),K.cssHooks[k].set(R.elem,R.start.transition(R.end,R.pos))}})},ue.hook(Y),K.cssHooks.borderColor={expand:function(d){var b={};return Je(["Top","Right","Bottom","Left"],function(S,k){b["border"+k+"Color"]=d}),b}},Oe=K.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"};/*!
 * jQuery UI Effects 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */var nt="ui-effects-",ft="ui-effects-style",Tt="ui-effects-animated";g.effects={effect:{}},function(){var d=["add","remove","toggle"],b={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};g.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(W,se){g.fx.step[se]=function(le){(le.end!=="none"&&!le.setAttr||le.pos===1&&!le.setAttr)&&(K.style(le.elem,se,le.end),le.setAttr=!0)}});function S(W){return W.replace(/-([\da-z])/gi,function(se,le){return le.toUpperCase()})}function k(W){var se,le,fe=W.ownerDocument.defaultView?W.ownerDocument.defaultView.getComputedStyle(W,null):W.currentStyle,be={};if(fe&&fe.length&&fe[0]&&fe[fe[0]])for(le=fe.length;le--;)se=fe[le],typeof fe[se]=="string"&&(be[S(se)]=fe[se]);else for(se in fe)typeof fe[se]=="string"&&(be[se]=fe[se]);return be}function R(W,se){var le={},fe,be;for(fe in se)be=se[fe],W[fe]!==be&&(b[fe]||(g.fx.step[fe]||!isNaN(parseFloat(be)))&&(le[fe]=be));return le}g.fn.addBack||(g.fn.addBack=function(W){return this.add(W==null?this.prevObject:this.prevObject.filter(W))}),g.effects.animateClass=function(W,se,le,fe){var be=g.speed(se,le,fe);return this.queue(function(){var Te=g(this),Ve=Te.attr("class")||"",Ue,me=be.children?Te.find("*").addBack():Te;me=me.map(function(){var ke=g(this);return{el:ke,start:k(this)}}),Ue=function(){g.each(d,function(ke,qe){W[qe]&&Te[qe+"Class"](W[qe])})},Ue(),me=me.map(function(){return this.end=k(this.el[0]),this.diff=R(this.start,this.end),this}),Te.attr("class",Ve),me=me.map(function(){var ke=this,qe=g.Deferred(),lt=g.extend({},be,{queue:!1,complete:function(){qe.resolve(ke)}});return this.el.animate(this.diff,lt),qe.promise()}),g.when.apply(g,me.get()).done(function(){Ue(),g.each(arguments,function(){var ke=this.el;g.each(this.diff,function(qe){ke.css(qe,"")})}),be.complete.call(Te[0])})})},g.fn.extend({addClass:function(W){return function(se,le,fe,be){return le?g.effects.animateClass.call(this,{add:se},le,fe,be):W.apply(this,arguments)}}(g.fn.addClass),removeClass:function(W){return function(se,le,fe,be){return arguments.length>1?g.effects.animateClass.call(this,{remove:se},le,fe,be):W.apply(this,arguments)}}(g.fn.removeClass),toggleClass:function(W){return function(se,le,fe,be,Te){return typeof le=="boolean"||le===void 0?fe?g.effects.animateClass.call(this,le?{add:se}:{remove:se},fe,be,Te):W.apply(this,arguments):g.effects.animateClass.call(this,{toggle:se},le,fe,be)}}(g.fn.toggleClass),switchClass:function(W,se,le,fe,be){return g.effects.animateClass.call(this,{add:se,remove:W},le,fe,be)}})}(),function(){g.expr&&g.expr.pseudos&&g.expr.pseudos.animated&&(g.expr.pseudos.animated=function(k){return function(R){return!!g(R).data(Tt)||k(R)}}(g.expr.pseudos.animated)),g.uiBackCompat!==!1&&g.extend(g.effects,{save:function(k,R){for(var W=0,se=R.length;W<se;W++)R[W]!==null&&k.data(nt+R[W],k[0].style[R[W]])},restore:function(k,R){for(var W,se=0,le=R.length;se<le;se++)R[se]!==null&&(W=k.data(nt+R[se]),k.css(R[se],W))},setMode:function(k,R){return R==="toggle"&&(R=k.is(":hidden")?"show":"hide"),R},createWrapper:function(k){if(k.parent().is(".ui-effects-wrapper"))return k.parent();var R={width:k.outerWidth(!0),height:k.outerHeight(!0),float:k.css("float")},W=g("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),se={width:k.width(),height:k.height()},le=document.activeElement;try{le.id}catch{le=document.body}return k.wrap(W),(k[0]===le||g.contains(k[0],le))&&g(le).trigger("focus"),W=k.parent(),k.css("position")==="static"?(W.css({position:"relative"}),k.css({position:"relative"})):(g.extend(R,{position:k.css("position"),zIndex:k.css("z-index")}),g.each(["top","left","bottom","right"],function(fe,be){R[be]=k.css(be),isNaN(parseInt(R[be],10))&&(R[be]="auto")}),k.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),k.css(se),W.css(R).show()},removeWrapper:function(k){var R=document.activeElement;return k.parent().is(".ui-effects-wrapper")&&(k.parent().replaceWith(k),(k[0]===R||g.contains(k[0],R))&&g(R).trigger("focus")),k}}),g.extend(g.effects,{version:"1.13.2",define:function(k,R,W){return W||(W=R,R="effect"),g.effects.effect[k]=W,g.effects.effect[k].mode=R,W},scaledDimensions:function(k,R,W){if(R===0)return{height:0,width:0,outerHeight:0,outerWidth:0};var se=W!=="horizontal"?(R||100)/100:1,le=W!=="vertical"?(R||100)/100:1;return{height:k.height()*le,width:k.width()*se,outerHeight:k.outerHeight()*le,outerWidth:k.outerWidth()*se}},clipToBox:function(k){return{width:k.clip.right-k.clip.left,height:k.clip.bottom-k.clip.top,left:k.clip.left,top:k.clip.top}},unshift:function(k,R,W){var se=k.queue();R>1&&se.splice.apply(se,[1,0].concat(se.splice(R,W))),k.dequeue()},saveStyle:function(k){k.data(ft,k[0].style.cssText)},restoreStyle:function(k){k[0].style.cssText=k.data(ft)||"",k.removeData(ft)},mode:function(k,R){var W=k.is(":hidden");return R==="toggle"&&(R=W?"show":"hide"),(W?R==="hide":R==="show")&&(R="none"),R},getBaseline:function(k,R){var W,se;switch(k[0]){case"top":W=0;break;case"middle":W=.5;break;case"bottom":W=1;break;default:W=k[0]/R.height}switch(k[1]){case"left":se=0;break;case"center":se=.5;break;case"right":se=1;break;default:se=k[1]/R.width}return{x:se,y:W}},createPlaceholder:function(k){var R,W=k.css("position"),se=k.position();return k.css({marginTop:k.css("marginTop"),marginBottom:k.css("marginBottom"),marginLeft:k.css("marginLeft"),marginRight:k.css("marginRight")}).outerWidth(k.outerWidth()).outerHeight(k.outerHeight()),/^(static|relative)/.test(W)&&(W="absolute",R=g("<"+k[0].nodeName+">").insertAfter(k).css({display:/^(inline|ruby)/.test(k.css("display"))?"inline-block":"block",visibility:"hidden",marginTop:k.css("marginTop"),marginBottom:k.css("marginBottom"),marginLeft:k.css("marginLeft"),marginRight:k.css("marginRight"),float:k.css("float")}).outerWidth(k.outerWidth()).outerHeight(k.outerHeight()).addClass("ui-effects-placeholder"),k.data(nt+"placeholder",R)),k.css({position:W,left:se.left,top:se.top}),R},removePlaceholder:function(k){var R=nt+"placeholder",W=k.data(R);W&&(W.remove(),k.removeData(R))},cleanUp:function(k){g.effects.restoreStyle(k),g.effects.removePlaceholder(k)},setTransition:function(k,R,W,se){return se=se||{},g.each(R,function(le,fe){var be=k.cssUnit(fe);be[0]>0&&(se[fe]=be[0]*W+be[1])}),se}});function d(k,R,W,se){return g.isPlainObject(k)&&(R=k,k=k.effect),k={effect:k},R==null&&(R={}),typeof R=="function"&&(se=R,W=null,R={}),(typeof R=="number"||g.fx.speeds[R])&&(se=W,W=R,R={}),typeof W=="function"&&(se=W,W=null),R&&g.extend(k,R),W=W||R.duration,k.duration=g.fx.off?0:typeof W=="number"?W:W in g.fx.speeds?g.fx.speeds[W]:g.fx.speeds._default,k.complete=se||R.complete,k}function b(k){return!!(!k||typeof k=="number"||g.fx.speeds[k]||typeof k=="string"&&!g.effects.effect[k]||typeof k=="function"||typeof k=="object"&&!k.effect)}g.fn.extend({effect:function(){var k=d.apply(this,arguments),R=g.effects.effect[k.effect],W=R.mode,se=k.queue,le=se||"fx",fe=k.complete,be=k.mode,Te=[],Ve=function(me){var ke=g(this),qe=g.effects.mode(ke,be)||W;ke.data(Tt,!0),Te.push(qe),W&&(qe==="show"||qe===W&&qe==="hide")&&ke.show(),(!W||qe!=="none")&&g.effects.saveStyle(ke),typeof me=="function"&&me()};if(g.fx.off||!R)return be?this[be](k.duration,fe):this.each(function(){fe&&fe.call(this)});function Ue(me){var ke=g(this);function qe(){ke.removeData(Tt),g.effects.cleanUp(ke),k.mode==="hide"&&ke.hide(),lt()}function lt(){typeof fe=="function"&&fe.call(ke[0]),typeof me=="function"&&me()}k.mode=Te.shift(),g.uiBackCompat!==!1&&!W?(ke.is(":hidden")?be==="hide":be==="show")?(ke[be](),lt()):R.call(ke[0],k,lt):k.mode==="none"?(ke[be](),lt()):R.call(ke[0],k,qe)}return se===!1?this.each(Ve).each(Ue):this.queue(le,Ve).queue(le,Ue)},show:function(k){return function(R){if(b(R))return k.apply(this,arguments);var W=d.apply(this,arguments);return W.mode="show",this.effect.call(this,W)}}(g.fn.show),hide:function(k){return function(R){if(b(R))return k.apply(this,arguments);var W=d.apply(this,arguments);return W.mode="hide",this.effect.call(this,W)}}(g.fn.hide),toggle:function(k){return function(R){if(b(R)||typeof R=="boolean")return k.apply(this,arguments);var W=d.apply(this,arguments);return W.mode="toggle",this.effect.call(this,W)}}(g.fn.toggle),cssUnit:function(k){var R=this.css(k),W=[];return g.each(["em","px","%","pt"],function(se,le){R.indexOf(le)>0&&(W=[parseFloat(R),le])}),W},cssClip:function(k){return k?this.css("clip","rect("+k.top+"px "+k.right+"px "+k.bottom+"px "+k.left+"px)"):S(this.css("clip"),this)},transfer:function(k,R){var W=g(this),se=g(k.to),le=se.css("position")==="fixed",fe=g("body"),be=le?fe.scrollTop():0,Te=le?fe.scrollLeft():0,Ve=se.offset(),Ue={top:Ve.top-be,left:Ve.left-Te,height:se.innerHeight(),width:se.innerWidth()},me=W.offset(),ke=g("<div class='ui-effects-transfer'></div>");ke.appendTo("body").addClass(k.className).css({top:me.top-be,left:me.left-Te,height:W.innerHeight(),width:W.innerWidth(),position:le?"fixed":"absolute"}).animate(Ue,k.duration,k.easing,function(){ke.remove(),typeof R=="function"&&R()})}});function S(k,R){var W=R.outerWidth(),se=R.outerHeight(),le=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/,fe=le.exec(k)||["",0,W,se,0];return{top:parseFloat(fe[1])||0,right:fe[2]==="auto"?W:parseFloat(fe[2]),bottom:fe[3]==="auto"?se:parseFloat(fe[3]),left:parseFloat(fe[4])||0}}g.fx.step.clip=function(k){k.clipInit||(k.start=g(k.elem).cssClip(),typeof k.end=="string"&&(k.end=S(k.end,k.elem)),k.clipInit=!0),g(k.elem).cssClip({top:k.pos*(k.end.top-k.start.top)+k.start.top,right:k.pos*(k.end.right-k.start.right)+k.start.right,bottom:k.pos*(k.end.bottom-k.start.bottom)+k.start.bottom,left:k.pos*(k.end.left-k.start.left)+k.start.left})}}(),function(){var d={};g.each(["Quad","Cubic","Quart","Quint","Expo"],function(b,S){d[S]=function(k){return Math.pow(k,b+2)}}),g.extend(d,{Sine:function(b){return 1-Math.cos(b*Math.PI/2)},Circ:function(b){return 1-Math.sqrt(1-b*b)},Elastic:function(b){return b===0||b===1?b:-Math.pow(2,8*(b-1))*Math.sin(((b-1)*80-7.5)*Math.PI/15)},Back:function(b){return b*b*(3*b-2)},Bounce:function(b){for(var S,k=4;b<((S=Math.pow(2,--k))-1)/11;);return 1/Math.pow(4,3-k)-7.5625*Math.pow((S*3-2)/22-b,2)}}),g.each(d,function(b,S){g.easing["easeIn"+b]=S,g.easing["easeOut"+b]=function(k){return 1-S(1-k)},g.easing["easeInOut"+b]=function(k){return k<.5?S(k*2)/2:1-S(k*-2+2)/2}})}(),g.effects;/*!
 * jQuery UI Effects Blind 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("blind","hide",function(d,b){var S={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},k=g(this),R=d.direction||"up",W=k.cssClip(),se={clip:g.extend({},W)},le=g.effects.createPlaceholder(k);se.clip[S[R][0]]=se.clip[S[R][1]],d.mode==="show"&&(k.cssClip(se.clip),le&&le.css(g.effects.clipToBox(se)),se.clip=W),le&&le.animate(g.effects.clipToBox(se),d.duration,d.easing),k.animate(se,{queue:!1,duration:d.duration,easing:d.easing,complete:b})});/*!
 * jQuery UI Effects Bounce 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("bounce",function(d,b){var S,k,R,W=g(this),se=d.mode,le=se==="hide",fe=se==="show",be=d.direction||"up",Te=d.distance,Ve=d.times||5,Ue=Ve*2+(fe||le?1:0),me=d.duration/Ue,ke=d.easing,qe=be==="up"||be==="down"?"top":"left",lt=be==="up"||be==="left",pt=0,Ft=W.queue().length;for(g.effects.createPlaceholder(W),R=W.css(qe),Te||(Te=W[qe==="top"?"outerHeight":"outerWidth"]()/3),fe&&(k={opacity:1},k[qe]=R,W.css("opacity",0).css(qe,lt?-Te*2:Te*2).animate(k,me,ke)),le&&(Te=Te/Math.pow(2,Ve-1)),k={},k[qe]=R;pt<Ve;pt++)S={},S[qe]=(lt?"-=":"+=")+Te,W.animate(S,me,ke).animate(k,me,ke),Te=le?Te*2:Te/2;le&&(S={opacity:0},S[qe]=(lt?"-=":"+=")+Te,W.animate(S,me,ke)),W.queue(b),g.effects.unshift(W,Ft,Ue+1)});/*!
 * jQuery UI Effects Clip 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("clip","hide",function(d,b){var S,k={},R=g(this),W=d.direction||"vertical",se=W==="both",le=se||W==="horizontal",fe=se||W==="vertical";S=R.cssClip(),k.clip={top:fe?(S.bottom-S.top)/2:S.top,right:le?(S.right-S.left)/2:S.right,bottom:fe?(S.bottom-S.top)/2:S.bottom,left:le?(S.right-S.left)/2:S.left},g.effects.createPlaceholder(R),d.mode==="show"&&(R.cssClip(k.clip),k.clip=S),R.animate(k,{queue:!1,duration:d.duration,easing:d.easing,complete:b})});/*!
 * jQuery UI Effects Drop 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("drop","hide",function(d,b){var S,k=g(this),R=d.mode,W=R==="show",se=d.direction||"left",le=se==="up"||se==="down"?"top":"left",fe=se==="up"||se==="left"?"-=":"+=",be=fe==="+="?"-=":"+=",Te={opacity:0};g.effects.createPlaceholder(k),S=d.distance||k[le==="top"?"outerHeight":"outerWidth"](!0)/2,Te[le]=fe+S,W&&(k.css(Te),Te[le]=be+S,Te.opacity=1),k.animate(Te,{queue:!1,duration:d.duration,easing:d.easing,complete:b})});/*!
 * jQuery UI Effects Explode 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("explode","hide",function(d,b){var S,k,R,W,se,le,fe=d.pieces?Math.round(Math.sqrt(d.pieces)):3,be=fe,Te=g(this),Ve=d.mode,Ue=Ve==="show",me=Te.show().css("visibility","hidden").offset(),ke=Math.ceil(Te.outerWidth()/be),qe=Math.ceil(Te.outerHeight()/fe),lt=[];function pt(){lt.push(this),lt.length===fe*be&&Ft()}for(S=0;S<fe;S++)for(W=me.top+S*qe,le=S-(fe-1)/2,k=0;k<be;k++)R=me.left+k*ke,se=k-(be-1)/2,Te.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-k*ke,top:-S*qe}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:ke,height:qe,left:R+(Ue?se*ke:0),top:W+(Ue?le*qe:0),opacity:Ue?0:1}).animate({left:R+(Ue?0:se*ke),top:W+(Ue?0:le*qe),opacity:Ue?1:0},d.duration||500,d.easing,pt);function Ft(){Te.css({visibility:"visible"}),g(lt).remove(),b()}});/*!
 * jQuery UI Effects Fade 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("fade","toggle",function(d,b){var S=d.mode==="show";g(this).css("opacity",S?0:1).animate({opacity:S?1:0},{queue:!1,duration:d.duration,easing:d.easing,complete:b})});/*!
 * jQuery UI Effects Fold 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("fold","hide",function(d,b){var S=g(this),k=d.mode,R=k==="show",W=k==="hide",se=d.size||15,le=/([0-9]+)%/.exec(se),fe=!!d.horizFirst,be=fe?["right","bottom"]:["bottom","right"],Te=d.duration/2,Ve=g.effects.createPlaceholder(S),Ue=S.cssClip(),me={clip:g.extend({},Ue)},ke={clip:g.extend({},Ue)},qe=[Ue[be[0]],Ue[be[1]]],lt=S.queue().length;le&&(se=parseInt(le[1],10)/100*qe[W?0:1]),me.clip[be[0]]=se,ke.clip[be[0]]=se,ke.clip[be[1]]=0,R&&(S.cssClip(ke.clip),Ve&&Ve.css(g.effects.clipToBox(ke)),ke.clip=Ue),S.queue(function(pt){Ve&&Ve.animate(g.effects.clipToBox(me),Te,d.easing).animate(g.effects.clipToBox(ke),Te,d.easing),pt()}).animate(me,Te,d.easing).animate(ke,Te,d.easing).queue(b),g.effects.unshift(S,lt,4)});/*!
 * jQuery UI Effects Highlight 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("highlight","show",function(d,b){var S=g(this),k={backgroundColor:S.css("backgroundColor")};d.mode==="hide"&&(k.opacity=0),g.effects.saveStyle(S),S.css({backgroundImage:"none",backgroundColor:d.color||"#ffff99"}).animate(k,{queue:!1,duration:d.duration,easing:d.easing,complete:b})});/*!
 * jQuery UI Effects Size 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("size",function(d,b){var S,k,R,W=g(this),se=["fontSize"],le=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],fe=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],be=d.mode,Te=be!=="effect",Ve=d.scale||"both",Ue=d.origin||["middle","center"],me=W.css("position"),ke=W.position(),qe=g.effects.scaledDimensions(W),lt=d.from||qe,pt=d.to||g.effects.scaledDimensions(W,0);g.effects.createPlaceholder(W),be==="show"&&(R=lt,lt=pt,pt=R),k={from:{y:lt.height/qe.height,x:lt.width/qe.width},to:{y:pt.height/qe.height,x:pt.width/qe.width}},(Ve==="box"||Ve==="both")&&(k.from.y!==k.to.y&&(lt=g.effects.setTransition(W,le,k.from.y,lt),pt=g.effects.setTransition(W,le,k.to.y,pt)),k.from.x!==k.to.x&&(lt=g.effects.setTransition(W,fe,k.from.x,lt),pt=g.effects.setTransition(W,fe,k.to.x,pt))),(Ve==="content"||Ve==="both")&&k.from.y!==k.to.y&&(lt=g.effects.setTransition(W,se,k.from.y,lt),pt=g.effects.setTransition(W,se,k.to.y,pt)),Ue&&(S=g.effects.getBaseline(Ue,qe),lt.top=(qe.outerHeight-lt.outerHeight)*S.y+ke.top,lt.left=(qe.outerWidth-lt.outerWidth)*S.x+ke.left,pt.top=(qe.outerHeight-pt.outerHeight)*S.y+ke.top,pt.left=(qe.outerWidth-pt.outerWidth)*S.x+ke.left),delete lt.outerHeight,delete lt.outerWidth,W.css(lt),(Ve==="content"||Ve==="both")&&(le=le.concat(["marginTop","marginBottom"]).concat(se),fe=fe.concat(["marginLeft","marginRight"]),W.find("*[width]").each(function(){var Ft=g(this),zt=g.effects.scaledDimensions(Ft),Nt={height:zt.height*k.from.y,width:zt.width*k.from.x,outerHeight:zt.outerHeight*k.from.y,outerWidth:zt.outerWidth*k.from.x},Mt={height:zt.height*k.to.y,width:zt.width*k.to.x,outerHeight:zt.height*k.to.y,outerWidth:zt.width*k.to.x};k.from.y!==k.to.y&&(Nt=g.effects.setTransition(Ft,le,k.from.y,Nt),Mt=g.effects.setTransition(Ft,le,k.to.y,Mt)),k.from.x!==k.to.x&&(Nt=g.effects.setTransition(Ft,fe,k.from.x,Nt),Mt=g.effects.setTransition(Ft,fe,k.to.x,Mt)),Te&&g.effects.saveStyle(Ft),Ft.css(Nt),Ft.animate(Mt,d.duration,d.easing,function(){Te&&g.effects.restoreStyle(Ft)})})),W.animate(pt,{queue:!1,duration:d.duration,easing:d.easing,complete:function(){var Ft=W.offset();pt.opacity===0&&W.css("opacity",lt.opacity),Te||(W.css("position",me==="static"?"relative":me).offset(Ft),g.effects.saveStyle(W)),b()}})});/*!
 * jQuery UI Effects Scale 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("scale",function(d,b){var S=g(this),k=d.mode,R=parseInt(d.percent,10)||(parseInt(d.percent,10)===0||k!=="effect"?0:100),W=g.extend(!0,{from:g.effects.scaledDimensions(S),to:g.effects.scaledDimensions(S,R,d.direction||"both"),origin:d.origin||["middle","center"]},d);d.fade&&(W.from.opacity=1,W.to.opacity=0),g.effects.effect.size.call(this,W,b)});/*!
 * jQuery UI Effects Puff 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("puff","hide",function(d,b){var S=g.extend(!0,{},d,{fade:!0,percent:parseInt(d.percent,10)||150});g.effects.effect.scale.call(this,S,b)});/*!
 * jQuery UI Effects Pulsate 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("pulsate","show",function(d,b){var S=g(this),k=d.mode,R=k==="show",W=k==="hide",se=R||W,le=(d.times||5)*2+(se?1:0),fe=d.duration/le,be=0,Te=1,Ve=S.queue().length;for((R||!S.is(":visible"))&&(S.css("opacity",0).show(),be=1);Te<le;Te++)S.animate({opacity:be},fe,d.easing),be=1-be;S.animate({opacity:be},fe,d.easing),S.queue(b),g.effects.unshift(S,Ve,le+1)});/*!
 * jQuery UI Effects Shake 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("shake",function(d,b){var S=1,k=g(this),R=d.direction||"left",W=d.distance||20,se=d.times||3,le=se*2+1,fe=Math.round(d.duration/le),be=R==="up"||R==="down"?"top":"left",Te=R==="up"||R==="left",Ve={},Ue={},me={},ke=k.queue().length;for(g.effects.createPlaceholder(k),Ve[be]=(Te?"-=":"+=")+W,Ue[be]=(Te?"+=":"-=")+W*2,me[be]=(Te?"-=":"+=")+W*2,k.animate(Ve,fe,d.easing);S<se;S++)k.animate(Ue,fe,d.easing).animate(me,fe,d.easing);k.animate(Ue,fe,d.easing).animate(Ve,fe/2,d.easing).queue(b),g.effects.unshift(k,ke,le+1)});/*!
 * jQuery UI Effects Slide 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.effects.define("slide","show",function(d,b){var S,k,R=g(this),W={up:["bottom","top"],down:["top","bottom"],left:["right","left"],right:["left","right"]},se=d.mode,le=d.direction||"left",fe=le==="up"||le==="down"?"top":"left",be=le==="up"||le==="left",Te=d.distance||R[fe==="top"?"outerHeight":"outerWidth"](!0),Ve={};g.effects.createPlaceholder(R),S=R.cssClip(),k=R.position()[fe],Ve[fe]=(be?-1:1)*Te+k,Ve.clip=R.cssClip(),Ve.clip[W[le][1]]=Ve.clip[W[le][0]],se==="show"&&(R.cssClip(Ve.clip),R.css(fe,Ve[fe]),Ve.clip=S,Ve[fe]=k),R.animate(Ve,{queue:!1,duration:d.duration,easing:d.easing,complete:b})}),g.uiBackCompat!==!1&&g.effects.define("transfer",function(d,b){g(this).transfer(d,b)});/*!
 * jQuery UI Focusable 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.ui.focusable=function(d,b){var S,k,R,W,se,le=d.nodeName.toLowerCase();return le==="area"?(S=d.parentNode,k=S.name,!d.href||!k||S.nodeName.toLowerCase()!=="map"?!1:(R=g("img[usemap='#"+k+"']"),R.length>0&&R.is(":visible"))):(/^(input|select|textarea|button|object)$/.test(le)?(W=!d.disabled,W&&(se=g(d).closest("fieldset")[0],se&&(W=!se.disabled))):le==="a"?W=d.href||b:W=b,W&&g(d).is(":visible")&&qt(g(d)))};function qt(d){for(var b=d.css("visibility");b==="inherit";)d=d.parent(),b=d.css("visibility");return b==="visible"}g.extend(g.expr.pseudos,{focusable:function(d){return g.ui.focusable(d,g.attr(d,"tabindex")!=null)}}),g.ui.focusable,g.fn._form=function(){return typeof this[0].form=="string"?this.closest("form"):g(this[0].form)};/*!
 * jQuery UI Form Reset Mixin 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.ui.formResetMixin={_formResetHandler:function(){var d=g(this);setTimeout(function(){var b=d.data("ui-form-reset-instances");g.each(b,function(){this.refresh()})})},_bindFormResetHandler:function(){if(this.form=this.element._form(),!!this.form.length){var d=this.form.data("ui-form-reset-instances")||[];d.length||this.form.on("reset.ui-form-reset",this._formResetHandler),d.push(this),this.form.data("ui-form-reset-instances",d)}},_unbindFormResetHandler:function(){if(this.form.length){var d=this.form.data("ui-form-reset-instances");d.splice(g.inArray(this,d),1),d.length?this.form.data("ui-form-reset-instances",d):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}};/*!
 * jQuery UI Support for jQuery core 1.8.x and newer 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 */if(g.expr.pseudos||(g.expr.pseudos=g.expr[":"]),g.uniqueSort||(g.uniqueSort=g.unique),!g.escapeSelector){var Vt=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g,vt=function(d,b){return b?d==="\0"?"ï¿½":d.slice(0,-1)+"\\"+d.charCodeAt(d.length-1).toString(16)+" ":"\\"+d};g.escapeSelector=function(d){return(d+"").replace(Vt,vt)}}(!g.fn.even||!g.fn.odd)&&g.fn.extend({even:function(){return this.filter(function(d){return d%2===0})},odd:function(){return this.filter(function(d){return d%2===1})}});/*!
 * jQuery UI Keycode 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38};/*!
 * jQuery UI Labels 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.fn.labels=function(){var d,b,S,k,R;return this.length?this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(k=this.eq(0).parents("label"),S=this.attr("id"),S&&(d=this.eq(0).parents().last(),R=d.add(d.length?d.siblings():this.siblings()),b="label[for='"+g.escapeSelector(S)+"']",k=k.add(R.find(b).addBack(b))),this.pushStack(k)):this.pushStack([])};/*!
 * jQuery UI Scroll Parent 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.fn.scrollParent=function(d){var b=this.css("position"),S=b==="absolute",k=d?/(auto|scroll|hidden)/:/(auto|scroll)/,R=this.parents().filter(function(){var W=g(this);return S&&W.css("position")==="static"?!1:k.test(W.css("overflow")+W.css("overflow-y")+W.css("overflow-x"))}).eq(0);return b==="fixed"||!R.length?g(this[0].ownerDocument||document):R};/*!
 * jQuery UI Tabbable 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.extend(g.expr.pseudos,{tabbable:function(d){var b=g.attr(d,"tabindex"),S=b!=null;return(!S||b>=0)&&g.ui.focusable(d,S)}});/*!
 * jQuery UI Unique ID 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.fn.extend({uniqueId:function(){var d=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++d)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&g(this).removeAttr("id")})}});/*!
 * jQuery UI Accordion 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.accordion",{version:"1.13.2",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:function(d){return d.find("> li > :first-child").add(d.find("> :not(li)").even())},heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var d=this.options;this.prevShow=this.prevHide=g(),this._addClass("ui-accordion","ui-widget ui-helper-reset"),this.element.attr("role","tablist"),!d.collapsible&&(d.active===!1||d.active==null)&&(d.active=0),this._processPanels(),d.active<0&&(d.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():g()}},_createIcons:function(){var d,b,S=this.options.icons;S&&(d=g("<span>"),this._addClass(d,"ui-accordion-header-icon","ui-icon "+S.header),d.prependTo(this.headers),b=this.active.children(".ui-accordion-header-icon"),this._removeClass(b,S.header)._addClass(b,null,S.activeHeader)._addClass(this.headers,"ui-accordion-icons"))},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons"),this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var d;this.element.removeAttr("role"),this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(),this._destroyIcons(),d=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(),this.options.heightStyle!=="content"&&d.css("height","")},_setOption:function(d,b){if(d==="active"){this._activate(b);return}d==="event"&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(b)),this._super(d,b),d==="collapsible"&&!b&&this.options.active===!1&&this._activate(0),d==="icons"&&(this._destroyIcons(),b&&this._createIcons())},_setOptionDisabled:function(d){this._super(d),this.element.attr("aria-disabled",d),this._toggleClass(null,"ui-state-disabled",!!d),this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",!!d)},_keydown:function(d){if(!(d.altKey||d.ctrlKey)){var b=g.ui.keyCode,S=this.headers.length,k=this.headers.index(d.target),R=!1;switch(d.keyCode){case b.RIGHT:case b.DOWN:R=this.headers[(k+1)%S];break;case b.LEFT:case b.UP:R=this.headers[(k-1+S)%S];break;case b.SPACE:case b.ENTER:this._eventHandler(d);break;case b.HOME:R=this.headers[0];break;case b.END:R=this.headers[S-1];break}R&&(g(d.target).attr("tabIndex",-1),g(R).attr("tabIndex",0),g(R).trigger("focus"),d.preventDefault())}},_panelKeyDown:function(d){d.keyCode===g.ui.keyCode.UP&&d.ctrlKey&&g(d.currentTarget).prev().trigger("focus")},refresh:function(){var d=this.options;this._processPanels(),d.active===!1&&d.collapsible===!0||!this.headers.length?(d.active=!1,this.active=g()):d.active===!1?this._activate(0):this.active.length&&!g.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(d.active=!1,this.active=g()):this._activate(Math.max(0,d.active-1)):d.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){var d=this.headers,b=this.panels;typeof this.options.header=="function"?this.headers=this.options.header(this.element):this.headers=this.element.find(this.options.header),this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default"),this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide(),this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content"),b&&(this._off(d.not(this.headers)),this._off(b.not(this.panels)))},_refresh:function(){var d,b=this.options,S=b.heightStyle,k=this.element.parent();this.active=this._findActive(b.active),this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed"),this._addClass(this.active.next(),"ui-accordion-content-active"),this.active.next().show(),this.headers.attr("role","tab").each(function(){var R=g(this),W=R.uniqueId().attr("id"),se=R.next(),le=se.uniqueId().attr("id");R.attr("aria-controls",le),se.attr("aria-labelledby",W)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(b.event),S==="fill"?(d=k.height(),this.element.siblings(":visible").each(function(){var R=g(this),W=R.css("position");W==="absolute"||W==="fixed"||(d-=R.outerHeight(!0))}),this.headers.each(function(){d-=g(this).outerHeight(!0)}),this.headers.next().each(function(){g(this).height(Math.max(0,d-g(this).innerHeight()+g(this).height()))}).css("overflow","auto")):S==="auto"&&(d=0,this.headers.next().each(function(){var R=g(this).is(":visible");R||g(this).show(),d=Math.max(d,g(this).css("height","").height()),R||g(this).hide()}).height(d))},_activate:function(d){var b=this._findActive(d)[0];b!==this.active[0]&&(b=b||this.active[0],this._eventHandler({target:b,currentTarget:b,preventDefault:g.noop}))},_findActive:function(d){return typeof d=="number"?this.headers.eq(d):g()},_setupEvents:function(d){var b={keydown:"_keydown"};d&&g.each(d.split(" "),function(S,k){b[k]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,b),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(d){var b,S,k=this.options,R=this.active,W=g(d.currentTarget),se=W[0]===R[0],le=se&&k.collapsible,fe=le?g():W.next(),be=R.next(),Te={oldHeader:R,oldPanel:be,newHeader:le?g():W,newPanel:fe};d.preventDefault(),!(se&&!k.collapsible||this._trigger("beforeActivate",d,Te)===!1)&&(k.active=le?!1:this.headers.index(W),this.active=se?g():W,this._toggle(Te),this._removeClass(R,"ui-accordion-header-active","ui-state-active"),k.icons&&(b=R.children(".ui-accordion-header-icon"),this._removeClass(b,null,k.icons.activeHeader)._addClass(b,null,k.icons.header)),se||(this._removeClass(W,"ui-accordion-header-collapsed")._addClass(W,"ui-accordion-header-active","ui-state-active"),k.icons&&(S=W.children(".ui-accordion-header-icon"),this._removeClass(S,null,k.icons.header)._addClass(S,null,k.icons.activeHeader)),this._addClass(W.next(),"ui-accordion-content-active")))},_toggle:function(d){var b=d.newPanel,S=this.prevShow.length?this.prevShow:d.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=b,this.prevHide=S,this.options.animate?this._animate(b,S,d):(S.hide(),b.show(),this._toggleComplete(d)),S.attr({"aria-hidden":"true"}),S.prev().attr({"aria-selected":"false","aria-expanded":"false"}),b.length&&S.length?S.prev().attr({tabIndex:-1,"aria-expanded":"false"}):b.length&&this.headers.filter(function(){return parseInt(g(this).attr("tabIndex"),10)===0}).attr("tabIndex",-1),b.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(d,b,S){var k,R,W,se=this,le=0,fe=d.css("box-sizing"),be=d.length&&(!b.length||d.index()<b.index()),Te=this.options.animate||{},Ve=be&&Te.down||Te,Ue=function(){se._toggleComplete(S)};if(typeof Ve=="number"&&(W=Ve),typeof Ve=="string"&&(R=Ve),R=R||Ve.easing||Te.easing,W=W||Ve.duration||Te.duration,!b.length)return d.animate(this.showProps,W,R,Ue);if(!d.length)return b.animate(this.hideProps,W,R,Ue);k=d.show().outerHeight(),b.animate(this.hideProps,{duration:W,easing:R,step:function(me,ke){ke.now=Math.round(me)}}),d.hide().animate(this.showProps,{duration:W,easing:R,complete:Ue,step:function(me,ke){ke.now=Math.round(me),ke.prop!=="height"?fe==="content-box"&&(le+=ke.now):se.options.heightStyle!=="content"&&(ke.now=Math.round(k-b.outerHeight()-le),le=0)}})},_toggleComplete:function(d){var b=d.oldPanel,S=b.prev();this._removeClass(b,"ui-accordion-content-active"),this._removeClass(S,"ui-accordion-header-active")._addClass(S,"ui-accordion-header-collapsed"),b.length&&(b.parent()[0].className=b.parent()[0].className),this._trigger("activate",null,d)}}),g.ui.safeActiveElement=function(d){var b;try{b=d.activeElement}catch{b=d.body}return b||(b=d.body),b.nodeName||(b=d.body),b};/*!
 * jQuery UI Menu 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.menu",{version:"1.13.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.lastMousePosition={x:null,y:null},this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(d){d.preventDefault(),this._activateItem(d)},"click .ui-menu-item":function(d){var b=g(d.target),S=g(g.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&b.not(".ui-state-disabled").length&&(this.select(d),d.isPropagationStopped()||(this.mouseHandled=!0),b.has(".ui-menu").length?this.expand(d):!this.element.is(":focus")&&S.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&this.active.parents(".ui-menu").length===1&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":"_activateItem","mousemove .ui-menu-item":"_activateItem",mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(d,b){var S=this.active||this._menuItems().first();b||this.focus(d,S)},blur:function(d){this._delay(function(){var b=!g.contains(this.element[0],g.ui.safeActiveElement(this.document[0]));b&&this.collapseAll(d)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(d){this._closeOnDocumentClick(d)&&this.collapseAll(d,!0),this.mouseHandled=!1}})},_activateItem:function(d){if(!this.previousFilter&&!(d.clientX===this.lastMousePosition.x&&d.clientY===this.lastMousePosition.y)){this.lastMousePosition={x:d.clientX,y:d.clientY};var b=g(d.target).closest(".ui-menu-item"),S=g(d.currentTarget);b[0]===S[0]&&(S.is(".ui-state-active")||(this._removeClass(S.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(d,S)))}},_destroy:function(){var d=this.element.find(".ui-menu-item").removeAttr("role aria-disabled"),b=d.children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),b.children().each(function(){var S=g(this);S.data("ui-menu-submenu-caret")&&S.remove()})},_keydown:function(d){var b,S,k,R,W=!0;switch(d.keyCode){case g.ui.keyCode.PAGE_UP:this.previousPage(d);break;case g.ui.keyCode.PAGE_DOWN:this.nextPage(d);break;case g.ui.keyCode.HOME:this._move("first","first",d);break;case g.ui.keyCode.END:this._move("last","last",d);break;case g.ui.keyCode.UP:this.previous(d);break;case g.ui.keyCode.DOWN:this.next(d);break;case g.ui.keyCode.LEFT:this.collapse(d);break;case g.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(d);break;case g.ui.keyCode.ENTER:case g.ui.keyCode.SPACE:this._activate(d);break;case g.ui.keyCode.ESCAPE:this.collapse(d);break;default:W=!1,S=this.previousFilter||"",R=!1,k=d.keyCode>=96&&d.keyCode<=105?(d.keyCode-96).toString():String.fromCharCode(d.keyCode),clearTimeout(this.filterTimer),k===S?R=!0:k=S+k,b=this._filterMenuItems(k),b=R&&b.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):b,b.length||(k=String.fromCharCode(d.keyCode),b=this._filterMenuItems(k)),b.length?(this.focus(d,b),this.previousFilter=k,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}W&&d.preventDefault()},_activate:function(d){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(d):this.select(d))},refresh:function(){var d,b,S,k,R,W=this,se=this.options.icons.submenu,le=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),S=le.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var fe=g(this),be=fe.prev(),Te=g("<span>").data("ui-menu-submenu-caret",!0);W._addClass(Te,"ui-menu-icon","ui-icon "+se),be.attr("aria-haspopup","true").prepend(Te),fe.attr("aria-labelledby",be.attr("id"))}),this._addClass(S,"ui-menu","ui-widget ui-widget-content ui-front"),d=le.add(this.element),b=d.find(this.options.items),b.not(".ui-menu-item").each(function(){var fe=g(this);W._isDivider(fe)&&W._addClass(fe,"ui-menu-divider","ui-widget-content")}),k=b.not(".ui-menu-item, .ui-menu-divider"),R=k.children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(k,"ui-menu-item")._addClass(R,"ui-menu-item-wrapper"),b.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!g.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(d,b){if(d==="icons"){var S=this.element.find(".ui-menu-icon");this._removeClass(S,null,this.options.icons.submenu)._addClass(S,null,b.submenu)}this._super(d,b)},_setOptionDisabled:function(d){this._super(d),this.element.attr("aria-disabled",String(d)),this._toggleClass(null,"ui-state-disabled",!!d)},focus:function(d,b){var S,k,R;this.blur(d,d&&d.type==="focus"),this._scrollIntoView(b),this.active=b.first(),k=this.active.children(".ui-menu-item-wrapper"),this._addClass(k,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",k.attr("id")),R=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(R,null,"ui-state-active"),d&&d.type==="keydown"?this._close():this.timer=this._delay(function(){this._close()},this.delay),S=b.children(".ui-menu"),S.length&&d&&/^mouse/.test(d.type)&&this._startOpening(S),this.activeMenu=b.parent(),this._trigger("focus",d,{item:b})},_scrollIntoView:function(d){var b,S,k,R,W,se;this._hasScroll()&&(b=parseFloat(g.css(this.activeMenu[0],"borderTopWidth"))||0,S=parseFloat(g.css(this.activeMenu[0],"paddingTop"))||0,k=d.offset().top-this.activeMenu.offset().top-b-S,R=this.activeMenu.scrollTop(),W=this.activeMenu.height(),se=d.outerHeight(),k<0?this.activeMenu.scrollTop(R+k):k+se>W&&this.activeMenu.scrollTop(R+k-W+se))},blur:function(d,b){b||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",d,{item:this.active}),this.active=null)},_startOpening:function(d){clearTimeout(this.timer),d.attr("aria-hidden")==="true"&&(this.timer=this._delay(function(){this._close(),this._open(d)},this.delay))},_open:function(d){var b=g.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(d.parents(".ui-menu")).hide().attr("aria-hidden","true"),d.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(b)},collapseAll:function(d,b){clearTimeout(this.timer),this.timer=this._delay(function(){var S=b?this.element:g(d&&d.target).closest(this.element.find(".ui-menu"));S.length||(S=this.element),this._close(S),this.blur(d),this._removeClass(S.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=S},b?0:this.delay)},_close:function(d){d||(d=this.active?this.active.parent():this.element),d.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(d){return!g(d.target).closest(".ui-menu").length},_isDivider:function(d){return!/[^\-\u2014\u2013\s]/.test(d.text())},collapse:function(d){var b=this.active&&this.active.parent().closest(".ui-menu-item",this.element);b&&b.length&&(this._close(),this.focus(d,b))},expand:function(d){var b=this.active&&this._menuItems(this.active.children(".ui-menu")).first();b&&b.length&&(this._open(b.parent()),this._delay(function(){this.focus(d,b)}))},next:function(d){this._move("next","first",d)},previous:function(d){this._move("prev","last",d)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_menuItems:function(d){return(d||this.element).find(this.options.items).filter(".ui-menu-item")},_move:function(d,b,S){var k;this.active&&(d==="first"||d==="last"?k=this.active[d==="first"?"prevAll":"nextAll"](".ui-menu-item").last():k=this.active[d+"All"](".ui-menu-item").first()),(!k||!k.length||!this.active)&&(k=this._menuItems(this.activeMenu)[b]()),this.focus(S,k)},nextPage:function(d){var b,S,k;if(!this.active){this.next(d);return}this.isLastItem()||(this._hasScroll()?(S=this.active.offset().top,k=this.element.innerHeight(),g.fn.jquery.indexOf("3.2.")===0&&(k+=this.element[0].offsetHeight-this.element.outerHeight()),this.active.nextAll(".ui-menu-item").each(function(){return b=g(this),b.offset().top-S-k<0}),this.focus(d,b)):this.focus(d,this._menuItems(this.activeMenu)[this.active?"last":"first"]()))},previousPage:function(d){var b,S,k;if(!this.active){this.next(d);return}this.isFirstItem()||(this._hasScroll()?(S=this.active.offset().top,k=this.element.innerHeight(),g.fn.jquery.indexOf("3.2.")===0&&(k+=this.element[0].offsetHeight-this.element.outerHeight()),this.active.prevAll(".ui-menu-item").each(function(){return b=g(this),b.offset().top-S+k>0}),this.focus(d,b)):this.focus(d,this._menuItems(this.activeMenu).first()))},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(d){this.active=this.active||g(d.target).closest(".ui-menu-item");var b={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(d,!0),this._trigger("select",d,b)},_filterMenuItems:function(d){var b=d.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),S=new RegExp("^"+b,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return S.test(String.prototype.trim.call(g(this).children(".ui-menu-item-wrapper").text()))})}});/*!
 * jQuery UI Autocomplete 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.autocomplete",{version:"1.13.2",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,liveRegionTimer:null,_create:function(){var d,b,S,k=this.element[0].nodeName.toLowerCase(),R=k==="textarea",W=k==="input";this.isMultiLine=R||!W&&this._isContentEditable(this.element),this.valueMethod=this.element[R||W?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(se){if(this.element.prop("readOnly")){d=!0,S=!0,b=!0;return}d=!1,S=!1,b=!1;var le=g.ui.keyCode;switch(se.keyCode){case le.PAGE_UP:d=!0,this._move("previousPage",se);break;case le.PAGE_DOWN:d=!0,this._move("nextPage",se);break;case le.UP:d=!0,this._keyEvent("previous",se);break;case le.DOWN:d=!0,this._keyEvent("next",se);break;case le.ENTER:this.menu.active&&(d=!0,se.preventDefault(),this.menu.select(se));break;case le.TAB:this.menu.active&&this.menu.select(se);break;case le.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(se),se.preventDefault());break;default:b=!0,this._searchTimeout(se);break}},keypress:function(se){if(d){d=!1,(!this.isMultiLine||this.menu.element.is(":visible"))&&se.preventDefault();return}if(!b){var le=g.ui.keyCode;switch(se.keyCode){case le.PAGE_UP:this._move("previousPage",se);break;case le.PAGE_DOWN:this._move("nextPage",se);break;case le.UP:this._keyEvent("previous",se);break;case le.DOWN:this._keyEvent("next",se);break}}},input:function(se){if(S){S=!1,se.preventDefault();return}this._searchTimeout(se)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(se){clearTimeout(this.searching),this.close(se),this._change(se)}}),this._initSource(),this.menu=g("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().attr({unselectable:"on"}).menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(se){se.preventDefault()},menufocus:function(se,le){var fe,be;if(this.isNewMenu&&(this.isNewMenu=!1,se.originalEvent&&/^mouse/.test(se.originalEvent.type))){this.menu.blur(),this.document.one("mousemove",function(){g(se.target).trigger(se.originalEvent)});return}be=le.item.data("ui-autocomplete-item"),this._trigger("focus",se,{item:be})!==!1&&se.originalEvent&&/^key/.test(se.originalEvent.type)&&this._value(be.value),fe=le.item.attr("aria-label")||be.value,fe&&String.prototype.trim.call(fe).length&&(clearTimeout(this.liveRegionTimer),this.liveRegionTimer=this._delay(function(){this.liveRegion.html(g("<div>").text(fe))},100))},menuselect:function(se,le){var fe=le.item.data("ui-autocomplete-item"),be=this.previous;this.element[0]!==g.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=be,this._delay(function(){this.previous=be,this.selectedItem=fe})),this._trigger("select",se,{item:fe})!==!1&&this._value(fe.value),this.term=this._value(),this.close(se),this.selectedItem=fe}}),this.liveRegion=g("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(d,b){this._super(d,b),d==="source"&&this._initSource(),d==="appendTo"&&this.menu.element.appendTo(this._appendTo()),d==="disabled"&&b&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(d){var b=this.menu.element[0];return d.target===this.element[0]||d.target===b||g.contains(b,d.target)},_closeOnClickOutside:function(d){this._isEventTargetInWidget(d)||this.close()},_appendTo:function(){var d=this.options.appendTo;return d&&(d=d.jquery||d.nodeType?g(d):this.document.find(d).eq(0)),(!d||!d[0])&&(d=this.element.closest(".ui-front, dialog")),d.length||(d=this.document[0].body),d},_initSource:function(){var d,b,S=this;Array.isArray(this.options.source)?(d=this.options.source,this.source=function(k,R){R(g.ui.autocomplete.filter(d,k.term))}):typeof this.options.source=="string"?(b=this.options.source,this.source=function(k,R){S.xhr&&S.xhr.abort(),S.xhr=g.ajax({url:b,data:k,dataType:"json",success:function(W){R(W)},error:function(){R([])}})}):this.source=this.options.source},_searchTimeout:function(d){clearTimeout(this.searching),this.searching=this._delay(function(){var b=this.term===this._value(),S=this.menu.element.is(":visible"),k=d.altKey||d.ctrlKey||d.metaKey||d.shiftKey;(!b||b&&!S&&!k)&&(this.selectedItem=null,this.search(null,d))},this.options.delay)},search:function(d,b){if(d=d??this._value(),this.term=this._value(),d.length<this.options.minLength)return this.close(b);if(this._trigger("search",b)!==!1)return this._search(d)},_search:function(d){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:d},this._response())},_response:function(){var d=++this.requestIndex;return(function(b){d===this.requestIndex&&this.__response(b),this.pending--,this.pending||this._removeClass("ui-autocomplete-loading")}).bind(this)},__response:function(d){d&&(d=this._normalize(d)),this._trigger("response",null,{content:d}),!this.options.disabled&&d&&d.length&&!this.cancelSearch?(this._suggest(d),this._trigger("open")):this._close()},close:function(d){this.cancelSearch=!0,this._close(d)},_close:function(d){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",d))},_change:function(d){this.previous!==this._value()&&this._trigger("change",d,{item:this.selectedItem})},_normalize:function(d){return d.length&&d[0].label&&d[0].value?d:g.map(d,function(b){return typeof b=="string"?{label:b,value:b}:g.extend({},b,{label:b.label||b.value,value:b.value||b.label})})},_suggest:function(d){var b=this.menu.element.empty();this._renderMenu(b,d),this.isNewMenu=!0,this.menu.refresh(),b.show(),this._resizeMenu(),b.position(g.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var d=this.menu.element;d.outerWidth(Math.max(d.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(d,b){var S=this;g.each(b,function(k,R){S._renderItemData(d,R)})},_renderItemData:function(d,b){return this._renderItem(d,b).data("ui-autocomplete-item",b)},_renderItem:function(d,b){return g("<li>").append(g("<div>").text(b.label)).appendTo(d)},_move:function(d,b){if(!this.menu.element.is(":visible")){this.search(null,b);return}if(this.menu.isFirstItem()&&/^previous/.test(d)||this.menu.isLastItem()&&/^next/.test(d)){this.isMultiLine||this._value(this.term),this.menu.blur();return}this.menu[d](b)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(d,b){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(d,b),b.preventDefault())},_isContentEditable:function(d){if(!d.length)return!1;var b=d.prop("contentEditable");return b==="inherit"?this._isContentEditable(d.parent()):b==="true"}}),g.extend(g.ui.autocomplete,{escapeRegex:function(d){return d.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(d,b){var S=new RegExp(g.ui.autocomplete.escapeRegex(b),"i");return g.grep(d,function(k){return S.test(k.label||k.value||k)})}}),g.widget("ui.autocomplete",g.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(d){return d+(d>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(d){var b;this._superApply(arguments),!(this.options.disabled||this.cancelSearch)&&(d&&d.length?b=this.options.messages.results(d.length):b=this.options.messages.noResults,clearTimeout(this.liveRegionTimer),this.liveRegionTimer=this._delay(function(){this.liveRegion.html(g("<div>").text(b))},100))}}),g.ui.autocomplete;/*!
 * jQuery UI Controlgroup 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */var Ut=/ui-corner-([a-z]){2,6}/g;g.widget("ui.controlgroup",{version:"1.13.2",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var d=this,b=[];g.each(this.options.items,function(S,k){var R,W={};if(k){if(S==="controlgroupLabel"){R=d.element.find(k),R.each(function(){var se=g(this);se.children(".ui-controlgroup-label-contents").length||se.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),d._addClass(R,null,"ui-widget ui-widget-content ui-state-default"),b=b.concat(R.get());return}g.fn[S]&&(d["_"+S+"Options"]?W=d["_"+S+"Options"]("middle"):W={classes:{}},d.element.find(k).each(function(){var se=g(this),le=se[S]("instance"),fe=g.widget.extend({},W);if(!(S==="button"&&se.parent(".ui-spinner").length)){le||(le=se[S]()[S]("instance")),le&&(fe.classes=d._resolveClassesValues(fe.classes,le)),se[S](fe);var be=se[S]("widget");g.data(be[0],"ui-controlgroup-data",le||se[S]("instance")),b.push(be[0])}}))}}),this.childWidgets=g(g.uniqueSort(b)),this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(d){this.childWidgets.each(function(){var b=g(this),S=b.data("ui-controlgroup-data");S&&S[d]&&S[d]()})},_updateCornerClass:function(d,b){var S="ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all",k=this._buildSimpleOptions(b,"label").classes.label;this._removeClass(d,null,S),this._addClass(d,null,k)},_buildSimpleOptions:function(d,b){var S=this.options.direction==="vertical",k={classes:{}};return k.classes[b]={middle:"",first:"ui-corner-"+(S?"top":"left"),last:"ui-corner-"+(S?"bottom":"right"),only:"ui-corner-all"}[d],k},_spinnerOptions:function(d){var b=this._buildSimpleOptions(d,"ui-spinner");return b.classes["ui-spinner-up"]="",b.classes["ui-spinner-down"]="",b},_buttonOptions:function(d){return this._buildSimpleOptions(d,"ui-button")},_checkboxradioOptions:function(d){return this._buildSimpleOptions(d,"ui-checkboxradio-label")},_selectmenuOptions:function(d){var b=this.options.direction==="vertical";return{width:b?"auto":!1,classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(b?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(b?"top":"left")},last:{"ui-selectmenu-button-open":b?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(b?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[d]}},_resolveClassesValues:function(d,b){var S={};return g.each(d,function(k){var R=b.options.classes[k]||"";R=String.prototype.trim.call(R.replace(Ut,"")),S[k]=(R+" "+d[k]).replace(/\s+/g," ")}),S},_setOption:function(d,b){if(d==="direction"&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(d,b),d==="disabled"){this._callChildMethod(b?"disable":"enable");return}this.refresh()},refresh:function(){var d,b=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),this.options.direction==="horizontal"&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),d=this.childWidgets,this.options.onlyVisible&&(d=d.filter(":visible")),d.length&&(g.each(["first","last"],function(S,k){var R=d[k]().data("ui-controlgroup-data");if(R&&b["_"+R.widgetName+"Options"]){var W=b["_"+R.widgetName+"Options"](d.length===1?"only":k);W.classes=b._resolveClassesValues(W.classes,R),R.element[R.widgetName](W)}else b._updateCornerClass(d[k](),k)}),this._callChildMethod("refresh"))}});/*!
 * jQuery UI Checkboxradio 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.checkboxradio",[g.ui.formResetMixin,{version:"1.13.2",options:{disabled:null,label:null,icon:!0,classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var d,b,S,k=this._super()||{};return this._readType(),b=this.element.labels(),this.label=g(b[b.length-1]),this.label.length||g.error("No label found for checkboxradio widget"),this.originalLabel="",S=this.label.contents().not(this.element[0]),S.length&&(this.originalLabel+=S.clone().wrapAll("<div></div>").parent().html()),this.originalLabel&&(k.label=this.originalLabel),d=this.element[0].disabled,d!=null&&(k.disabled=d),k},_create:function(){var d=this.element[0].checked;this._bindFormResetHandler(),this.options.disabled==null&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),this.type==="radio"&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),d&&this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var d=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,(d!=="input"||!/radio|checkbox/.test(this.type))&&g.error("Can't create checkboxradio on element.nodeName="+d+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var d,b=this.element[0].name,S="input[name='"+g.escapeSelector(b)+"']";return b?(this.form.length?d=g(this.form[0].elements).filter(S):d=g(S).filter(function(){return g(this)._form().length===0}),d.not(this.element)):g([])},_toggleClasses:function(){var d=this.element[0].checked;this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",d),this.options.icon&&this.type==="checkbox"&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",d)._toggleClass(this.icon,null,"ui-icon-blank",!d),this.type==="radio"&&this._getRadioGroup().each(function(){var b=g(this).checkboxradio("instance");b&&b._removeClass(b.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(d,b){if(!(d==="label"&&!b)){if(this._super(d,b),d==="disabled"){this._toggleClass(this.label,null,"ui-state-disabled",b),this.element[0].disabled=b;return}this.refresh()}},_updateIcon:function(d){var b="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=g("<span>"),this.iconSpace=g("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),this.type==="checkbox"?(b+=d?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,d?"ui-icon-blank":"ui-icon-check")):b+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",b),d||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):this.icon!==void 0&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var d=this.label.contents().not(this.element[0]);this.icon&&(d=d.not(this.icon[0])),this.iconSpace&&(d=d.not(this.iconSpace[0])),d.remove(),this.label.append(this.options.label)},refresh:function(){var d=this.element[0].checked,b=this.element[0].disabled;this._updateIcon(d),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",d),this.options.label!==null&&this._updateLabel(),b!==this.options.disabled&&this._setOptions({disabled:b})}}]),g.ui.checkboxradio;/*!
 * jQuery UI Button 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.button",{version:"1.13.2",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var d,b=this._super()||{};return this.isInput=this.element.is("input"),d=this.element[0].disabled,d!=null&&(b.disabled=d),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(b.label=this.originalLabel),b},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),this.options.disabled==null&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(d){d.keyCode===g.ui.keyCode.SPACE&&(d.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),!this.options.showLabel&&!this.title&&this.element.attr("title",this.options.label)},_updateIcon:function(d,b){var S=d!=="iconPosition",k=S?this.options.iconPosition:b,R=k==="top"||k==="bottom";this.icon?S&&this._removeClass(this.icon,null,this.options.icon):(this.icon=g("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),S&&this._addClass(this.icon,null,b),this._attachIcon(k),R?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=g("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(k))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(d){this.icon[/^(?:end|bottom)/.test(d)?"before":"after"](this.iconSpace)},_attachIcon:function(d){this.element[/^(?:end|bottom)/.test(d)?"append":"prepend"](this.icon)},_setOptions:function(d){var b=d.showLabel===void 0?this.options.showLabel:d.showLabel,S=d.icon===void 0?this.options.icon:d.icon;!b&&!S&&(d.showLabel=!0),this._super(d)},_setOption:function(d,b){d==="icon"&&(b?this._updateIcon(d,b):this.icon&&(this.icon.remove(),this.iconSpace&&this.iconSpace.remove())),d==="iconPosition"&&this._updateIcon(d,b),d==="showLabel"&&(this._toggleClass("ui-button-icon-only",null,!b),this._updateTooltip()),d==="label"&&(this.isInput?this.element.val(b):(this.element.html(b),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(d,b),d==="disabled"&&(this._toggleClass(null,"ui-state-disabled",b),this.element[0].disabled=b,b&&this.element.trigger("blur"))},refresh:function(){var d=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");d!==this.options.disabled&&this._setOptions({disabled:d}),this._updateTooltip()}}),g.uiBackCompat!==!1&&(g.widget("ui.button",g.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),!this.options.icon&&(this.options.icons.primary||this.options.icons.secondary)?this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"):this.options.icon&&(this.options.icons.primary=this.options.icon),this._super()},_setOption:function(d,b){if(d==="text"){this._super("showLabel",b);return}d==="showLabel"&&(this.options.text=b),d==="icon"&&(this.options.icons.primary=b),d==="icons"&&(b.primary?(this._super("icon",b.primary),this._super("iconPosition","beginning")):b.secondary&&(this._super("icon",b.secondary),this._super("iconPosition","end"))),this._superApply(arguments)}}),g.fn.button=function(d){return function(b){var S=typeof b=="string",k=Array.prototype.slice.call(arguments,1),R=this;return S?!this.length&&b==="instance"?R=void 0:this.each(function(){var W,se=g(this).attr("type"),le=se!=="checkbox"&&se!=="radio"?"button":"checkboxradio",fe=g.data(this,"ui-"+le);if(b==="instance")return R=fe,!1;if(!fe)return g.error("cannot call methods on button prior to initialization; attempted to call method '"+b+"'");if(typeof fe[b]!="function"||b.charAt(0)==="_")return g.error("no such method '"+b+"' for button widget instance");if(W=fe[b].apply(fe,k),W!==fe&&W!==void 0)return R=W&&W.jquery?R.pushStack(W.get()):W,!1}):(k.length&&(b=g.widget.extend.apply(null,[b].concat(k))),this.each(function(){var W=g(this).attr("type"),se=W!=="checkbox"&&W!=="radio"?"button":"checkboxradio",le=g.data(this,"ui-"+se);if(le)le.option(b||{}),le._init&&le._init();else{if(se==="button"){d.call(g(this),b);return}g(this).checkboxradio(g.extend({icon:!1},b))}})),R}}(g.fn.button),g.fn.buttonset=function(){return g.ui.controlgroup||g.error("Controlgroup widget missing"),arguments[0]==="option"&&arguments[1]==="items"&&arguments[2]?this.controlgroup.apply(this,[arguments[0],"items.button",arguments[2]]):arguments[0]==="option"&&arguments[1]==="items"?this.controlgroup.apply(this,[arguments[0],"items.button"]):(typeof arguments[0]=="object"&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))}),g.ui.button;/*!
 * jQuery UI Datepicker 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.extend(g.ui,{datepicker:{version:"1.13.2"}});var Pt;function Yt(d){for(var b,S;d.length&&d[0]!==document;){if(b=d.css("position"),(b==="absolute"||b==="relative"||b==="fixed")&&(S=parseInt(d.css("zIndex"),10),!isNaN(S)&&S!==0))return S;d=d.parent()}return 0}function Ai(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:"",selectMonthLabel:"Select month",selectYearLabel:"Select year"},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,onUpdateDatepicker:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},g.extend(this._defaults,this.regional[""]),this.regional.en=g.extend(!0,{},this.regional[""]),this.regional["en-US"]=g.extend(!0,{},this.regional.en),this.dpDiv=Ri(g("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}g.extend(Ai.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(d){return Li(this._defaults,d||{}),this},_attachDatepicker:function(d,b){var S,k,R;S=d.nodeName.toLowerCase(),k=S==="div"||S==="span",d.id||(this.uuid+=1,d.id="dp"+this.uuid),R=this._newInst(g(d),k),R.settings=g.extend({},b||{}),S==="input"?this._connectDatepicker(d,R):k&&this._inlineDatepicker(d,R)},_newInst:function(d,b){var S=d[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:S,input:d,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,dpDiv:b?Ri(g("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(d,b){var S=g(d);b.append=g([]),b.trigger=g([]),!S.hasClass(this.markerClassName)&&(this._attachments(S,b),S.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(b),g.data(d,"datepicker",b),b.settings.disabled&&this._disableDatepicker(d))},_attachments:function(d,b){var S,k,R,W=this._get(b,"appendText"),se=this._get(b,"isRTL");b.append&&b.append.remove(),W&&(b.append=g("<span>").addClass(this._appendClass).text(W),d[se?"before":"after"](b.append)),d.off("focus",this._showDatepicker),b.trigger&&b.trigger.remove(),S=this._get(b,"showOn"),(S==="focus"||S==="both")&&d.on("focus",this._showDatepicker),(S==="button"||S==="both")&&(k=this._get(b,"buttonText"),R=this._get(b,"buttonImage"),this._get(b,"buttonImageOnly")?b.trigger=g("<img>").addClass(this._triggerClass).attr({src:R,alt:k,title:k}):(b.trigger=g("<button type='button'>").addClass(this._triggerClass),R?b.trigger.html(g("<img>").attr({src:R,alt:k,title:k})):b.trigger.text(k)),d[se?"before":"after"](b.trigger),b.trigger.on("click",function(){return g.datepicker._datepickerShowing&&g.datepicker._lastInput===d[0]?g.datepicker._hideDatepicker():(g.datepicker._datepickerShowing&&g.datepicker._lastInput!==d[0]&&g.datepicker._hideDatepicker(),g.datepicker._showDatepicker(d[0])),!1}))},_autoSize:function(d){if(this._get(d,"autoSize")&&!d.inline){var b,S,k,R,W=new Date(2009,11,20),se=this._get(d,"dateFormat");se.match(/[DM]/)&&(b=function(le){for(S=0,k=0,R=0;R<le.length;R++)le[R].length>S&&(S=le[R].length,k=R);return k},W.setMonth(b(this._get(d,se.match(/MM/)?"monthNames":"monthNamesShort"))),W.setDate(b(this._get(d,se.match(/DD/)?"dayNames":"dayNamesShort"))+20-W.getDay())),d.input.attr("size",this._formatDate(d,W).length)}},_inlineDatepicker:function(d,b){var S=g(d);S.hasClass(this.markerClassName)||(S.addClass(this.markerClassName).append(b.dpDiv),g.data(d,"datepicker",b),this._setDate(b,this._getDefaultDate(b),!0),this._updateDatepicker(b),this._updateAlternate(b),b.settings.disabled&&this._disableDatepicker(d),b.dpDiv.css("display","block"))},_dialogDatepicker:function(d,b,S,k,R){var W,se,le,fe,be,Te=this._dialogInst;return Te||(this.uuid+=1,W="dp"+this.uuid,this._dialogInput=g("<input type='text' id='"+W+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),g("body").append(this._dialogInput),Te=this._dialogInst=this._newInst(this._dialogInput,!1),Te.settings={},g.data(this._dialogInput[0],"datepicker",Te)),Li(Te.settings,k||{}),b=b&&b.constructor===Date?this._formatDate(Te,b):b,this._dialogInput.val(b),this._pos=R?R.length?R:[R.pageX,R.pageY]:null,this._pos||(se=document.documentElement.clientWidth,le=document.documentElement.clientHeight,fe=document.documentElement.scrollLeft||document.body.scrollLeft,be=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[se/2-100+fe,le/2-150+be]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),Te.settings.onSelect=S,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),g.blockUI&&g.blockUI(this.dpDiv),g.data(this._dialogInput[0],"datepicker",Te),this},_destroyDatepicker:function(d){var b,S=g(d),k=g.data(d,"datepicker");S.hasClass(this.markerClassName)&&(b=d.nodeName.toLowerCase(),g.removeData(d,"datepicker"),b==="input"?(k.append.remove(),k.trigger.remove(),S.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):(b==="div"||b==="span")&&S.removeClass(this.markerClassName).empty(),Pt===k&&(Pt=null,this._curInst=null))},_enableDatepicker:function(d){var b,S,k=g(d),R=g.data(d,"datepicker");k.hasClass(this.markerClassName)&&(b=d.nodeName.toLowerCase(),b==="input"?(d.disabled=!1,R.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):(b==="div"||b==="span")&&(S=k.children("."+this._inlineClass),S.children().removeClass("ui-state-disabled"),S.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=g.map(this._disabledInputs,function(W){return W===d?null:W}))},_disableDatepicker:function(d){var b,S,k=g(d),R=g.data(d,"datepicker");k.hasClass(this.markerClassName)&&(b=d.nodeName.toLowerCase(),b==="input"?(d.disabled=!0,R.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):(b==="div"||b==="span")&&(S=k.children("."+this._inlineClass),S.children().addClass("ui-state-disabled"),S.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=g.map(this._disabledInputs,function(W){return W===d?null:W}),this._disabledInputs[this._disabledInputs.length]=d)},_isDisabledDatepicker:function(d){if(!d)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]===d)return!0;return!1},_getInst:function(d){try{return g.data(d,"datepicker")}catch{throw"Missing instance data for this datepicker"}},_optionDatepicker:function(d,b,S){var k,R,W,se,le=this._getInst(d);if(arguments.length===2&&typeof b=="string")return b==="defaults"?g.extend({},g.datepicker._defaults):le?b==="all"?g.extend({},le.settings):this._get(le,b):null;k=b||{},typeof b=="string"&&(k={},k[b]=S),le&&(this._curInst===le&&this._hideDatepicker(),R=this._getDateDatepicker(d,!0),W=this._getMinMaxDate(le,"min"),se=this._getMinMaxDate(le,"max"),Li(le.settings,k),W!==null&&k.dateFormat!==void 0&&k.minDate===void 0&&(le.settings.minDate=this._formatDate(le,W)),se!==null&&k.dateFormat!==void 0&&k.maxDate===void 0&&(le.settings.maxDate=this._formatDate(le,se)),"disabled"in k&&(k.disabled?this._disableDatepicker(d):this._enableDatepicker(d)),this._attachments(g(d),le),this._autoSize(le),this._setDate(le,R),this._updateAlternate(le),this._updateDatepicker(le))},_changeDatepicker:function(d,b,S){this._optionDatepicker(d,b,S)},_refreshDatepicker:function(d){var b=this._getInst(d);b&&this._updateDatepicker(b)},_setDateDatepicker:function(d,b){var S=this._getInst(d);S&&(this._setDate(S,b),this._updateDatepicker(S),this._updateAlternate(S))},_getDateDatepicker:function(d,b){var S=this._getInst(d);return S&&!S.inline&&this._setDateFromField(S,b),S?this._getDate(S):null},_doKeyDown:function(d){var b,S,k,R=g.datepicker._getInst(d.target),W=!0,se=R.dpDiv.is(".ui-datepicker-rtl");if(R._keyEvent=!0,g.datepicker._datepickerShowing)switch(d.keyCode){case 9:g.datepicker._hideDatepicker(),W=!1;break;case 13:return k=g("td."+g.datepicker._dayOverClass+":not(."+g.datepicker._currentClass+")",R.dpDiv),k[0]&&g.datepicker._selectDay(d.target,R.selectedMonth,R.selectedYear,k[0]),b=g.datepicker._get(R,"onSelect"),b?(S=g.datepicker._formatDate(R),b.apply(R.input?R.input[0]:null,[S,R])):g.datepicker._hideDatepicker(),!1;case 27:g.datepicker._hideDatepicker();break;case 33:g.datepicker._adjustDate(d.target,d.ctrlKey?-g.datepicker._get(R,"stepBigMonths"):-g.datepicker._get(R,"stepMonths"),"M");break;case 34:g.datepicker._adjustDate(d.target,d.ctrlKey?+g.datepicker._get(R,"stepBigMonths"):+g.datepicker._get(R,"stepMonths"),"M");break;case 35:(d.ctrlKey||d.metaKey)&&g.datepicker._clearDate(d.target),W=d.ctrlKey||d.metaKey;break;case 36:(d.ctrlKey||d.metaKey)&&g.datepicker._gotoToday(d.target),W=d.ctrlKey||d.metaKey;break;case 37:(d.ctrlKey||d.metaKey)&&g.datepicker._adjustDate(d.target,se?1:-1,"D"),W=d.ctrlKey||d.metaKey,d.originalEvent.altKey&&g.datepicker._adjustDate(d.target,d.ctrlKey?-g.datepicker._get(R,"stepBigMonths"):-g.datepicker._get(R,"stepMonths"),"M");break;case 38:(d.ctrlKey||d.metaKey)&&g.datepicker._adjustDate(d.target,-7,"D"),W=d.ctrlKey||d.metaKey;break;case 39:(d.ctrlKey||d.metaKey)&&g.datepicker._adjustDate(d.target,se?-1:1,"D"),W=d.ctrlKey||d.metaKey,d.originalEvent.altKey&&g.datepicker._adjustDate(d.target,d.ctrlKey?+g.datepicker._get(R,"stepBigMonths"):+g.datepicker._get(R,"stepMonths"),"M");break;case 40:(d.ctrlKey||d.metaKey)&&g.datepicker._adjustDate(d.target,7,"D"),W=d.ctrlKey||d.metaKey;break;default:W=!1}else d.keyCode===36&&d.ctrlKey?g.datepicker._showDatepicker(this):W=!1;W&&(d.preventDefault(),d.stopPropagation())},_doKeyPress:function(d){var b,S,k=g.datepicker._getInst(d.target);if(g.datepicker._get(k,"constrainInput"))return b=g.datepicker._possibleChars(g.datepicker._get(k,"dateFormat")),S=String.fromCharCode(d.charCode==null?d.keyCode:d.charCode),d.ctrlKey||d.metaKey||S<" "||!b||b.indexOf(S)>-1},_doKeyUp:function(d){var b,S=g.datepicker._getInst(d.target);if(S.input.val()!==S.lastVal)try{b=g.datepicker.parseDate(g.datepicker._get(S,"dateFormat"),S.input?S.input.val():null,g.datepicker._getFormatConfig(S)),b&&(g.datepicker._setDateFromField(S),g.datepicker._updateAlternate(S),g.datepicker._updateDatepicker(S))}catch{}return!0},_showDatepicker:function(d){if(d=d.target||d,d.nodeName.toLowerCase()!=="input"&&(d=g("input",d.parentNode)[0]),!(g.datepicker._isDisabledDatepicker(d)||g.datepicker._lastInput===d)){var b,S,k,R,W,se,le;b=g.datepicker._getInst(d),g.datepicker._curInst&&g.datepicker._curInst!==b&&(g.datepicker._curInst.dpDiv.stop(!0,!0),b&&g.datepicker._datepickerShowing&&g.datepicker._hideDatepicker(g.datepicker._curInst.input[0])),S=g.datepicker._get(b,"beforeShow"),k=S?S.apply(d,[d,b]):{},k!==!1&&(Li(b.settings,k),b.lastVal=null,g.datepicker._lastInput=d,g.datepicker._setDateFromField(b),g.datepicker._inDialog&&(d.value=""),g.datepicker._pos||(g.datepicker._pos=g.datepicker._findPos(d),g.datepicker._pos[1]+=d.offsetHeight),R=!1,g(d).parents().each(function(){return R|=g(this).css("position")==="fixed",!R}),W={left:g.datepicker._pos[0],top:g.datepicker._pos[1]},g.datepicker._pos=null,b.dpDiv.empty(),b.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),g.datepicker._updateDatepicker(b),W=g.datepicker._checkOffset(b,W,R),b.dpDiv.css({position:g.datepicker._inDialog&&g.blockUI?"static":R?"fixed":"absolute",display:"none",left:W.left+"px",top:W.top+"px"}),b.inline||(se=g.datepicker._get(b,"showAnim"),le=g.datepicker._get(b,"duration"),b.dpDiv.css("z-index",Yt(g(d))+1),g.datepicker._datepickerShowing=!0,g.effects&&g.effects.effect[se]?b.dpDiv.show(se,g.datepicker._get(b,"showOptions"),le):b.dpDiv[se||"show"](se?le:null),g.datepicker._shouldFocusInput(b)&&b.input.trigger("focus"),g.datepicker._curInst=b))}},_updateDatepicker:function(d){this.maxRows=4,Pt=d,d.dpDiv.empty().append(this._generateHTML(d)),this._attachHandlers(d);var b,S=this._getNumberOfMonths(d),k=S[1],R=17,W=d.dpDiv.find("."+this._dayOverClass+" a"),se=g.datepicker._get(d,"onUpdateDatepicker");W.length>0&&Ei.apply(W.get(0)),d.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),k>1&&d.dpDiv.addClass("ui-datepicker-multi-"+k).css("width",R*k+"em"),d.dpDiv[(S[0]!==1||S[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi"),d.dpDiv[(this._get(d,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),d===g.datepicker._curInst&&g.datepicker._datepickerShowing&&g.datepicker._shouldFocusInput(d)&&d.input.trigger("focus"),d.yearshtml&&(b=d.yearshtml,setTimeout(function(){b===d.yearshtml&&d.yearshtml&&d.dpDiv.find("select.ui-datepicker-year").first().replaceWith(d.yearshtml),b=d.yearshtml=null},0)),se&&se.apply(d.input?d.input[0]:null,[d])},_shouldFocusInput:function(d){return d.input&&d.input.is(":visible")&&!d.input.is(":disabled")&&!d.input.is(":focus")},_checkOffset:function(d,b,S){var k=d.dpDiv.outerWidth(),R=d.dpDiv.outerHeight(),W=d.input?d.input.outerWidth():0,se=d.input?d.input.outerHeight():0,le=document.documentElement.clientWidth+(S?0:g(document).scrollLeft()),fe=document.documentElement.clientHeight+(S?0:g(document).scrollTop());return b.left-=this._get(d,"isRTL")?k-W:0,b.left-=S&&b.left===d.input.offset().left?g(document).scrollLeft():0,b.top-=S&&b.top===d.input.offset().top+se?g(document).scrollTop():0,b.left-=Math.min(b.left,b.left+k>le&&le>k?Math.abs(b.left+k-le):0),b.top-=Math.min(b.top,b.top+R>fe&&fe>R?Math.abs(R+se):0),b},_findPos:function(d){for(var b,S=this._getInst(d),k=this._get(S,"isRTL");d&&(d.type==="hidden"||d.nodeType!==1||g.expr.pseudos.hidden(d));)d=d[k?"previousSibling":"nextSibling"];return b=g(d).offset(),[b.left,b.top]},_hideDatepicker:function(d){var b,S,k,R,W=this._curInst;!W||d&&W!==g.data(d,"datepicker")||this._datepickerShowing&&(b=this._get(W,"showAnim"),S=this._get(W,"duration"),k=function(){g.datepicker._tidyDialog(W)},g.effects&&(g.effects.effect[b]||g.effects[b])?W.dpDiv.hide(b,g.datepicker._get(W,"showOptions"),S,k):W.dpDiv[b==="slideDown"?"slideUp":b==="fadeIn"?"fadeOut":"hide"](b?S:null,k),b||k(),this._datepickerShowing=!1,R=this._get(W,"onClose"),R&&R.apply(W.input?W.input[0]:null,[W.input?W.input.val():"",W]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),g.blockUI&&(g.unblockUI(),g("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(d){d.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(d){if(g.datepicker._curInst){var b=g(d.target),S=g.datepicker._getInst(b[0]);(b[0].id!==g.datepicker._mainDivId&&b.parents("#"+g.datepicker._mainDivId).length===0&&!b.hasClass(g.datepicker.markerClassName)&&!b.closest("."+g.datepicker._triggerClass).length&&g.datepicker._datepickerShowing&&!(g.datepicker._inDialog&&g.blockUI)||b.hasClass(g.datepicker.markerClassName)&&g.datepicker._curInst!==S)&&g.datepicker._hideDatepicker()}},_adjustDate:function(d,b,S){var k=g(d),R=this._getInst(k[0]);this._isDisabledDatepicker(k[0])||(this._adjustInstDate(R,b,S),this._updateDatepicker(R))},_gotoToday:function(d){var b,S=g(d),k=this._getInst(S[0]);this._get(k,"gotoCurrent")&&k.currentDay?(k.selectedDay=k.currentDay,k.drawMonth=k.selectedMonth=k.currentMonth,k.drawYear=k.selectedYear=k.currentYear):(b=new Date,k.selectedDay=b.getDate(),k.drawMonth=k.selectedMonth=b.getMonth(),k.drawYear=k.selectedYear=b.getFullYear()),this._notifyChange(k),this._adjustDate(S)},_selectMonthYear:function(d,b,S){var k=g(d),R=this._getInst(k[0]);R["selected"+(S==="M"?"Month":"Year")]=R["draw"+(S==="M"?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10),this._notifyChange(R),this._adjustDate(k)},_selectDay:function(d,b,S,k){var R,W=g(d);g(k).hasClass(this._unselectableClass)||this._isDisabledDatepicker(W[0])||(R=this._getInst(W[0]),R.selectedDay=R.currentDay=parseInt(g("a",k).attr("data-date")),R.selectedMonth=R.currentMonth=b,R.selectedYear=R.currentYear=S,this._selectDate(d,this._formatDate(R,R.currentDay,R.currentMonth,R.currentYear)))},_clearDate:function(d){var b=g(d);this._selectDate(b,"")},_selectDate:function(d,b){var S,k=g(d),R=this._getInst(k[0]);b=b??this._formatDate(R),R.input&&R.input.val(b),this._updateAlternate(R),S=this._get(R,"onSelect"),S?S.apply(R.input?R.input[0]:null,[b,R]):R.input&&R.input.trigger("change"),R.inline?this._updateDatepicker(R):(this._hideDatepicker(),this._lastInput=R.input[0],typeof R.input[0]!="object"&&R.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(d){var b,S,k,R=this._get(d,"altField");R&&(b=this._get(d,"altFormat")||this._get(d,"dateFormat"),S=this._getDate(d),k=this.formatDate(b,S,this._getFormatConfig(d)),g(document).find(R).val(k))},noWeekends:function(d){var b=d.getDay();return[b>0&&b<6,""]},iso8601Week:function(d){var b,S=new Date(d.getTime());return S.setDate(S.getDate()+4-(S.getDay()||7)),b=S.getTime(),S.setMonth(0),S.setDate(1),Math.floor(Math.round((b-S)/864e5)/7)+1},parseDate:function(d,b,S){if(d==null||b==null)throw"Invalid arguments";if(b=typeof b=="object"?b.toString():b+"",b==="")return null;var k,R,W,se=0,le=(S?S.shortYearCutoff:null)||this._defaults.shortYearCutoff,fe=typeof le!="string"?le:new Date().getFullYear()%100+parseInt(le,10),be=(S?S.dayNamesShort:null)||this._defaults.dayNamesShort,Te=(S?S.dayNames:null)||this._defaults.dayNames,Ve=(S?S.monthNamesShort:null)||this._defaults.monthNamesShort,Ue=(S?S.monthNames:null)||this._defaults.monthNames,me=-1,ke=-1,qe=-1,lt=-1,pt=!1,Ft,zt=function(ri){var ci=k+1<d.length&&d.charAt(k+1)===ri;return ci&&k++,ci},Nt=function(ri){var ci=zt(ri),wt=ri==="@"?14:ri==="!"?20:ri==="y"&&ci?4:ri==="o"?3:2,di=ri==="y"?wt:1,ii=new RegExp("^\\d{"+di+","+wt+"}"),Hi=b.substring(se).match(ii);if(!Hi)throw"Missing number at position "+se;return se+=Hi[0].length,parseInt(Hi[0],10)},Mt=function(ri,ci,wt){var di=-1,ii=g.map(zt(ri)?wt:ci,function(Hi,Vi){return[[Vi,Hi]]}).sort(function(Hi,Vi){return-(Hi[1].length-Vi[1].length)});if(g.each(ii,function(Hi,Vi){var Ot=Vi[1];if(b.substr(se,Ot.length).toLowerCase()===Ot.toLowerCase())return di=Vi[0],se+=Ot.length,!1}),di!==-1)return di+1;throw"Unknown name at position "+se},$t=function(){if(b.charAt(se)!==d.charAt(k))throw"Unexpected literal at position "+se;se++};for(k=0;k<d.length;k++)if(pt)d.charAt(k)==="'"&&!zt("'")?pt=!1:$t();else switch(d.charAt(k)){case"d":qe=Nt("d");break;case"D":Mt("D",be,Te);break;case"o":lt=Nt("o");break;case"m":ke=Nt("m");break;case"M":ke=Mt("M",Ve,Ue);break;case"y":me=Nt("y");break;case"@":Ft=new Date(Nt("@")),me=Ft.getFullYear(),ke=Ft.getMonth()+1,qe=Ft.getDate();break;case"!":Ft=new Date((Nt("!")-this._ticksTo1970)/1e4),me=Ft.getFullYear(),ke=Ft.getMonth()+1,qe=Ft.getDate();break;case"'":zt("'")?$t():pt=!0;break;default:$t()}if(se<b.length&&(W=b.substr(se),!/^\s+/.test(W)))throw"Extra/unparsed characters found in date: "+W;if(me===-1?me=new Date().getFullYear():me<100&&(me+=new Date().getFullYear()-new Date().getFullYear()%100+(me<=fe?0:-100)),lt>-1){ke=1,qe=lt;do{if(R=this._getDaysInMonth(me,ke-1),qe<=R)break;ke++,qe-=R}while(!0)}if(Ft=this._daylightSavingAdjust(new Date(me,ke-1,qe)),Ft.getFullYear()!==me||Ft.getMonth()+1!==ke||Ft.getDate()!==qe)throw"Invalid date";return Ft},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(1969*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*1e7,formatDate:function(d,b,S){if(!b)return"";var k,R=(S?S.dayNamesShort:null)||this._defaults.dayNamesShort,W=(S?S.dayNames:null)||this._defaults.dayNames,se=(S?S.monthNamesShort:null)||this._defaults.monthNamesShort,le=(S?S.monthNames:null)||this._defaults.monthNames,fe=function(me){var ke=k+1<d.length&&d.charAt(k+1)===me;return ke&&k++,ke},be=function(me,ke,qe){var lt=""+ke;if(fe(me))for(;lt.length<qe;)lt="0"+lt;return lt},Te=function(me,ke,qe,lt){return fe(me)?lt[ke]:qe[ke]},Ve="",Ue=!1;if(b)for(k=0;k<d.length;k++)if(Ue)d.charAt(k)==="'"&&!fe("'")?Ue=!1:Ve+=d.charAt(k);else switch(d.charAt(k)){case"d":Ve+=be("d",b.getDate(),2);break;case"D":Ve+=Te("D",b.getDay(),R,W);break;case"o":Ve+=be("o",Math.round((new Date(b.getFullYear(),b.getMonth(),b.getDate()).getTime()-new Date(b.getFullYear(),0,0).getTime())/864e5),3);break;case"m":Ve+=be("m",b.getMonth()+1,2);break;case"M":Ve+=Te("M",b.getMonth(),se,le);break;case"y":Ve+=fe("y")?b.getFullYear():(b.getFullYear()%100<10?"0":"")+b.getFullYear()%100;break;case"@":Ve+=b.getTime();break;case"!":Ve+=b.getTime()*1e4+this._ticksTo1970;break;case"'":fe("'")?Ve+="'":Ue=!0;break;default:Ve+=d.charAt(k)}return Ve},_possibleChars:function(d){var b,S="",k=!1,R=function(W){var se=b+1<d.length&&d.charAt(b+1)===W;return se&&b++,se};for(b=0;b<d.length;b++)if(k)d.charAt(b)==="'"&&!R("'")?k=!1:S+=d.charAt(b);else switch(d.charAt(b)){case"d":case"m":case"y":case"@":S+="0123456789";break;case"D":case"M":return null;case"'":R("'")?S+="'":k=!0;break;default:S+=d.charAt(b)}return S},_get:function(d,b){return d.settings[b]!==void 0?d.settings[b]:this._defaults[b]},_setDateFromField:function(d,b){if(d.input.val()!==d.lastVal){var S=this._get(d,"dateFormat"),k=d.lastVal=d.input?d.input.val():null,R=this._getDefaultDate(d),W=R,se=this._getFormatConfig(d);try{W=this.parseDate(S,k,se)||R}catch{k=b?"":k}d.selectedDay=W.getDate(),d.drawMonth=d.selectedMonth=W.getMonth(),d.drawYear=d.selectedYear=W.getFullYear(),d.currentDay=k?W.getDate():0,d.currentMonth=k?W.getMonth():0,d.currentYear=k?W.getFullYear():0,this._adjustInstDate(d)}},_getDefaultDate:function(d){return this._restrictMinMax(d,this._determineDate(d,this._get(d,"defaultDate"),new Date))},_determineDate:function(d,b,S){var k=function(se){var le=new Date;return le.setDate(le.getDate()+se),le},R=function(se){try{return g.datepicker.parseDate(g.datepicker._get(d,"dateFormat"),se,g.datepicker._getFormatConfig(d))}catch{}for(var le=(se.toLowerCase().match(/^c/)?g.datepicker._getDate(d):null)||new Date,fe=le.getFullYear(),be=le.getMonth(),Te=le.getDate(),Ve=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,Ue=Ve.exec(se);Ue;){switch(Ue[2]||"d"){case"d":case"D":Te+=parseInt(Ue[1],10);break;case"w":case"W":Te+=parseInt(Ue[1],10)*7;break;case"m":case"M":be+=parseInt(Ue[1],10),Te=Math.min(Te,g.datepicker._getDaysInMonth(fe,be));break;case"y":case"Y":fe+=parseInt(Ue[1],10),Te=Math.min(Te,g.datepicker._getDaysInMonth(fe,be));break}Ue=Ve.exec(se)}return new Date(fe,be,Te)},W=b==null||b===""?S:typeof b=="string"?R(b):typeof b=="number"?isNaN(b)?S:k(b):new Date(b.getTime());return W=W&&W.toString()==="Invalid Date"?S:W,W&&(W.setHours(0),W.setMinutes(0),W.setSeconds(0),W.setMilliseconds(0)),this._daylightSavingAdjust(W)},_daylightSavingAdjust:function(d){return d?(d.setHours(d.getHours()>12?d.getHours()+2:0),d):null},_setDate:function(d,b,S){var k=!b,R=d.selectedMonth,W=d.selectedYear,se=this._restrictMinMax(d,this._determineDate(d,b,new Date));d.selectedDay=d.currentDay=se.getDate(),d.drawMonth=d.selectedMonth=d.currentMonth=se.getMonth(),d.drawYear=d.selectedYear=d.currentYear=se.getFullYear(),(R!==d.selectedMonth||W!==d.selectedYear)&&!S&&this._notifyChange(d),this._adjustInstDate(d),d.input&&d.input.val(k?"":this._formatDate(d))},_getDate:function(d){var b=!d.currentYear||d.input&&d.input.val()===""?null:this._daylightSavingAdjust(new Date(d.currentYear,d.currentMonth,d.currentDay));return b},_attachHandlers:function(d){var b=this._get(d,"stepMonths"),S="#"+d.id.replace(/\\\\/g,"\\");d.dpDiv.find("[data-handler]").map(function(){var k={prev:function(){g.datepicker._adjustDate(S,-b,"M")},next:function(){g.datepicker._adjustDate(S,+b,"M")},hide:function(){g.datepicker._hideDatepicker()},today:function(){g.datepicker._gotoToday(S)},selectDay:function(){return g.datepicker._selectDay(S,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return g.datepicker._selectMonthYear(S,this,"M"),!1},selectYear:function(){return g.datepicker._selectMonthYear(S,this,"Y"),!1}};g(this).on(this.getAttribute("data-event"),k[this.getAttribute("data-handler")])})},_generateHTML:function(d){var b,S,k,R,W,se,le,fe,be,Te,Ve,Ue,me,ke,qe,lt,pt,Ft,zt,Nt,Mt,$t,ri,ci,wt,di,ii,Hi,Vi,Ot,_i,Ti,Wi,Zt,mi,bi,$i,tr,Ar,Tr=new Date,ji=this._daylightSavingAdjust(new Date(Tr.getFullYear(),Tr.getMonth(),Tr.getDate())),Ii=this._get(d,"isRTL"),Qs=this._get(d,"showButtonPanel"),$r=this._get(d,"hideIfNoPrevNext"),it=this._get(d,"navigationAsDateFormat"),Ie=this._getNumberOfMonths(d),ce=this._get(d,"showCurrentAtPos"),ye=this._get(d,"stepMonths"),xe=Ie[0]!==1||Ie[1]!==1,Me=this._daylightSavingAdjust(d.currentDay?new Date(d.currentYear,d.currentMonth,d.currentDay):new Date(9999,9,9)),Ge=this._getMinMaxDate(d,"min"),Le=this._getMinMaxDate(d,"max"),Ke=d.drawMonth-ce,st=d.drawYear;if(Ke<0&&(Ke+=12,st--),Le)for(b=this._daylightSavingAdjust(new Date(Le.getFullYear(),Le.getMonth()-Ie[0]*Ie[1]+1,Le.getDate())),b=Ge&&b<Ge?Ge:b;this._daylightSavingAdjust(new Date(st,Ke,1))>b;)Ke--,Ke<0&&(Ke=11,st--);for(d.drawMonth=Ke,d.drawYear=st,S=this._get(d,"prevText"),S=it?this.formatDate(S,this._daylightSavingAdjust(new Date(st,Ke-ye,1)),this._getFormatConfig(d)):S,this._canAdjustMonth(d,-1,st,Ke)?k=g("<a>").attr({class:"ui-datepicker-prev ui-corner-all","data-handler":"prev","data-event":"click",title:S}).append(g("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(Ii?"e":"w")).text(S))[0].outerHTML:$r?k="":k=g("<a>").attr({class:"ui-datepicker-prev ui-corner-all ui-state-disabled",title:S}).append(g("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(Ii?"e":"w")).text(S))[0].outerHTML,R=this._get(d,"nextText"),R=it?this.formatDate(R,this._daylightSavingAdjust(new Date(st,Ke+ye,1)),this._getFormatConfig(d)):R,this._canAdjustMonth(d,1,st,Ke)?W=g("<a>").attr({class:"ui-datepicker-next ui-corner-all","data-handler":"next","data-event":"click",title:R}).append(g("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(Ii?"w":"e")).text(R))[0].outerHTML:$r?W="":W=g("<a>").attr({class:"ui-datepicker-next ui-corner-all ui-state-disabled",title:R}).append(g("<span>").attr("class","ui-icon ui-icon-circle-triangle-"+(Ii?"w":"e")).text(R))[0].outerHTML,se=this._get(d,"currentText"),le=this._get(d,"gotoCurrent")&&d.currentDay?Me:ji,se=it?this.formatDate(se,le,this._getFormatConfig(d)):se,fe="",d.inline||(fe=g("<button>").attr({type:"button",class:"ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all","data-handler":"hide","data-event":"click"}).text(this._get(d,"closeText"))[0].outerHTML),be="",Qs&&(be=g("<div class='ui-datepicker-buttonpane ui-widget-content'>").append(Ii?fe:"").append(this._isInRange(d,le)?g("<button>").attr({type:"button",class:"ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all","data-handler":"today","data-event":"click"}).text(se):"").append(Ii?"":fe)[0].outerHTML),Te=parseInt(this._get(d,"firstDay"),10),Te=isNaN(Te)?0:Te,Ve=this._get(d,"showWeek"),Ue=this._get(d,"dayNames"),me=this._get(d,"dayNamesMin"),ke=this._get(d,"monthNames"),qe=this._get(d,"monthNamesShort"),lt=this._get(d,"beforeShowDay"),pt=this._get(d,"showOtherMonths"),Ft=this._get(d,"selectOtherMonths"),zt=this._getDefaultDate(d),Nt="",$t=0;$t<Ie[0];$t++){for(ri="",this.maxRows=4,ci=0;ci<Ie[1];ci++){if(wt=this._daylightSavingAdjust(new Date(st,Ke,d.selectedDay)),di=" ui-corner-all",ii="",xe){if(ii+="<div class='ui-datepicker-group",Ie[1]>1)switch(ci){case 0:ii+=" ui-datepicker-group-first",di=" ui-corner-"+(Ii?"right":"left");break;case Ie[1]-1:ii+=" ui-datepicker-group-last",di=" ui-corner-"+(Ii?"left":"right");break;default:ii+=" ui-datepicker-group-middle",di="";break}ii+="'>"}for(ii+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+di+"'>"+(/all|left/.test(di)&&$t===0?Ii?W:k:"")+(/all|right/.test(di)&&$t===0?Ii?k:W:"")+this._generateMonthYearHeader(d,Ke,st,Ge,Le,$t>0||ci>0,ke,qe)+"</div><table class='ui-datepicker-calendar'><thead><tr>",Hi=Ve?"<th class='ui-datepicker-week-col'>"+this._get(d,"weekHeader")+"</th>":"",Mt=0;Mt<7;Mt++)Vi=(Mt+Te)%7,Hi+="<th scope='col'"+((Mt+Te+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+Ue[Vi]+"'>"+me[Vi]+"</span></th>";for(ii+=Hi+"</tr></thead><tbody>",Ot=this._getDaysInMonth(st,Ke),st===d.selectedYear&&Ke===d.selectedMonth&&(d.selectedDay=Math.min(d.selectedDay,Ot)),_i=(this._getFirstDayOfMonth(st,Ke)-Te+7)%7,Ti=Math.ceil((_i+Ot)/7),Wi=xe&&this.maxRows>Ti?this.maxRows:Ti,this.maxRows=Wi,Zt=this._daylightSavingAdjust(new Date(st,Ke,1-_i)),mi=0;mi<Wi;mi++){for(ii+="<tr>",bi=Ve?"<td class='ui-datepicker-week-col'>"+this._get(d,"calculateWeek")(Zt)+"</td>":"",Mt=0;Mt<7;Mt++)$i=lt?lt.apply(d.input?d.input[0]:null,[Zt]):[!0,""],tr=Zt.getMonth()!==Ke,Ar=tr&&!Ft||!$i[0]||Ge&&Zt<Ge||Le&&Zt>Le,bi+="<td class='"+((Mt+Te+6)%7>=5?" ui-datepicker-week-end":"")+(tr?" ui-datepicker-other-month":"")+(Zt.getTime()===wt.getTime()&&Ke===d.selectedMonth&&d._keyEvent||zt.getTime()===Zt.getTime()&&zt.getTime()===wt.getTime()?" "+this._dayOverClass:"")+(Ar?" "+this._unselectableClass+" ui-state-disabled":"")+(tr&&!pt?"":" "+$i[1]+(Zt.getTime()===Me.getTime()?" "+this._currentClass:"")+(Zt.getTime()===ji.getTime()?" ui-datepicker-today":""))+"'"+((!tr||pt)&&$i[2]?" title='"+$i[2].replace(/'/g,"&#39;")+"'":"")+(Ar?"":" data-handler='selectDay' data-event='click' data-month='"+Zt.getMonth()+"' data-year='"+Zt.getFullYear()+"'")+">"+(tr&&!pt?"&#xa0;":Ar?"<span class='ui-state-default'>"+Zt.getDate()+"</span>":"<a class='ui-state-default"+(Zt.getTime()===ji.getTime()?" ui-state-highlight":"")+(Zt.getTime()===Me.getTime()?" ui-state-active":"")+(tr?" ui-priority-secondary":"")+"' href='#' aria-current='"+(Zt.getTime()===Me.getTime()?"true":"false")+"' data-date='"+Zt.getDate()+"'>"+Zt.getDate()+"</a>")+"</td>",Zt.setDate(Zt.getDate()+1),Zt=this._daylightSavingAdjust(Zt);ii+=bi+"</tr>"}Ke++,Ke>11&&(Ke=0,st++),ii+="</tbody></table>"+(xe?"</div>"+(Ie[0]>0&&ci===Ie[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),ri+=ii}Nt+=ri}return Nt+=be,d._keyEvent=!1,Nt},_generateMonthYearHeader:function(d,b,S,k,R,W,se,le){var fe,be,Te,Ve,Ue,me,ke,qe,lt=this._get(d,"changeMonth"),pt=this._get(d,"changeYear"),Ft=this._get(d,"showMonthAfterYear"),zt=this._get(d,"selectMonthLabel"),Nt=this._get(d,"selectYearLabel"),Mt="<div class='ui-datepicker-title'>",$t="";if(W||!lt)$t+="<span class='ui-datepicker-month'>"+se[b]+"</span>";else{for(fe=k&&k.getFullYear()===S,be=R&&R.getFullYear()===S,$t+="<select class='ui-datepicker-month' aria-label='"+zt+"' data-handler='selectMonth' data-event='change'>",Te=0;Te<12;Te++)(!fe||Te>=k.getMonth())&&(!be||Te<=R.getMonth())&&($t+="<option value='"+Te+"'"+(Te===b?" selected='selected'":"")+">"+le[Te]+"</option>");$t+="</select>"}if(Ft||(Mt+=$t+(W||!(lt&&pt)?"&#xa0;":"")),!d.yearshtml)if(d.yearshtml="",W||!pt)Mt+="<span class='ui-datepicker-year'>"+S+"</span>";else{for(Ve=this._get(d,"yearRange").split(":"),Ue=new Date().getFullYear(),me=function(ri){var ci=ri.match(/c[+\-].*/)?S+parseInt(ri.substring(1),10):ri.match(/[+\-].*/)?Ue+parseInt(ri,10):parseInt(ri,10);return isNaN(ci)?Ue:ci},ke=me(Ve[0]),qe=Math.max(ke,me(Ve[1]||"")),ke=k?Math.max(ke,k.getFullYear()):ke,qe=R?Math.min(qe,R.getFullYear()):qe,d.yearshtml+="<select class='ui-datepicker-year' aria-label='"+Nt+"' data-handler='selectYear' data-event='change'>";ke<=qe;ke++)d.yearshtml+="<option value='"+ke+"'"+(ke===S?" selected='selected'":"")+">"+ke+"</option>";d.yearshtml+="</select>",Mt+=d.yearshtml,d.yearshtml=null}return Mt+=this._get(d,"yearSuffix"),Ft&&(Mt+=(W||!(lt&&pt)?"&#xa0;":"")+$t),Mt+="</div>",Mt},_adjustInstDate:function(d,b,S){var k=d.selectedYear+(S==="Y"?b:0),R=d.selectedMonth+(S==="M"?b:0),W=Math.min(d.selectedDay,this._getDaysInMonth(k,R))+(S==="D"?b:0),se=this._restrictMinMax(d,this._daylightSavingAdjust(new Date(k,R,W)));d.selectedDay=se.getDate(),d.drawMonth=d.selectedMonth=se.getMonth(),d.drawYear=d.selectedYear=se.getFullYear(),(S==="M"||S==="Y")&&this._notifyChange(d)},_restrictMinMax:function(d,b){var S=this._getMinMaxDate(d,"min"),k=this._getMinMaxDate(d,"max"),R=S&&b<S?S:b;return k&&R>k?k:R},_notifyChange:function(d){var b=this._get(d,"onChangeMonthYear");b&&b.apply(d.input?d.input[0]:null,[d.selectedYear,d.selectedMonth+1,d])},_getNumberOfMonths:function(d){var b=this._get(d,"numberOfMonths");return b==null?[1,1]:typeof b=="number"?[1,b]:b},_getMinMaxDate:function(d,b){return this._determineDate(d,this._get(d,b+"Date"),null)},_getDaysInMonth:function(d,b){return 32-this._daylightSavingAdjust(new Date(d,b,32)).getDate()},_getFirstDayOfMonth:function(d,b){return new Date(d,b,1).getDay()},_canAdjustMonth:function(d,b,S,k){var R=this._getNumberOfMonths(d),W=this._daylightSavingAdjust(new Date(S,k+(b<0?b:R[0]*R[1]),1));return b<0&&W.setDate(this._getDaysInMonth(W.getFullYear(),W.getMonth())),this._isInRange(d,W)},_isInRange:function(d,b){var S,k,R=this._getMinMaxDate(d,"min"),W=this._getMinMaxDate(d,"max"),se=null,le=null,fe=this._get(d,"yearRange");return fe&&(S=fe.split(":"),k=new Date().getFullYear(),se=parseInt(S[0],10),le=parseInt(S[1],10),S[0].match(/[+\-].*/)&&(se+=k),S[1].match(/[+\-].*/)&&(le+=k)),(!R||b.getTime()>=R.getTime())&&(!W||b.getTime()<=W.getTime())&&(!se||b.getFullYear()>=se)&&(!le||b.getFullYear()<=le)},_getFormatConfig:function(d){var b=this._get(d,"shortYearCutoff");return b=typeof b!="string"?b:new Date().getFullYear()%100+parseInt(b,10),{shortYearCutoff:b,dayNamesShort:this._get(d,"dayNamesShort"),dayNames:this._get(d,"dayNames"),monthNamesShort:this._get(d,"monthNamesShort"),monthNames:this._get(d,"monthNames")}},_formatDate:function(d,b,S,k){b||(d.currentDay=d.selectedDay,d.currentMonth=d.selectedMonth,d.currentYear=d.selectedYear);var R=b?typeof b=="object"?b:this._daylightSavingAdjust(new Date(k,S,b)):this._daylightSavingAdjust(new Date(d.currentYear,d.currentMonth,d.currentDay));return this.formatDate(this._get(d,"dateFormat"),R,this._getFormatConfig(d))}});function Ri(d){var b="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return d.on("mouseout",b,function(){g(this).removeClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&g(this).removeClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&g(this).removeClass("ui-datepicker-next-hover")}).on("mouseover",b,Ei)}function Ei(){g.datepicker._isDisabledDatepicker(Pt.inline?Pt.dpDiv.parent()[0]:Pt.input[0])||(g(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),g(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&g(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&g(this).addClass("ui-datepicker-next-hover"))}function Li(d,b){g.extend(d,b);for(var S in b)b[S]==null&&(d[S]=b[S]);return d}g.fn.datepicker=function(d){if(!this.length)return this;g.datepicker.initialized||(g(document).on("mousedown",g.datepicker._checkExternalClick),g.datepicker.initialized=!0),g("#"+g.datepicker._mainDivId).length===0&&g("body").append(g.datepicker.dpDiv);var b=Array.prototype.slice.call(arguments,1);return typeof d=="string"&&(d==="isDisabled"||d==="getDate"||d==="widget")?g.datepicker["_"+d+"Datepicker"].apply(g.datepicker,[this[0]].concat(b)):d==="option"&&arguments.length===2&&typeof arguments[1]=="string"?g.datepicker["_"+d+"Datepicker"].apply(g.datepicker,[this[0]].concat(b)):this.each(function(){typeof d=="string"?g.datepicker["_"+d+"Datepicker"].apply(g.datepicker,[this].concat(b)):g.datepicker._attachDatepicker(this,d)})},g.datepicker=new Ai,g.datepicker.initialized=!1,g.datepicker.uuid=new Date().getTime(),g.datepicker.version="1.13.2",g.datepicker,g.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());/*!
 * jQuery UI Mouse 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */var Yi=!1;g(document).on("mouseup",function(){Yi=!1}),g.widget("ui.mouse",{version:"1.13.2",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var d=this;this.element.on("mousedown."+this.widgetName,function(b){return d._mouseDown(b)}).on("click."+this.widgetName,function(b){if(g.data(b.target,d.widgetName+".preventClickEvent")===!0)return g.removeData(b.target,d.widgetName+".preventClickEvent"),b.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(d){if(!Yi){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(d),this._mouseDownEvent=d;var b=this,S=d.which===1,k=typeof this.options.cancel=="string"&&d.target.nodeName?g(d.target).closest(this.options.cancel).length:!1;return!S||k||!this._mouseCapture(d)?!0:(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){b.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(d)&&this._mouseDelayMet(d)&&(this._mouseStarted=this._mouseStart(d)!==!1,!this._mouseStarted)?(d.preventDefault(),!0):(g.data(d.target,this.widgetName+".preventClickEvent")===!0&&g.removeData(d.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(R){return b._mouseMove(R)},this._mouseUpDelegate=function(R){return b._mouseUp(R)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),d.preventDefault(),Yi=!0,!0))}},_mouseMove:function(d){if(this._mouseMoved){if(g.ui.ie&&(!document.documentMode||document.documentMode<9)&&!d.button)return this._mouseUp(d);if(!d.which){if(d.originalEvent.altKey||d.originalEvent.ctrlKey||d.originalEvent.metaKey||d.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(d)}}return(d.which||d.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(d),d.preventDefault()):(this._mouseDistanceMet(d)&&this._mouseDelayMet(d)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,d)!==!1,this._mouseStarted?this._mouseDrag(d):this._mouseUp(d)),!this._mouseStarted)},_mouseUp:function(d){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,d.target===this._mouseDownEvent.target&&g.data(d.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(d)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,Yi=!1,d.preventDefault()},_mouseDistanceMet:function(d){return Math.max(Math.abs(this._mouseDownEvent.pageX-d.pageX),Math.abs(this._mouseDownEvent.pageY-d.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),g.ui.plugin={add:function(d,b,S){var k,R=g.ui[d].prototype;for(k in S)R.plugins[k]=R.plugins[k]||[],R.plugins[k].push([b,S[k]])},call:function(d,b,S,k){var R,W=d.plugins[b];if(W&&!(!k&&(!d.element[0].parentNode||d.element[0].parentNode.nodeType===11)))for(R=0;R<W.length;R++)d.options[W[R][0]]&&W[R][1].apply(d.element,S)}},g.ui.safeBlur=function(d){d&&d.nodeName.toLowerCase()!=="body"&&g(d).trigger("blur")};/*!
 * jQuery UI Draggable 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.draggable",g.ui.mouse,{version:"1.13.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){this.options.helper==="original"&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(d,b){this._super(d,b),d==="handle"&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){if((this.helper||this.element).is(".ui-draggable-dragging")){this.destroyOnClear=!0;return}this._removeHandleClassName(),this._mouseDestroy()},_mouseCapture:function(d){var b=this.options;return this.helper||b.disabled||g(d.target).closest(".ui-resizable-handle").length>0||(this.handle=this._getHandle(d),!this.handle)?!1:(this._blurActiveElement(d),this._blockFrames(b.iframeFix===!0?"iframe":b.iframeFix),!0)},_blockFrames:function(d){this.iframeBlocks=this.document.find(d).map(function(){var b=g(this);return g("<div>").css("position","absolute").appendTo(b.parent()).outerWidth(b.outerWidth()).outerHeight(b.outerHeight()).offset(b.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(d){var b=g.ui.safeActiveElement(this.document[0]),S=g(d.target);S.closest(b).length||g.ui.safeBlur(b)},_mouseStart:function(d){var b=this.options;return this.helper=this._createHelper(d),this._addClass(this.helper,"ui-draggable-dragging"),this._cacheHelperProportions(),g.ui.ddmanager&&(g.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return g(this).css("position")==="fixed"}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(d),this.originalPosition=this.position=this._generatePosition(d,!1),this.originalPageX=d.pageX,this.originalPageY=d.pageY,b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt),this._setContainment(),this._trigger("start",d)===!1?(this._clear(),!1):(this._cacheHelperProportions(),g.ui.ddmanager&&!b.dropBehaviour&&g.ui.ddmanager.prepareOffsets(this,d),this._mouseDrag(d,!0),g.ui.ddmanager&&g.ui.ddmanager.dragStart(this,d),!0)},_refreshOffsets:function(d){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:d.pageX-this.offset.left,top:d.pageY-this.offset.top}},_mouseDrag:function(d,b){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(d,!0),this.positionAbs=this._convertPositionTo("absolute"),!b){var S=this._uiHash();if(this._trigger("drag",d,S)===!1)return this._mouseUp(new g.Event("mouseup",d)),!1;this.position=S.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",g.ui.ddmanager&&g.ui.ddmanager.drag(this,d),!1},_mouseStop:function(d){var b=this,S=!1;return g.ui.ddmanager&&!this.options.dropBehaviour&&(S=g.ui.ddmanager.drop(this,d)),this.dropped&&(S=this.dropped,this.dropped=!1),this.options.revert==="invalid"&&!S||this.options.revert==="valid"&&S||this.options.revert===!0||typeof this.options.revert=="function"&&this.options.revert.call(this.element,S)?g(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){b._trigger("stop",d)!==!1&&b._clear()}):this._trigger("stop",d)!==!1&&this._clear(),!1},_mouseUp:function(d){return this._unblockFrames(),g.ui.ddmanager&&g.ui.ddmanager.dragStop(this,d),this.handleElement.is(d.target)&&this.element.trigger("focus"),g.ui.mouse.prototype._mouseUp.call(this,d)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new g.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(d){return this.options.handle?!!g(d.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(d){var b=this.options,S=typeof b.helper=="function",k=S?g(b.helper.apply(this.element[0],[d])):b.helper==="clone"?this.element.clone().removeAttr("id"):this.element;return k.parents("body").length||k.appendTo(b.appendTo==="parent"?this.element[0].parentNode:b.appendTo),S&&k[0]===this.element[0]&&this._setPositionRelative(),k[0]!==this.element[0]&&!/(fixed|absolute)/.test(k.css("position"))&&k.css("position","absolute"),k},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(d){typeof d=="string"&&(d=d.split(" ")),Array.isArray(d)&&(d={left:+d[0],top:+d[1]||0}),"left"in d&&(this.offset.click.left=d.left+this.margins.left),"right"in d&&(this.offset.click.left=this.helperProportions.width-d.right+this.margins.left),"top"in d&&(this.offset.click.top=d.top+this.margins.top),"bottom"in d&&(this.offset.click.top=this.helperProportions.height-d.bottom+this.margins.top)},_isRootNode:function(d){return/(html|body)/i.test(d.tagName)||d===this.document[0]},_getParentOffset:function(){var d=this.offsetParent.offset(),b=this.document[0];return this.cssPosition==="absolute"&&this.scrollParent[0]!==b&&g.contains(this.scrollParent[0],this.offsetParent[0])&&(d.left+=this.scrollParent.scrollLeft(),d.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(d={top:0,left:0}),{top:d.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:d.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition!=="relative")return{top:0,left:0};var d=this.element.position(),b=this._isRootNode(this.scrollParent[0]);return{top:d.top-(parseInt(this.helper.css("top"),10)||0)+(b?0:this.scrollParent.scrollTop()),left:d.left-(parseInt(this.helper.css("left"),10)||0)+(b?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var d,b,S,k=this.options,R=this.document[0];if(this.relativeContainer=null,!k.containment){this.containment=null;return}if(k.containment==="window"){this.containment=[g(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,g(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,g(window).scrollLeft()+g(window).width()-this.helperProportions.width-this.margins.left,g(window).scrollTop()+(g(window).height()||R.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(k.containment==="document"){this.containment=[0,0,g(R).width()-this.helperProportions.width-this.margins.left,(g(R).height()||R.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(k.containment.constructor===Array){this.containment=k.containment;return}k.containment==="parent"&&(k.containment=this.helper[0].parentNode),b=g(k.containment),S=b[0],S&&(d=/(scroll|auto)/.test(b.css("overflow")),this.containment=[(parseInt(b.css("borderLeftWidth"),10)||0)+(parseInt(b.css("paddingLeft"),10)||0),(parseInt(b.css("borderTopWidth"),10)||0)+(parseInt(b.css("paddingTop"),10)||0),(d?Math.max(S.scrollWidth,S.offsetWidth):S.offsetWidth)-(parseInt(b.css("borderRightWidth"),10)||0)-(parseInt(b.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(d?Math.max(S.scrollHeight,S.offsetHeight):S.offsetHeight)-(parseInt(b.css("borderBottomWidth"),10)||0)-(parseInt(b.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=b)},_convertPositionTo:function(d,b){b||(b=this.position);var S=d==="absolute"?1:-1,k=this._isRootNode(this.scrollParent[0]);return{top:b.top+this.offset.relative.top*S+this.offset.parent.top*S-(this.cssPosition==="fixed"?-this.offset.scroll.top:k?0:this.offset.scroll.top)*S,left:b.left+this.offset.relative.left*S+this.offset.parent.left*S-(this.cssPosition==="fixed"?-this.offset.scroll.left:k?0:this.offset.scroll.left)*S}},_generatePosition:function(d,b){var S,k,R,W,se=this.options,le=this._isRootNode(this.scrollParent[0]),fe=d.pageX,be=d.pageY;return(!le||!this.offset.scroll)&&(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),b&&(this.containment&&(this.relativeContainer?(k=this.relativeContainer.offset(),S=[this.containment[0]+k.left,this.containment[1]+k.top,this.containment[2]+k.left,this.containment[3]+k.top]):S=this.containment,d.pageX-this.offset.click.left<S[0]&&(fe=S[0]+this.offset.click.left),d.pageY-this.offset.click.top<S[1]&&(be=S[1]+this.offset.click.top),d.pageX-this.offset.click.left>S[2]&&(fe=S[2]+this.offset.click.left),d.pageY-this.offset.click.top>S[3]&&(be=S[3]+this.offset.click.top)),se.grid&&(R=se.grid[1]?this.originalPageY+Math.round((be-this.originalPageY)/se.grid[1])*se.grid[1]:this.originalPageY,be=S?R-this.offset.click.top>=S[1]||R-this.offset.click.top>S[3]?R:R-this.offset.click.top>=S[1]?R-se.grid[1]:R+se.grid[1]:R,W=se.grid[0]?this.originalPageX+Math.round((fe-this.originalPageX)/se.grid[0])*se.grid[0]:this.originalPageX,fe=S?W-this.offset.click.left>=S[0]||W-this.offset.click.left>S[2]?W:W-this.offset.click.left>=S[0]?W-se.grid[0]:W+se.grid[0]:W),se.axis==="y"&&(fe=this.originalPageX),se.axis==="x"&&(be=this.originalPageY)),{top:be-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.offset.scroll.top:le?0:this.offset.scroll.top),left:fe-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.offset.scroll.left:le?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(d,b,S){return S=S||this._uiHash(),g.ui.plugin.call(this,d,[b,S,this],!0),/^(drag|start|stop)/.test(d)&&(this.positionAbs=this._convertPositionTo("absolute"),S.offset=this.positionAbs),g.Widget.prototype._trigger.call(this,d,b,S)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),g.ui.plugin.add("draggable","connectToSortable",{start:function(d,b,S){var k=g.extend({},b,{item:S.element});S.sortables=[],g(S.options.connectToSortable).each(function(){var R=g(this).sortable("instance");R&&!R.options.disabled&&(S.sortables.push(R),R.refreshPositions(),R._trigger("activate",d,k))})},stop:function(d,b,S){var k=g.extend({},b,{item:S.element});S.cancelHelperRemoval=!1,g.each(S.sortables,function(){var R=this;R.isOver?(R.isOver=0,S.cancelHelperRemoval=!0,R.cancelHelperRemoval=!1,R._storedCSS={position:R.placeholder.css("position"),top:R.placeholder.css("top"),left:R.placeholder.css("left")},R._mouseStop(d),R.options.helper=R.options._helper):(R.cancelHelperRemoval=!0,R._trigger("deactivate",d,k))})},drag:function(d,b,S){g.each(S.sortables,function(){var k=!1,R=this;R.positionAbs=S.positionAbs,R.helperProportions=S.helperProportions,R.offset.click=S.offset.click,R._intersectsWith(R.containerCache)&&(k=!0,g.each(S.sortables,function(){return this.positionAbs=S.positionAbs,this.helperProportions=S.helperProportions,this.offset.click=S.offset.click,this!==R&&this._intersectsWith(this.containerCache)&&g.contains(R.element[0],this.element[0])&&(k=!1),k})),k?(R.isOver||(R.isOver=1,S._parent=b.helper.parent(),R.currentItem=b.helper.appendTo(R.element).data("ui-sortable-item",!0),R.options._helper=R.options.helper,R.options.helper=function(){return b.helper[0]},d.target=R.currentItem[0],R._mouseCapture(d,!0),R._mouseStart(d,!0,!0),R.offset.click.top=S.offset.click.top,R.offset.click.left=S.offset.click.left,R.offset.parent.left-=S.offset.parent.left-R.offset.parent.left,R.offset.parent.top-=S.offset.parent.top-R.offset.parent.top,S._trigger("toSortable",d),S.dropped=R.element,g.each(S.sortables,function(){this.refreshPositions()}),S.currentItem=S.element,R.fromOutside=S),R.currentItem&&(R._mouseDrag(d),b.position=R.position)):R.isOver&&(R.isOver=0,R.cancelHelperRemoval=!0,R.options._revert=R.options.revert,R.options.revert=!1,R._trigger("out",d,R._uiHash(R)),R._mouseStop(d,!0),R.options.revert=R.options._revert,R.options.helper=R.options._helper,R.placeholder&&R.placeholder.remove(),b.helper.appendTo(S._parent),S._refreshOffsets(d),b.position=S._generatePosition(d,!0),S._trigger("fromSortable",d),S.dropped=!1,g.each(S.sortables,function(){this.refreshPositions()}))})}}),g.ui.plugin.add("draggable","cursor",{start:function(d,b,S){var k=g("body"),R=S.options;k.css("cursor")&&(R._cursor=k.css("cursor")),k.css("cursor",R.cursor)},stop:function(d,b,S){var k=S.options;k._cursor&&g("body").css("cursor",k._cursor)}}),g.ui.plugin.add("draggable","opacity",{start:function(d,b,S){var k=g(b.helper),R=S.options;k.css("opacity")&&(R._opacity=k.css("opacity")),k.css("opacity",R.opacity)},stop:function(d,b,S){var k=S.options;k._opacity&&g(b.helper).css("opacity",k._opacity)}}),g.ui.plugin.add("draggable","scroll",{start:function(d,b,S){S.scrollParentNotHidden||(S.scrollParentNotHidden=S.helper.scrollParent(!1)),S.scrollParentNotHidden[0]!==S.document[0]&&S.scrollParentNotHidden[0].tagName!=="HTML"&&(S.overflowOffset=S.scrollParentNotHidden.offset())},drag:function(d,b,S){var k=S.options,R=!1,W=S.scrollParentNotHidden[0],se=S.document[0];W!==se&&W.tagName!=="HTML"?((!k.axis||k.axis!=="x")&&(S.overflowOffset.top+W.offsetHeight-d.pageY<k.scrollSensitivity?W.scrollTop=R=W.scrollTop+k.scrollSpeed:d.pageY-S.overflowOffset.top<k.scrollSensitivity&&(W.scrollTop=R=W.scrollTop-k.scrollSpeed)),(!k.axis||k.axis!=="y")&&(S.overflowOffset.left+W.offsetWidth-d.pageX<k.scrollSensitivity?W.scrollLeft=R=W.scrollLeft+k.scrollSpeed:d.pageX-S.overflowOffset.left<k.scrollSensitivity&&(W.scrollLeft=R=W.scrollLeft-k.scrollSpeed))):((!k.axis||k.axis!=="x")&&(d.pageY-g(se).scrollTop()<k.scrollSensitivity?R=g(se).scrollTop(g(se).scrollTop()-k.scrollSpeed):g(window).height()-(d.pageY-g(se).scrollTop())<k.scrollSensitivity&&(R=g(se).scrollTop(g(se).scrollTop()+k.scrollSpeed))),(!k.axis||k.axis!=="y")&&(d.pageX-g(se).scrollLeft()<k.scrollSensitivity?R=g(se).scrollLeft(g(se).scrollLeft()-k.scrollSpeed):g(window).width()-(d.pageX-g(se).scrollLeft())<k.scrollSensitivity&&(R=g(se).scrollLeft(g(se).scrollLeft()+k.scrollSpeed)))),R!==!1&&g.ui.ddmanager&&!k.dropBehaviour&&g.ui.ddmanager.prepareOffsets(S,d)}}),g.ui.plugin.add("draggable","snap",{start:function(d,b,S){var k=S.options;S.snapElements=[],g(k.snap.constructor!==String?k.snap.items||":data(ui-draggable)":k.snap).each(function(){var R=g(this),W=R.offset();this!==S.element[0]&&S.snapElements.push({item:this,width:R.outerWidth(),height:R.outerHeight(),top:W.top,left:W.left})})},drag:function(d,b,S){var k,R,W,se,le,fe,be,Te,Ve,Ue,me=S.options,ke=me.snapTolerance,qe=b.offset.left,lt=qe+S.helperProportions.width,pt=b.offset.top,Ft=pt+S.helperProportions.height;for(Ve=S.snapElements.length-1;Ve>=0;Ve--){if(le=S.snapElements[Ve].left-S.margins.left,fe=le+S.snapElements[Ve].width,be=S.snapElements[Ve].top-S.margins.top,Te=be+S.snapElements[Ve].height,lt<le-ke||qe>fe+ke||Ft<be-ke||pt>Te+ke||!g.contains(S.snapElements[Ve].item.ownerDocument,S.snapElements[Ve].item)){S.snapElements[Ve].snapping&&S.options.snap.release&&S.options.snap.release.call(S.element,d,g.extend(S._uiHash(),{snapItem:S.snapElements[Ve].item})),S.snapElements[Ve].snapping=!1;continue}me.snapMode!=="inner"&&(k=Math.abs(be-Ft)<=ke,R=Math.abs(Te-pt)<=ke,W=Math.abs(le-lt)<=ke,se=Math.abs(fe-qe)<=ke,k&&(b.position.top=S._convertPositionTo("relative",{top:be-S.helperProportions.height,left:0}).top),R&&(b.position.top=S._convertPositionTo("relative",{top:Te,left:0}).top),W&&(b.position.left=S._convertPositionTo("relative",{top:0,left:le-S.helperProportions.width}).left),se&&(b.position.left=S._convertPositionTo("relative",{top:0,left:fe}).left)),Ue=k||R||W||se,me.snapMode!=="outer"&&(k=Math.abs(be-pt)<=ke,R=Math.abs(Te-Ft)<=ke,W=Math.abs(le-qe)<=ke,se=Math.abs(fe-lt)<=ke,k&&(b.position.top=S._convertPositionTo("relative",{top:be,left:0}).top),R&&(b.position.top=S._convertPositionTo("relative",{top:Te-S.helperProportions.height,left:0}).top),W&&(b.position.left=S._convertPositionTo("relative",{top:0,left:le}).left),se&&(b.position.left=S._convertPositionTo("relative",{top:0,left:fe-S.helperProportions.width}).left)),!S.snapElements[Ve].snapping&&(k||R||W||se||Ue)&&S.options.snap.snap&&S.options.snap.snap.call(S.element,d,g.extend(S._uiHash(),{snapItem:S.snapElements[Ve].item})),S.snapElements[Ve].snapping=k||R||W||se||Ue}}}),g.ui.plugin.add("draggable","stack",{start:function(d,b,S){var k,R=S.options,W=g.makeArray(g(R.stack)).sort(function(se,le){return(parseInt(g(se).css("zIndex"),10)||0)-(parseInt(g(le).css("zIndex"),10)||0)});W.length&&(k=parseInt(g(W[0]).css("zIndex"),10)||0,g(W).each(function(se){g(this).css("zIndex",k+se)}),this.css("zIndex",k+W.length))}}),g.ui.plugin.add("draggable","zIndex",{start:function(d,b,S){var k=g(b.helper),R=S.options;k.css("zIndex")&&(R._zIndex=k.css("zIndex")),k.css("zIndex",R.zIndex)},stop:function(d,b,S){var k=S.options;k._zIndex&&g(b.helper).css("zIndex",k._zIndex)}}),g.ui.draggable;/*!
 * jQuery UI Resizable 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.resizable",g.ui.mouse,{version:"1.13.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(d){return parseFloat(d)||0},_isNumber:function(d){return!isNaN(parseFloat(d))},_hasScroll:function(d,b){if(g(d).css("overflow")==="hidden")return!1;var S=b&&b==="left"?"scrollLeft":"scrollTop",k=!1;if(d[S]>0)return!0;try{d[S]=1,k=d[S]>0,d[S]=0}catch{}return k},_create:function(){var d,b=this.options,S=this;this._addClass("ui-resizable"),g.extend(this,{_aspectRatio:!!b.aspectRatio,aspectRatio:b.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:b.helper||b.ghost||b.animate?b.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(g("<div class='ui-wrapper'></div>").css({overflow:"hidden",position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,d={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(d),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css(d),this._proportionallyResize()),this._setupHandles(),b.autoHide&&g(this.element).on("mouseenter",function(){b.disabled||(S._removeClass("ui-resizable-autohide"),S._handles.show())}).on("mouseleave",function(){b.disabled||S.resizing||(S._addClass("ui-resizable-autohide"),S._handles.hide())}),this._mouseInit()},_destroy:function(){this._mouseDestroy(),this._addedHandles.remove();var d,b=function(S){g(S).removeData("resizable").removeData("ui-resizable").off(".resizable")};return this.elementIsWrapper&&(b(this.element),d=this.element,this.originalElement.css({position:d.css("position"),width:d.outerWidth(),height:d.outerHeight(),top:d.css("top"),left:d.css("left")}).insertAfter(d),d.remove()),this.originalElement.css("resize",this.originalResizeStyle),b(this.originalElement),this},_setOption:function(d,b){switch(this._super(d,b),d){case"handles":this._removeHandles(),this._setupHandles();break;case"aspectRatio":this._aspectRatio=!!b;break}},_setupHandles:function(){var d=this.options,b,S,k,R,W,se=this;if(this.handles=d.handles||(g(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=g(),this._addedHandles=g(),this.handles.constructor===String)for(this.handles==="all"&&(this.handles="n,e,s,w,se,sw,ne,nw"),k=this.handles.split(","),this.handles={},S=0;S<k.length;S++)b=String.prototype.trim.call(k[S]),R="ui-resizable-"+b,W=g("<div>"),this._addClass(W,"ui-resizable-handle "+R),W.css({zIndex:d.zIndex}),this.handles[b]=".ui-resizable-"+b,this.element.children(this.handles[b]).length||(this.element.append(W),this._addedHandles=this._addedHandles.add(W));this._renderAxis=function(le){var fe,be,Te,Ve;le=le||this.element;for(fe in this.handles)this.handles[fe].constructor===String?this.handles[fe]=this.element.children(this.handles[fe]).first().show():(this.handles[fe].jquery||this.handles[fe].nodeType)&&(this.handles[fe]=g(this.handles[fe]),this._on(this.handles[fe],{mousedown:se._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(be=g(this.handles[fe],this.element),Ve=/sw|ne|nw|se|n|s/.test(fe)?be.outerHeight():be.outerWidth(),Te=["padding",/ne|nw|n/.test(fe)?"Top":/se|sw|s/.test(fe)?"Bottom":/^e$/.test(fe)?"Right":"Left"].join(""),le.css(Te,Ve),this._proportionallyResize()),this._handles=this._handles.add(this.handles[fe])},this._renderAxis(this.element),this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",function(){se.resizing||(this.className&&(W=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),se.axis=W&&W[1]?W[1]:"se")}),d.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._addedHandles.remove()},_mouseCapture:function(d){var b,S,k=!1;for(b in this.handles)S=g(this.handles[b])[0],(S===d.target||g.contains(S,d.target))&&(k=!0);return!this.options.disabled&&k},_mouseStart:function(d){var b,S,k,R=this.options,W=this.element;return this.resizing=!0,this._renderProxy(),b=this._num(this.helper.css("left")),S=this._num(this.helper.css("top")),R.containment&&(b+=g(R.containment).scrollLeft()||0,S+=g(R.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:b,top:S},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:W.width(),height:W.height()},this.originalSize=this._helper?{width:W.outerWidth(),height:W.outerHeight()}:{width:W.width(),height:W.height()},this.sizeDiff={width:W.outerWidth()-W.width(),height:W.outerHeight()-W.height()},this.originalPosition={left:b,top:S},this.originalMousePosition={left:d.pageX,top:d.pageY},this.aspectRatio=typeof R.aspectRatio=="number"?R.aspectRatio:this.originalSize.width/this.originalSize.height||1,k=g(".ui-resizable-"+this.axis).css("cursor"),g("body").css("cursor",k==="auto"?this.axis+"-resize":k),this._addClass("ui-resizable-resizing"),this._propagate("start",d),!0},_mouseDrag:function(d){var b,S,k=this.originalMousePosition,R=this.axis,W=d.pageX-k.left||0,se=d.pageY-k.top||0,le=this._change[R];return this._updatePrevProperties(),le&&(b=le.apply(this,[d,W,se]),this._updateVirtualBoundaries(d.shiftKey),(this._aspectRatio||d.shiftKey)&&(b=this._updateRatio(b,d)),b=this._respectSize(b,d),this._updateCache(b),this._propagate("resize",d),S=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),g.isEmptyObject(S)||(this._updatePrevProperties(),this._trigger("resize",d,this.ui()),this._applyChanges())),!1},_mouseStop:function(d){this.resizing=!1;var b,S,k,R,W,se,le,fe=this.options,be=this;return this._helper&&(b=this._proportionallyResizeElements,S=b.length&&/textarea/i.test(b[0].nodeName),k=S&&this._hasScroll(b[0],"left")?0:be.sizeDiff.height,R=S?0:be.sizeDiff.width,W={width:be.helper.width()-R,height:be.helper.height()-k},se=parseFloat(be.element.css("left"))+(be.position.left-be.originalPosition.left)||null,le=parseFloat(be.element.css("top"))+(be.position.top-be.originalPosition.top)||null,fe.animate||this.element.css(g.extend(W,{top:le,left:se})),be.helper.height(be.size.height),be.helper.width(be.size.width),this._helper&&!fe.animate&&this._proportionallyResize()),g("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",d),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize={width:this.size.width,height:this.size.height}},_applyChanges:function(){var d={};return this.position.top!==this.prevPosition.top&&(d.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(d.left=this.position.left+"px"),this.size.width!==this.prevSize.width&&(d.width=this.size.width+"px"),this.size.height!==this.prevSize.height&&(d.height=this.size.height+"px"),this.helper.css(d),d},_updateVirtualBoundaries:function(d){var b,S,k,R,W,se=this.options;W={minWidth:this._isNumber(se.minWidth)?se.minWidth:0,maxWidth:this._isNumber(se.maxWidth)?se.maxWidth:1/0,minHeight:this._isNumber(se.minHeight)?se.minHeight:0,maxHeight:this._isNumber(se.maxHeight)?se.maxHeight:1/0},(this._aspectRatio||d)&&(b=W.minHeight*this.aspectRatio,k=W.minWidth/this.aspectRatio,S=W.maxHeight*this.aspectRatio,R=W.maxWidth/this.aspectRatio,b>W.minWidth&&(W.minWidth=b),k>W.minHeight&&(W.minHeight=k),S<W.maxWidth&&(W.maxWidth=S),R<W.maxHeight&&(W.maxHeight=R)),this._vBoundaries=W},_updateCache:function(d){this.offset=this.helper.offset(),this._isNumber(d.left)&&(this.position.left=d.left),this._isNumber(d.top)&&(this.position.top=d.top),this._isNumber(d.height)&&(this.size.height=d.height),this._isNumber(d.width)&&(this.size.width=d.width)},_updateRatio:function(d){var b=this.position,S=this.size,k=this.axis;return this._isNumber(d.height)?d.width=d.height*this.aspectRatio:this._isNumber(d.width)&&(d.height=d.width/this.aspectRatio),k==="sw"&&(d.left=b.left+(S.width-d.width),d.top=null),k==="nw"&&(d.top=b.top+(S.height-d.height),d.left=b.left+(S.width-d.width)),d},_respectSize:function(d){var b=this._vBoundaries,S=this.axis,k=this._isNumber(d.width)&&b.maxWidth&&b.maxWidth<d.width,R=this._isNumber(d.height)&&b.maxHeight&&b.maxHeight<d.height,W=this._isNumber(d.width)&&b.minWidth&&b.minWidth>d.width,se=this._isNumber(d.height)&&b.minHeight&&b.minHeight>d.height,le=this.originalPosition.left+this.originalSize.width,fe=this.originalPosition.top+this.originalSize.height,be=/sw|nw|w/.test(S),Te=/nw|ne|n/.test(S);return W&&(d.width=b.minWidth),se&&(d.height=b.minHeight),k&&(d.width=b.maxWidth),R&&(d.height=b.maxHeight),W&&be&&(d.left=le-b.minWidth),k&&be&&(d.left=le-b.maxWidth),se&&Te&&(d.top=fe-b.minHeight),R&&Te&&(d.top=fe-b.maxHeight),!d.width&&!d.height&&!d.left&&d.top?d.top=null:!d.width&&!d.height&&!d.top&&d.left&&(d.left=null),d},_getPaddingPlusBorderDimensions:function(d){for(var b=0,S=[],k=[d.css("borderTopWidth"),d.css("borderRightWidth"),d.css("borderBottomWidth"),d.css("borderLeftWidth")],R=[d.css("paddingTop"),d.css("paddingRight"),d.css("paddingBottom"),d.css("paddingLeft")];b<4;b++)S[b]=parseFloat(k[b])||0,S[b]+=parseFloat(R[b])||0;return{height:S[0]+S[2],width:S[1]+S[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var d,b=0,S=this.helper||this.element;b<this._proportionallyResizeElements.length;b++)d=this._proportionallyResizeElements[b],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(d)),d.css({height:S.height()-this.outerDimensions.height||0,width:S.width()-this.outerDimensions.width||0})},_renderProxy:function(){var d=this.element,b=this.options;this.elementOffset=d.offset(),this._helper?(this.helper=this.helper||g("<div></div>").css({overflow:"hidden"}),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++b.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(d,b){return{width:this.originalSize.width+b}},w:function(d,b){var S=this.originalSize,k=this.originalPosition;return{left:k.left+b,width:S.width-b}},n:function(d,b,S){var k=this.originalSize,R=this.originalPosition;return{top:R.top+S,height:k.height-S}},s:function(d,b,S){return{height:this.originalSize.height+S}},se:function(d,b,S){return g.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[d,b,S]))},sw:function(d,b,S){return g.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[d,b,S]))},ne:function(d,b,S){return g.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[d,b,S]))},nw:function(d,b,S){return g.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[d,b,S]))}},_propagate:function(d,b){g.ui.plugin.call(this,d,[b,this.ui()]),d!=="resize"&&this._trigger(d,b,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),g.ui.plugin.add("resizable","animate",{stop:function(d){var b=g(this).resizable("instance"),S=b.options,k=b._proportionallyResizeElements,R=k.length&&/textarea/i.test(k[0].nodeName),W=R&&b._hasScroll(k[0],"left")?0:b.sizeDiff.height,se=R?0:b.sizeDiff.width,le={width:b.size.width-se,height:b.size.height-W},fe=parseFloat(b.element.css("left"))+(b.position.left-b.originalPosition.left)||null,be=parseFloat(b.element.css("top"))+(b.position.top-b.originalPosition.top)||null;b.element.animate(g.extend(le,be&&fe?{top:be,left:fe}:{}),{duration:S.animateDuration,easing:S.animateEasing,step:function(){var Te={width:parseFloat(b.element.css("width")),height:parseFloat(b.element.css("height")),top:parseFloat(b.element.css("top")),left:parseFloat(b.element.css("left"))};k&&k.length&&g(k[0]).css({width:Te.width,height:Te.height}),b._updateCache(Te),b._propagate("resize",d)}})}}),g.ui.plugin.add("resizable","containment",{start:function(){var d,b,S,k,R,W,se,le=g(this).resizable("instance"),fe=le.options,be=le.element,Te=fe.containment,Ve=Te instanceof g?Te.get(0):/parent/.test(Te)?be.parent().get(0):Te;Ve&&(le.containerElement=g(Ve),/document/.test(Te)||Te===document?(le.containerOffset={left:0,top:0},le.containerPosition={left:0,top:0},le.parentData={element:g(document),left:0,top:0,width:g(document).width(),height:g(document).height()||document.body.parentNode.scrollHeight}):(d=g(Ve),b=[],g(["Top","Right","Left","Bottom"]).each(function(Ue,me){b[Ue]=le._num(d.css("padding"+me))}),le.containerOffset=d.offset(),le.containerPosition=d.position(),le.containerSize={height:d.innerHeight()-b[3],width:d.innerWidth()-b[1]},S=le.containerOffset,k=le.containerSize.height,R=le.containerSize.width,W=le._hasScroll(Ve,"left")?Ve.scrollWidth:R,se=le._hasScroll(Ve)?Ve.scrollHeight:k,le.parentData={element:Ve,left:S.left,top:S.top,width:W,height:se}))},resize:function(d){var b,S,k,R,W=g(this).resizable("instance"),se=W.options,le=W.containerOffset,fe=W.position,be=W._aspectRatio||d.shiftKey,Te={top:0,left:0},Ve=W.containerElement,Ue=!0;Ve[0]!==document&&/static/.test(Ve.css("position"))&&(Te=le),fe.left<(W._helper?le.left:0)&&(W.size.width=W.size.width+(W._helper?W.position.left-le.left:W.position.left-Te.left),be&&(W.size.height=W.size.width/W.aspectRatio,Ue=!1),W.position.left=se.helper?le.left:0),fe.top<(W._helper?le.top:0)&&(W.size.height=W.size.height+(W._helper?W.position.top-le.top:W.position.top),be&&(W.size.width=W.size.height*W.aspectRatio,Ue=!1),W.position.top=W._helper?le.top:0),k=W.containerElement.get(0)===W.element.parent().get(0),R=/relative|absolute/.test(W.containerElement.css("position")),k&&R?(W.offset.left=W.parentData.left+W.position.left,W.offset.top=W.parentData.top+W.position.top):(W.offset.left=W.element.offset().left,W.offset.top=W.element.offset().top),b=Math.abs(W.sizeDiff.width+(W._helper?W.offset.left-Te.left:W.offset.left-le.left)),S=Math.abs(W.sizeDiff.height+(W._helper?W.offset.top-Te.top:W.offset.top-le.top)),b+W.size.width>=W.parentData.width&&(W.size.width=W.parentData.width-b,be&&(W.size.height=W.size.width/W.aspectRatio,Ue=!1)),S+W.size.height>=W.parentData.height&&(W.size.height=W.parentData.height-S,be&&(W.size.width=W.size.height*W.aspectRatio,Ue=!1)),Ue||(W.position.left=W.prevPosition.left,W.position.top=W.prevPosition.top,W.size.width=W.prevSize.width,W.size.height=W.prevSize.height)},stop:function(){var d=g(this).resizable("instance"),b=d.options,S=d.containerOffset,k=d.containerPosition,R=d.containerElement,W=g(d.helper),se=W.offset(),le=W.outerWidth()-d.sizeDiff.width,fe=W.outerHeight()-d.sizeDiff.height;d._helper&&!b.animate&&/relative/.test(R.css("position"))&&g(this).css({left:se.left-k.left-S.left,width:le,height:fe}),d._helper&&!b.animate&&/static/.test(R.css("position"))&&g(this).css({left:se.left-k.left-S.left,width:le,height:fe})}}),g.ui.plugin.add("resizable","alsoResize",{start:function(){var d=g(this).resizable("instance"),b=d.options;g(b.alsoResize).each(function(){var S=g(this);S.data("ui-resizable-alsoresize",{width:parseFloat(S.width()),height:parseFloat(S.height()),left:parseFloat(S.css("left")),top:parseFloat(S.css("top"))})})},resize:function(d,b){var S=g(this).resizable("instance"),k=S.options,R=S.originalSize,W=S.originalPosition,se={height:S.size.height-R.height||0,width:S.size.width-R.width||0,top:S.position.top-W.top||0,left:S.position.left-W.left||0};g(k.alsoResize).each(function(){var le=g(this),fe=g(this).data("ui-resizable-alsoresize"),be={},Te=le.parents(b.originalElement[0]).length?["width","height"]:["width","height","top","left"];g.each(Te,function(Ve,Ue){var me=(fe[Ue]||0)+(se[Ue]||0);me&&me>=0&&(be[Ue]=me||null)}),le.css(be)})},stop:function(){g(this).removeData("ui-resizable-alsoresize")}}),g.ui.plugin.add("resizable","ghost",{start:function(){var d=g(this).resizable("instance"),b=d.size;d.ghost=d.originalElement.clone(),d.ghost.css({opacity:.25,display:"block",position:"relative",height:b.height,width:b.width,margin:0,left:0,top:0}),d._addClass(d.ghost,"ui-resizable-ghost"),g.uiBackCompat!==!1&&typeof d.options.ghost=="string"&&d.ghost.addClass(this.options.ghost),d.ghost.appendTo(d.helper)},resize:function(){var d=g(this).resizable("instance");d.ghost&&d.ghost.css({position:"relative",height:d.size.height,width:d.size.width})},stop:function(){var d=g(this).resizable("instance");d.ghost&&d.helper&&d.helper.get(0).removeChild(d.ghost.get(0))}}),g.ui.plugin.add("resizable","grid",{resize:function(){var d,b=g(this).resizable("instance"),S=b.options,k=b.size,R=b.originalSize,W=b.originalPosition,se=b.axis,le=typeof S.grid=="number"?[S.grid,S.grid]:S.grid,fe=le[0]||1,be=le[1]||1,Te=Math.round((k.width-R.width)/fe)*fe,Ve=Math.round((k.height-R.height)/be)*be,Ue=R.width+Te,me=R.height+Ve,ke=S.maxWidth&&S.maxWidth<Ue,qe=S.maxHeight&&S.maxHeight<me,lt=S.minWidth&&S.minWidth>Ue,pt=S.minHeight&&S.minHeight>me;S.grid=le,lt&&(Ue+=fe),pt&&(me+=be),ke&&(Ue-=fe),qe&&(me-=be),/^(se|s|e)$/.test(se)?(b.size.width=Ue,b.size.height=me):/^(ne)$/.test(se)?(b.size.width=Ue,b.size.height=me,b.position.top=W.top-Ve):/^(sw)$/.test(se)?(b.size.width=Ue,b.size.height=me,b.position.left=W.left-Te):((me-be<=0||Ue-fe<=0)&&(d=b._getPaddingPlusBorderDimensions(this)),me-be>0?(b.size.height=me,b.position.top=W.top-Ve):(me=be-d.height,b.size.height=me,b.position.top=W.top+R.height-me),Ue-fe>0?(b.size.width=Ue,b.position.left=W.left-Te):(Ue=fe-d.width,b.size.width=Ue,b.position.left=W.left+R.width-Ue))}}),g.ui.resizable;/*!
 * jQuery UI Dialog 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.dialog",{version:"1.13.2",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(d){var b=g(this).css(d).offset().top;b<0&&g(this).css("top",d.top-b)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title==null&&this.originalTitle!=null&&(this.options.title=this.originalTitle),this.options.disabled&&(this.options.disabled=!1),this._createWrapper(),this.element.show().removeAttr("title").appendTo(this.uiDialog),this._addClass("ui-dialog-content","ui-widget-content"),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&g.fn.draggable&&this._makeDraggable(),this.options.resizable&&g.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var d=this.options.appendTo;return d&&(d.jquery||d.nodeType)?g(d):this.document.find(d||"body").eq(0)},_destroy:function(){var d,b=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().css(this.originalCss).detach(),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),d=b.parent.children().eq(b.index),d.length&&d[0]!==this.element[0]?d.before(this.element):b.parent.append(this.element)},widget:function(){return this.uiDialog},disable:g.noop,enable:g.noop,close:function(d){var b=this;!this._isOpen||this._trigger("beforeClose",d)===!1||(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||g.ui.safeBlur(g.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,function(){b._trigger("close",d)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(d,b){var S=!1,k=this.uiDialog.siblings(".ui-front:visible").map(function(){return+g(this).css("z-index")}).get(),R=Math.max.apply(null,k);return R>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",R+1),S=!0),S&&!b&&this._trigger("focus",d),S},open:function(){var d=this;if(this._isOpen){this._moveToTop()&&this._focusTabbable();return}this._isOpen=!0,this.opener=g(g.ui.safeActiveElement(this.document[0])),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){d._focusTabbable(),d._trigger("focus")}),this._makeFocusTarget(),this._trigger("open")},_focusTabbable:function(){var d=this._focusedElement;d||(d=this.element.find("[autofocus]")),d.length||(d=this.element.find(":tabbable")),d.length||(d=this.uiDialogButtonPane.find(":tabbable")),d.length||(d=this.uiDialogTitlebarClose.filter(":tabbable")),d.length||(d=this.uiDialog),d.eq(0).trigger("focus")},_restoreTabbableFocus:function(){var d=g.ui.safeActiveElement(this.document[0]),b=this.uiDialog[0]===d||g.contains(this.uiDialog[0],d);b||this._focusTabbable()},_keepFocus:function(d){d.preventDefault(),this._restoreTabbableFocus(),this._delay(this._restoreTabbableFocus)},_createWrapper:function(){this.uiDialog=g("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front"),this._on(this.uiDialog,{keydown:function(d){if(this.options.closeOnEscape&&!d.isDefaultPrevented()&&d.keyCode&&d.keyCode===g.ui.keyCode.ESCAPE){d.preventDefault(),this.close(d);return}if(!(d.keyCode!==g.ui.keyCode.TAB||d.isDefaultPrevented())){var b=this.uiDialog.find(":tabbable"),S=b.first(),k=b.last();(d.target===k[0]||d.target===this.uiDialog[0])&&!d.shiftKey?(this._delay(function(){S.trigger("focus")}),d.preventDefault()):(d.target===S[0]||d.target===this.uiDialog[0])&&d.shiftKey&&(this._delay(function(){k.trigger("focus")}),d.preventDefault())}},mousedown:function(d){this._moveToTop(d)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var d;this.uiDialogTitlebar=g("<div>"),this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix"),this._on(this.uiDialogTitlebar,{mousedown:function(b){g(b.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}}),this.uiDialogTitlebarClose=g("<button type='button'></button>").button({label:g("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:!1}).appendTo(this.uiDialogTitlebar),this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close"),this._on(this.uiDialogTitlebarClose,{click:function(b){b.preventDefault(),this.close(b)}}),d=g("<span>").uniqueId().prependTo(this.uiDialogTitlebar),this._addClass(d,"ui-dialog-title"),this._title(d),this.uiDialogTitlebar.prependTo(this.uiDialog),this.uiDialog.attr({"aria-labelledby":d.attr("id")})},_title:function(d){this.options.title?d.text(this.options.title):d.html("&#160;")},_createButtonPane:function(){this.uiDialogButtonPane=g("<div>"),this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix"),this.uiButtonSet=g("<div>").appendTo(this.uiDialogButtonPane),this._addClass(this.uiButtonSet,"ui-dialog-buttonset"),this._createButtons()},_createButtons:function(){var d=this,b=this.options.buttons;if(this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),g.isEmptyObject(b)||Array.isArray(b)&&!b.length){this._removeClass(this.uiDialog,"ui-dialog-buttons");return}g.each(b,function(S,k){var R,W;k=typeof k=="function"?{click:k,text:S}:k,k=g.extend({type:"button"},k),R=k.click,W={icon:k.icon,iconPosition:k.iconPosition,showLabel:k.showLabel,icons:k.icons,text:k.text},delete k.click,delete k.icon,delete k.iconPosition,delete k.showLabel,delete k.icons,typeof k.text=="boolean"&&delete k.text,g("<button></button>",k).button(W).appendTo(d.uiButtonSet).on("click",function(){R.apply(d.element[0],arguments)})}),this._addClass(this.uiDialog,"ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){var d=this,b=this.options;function S(k){return{position:k.position,offset:k.offset}}this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(k,R){d._addClass(g(this),"ui-dialog-dragging"),d._blockFrames(),d._trigger("dragStart",k,S(R))},drag:function(k,R){d._trigger("drag",k,S(R))},stop:function(k,R){var W=R.offset.left-d.document.scrollLeft(),se=R.offset.top-d.document.scrollTop();b.position={my:"left top",at:"left"+(W>=0?"+":"")+W+" top"+(se>=0?"+":"")+se,of:d.window},d._removeClass(g(this),"ui-dialog-dragging"),d._unblockFrames(),d._trigger("dragStop",k,S(R))}})},_makeResizable:function(){var d=this,b=this.options,S=b.resizable,k=this.uiDialog.css("position"),R=typeof S=="string"?S:"n,e,s,w,se,sw,ne,nw";function W(se){return{originalPosition:se.originalPosition,originalSize:se.originalSize,position:se.position,size:se.size}}this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:b.maxWidth,maxHeight:b.maxHeight,minWidth:b.minWidth,minHeight:this._minHeight(),handles:R,start:function(se,le){d._addClass(g(this),"ui-dialog-resizing"),d._blockFrames(),d._trigger("resizeStart",se,W(le))},resize:function(se,le){d._trigger("resize",se,W(le))},stop:function(se,le){var fe=d.uiDialog.offset(),be=fe.left-d.document.scrollLeft(),Te=fe.top-d.document.scrollTop();b.height=d.uiDialog.height(),b.width=d.uiDialog.width(),b.position={my:"left top",at:"left"+(be>=0?"+":"")+be+" top"+(Te>=0?"+":"")+Te,of:d.window},d._removeClass(g(this),"ui-dialog-resizing"),d._unblockFrames(),d._trigger("resizeStop",se,W(le))}}).css("position",k)},_trackFocus:function(){this._on(this.widget(),{focusin:function(d){this._makeFocusTarget(),this._focusedElement=g(d.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var d=this._trackingInstances(),b=g.inArray(this,d);b!==-1&&d.splice(b,1)},_trackingInstances:function(){var d=this.document.data("ui-dialog-instances");return d||(d=[],this.document.data("ui-dialog-instances",d)),d},_minHeight:function(){var d=this.options;return d.height==="auto"?d.minHeight:Math.min(d.minHeight,d.height)},_position:function(){var d=this.uiDialog.is(":visible");d||this.uiDialog.show(),this.uiDialog.position(this.options.position),d||this.uiDialog.hide()},_setOptions:function(d){var b=this,S=!1,k={};g.each(d,function(R,W){b._setOption(R,W),R in b.sizeRelatedOptions&&(S=!0),R in b.resizableRelatedOptions&&(k[R]=W)}),S&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",k)},_setOption:function(d,b){var S,k,R=this.uiDialog;d!=="disabled"&&(this._super(d,b),d==="appendTo"&&this.uiDialog.appendTo(this._appendTo()),d==="buttons"&&this._createButtons(),d==="closeText"&&this.uiDialogTitlebarClose.button({label:g("<a>").text(""+this.options.closeText).html()}),d==="draggable"&&(S=R.is(":data(ui-draggable)"),S&&!b&&R.draggable("destroy"),!S&&b&&this._makeDraggable()),d==="position"&&this._position(),d==="resizable"&&(k=R.is(":data(ui-resizable)"),k&&!b&&R.resizable("destroy"),k&&typeof b=="string"&&R.resizable("option","handles",b),!k&&b!==!1&&this._makeResizable()),d==="title"&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var d,b,S,k=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),k.minWidth>k.width&&(k.width=k.minWidth),d=this.uiDialog.css({height:"auto",width:k.width}).outerHeight(),b=Math.max(0,k.minHeight-d),S=typeof k.maxHeight=="number"?Math.max(0,k.maxHeight-d):"none",k.height==="auto"?this.element.css({minHeight:b,maxHeight:S,height:"auto"}):this.element.height(Math.max(0,k.height-d)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var d=g(this);return g("<div>").css({position:"absolute",width:d.outerWidth(),height:d.outerHeight()}).appendTo(d.parent()).offset(d.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(d){return g(d.target).closest(".ui-dialog").length?!0:!!g(d.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var d=g.fn.jquery.substring(0,4),b=!0;this._delay(function(){b=!1}),this.document.data("ui-dialog-overlays")||this.document.on("focusin.ui-dialog",(function(S){if(!b){var k=this._trackingInstances()[0];k._allowInteraction(S)||(S.preventDefault(),k._focusTabbable(),(d==="3.4."||d==="3.5.")&&k._delay(k._restoreTabbableFocus))}}).bind(this)),this.overlay=g("<div>").appendTo(this._appendTo()),this._addClass(this.overlay,null,"ui-widget-overlay ui-front"),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)}},_destroyOverlay:function(){if(this.options.modal&&this.overlay){var d=this.document.data("ui-dialog-overlays")-1;d?this.document.data("ui-dialog-overlays",d):(this.document.off("focusin.ui-dialog"),this.document.removeData("ui-dialog-overlays")),this.overlay.remove(),this.overlay=null}}}),g.uiBackCompat!==!1&&g.widget("ui.dialog",g.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super(),this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(d,b){d==="dialogClass"&&this.uiDialog.removeClass(this.options.dialogClass).addClass(b),this._superApply(arguments)}}),g.ui.dialog;/*!
 * jQuery UI Droppable 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.droppable",{version:"1.13.2",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var d,b=this.options,S=b.accept;this.isover=!1,this.isout=!0,this.accept=typeof S=="function"?S:function(k){return k.is(S)},this.proportions=function(){if(arguments.length)d=arguments[0];else return d||(d={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight})},this._addToManager(b.scope),b.addClasses&&this._addClass("ui-droppable")},_addToManager:function(d){g.ui.ddmanager.droppables[d]=g.ui.ddmanager.droppables[d]||[],g.ui.ddmanager.droppables[d].push(this)},_splice:function(d){for(var b=0;b<d.length;b++)d[b]===this&&d.splice(b,1)},_destroy:function(){var d=g.ui.ddmanager.droppables[this.options.scope];this._splice(d)},_setOption:function(d,b){if(d==="accept")this.accept=typeof b=="function"?b:function(k){return k.is(b)};else if(d==="scope"){var S=g.ui.ddmanager.droppables[this.options.scope];this._splice(S),this._addToManager(b)}this._super(d,b)},_activate:function(d){var b=g.ui.ddmanager.current;this._addActiveClass(),b&&this._trigger("activate",d,this.ui(b))},_deactivate:function(d){var b=g.ui.ddmanager.current;this._removeActiveClass(),b&&this._trigger("deactivate",d,this.ui(b))},_over:function(d){var b=g.ui.ddmanager.current;!b||(b.currentItem||b.element)[0]===this.element[0]||this.accept.call(this.element[0],b.currentItem||b.element)&&(this._addHoverClass(),this._trigger("over",d,this.ui(b)))},_out:function(d){var b=g.ui.ddmanager.current;!b||(b.currentItem||b.element)[0]===this.element[0]||this.accept.call(this.element[0],b.currentItem||b.element)&&(this._removeHoverClass(),this._trigger("out",d,this.ui(b)))},_drop:function(d,b){var S=b||g.ui.ddmanager.current,k=!1;return!S||(S.currentItem||S.element)[0]===this.element[0]||(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var R=g(this).droppable("instance");if(R.options.greedy&&!R.options.disabled&&R.options.scope===S.options.scope&&R.accept.call(R.element[0],S.currentItem||S.element)&&g.ui.intersect(S,g.extend(R,{offset:R.element.offset()}),R.options.tolerance,d))return k=!0,!1}),k)?!1:this.accept.call(this.element[0],S.currentItem||S.element)?(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",d,this.ui(S)),this.element):!1},ui:function(d){return{draggable:d.currentItem||d.element,helper:d.helper,position:d.position,offset:d.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}}),g.ui.intersect=function(){function d(b,S,k){return b>=S&&b<S+k}return function(b,S,k,R){if(!S.offset)return!1;var W=(b.positionAbs||b.position.absolute).left+b.margins.left,se=(b.positionAbs||b.position.absolute).top+b.margins.top,le=W+b.helperProportions.width,fe=se+b.helperProportions.height,be=S.offset.left,Te=S.offset.top,Ve=be+S.proportions().width,Ue=Te+S.proportions().height;switch(k){case"fit":return be<=W&&le<=Ve&&Te<=se&&fe<=Ue;case"intersect":return be<W+b.helperProportions.width/2&&le-b.helperProportions.width/2<Ve&&Te<se+b.helperProportions.height/2&&fe-b.helperProportions.height/2<Ue;case"pointer":return d(R.pageY,Te,S.proportions().height)&&d(R.pageX,be,S.proportions().width);case"touch":return(se>=Te&&se<=Ue||fe>=Te&&fe<=Ue||se<Te&&fe>Ue)&&(W>=be&&W<=Ve||le>=be&&le<=Ve||W<be&&le>Ve);default:return!1}}}(),g.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(d,b){var S,k,R=g.ui.ddmanager.droppables[d.options.scope]||[],W=b?b.type:null,se=(d.currentItem||d.element).find(":data(ui-droppable)").addBack();e:for(S=0;S<R.length;S++)if(!(R[S].options.disabled||d&&!R[S].accept.call(R[S].element[0],d.currentItem||d.element))){for(k=0;k<se.length;k++)if(se[k]===R[S].element[0]){R[S].proportions().height=0;continue e}R[S].visible=R[S].element.css("display")!=="none",R[S].visible&&(W==="mousedown"&&R[S]._activate.call(R[S],b),R[S].offset=R[S].element.offset(),R[S].proportions({width:R[S].element[0].offsetWidth,height:R[S].element[0].offsetHeight}))}},drop:function(d,b){var S=!1;return g.each((g.ui.ddmanager.droppables[d.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&g.ui.intersect(d,this,this.options.tolerance,b)&&(S=this._drop.call(this,b)||S),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],d.currentItem||d.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,b)))}),S},dragStart:function(d,b){d.element.parentsUntil("body").on("scroll.droppable",function(){d.options.refreshPositions||g.ui.ddmanager.prepareOffsets(d,b)})},drag:function(d,b){d.options.refreshPositions&&g.ui.ddmanager.prepareOffsets(d,b),g.each(g.ui.ddmanager.droppables[d.options.scope]||[],function(){if(!(this.options.disabled||this.greedyChild||!this.visible)){var S,k,R,W=g.ui.intersect(d,this,this.options.tolerance,b),se=!W&&this.isover?"isout":W&&!this.isover?"isover":null;se&&(this.options.greedy&&(k=this.options.scope,R=this.element.parents(":data(ui-droppable)").filter(function(){return g(this).droppable("instance").options.scope===k}),R.length&&(S=g(R[0]).droppable("instance"),S.greedyChild=se==="isover")),S&&se==="isover"&&(S.isover=!1,S.isout=!0,S._out.call(S,b)),this[se]=!0,this[se==="isout"?"isover":"isout"]=!1,this[se==="isover"?"_over":"_out"].call(this,b),S&&se==="isout"&&(S.isout=!1,S.isover=!0,S._over.call(S,b)))}})},dragStop:function(d,b){d.element.parentsUntil("body").off("scroll.droppable"),d.options.refreshPositions||g.ui.ddmanager.prepareOffsets(d,b)}},g.uiBackCompat!==!1&&g.widget("ui.droppable",g.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),g.ui.droppable;/*!
 * jQuery UI Progressbar 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.progressbar",{version:"1.13.2",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.attr({role:"progressbar","aria-valuemin":this.min}),this._addClass("ui-progressbar","ui-widget ui-widget-content"),this.valueDiv=g("<div>").appendTo(this.element),this._addClass(this.valueDiv,"ui-progressbar-value","ui-widget-header"),this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow"),this.valueDiv.remove()},value:function(d){if(d===void 0)return this.options.value;this.options.value=this._constrainedValue(d),this._refreshValue()},_constrainedValue:function(d){return d===void 0&&(d=this.options.value),this.indeterminate=d===!1,typeof d!="number"&&(d=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,d))},_setOptions:function(d){var b=d.value;delete d.value,this._super(d),this.options.value=this._constrainedValue(b),this._refreshValue()},_setOption:function(d,b){d==="max"&&(b=Math.max(this.min,b)),this._super(d,b)},_setOptionDisabled:function(d){this._super(d),this.element.attr("aria-disabled",d),this._toggleClass(null,"ui-state-disabled",!!d)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var d=this.options.value,b=this._percentage();this.valueDiv.toggle(this.indeterminate||d>this.min).width(b.toFixed(0)+"%"),this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,d===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=g("<div>").appendTo(this.valueDiv),this._addClass(this.overlayDiv,"ui-progressbar-overlay"))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":d}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==d&&(this.oldValue=d,this._trigger("change")),d===this.options.max&&this._trigger("complete")}});/*!
 * jQuery UI Selectable 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.selectable",g.ui.mouse,{version:"1.13.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var d=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){d.elementPos=g(d.element[0]).offset(),d.selectees=g(d.options.filter,d.element[0]),d._addClass(d.selectees,"ui-selectee"),d.selectees.each(function(){var b=g(this),S=b.offset(),k={left:S.left-d.elementPos.left,top:S.top-d.elementPos.top};g.data(this,"selectable-item",{element:this,$element:b,left:k.left,top:k.top,right:k.left+b.outerWidth(),bottom:k.top+b.outerHeight(),startselected:!1,selected:b.hasClass("ui-selected"),selecting:b.hasClass("ui-selecting"),unselecting:b.hasClass("ui-unselecting")})})},this.refresh(),this._mouseInit(),this.helper=g("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(d){var b=this,S=this.options;this.opos=[d.pageX,d.pageY],this.elementPos=g(this.element[0]).offset(),!this.options.disabled&&(this.selectees=g(S.filter,this.element[0]),this._trigger("start",d),g(S.appendTo).append(this.helper),this.helper.css({left:d.pageX,top:d.pageY,width:0,height:0}),S.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var k=g.data(this,"selectable-item");k.startselected=!0,!d.metaKey&&!d.ctrlKey&&(b._removeClass(k.$element,"ui-selected"),k.selected=!1,b._addClass(k.$element,"ui-unselecting"),k.unselecting=!0,b._trigger("unselecting",d,{unselecting:k.element}))}),g(d.target).parents().addBack().each(function(){var k,R=g.data(this,"selectable-item");if(R)return k=!d.metaKey&&!d.ctrlKey||!R.$element.hasClass("ui-selected"),b._removeClass(R.$element,k?"ui-unselecting":"ui-selected")._addClass(R.$element,k?"ui-selecting":"ui-unselecting"),R.unselecting=!k,R.selecting=k,R.selected=k,k?b._trigger("selecting",d,{selecting:R.element}):b._trigger("unselecting",d,{unselecting:R.element}),!1}))},_mouseDrag:function(d){if(this.dragged=!0,!this.options.disabled){var b,S=this,k=this.options,R=this.opos[0],W=this.opos[1],se=d.pageX,le=d.pageY;return R>se&&(b=se,se=R,R=b),W>le&&(b=le,le=W,W=b),this.helper.css({left:R,top:W,width:se-R,height:le-W}),this.selectees.each(function(){var fe=g.data(this,"selectable-item"),be=!1,Te={};!fe||fe.element===S.element[0]||(Te.left=fe.left+S.elementPos.left,Te.right=fe.right+S.elementPos.left,Te.top=fe.top+S.elementPos.top,Te.bottom=fe.bottom+S.elementPos.top,k.tolerance==="touch"?be=!(Te.left>se||Te.right<R||Te.top>le||Te.bottom<W):k.tolerance==="fit"&&(be=Te.left>R&&Te.right<se&&Te.top>W&&Te.bottom<le),be?(fe.selected&&(S._removeClass(fe.$element,"ui-selected"),fe.selected=!1),fe.unselecting&&(S._removeClass(fe.$element,"ui-unselecting"),fe.unselecting=!1),fe.selecting||(S._addClass(fe.$element,"ui-selecting"),fe.selecting=!0,S._trigger("selecting",d,{selecting:fe.element}))):(fe.selecting&&((d.metaKey||d.ctrlKey)&&fe.startselected?(S._removeClass(fe.$element,"ui-selecting"),fe.selecting=!1,S._addClass(fe.$element,"ui-selected"),fe.selected=!0):(S._removeClass(fe.$element,"ui-selecting"),fe.selecting=!1,fe.startselected&&(S._addClass(fe.$element,"ui-unselecting"),fe.unselecting=!0),S._trigger("unselecting",d,{unselecting:fe.element}))),fe.selected&&!d.metaKey&&!d.ctrlKey&&!fe.startselected&&(S._removeClass(fe.$element,"ui-selected"),fe.selected=!1,S._addClass(fe.$element,"ui-unselecting"),fe.unselecting=!0,S._trigger("unselecting",d,{unselecting:fe.element}))))}),!1}},_mouseStop:function(d){var b=this;return this.dragged=!1,g(".ui-unselecting",this.element[0]).each(function(){var S=g.data(this,"selectable-item");b._removeClass(S.$element,"ui-unselecting"),S.unselecting=!1,S.startselected=!1,b._trigger("unselected",d,{unselected:S.element})}),g(".ui-selecting",this.element[0]).each(function(){var S=g.data(this,"selectable-item");b._removeClass(S.$element,"ui-selecting")._addClass(S.$element,"ui-selected"),S.selecting=!1,S.selected=!0,S.startselected=!0,b._trigger("selected",d,{selected:S.element})}),this._trigger("stop",d),this.helper.remove(),!1}});/*!
 * jQuery UI Selectmenu 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.selectmenu",[g.ui.formResetMixin,{version:"1.13.2",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var d=this.element.uniqueId().attr("id");this.ids={element:d,button:d+"-button",menu:d+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=g()},_drawButton:function(){var d,b=this,S=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),this._on(this.labels,{click:function(k){this.button.trigger("focus"),k.preventDefault()}}),this.element.hide(),this.button=g("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),d=g("<span>").appendTo(this.button),this._addClass(d,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(S).appendTo(this.button),this.options.width!==!1&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){b._rendered||b._refreshMenu()})},_drawMenu:function(){var d=this;this.menu=g("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=g("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu","ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(b,S){b.preventDefault(),d._setSelection(),d._select(S.item.data("ui-selectmenu-item"),b)},focus:function(b,S){var k=S.item.data("ui-selectmenu-item");d.focusIndex!=null&&k.index!==d.focusIndex&&(d._trigger("focus",b,{item:k}),d.isOpen||d._select(k,b)),d.focusIndex=k.index,d.button.attr("aria-activedescendant",d.menuItems.eq(k.index).attr("id"))}}).menu("instance"),this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),this.options.width===null&&this._resizeButton()},_refreshMenu:function(){var d,b=this.element.find("option");this.menu.empty(),this._parseOptions(b),this._renderMenu(this.menu,this.items),this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,b.length&&(d=this._getSelectedItem(),this.menuInstance.focus(null,d),this._setAria(d.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(d){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",d)))},_position:function(){this.menuWrap.position(g.extend({of:this.button},this.options.position))},close:function(d){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",d))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(d){var b=g("<span>");return this._setText(b,d.label),this._addClass(b,"ui-selectmenu-text"),b},_renderMenu:function(d,b){var S=this,k="";g.each(b,function(R,W){var se;W.optgroup!==k&&(se=g("<li>",{text:W.optgroup}),S._addClass(se,"ui-selectmenu-optgroup","ui-menu-divider"+(W.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),se.appendTo(d),k=W.optgroup),S._renderItemData(d,W)})},_renderItemData:function(d,b){return this._renderItem(d,b).data("ui-selectmenu-item",b)},_renderItem:function(d,b){var S=g("<li>"),k=g("<div>",{title:b.element.attr("title")});return b.disabled&&this._addClass(S,null,"ui-state-disabled"),this._setText(k,b.label),S.append(k).appendTo(d)},_setText:function(d,b){b?d.text(b):d.html("&#160;")},_move:function(d,b){var S,k,R=".ui-menu-item";this.isOpen?S=this.menuItems.eq(this.focusIndex).parent("li"):(S=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),R+=":not(.ui-state-disabled)"),d==="first"||d==="last"?k=S[d==="first"?"prevAll":"nextAll"](R).eq(-1):k=S[d+"All"](R).eq(0),k.length&&this.menuInstance.focus(b,k)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(d){this[this.isOpen?"close":"open"](d)},_setSelection:function(){var d;this.range&&(window.getSelection?(d=window.getSelection(),d.removeAllRanges(),d.addRange(this.range)):this.range.select(),this.button.trigger("focus"))},_documentClick:{mousedown:function(d){this.isOpen&&(g(d.target).closest(".ui-selectmenu-menu, #"+g.escapeSelector(this.ids.button)).length||this.close(d))}},_buttonEvents:{mousedown:function(){var d;window.getSelection?(d=window.getSelection(),d.rangeCount&&(this.range=d.getRangeAt(0))):this.range=document.selection.createRange()},click:function(d){this._setSelection(),this._toggle(d)},keydown:function(d){var b=!0;switch(d.keyCode){case g.ui.keyCode.TAB:case g.ui.keyCode.ESCAPE:this.close(d),b=!1;break;case g.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(d);break;case g.ui.keyCode.UP:d.altKey?this._toggle(d):this._move("prev",d);break;case g.ui.keyCode.DOWN:d.altKey?this._toggle(d):this._move("next",d);break;case g.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(d):this._toggle(d);break;case g.ui.keyCode.LEFT:this._move("prev",d);break;case g.ui.keyCode.RIGHT:this._move("next",d);break;case g.ui.keyCode.HOME:case g.ui.keyCode.PAGE_UP:this._move("first",d);break;case g.ui.keyCode.END:case g.ui.keyCode.PAGE_DOWN:this._move("last",d);break;default:this.menu.trigger(d),b=!1}b&&d.preventDefault()}},_selectFocusedItem:function(d){var b=this.menuItems.eq(this.focusIndex).parent("li");b.hasClass("ui-state-disabled")||this._select(b.data("ui-selectmenu-item"),d)},_select:function(d,b){var S=this.element[0].selectedIndex;this.element[0].selectedIndex=d.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(d)),this._setAria(d),this._trigger("select",b,{item:d}),d.index!==S&&this._trigger("change",b,{item:d}),this.close(b)},_setAria:function(d){var b=this.menuItems.eq(d.index).attr("id");this.button.attr({"aria-labelledby":b,"aria-activedescendant":b}),this.menu.attr("aria-activedescendant",b)},_setOption:function(d,b){if(d==="icons"){var S=this.button.find("span.ui-icon");this._removeClass(S,null,this.options.icons.button)._addClass(S,null,b.button)}this._super(d,b),d==="appendTo"&&this.menuWrap.appendTo(this._appendTo()),d==="width"&&this._resizeButton()},_setOptionDisabled:function(d){this._super(d),this.menuInstance.option("disabled",d),this.button.attr("aria-disabled",d),this._toggleClass(this.button,null,"ui-state-disabled",d),this.element.prop("disabled",d),d?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var d=this.options.appendTo;return d&&(d=d.jquery||d.nodeType?g(d):this.document.find(d).eq(0)),(!d||!d[0])&&(d=this.element.closest(".ui-front, dialog")),d.length||(d=this.document[0].body),d},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var d=this.options.width;if(d===!1){this.button.css("width","");return}d===null&&(d=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(d)},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var d=this._super();return d.disabled=this.element.prop("disabled"),d},_parseOptions:function(d){var b=this,S=[];d.each(function(k,R){R.hidden||S.push(b._parseOption(g(R),k))}),this.items=S},_parseOption:function(d,b){var S=d.parent("optgroup");return{element:d,index:b,value:d.val(),label:d.text(),optgroup:S.attr("label")||"",disabled:S.prop("disabled")||d.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}]);/*!
 * jQuery UI Slider 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.slider",g.ui.mouse,{version:"1.13.2",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var d,b,S=this.options,k=this.element.find(".ui-slider-handle"),R="<span tabindex='0'></span>",W=[];for(b=S.values&&S.values.length||1,k.length>b&&(k.slice(b).remove(),k=k.slice(0,b)),d=k.length;d<b;d++)W.push(R);this.handles=k.add(g(W.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(se){g(this).data("ui-slider-handle-index",se).attr("tabIndex",0)})},_createRange:function(){var d=this.options;d.range?(d.range===!0&&(d.values?d.values.length&&d.values.length!==2?d.values=[d.values[0],d.values[0]]:Array.isArray(d.values)&&(d.values=d.values.slice(0)):d.values=[this._valueMin(),this._valueMin()]),!this.range||!this.range.length?(this.range=g("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")):(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})),(d.range==="min"||d.range==="max")&&this._addClass(this.range,"ui-slider-range-"+d.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(d){var b,S,k,R,W,se,le,fe,be=this,Te=this.options;return Te.disabled||(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),b={x:d.pageX,y:d.pageY},S=this._normValueFromMouse(b),k=this._valueMax()-this._valueMin()+1,this.handles.each(function(Ve){var Ue=Math.abs(S-be.values(Ve));(k>Ue||k===Ue&&(Ve===be._lastChangedValue||be.values(Ve)===Te.min))&&(k=Ue,R=g(this),W=Ve)}),se=this._start(d,W),se===!1)?!1:(this._mouseSliding=!0,this._handleIndex=W,this._addClass(R,null,"ui-state-active"),R.trigger("focus"),le=R.offset(),fe=!g(d.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=fe?{left:0,top:0}:{left:d.pageX-le.left-R.width()/2,top:d.pageY-le.top-R.height()/2-(parseInt(R.css("borderTopWidth"),10)||0)-(parseInt(R.css("borderBottomWidth"),10)||0)+(parseInt(R.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(d,W,S),this._animateOff=!0,!0)},_mouseStart:function(){return!0},_mouseDrag:function(d){var b={x:d.pageX,y:d.pageY},S=this._normValueFromMouse(b);return this._slide(d,this._handleIndex,S),!1},_mouseStop:function(d){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(d,this._handleIndex),this._change(d,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(d){var b,S,k,R,W;return this.orientation==="horizontal"?(b=this.elementSize.width,S=d.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,S=d.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),k=S/b,k>1&&(k=1),k<0&&(k=0),this.orientation==="vertical"&&(k=1-k),R=this._valueMax()-this._valueMin(),W=this._valueMin()+k*R,this._trimAlignValue(W)},_uiHash:function(d,b,S){var k={handle:this.handles[d],handleIndex:d,value:b!==void 0?b:this.value()};return this._hasMultipleValues()&&(k.value=b!==void 0?b:this.values(d),k.values=S||this.values()),k},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(d,b){return this._trigger("start",d,this._uiHash(b))},_slide:function(d,b,S){var k,R,W=this.value(),se=this.values();this._hasMultipleValues()&&(R=this.values(b?0:1),W=this.values(b),this.options.values.length===2&&this.options.range===!0&&(S=b===0?Math.min(R,S):Math.max(R,S)),se[b]=S),S!==W&&(k=this._trigger("slide",d,this._uiHash(b,S,se)),k!==!1&&(this._hasMultipleValues()?this.values(b,S):this.value(S)))},_stop:function(d,b){this._trigger("stop",d,this._uiHash(b))},_change:function(d,b){!this._keySliding&&!this._mouseSliding&&(this._lastChangedValue=b,this._trigger("change",d,this._uiHash(b)))},value:function(d){if(arguments.length){this.options.value=this._trimAlignValue(d),this._refreshValue(),this._change(null,0);return}return this._value()},values:function(d,b){var S,k,R;if(arguments.length>1){this.options.values[d]=this._trimAlignValue(b),this._refreshValue(),this._change(null,d);return}if(arguments.length)if(Array.isArray(arguments[0])){for(S=this.options.values,k=arguments[0],R=0;R<S.length;R+=1)S[R]=this._trimAlignValue(k[R]),this._change(null,R);this._refreshValue()}else return this._hasMultipleValues()?this._values(d):this.value();else return this._values()},_setOption:function(d,b){var S,k=0;switch(d==="range"&&this.options.range===!0&&(b==="min"?(this.options.value=this._values(0),this.options.values=null):b==="max"&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),Array.isArray(this.options.values)&&(k=this.options.values.length),this._super(d,b),d){case"orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(b),this.handles.css(b==="horizontal"?"bottom":"left","");break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),S=k-1;S>=0;S--)this._change(null,S);this._animateOff=!1;break;case"step":case"min":case"max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1;break}},_setOptionDisabled:function(d){this._super(d),this._toggleClass(null,"ui-state-disabled",!!d)},_value:function(){var d=this.options.value;return d=this._trimAlignValue(d),d},_values:function(d){var b,S,k;if(arguments.length)return b=this.options.values[d],b=this._trimAlignValue(b),b;if(this._hasMultipleValues()){for(S=this.options.values.slice(),k=0;k<S.length;k+=1)S[k]=this._trimAlignValue(S[k]);return S}else return[]},_trimAlignValue:function(d){if(d<=this._valueMin())return this._valueMin();if(d>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,S=(d-this._valueMin())%b,k=d-S;return Math.abs(S)*2>=b&&(k+=S>0?b:-b),parseFloat(k.toFixed(5))},_calculateNewMax:function(){var d=this.options.max,b=this._valueMin(),S=this.options.step,k=Math.round((d-b)/S)*S;d=k+b,d>this.options.max&&(d-=S),this.max=parseFloat(d.toFixed(this._precision()))},_precision:function(){var d=this._precisionOf(this.options.step);return this.options.min!==null&&(d=Math.max(d,this._precisionOf(this.options.min))),d},_precisionOf:function(d){var b=d.toString(),S=b.indexOf(".");return S===-1?0:b.length-S-1},_valueMin:function(){return this.options.min},_valueMax:function(){return this.max},_refreshRange:function(d){d==="vertical"&&this.range.css({width:"",left:""}),d==="horizontal"&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var d,b,S,k,R,W=this.options.range,se=this.options,le=this,fe=this._animateOff?!1:se.animate,be={};this._hasMultipleValues()?this.handles.each(function(Te){b=(le.values(Te)-le._valueMin())/(le._valueMax()-le._valueMin())*100,be[le.orientation==="horizontal"?"left":"bottom"]=b+"%",g(this).stop(1,1)[fe?"animate":"css"](be,se.animate),le.options.range===!0&&(le.orientation==="horizontal"?(Te===0&&le.range.stop(1,1)[fe?"animate":"css"]({left:b+"%"},se.animate),Te===1&&le.range[fe?"animate":"css"]({width:b-d+"%"},{queue:!1,duration:se.animate})):(Te===0&&le.range.stop(1,1)[fe?"animate":"css"]({bottom:b+"%"},se.animate),Te===1&&le.range[fe?"animate":"css"]({height:b-d+"%"},{queue:!1,duration:se.animate}))),d=b}):(S=this.value(),k=this._valueMin(),R=this._valueMax(),b=R!==k?(S-k)/(R-k)*100:0,be[this.orientation==="horizontal"?"left":"bottom"]=b+"%",this.handle.stop(1,1)[fe?"animate":"css"](be,se.animate),W==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[fe?"animate":"css"]({width:b+"%"},se.animate),W==="max"&&this.orientation==="horizontal"&&this.range.stop(1,1)[fe?"animate":"css"]({width:100-b+"%"},se.animate),W==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[fe?"animate":"css"]({height:b+"%"},se.animate),W==="max"&&this.orientation==="vertical"&&this.range.stop(1,1)[fe?"animate":"css"]({height:100-b+"%"},se.animate))},_handleEvents:{keydown:function(d){var b,S,k,R,W=g(d.target).data("ui-slider-handle-index");switch(d.keyCode){case g.ui.keyCode.HOME:case g.ui.keyCode.END:case g.ui.keyCode.PAGE_UP:case g.ui.keyCode.PAGE_DOWN:case g.ui.keyCode.UP:case g.ui.keyCode.RIGHT:case g.ui.keyCode.DOWN:case g.ui.keyCode.LEFT:if(d.preventDefault(),!this._keySliding&&(this._keySliding=!0,this._addClass(g(d.target),null,"ui-state-active"),b=this._start(d,W),b===!1))return;break}switch(R=this.options.step,this._hasMultipleValues()?S=k=this.values(W):S=k=this.value(),d.keyCode){case g.ui.keyCode.HOME:k=this._valueMin();break;case g.ui.keyCode.END:k=this._valueMax();break;case g.ui.keyCode.PAGE_UP:k=this._trimAlignValue(S+(this._valueMax()-this._valueMin())/this.numPages);break;case g.ui.keyCode.PAGE_DOWN:k=this._trimAlignValue(S-(this._valueMax()-this._valueMin())/this.numPages);break;case g.ui.keyCode.UP:case g.ui.keyCode.RIGHT:if(S===this._valueMax())return;k=this._trimAlignValue(S+R);break;case g.ui.keyCode.DOWN:case g.ui.keyCode.LEFT:if(S===this._valueMin())return;k=this._trimAlignValue(S-R);break}this._slide(d,W,k)},keyup:function(d){var b=g(d.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(d,b),this._change(d,b),this._removeClass(g(d.target),null,"ui-state-active"))}}});/*!
 * jQuery UI Sortable 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.sortable",g.ui.mouse,{version:"1.13.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(d,b,S){return d>=b&&d<b+S},_isFloating:function(d){return/left|right/.test(d.css("float"))||/inline|table-cell/.test(d.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(d,b){this._super(d,b),d==="handle"&&this._setHandleClassName()},_setHandleClassName:function(){var d=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),g.each(this.items,function(){d._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();for(var d=this.items.length-1;d>=0;d--)this.items[d].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(d,b){var S=null,k=!1,R=this;return this.reverting||this.options.disabled||this.options.type==="static"||(this._refreshItems(d),g(d.target).parents().each(function(){if(g.data(this,R.widgetName+"-item")===R)return S=g(this),!1}),g.data(d.target,R.widgetName+"-item")===R&&(S=g(d.target)),!S)||this.options.handle&&!b&&(g(this.options.handle,S).find("*").addBack().each(function(){this===d.target&&(k=!0)}),!k)?!1:(this.currentItem=S,this._removeCurrentsFromItems(),!0)},_mouseStart:function(d,b,S){var k,R,W=this.options;if(this.currentContainer=this,this.refreshPositions(),this.appendTo=g(W.appendTo!=="parent"?W.appendTo:this.currentItem.parent()),this.helper=this._createHelper(d),this._cacheHelperProportions(),this._cacheMargins(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},g.extend(this.offset,{click:{left:d.pageX-this.offset.left,top:d.pageY-this.offset.top},relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),W.cursorAt&&this._adjustOffsetFromHelper(W.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),this.scrollParent=this.placeholder.scrollParent(),g.extend(this.offset,{parent:this._getParentOffset()}),W.containment&&this._setContainment(),W.cursor&&W.cursor!=="auto"&&(R=this.document.find("body"),this.storedCursor=R.css("cursor"),R.css("cursor",W.cursor),this.storedStylesheet=g("<style>*{ cursor: "+W.cursor+" !important; }</style>").appendTo(R)),W.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",W.zIndex)),W.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",W.opacity)),this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",d,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!S)for(k=this.containers.length-1;k>=0;k--)this.containers[k]._trigger("activate",d,this._uiHash(this));return g.ui.ddmanager&&(g.ui.ddmanager.current=this),g.ui.ddmanager&&!W.dropBehaviour&&g.ui.ddmanager.prepareOffsets(this,d),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this.helper.parent().is(this.appendTo)||(this.helper.detach().appendTo(this.appendTo),this.offset.parent=this._getParentOffset()),this.position=this.originalPosition=this._generatePosition(d),this.originalPageX=d.pageX,this.originalPageY=d.pageY,this.lastPositionAbs=this.positionAbs=this._convertPositionTo("absolute"),this._mouseDrag(d),!0},_scroll:function(d){var b=this.options,S=!1;return this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-d.pageY<b.scrollSensitivity?this.scrollParent[0].scrollTop=S=this.scrollParent[0].scrollTop+b.scrollSpeed:d.pageY-this.overflowOffset.top<b.scrollSensitivity&&(this.scrollParent[0].scrollTop=S=this.scrollParent[0].scrollTop-b.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-d.pageX<b.scrollSensitivity?this.scrollParent[0].scrollLeft=S=this.scrollParent[0].scrollLeft+b.scrollSpeed:d.pageX-this.overflowOffset.left<b.scrollSensitivity&&(this.scrollParent[0].scrollLeft=S=this.scrollParent[0].scrollLeft-b.scrollSpeed)):(d.pageY-this.document.scrollTop()<b.scrollSensitivity?S=this.document.scrollTop(this.document.scrollTop()-b.scrollSpeed):this.window.height()-(d.pageY-this.document.scrollTop())<b.scrollSensitivity&&(S=this.document.scrollTop(this.document.scrollTop()+b.scrollSpeed)),d.pageX-this.document.scrollLeft()<b.scrollSensitivity?S=this.document.scrollLeft(this.document.scrollLeft()-b.scrollSpeed):this.window.width()-(d.pageX-this.document.scrollLeft())<b.scrollSensitivity&&(S=this.document.scrollLeft(this.document.scrollLeft()+b.scrollSpeed))),S},_mouseDrag:function(d){var b,S,k,R,W=this.options;for(this.position=this._generatePosition(d),this.positionAbs=this._convertPositionTo("absolute"),(!this.options.axis||this.options.axis!=="y")&&(this.helper[0].style.left=this.position.left+"px"),(!this.options.axis||this.options.axis!=="x")&&(this.helper[0].style.top=this.position.top+"px"),W.scroll&&this._scroll(d)!==!1&&(this._refreshItemPositions(!0),g.ui.ddmanager&&!W.dropBehaviour&&g.ui.ddmanager.prepareOffsets(this,d)),this.dragDirection={vertical:this._getDragVerticalDirection(),horizontal:this._getDragHorizontalDirection()},b=this.items.length-1;b>=0;b--)if(S=this.items[b],k=S.item[0],R=this._intersectsWithPointer(S),!!R&&S.instance===this.currentContainer&&k!==this.currentItem[0]&&this.placeholder[R===1?"next":"prev"]()[0]!==k&&!g.contains(this.placeholder[0],k)&&(this.options.type!=="semi-dynamic"||!g.contains(this.element[0],k))){if(this.direction=R===1?"down":"up",this.options.tolerance==="pointer"||this._intersectsWithSides(S))this._rearrange(d,S);else break;this._trigger("change",d,this._uiHash());break}return this._contactContainers(d),g.ui.ddmanager&&g.ui.ddmanager.drag(this,d),this._trigger("sort",d,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(d,b){if(d){if(g.ui.ddmanager&&!this.options.dropBehaviour&&g.ui.ddmanager.drop(this,d),this.options.revert){var S=this,k=this.placeholder.offset(),R=this.options.axis,W={};(!R||R==="x")&&(W.left=k.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),(!R||R==="y")&&(W.top=k.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,g(this.helper).animate(W,parseInt(this.options.revert,10)||500,function(){S._clear(d)})}else this._clear(d,b);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new g.Event("mouseup",{target:null})),this.options.helper==="original"?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var d=this.containers.length-1;d>=0;d--)this.containers[d]._trigger("deactivate",null,this._uiHash(this)),this.containers[d].containerCache.over&&(this.containers[d]._trigger("out",null,this._uiHash(this)),this.containers[d].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),g.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?g(this.domPosition.prev).after(this.currentItem):g(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(d){var b=this._getItemsAsjQuery(d&&d.connected),S=[];return d=d||{},g(b).each(function(){var k=(g(d.item||this).attr(d.attribute||"id")||"").match(d.expression||/(.+)[\-=_](.+)/);k&&S.push((d.key||k[1]+"[]")+"="+(d.key&&d.expression?k[1]:k[2]))}),!S.length&&d.key&&S.push(d.key+"="),S.join("&")},toArray:function(d){var b=this._getItemsAsjQuery(d&&d.connected),S=[];return d=d||{},b.each(function(){S.push(g(d.item||this).attr(d.attribute||"id")||"")}),S},_intersectsWith:function(d){var b=this.positionAbs.left,S=b+this.helperProportions.width,k=this.positionAbs.top,R=k+this.helperProportions.height,W=d.left,se=W+d.width,le=d.top,fe=le+d.height,be=this.offset.click.top,Te=this.offset.click.left,Ve=this.options.axis==="x"||k+be>le&&k+be<fe,Ue=this.options.axis==="y"||b+Te>W&&b+Te<se,me=Ve&&Ue;return this.options.tolerance==="pointer"||this.options.forcePointerForContainers||this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>d[this.floating?"width":"height"]?me:W<b+this.helperProportions.width/2&&S-this.helperProportions.width/2<se&&le<k+this.helperProportions.height/2&&R-this.helperProportions.height/2<fe},_intersectsWithPointer:function(d){var b,S,k=this.options.axis==="x"||this._isOverAxis(this.positionAbs.top+this.offset.click.top,d.top,d.height),R=this.options.axis==="y"||this._isOverAxis(this.positionAbs.left+this.offset.click.left,d.left,d.width),W=k&&R;return W?(b=this.dragDirection.vertical,S=this.dragDirection.horizontal,this.floating?S==="right"||b==="down"?2:1:b&&(b==="down"?2:1)):!1},_intersectsWithSides:function(d){var b=this._isOverAxis(this.positionAbs.top+this.offset.click.top,d.top+d.height/2,d.height),S=this._isOverAxis(this.positionAbs.left+this.offset.click.left,d.left+d.width/2,d.width),k=this.dragDirection.vertical,R=this.dragDirection.horizontal;return this.floating&&R?R==="right"&&S||R==="left"&&!S:k&&(k==="down"&&b||k==="up"&&!b)},_getDragVerticalDirection:function(){var d=this.positionAbs.top-this.lastPositionAbs.top;return d!==0&&(d>0?"down":"up")},_getDragHorizontalDirection:function(){var d=this.positionAbs.left-this.lastPositionAbs.left;return d!==0&&(d>0?"right":"left")},refresh:function(d){return this._refreshItems(d),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var d=this.options;return d.connectWith.constructor===String?[d.connectWith]:d.connectWith},_getItemsAsjQuery:function(d){var b,S,k,R,W=[],se=[],le=this._connectWith();if(le&&d)for(b=le.length-1;b>=0;b--)for(k=g(le[b],this.document[0]),S=k.length-1;S>=0;S--)R=g.data(k[S],this.widgetFullName),R&&R!==this&&!R.options.disabled&&se.push([typeof R.options.items=="function"?R.options.items.call(R.element):g(R.options.items,R.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),R]);se.push([typeof this.options.items=="function"?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):g(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);function fe(){W.push(this)}for(b=se.length-1;b>=0;b--)se[b][0].each(fe);return g(W)},_removeCurrentsFromItems:function(){var d=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=g.grep(this.items,function(b){for(var S=0;S<d.length;S++)if(d[S]===b.item[0])return!1;return!0})},_refreshItems:function(d){this.items=[],this.containers=[this];var b,S,k,R,W,se,le,fe,be=this.items,Te=[[typeof this.options.items=="function"?this.options.items.call(this.element[0],d,{item:this.currentItem}):g(this.options.items,this.element),this]],Ve=this._connectWith();if(Ve&&this.ready)for(b=Ve.length-1;b>=0;b--)for(k=g(Ve[b],this.document[0]),S=k.length-1;S>=0;S--)R=g.data(k[S],this.widgetFullName),R&&R!==this&&!R.options.disabled&&(Te.push([typeof R.options.items=="function"?R.options.items.call(R.element[0],d,{item:this.currentItem}):g(R.options.items,R.element),R]),this.containers.push(R));for(b=Te.length-1;b>=0;b--)for(W=Te[b][1],se=Te[b][0],S=0,fe=se.length;S<fe;S++)le=g(se[S]),le.data(this.widgetName+"-item",W),be.push({item:le,instance:W,width:0,height:0,left:0,top:0})},_refreshItemPositions:function(d){var b,S,k,R;for(b=this.items.length-1;b>=0;b--)S=this.items[b],!(this.currentContainer&&S.instance!==this.currentContainer&&S.item[0]!==this.currentItem[0])&&(k=this.options.toleranceElement?g(this.options.toleranceElement,S.item):S.item,d||(S.width=k.outerWidth(),S.height=k.outerHeight()),R=k.offset(),S.left=R.left,S.top=R.top)},refreshPositions:function(d){this.floating=this.items.length?this.options.axis==="x"||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset()),this._refreshItemPositions(d);var b,S;if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(b=this.containers.length-1;b>=0;b--)S=this.containers[b].element.offset(),this.containers[b].containerCache.left=S.left,this.containers[b].containerCache.top=S.top,this.containers[b].containerCache.width=this.containers[b].element.outerWidth(),this.containers[b].containerCache.height=this.containers[b].element.outerHeight();return this},_createPlaceholder:function(d){d=d||this;var b,S,k=d.options;(!k.placeholder||k.placeholder.constructor===String)&&(b=k.placeholder,S=d.currentItem[0].nodeName.toLowerCase(),k.placeholder={element:function(){var R=g("<"+S+">",d.document[0]);return d._addClass(R,"ui-sortable-placeholder",b||d.currentItem[0].className)._removeClass(R,"ui-sortable-helper"),S==="tbody"?d._createTrPlaceholder(d.currentItem.find("tr").eq(0),g("<tr>",d.document[0]).appendTo(R)):S==="tr"?d._createTrPlaceholder(d.currentItem,R):S==="img"&&R.attr("src",d.currentItem.attr("src")),b||R.css("visibility","hidden"),R},update:function(R,W){b&&!k.forcePlaceholderSize||((!W.height()||k.forcePlaceholderSize&&(S==="tbody"||S==="tr"))&&W.height(d.currentItem.innerHeight()-parseInt(d.currentItem.css("paddingTop")||0,10)-parseInt(d.currentItem.css("paddingBottom")||0,10)),W.width()||W.width(d.currentItem.innerWidth()-parseInt(d.currentItem.css("paddingLeft")||0,10)-parseInt(d.currentItem.css("paddingRight")||0,10)))}}),d.placeholder=g(k.placeholder.element.call(d.element,d.currentItem)),d.currentItem.after(d.placeholder),k.placeholder.update(d,d.placeholder)},_createTrPlaceholder:function(d,b){var S=this;d.children().each(function(){g("<td>&#160;</td>",S.document[0]).attr("colspan",g(this).attr("colspan")||1).appendTo(b)})},_contactContainers:function(d){var b,S,k,R,W,se,le,fe,be,Te,Ve=null,Ue=null;for(b=this.containers.length-1;b>=0;b--)if(!g.contains(this.currentItem[0],this.containers[b].element[0]))if(this._intersectsWith(this.containers[b].containerCache)){if(Ve&&g.contains(this.containers[b].element[0],Ve.element[0]))continue;Ve=this.containers[b],Ue=b}else this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",d,this._uiHash(this)),this.containers[b].containerCache.over=0);if(Ve)if(this.containers.length===1)this.containers[Ue].containerCache.over||(this.containers[Ue]._trigger("over",d,this._uiHash(this)),this.containers[Ue].containerCache.over=1);else{for(k=1e4,R=null,be=Ve.floating||this._isFloating(this.currentItem),W=be?"left":"top",se=be?"width":"height",Te=be?"pageX":"pageY",S=this.items.length-1;S>=0;S--)g.contains(this.containers[Ue].element[0],this.items[S].item[0])&&this.items[S].item[0]!==this.currentItem[0]&&(le=this.items[S].item.offset()[W],fe=!1,d[Te]-le>this.items[S][se]/2&&(fe=!0),Math.abs(d[Te]-le)<k&&(k=Math.abs(d[Te]-le),R=this.items[S],this.direction=fe?"up":"down"));if(!R&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[Ue]){this.currentContainer.containerCache.over||(this.containers[Ue]._trigger("over",d,this._uiHash()),this.currentContainer.containerCache.over=1);return}R?this._rearrange(d,R,null,!0):this._rearrange(d,null,this.containers[Ue].element,!0),this._trigger("change",d,this._uiHash()),this.containers[Ue]._trigger("change",d,this._uiHash(this)),this.currentContainer=this.containers[Ue],this.options.placeholder.update(this.currentContainer,this.placeholder),this.scrollParent=this.placeholder.scrollParent(),this.scrollParent[0]!==this.document[0]&&this.scrollParent[0].tagName!=="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this.containers[Ue]._trigger("over",d,this._uiHash(this)),this.containers[Ue].containerCache.over=1}},_createHelper:function(d){var b=this.options,S=typeof b.helper=="function"?g(b.helper.apply(this.element[0],[d,this.currentItem])):b.helper==="clone"?this.currentItem.clone():this.currentItem;return S.parents("body").length||this.appendTo[0].appendChild(S[0]),S[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!S[0].style.width||b.forceHelperSize)&&S.width(this.currentItem.width()),(!S[0].style.height||b.forceHelperSize)&&S.height(this.currentItem.height()),S},_adjustOffsetFromHelper:function(d){typeof d=="string"&&(d=d.split(" ")),Array.isArray(d)&&(d={left:+d[0],top:+d[1]||0}),"left"in d&&(this.offset.click.left=d.left+this.margins.left),"right"in d&&(this.offset.click.left=this.helperProportions.width-d.right+this.margins.left),"top"in d&&(this.offset.click.top=d.top+this.margins.top),"bottom"in d&&(this.offset.click.top=this.helperProportions.height-d.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var d=this.offsetParent.offset();return this.cssPosition==="absolute"&&this.scrollParent[0]!==this.document[0]&&g.contains(this.scrollParent[0],this.offsetParent[0])&&(d.left+=this.scrollParent.scrollLeft(),d.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&g.ui.ie)&&(d={top:0,left:0}),{top:d.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:d.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var d=this.currentItem.position();return{top:d.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:d.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var d,b,S,k=this.options;k.containment==="parent"&&(k.containment=this.helper[0].parentNode),(k.containment==="document"||k.containment==="window")&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,k.containment==="document"?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,(k.containment==="document"?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(k.containment)||(d=g(k.containment)[0],b=g(k.containment).offset(),S=g(d).css("overflow")!=="hidden",this.containment=[b.left+(parseInt(g(d).css("borderLeftWidth"),10)||0)+(parseInt(g(d).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt(g(d).css("borderTopWidth"),10)||0)+(parseInt(g(d).css("paddingTop"),10)||0)-this.margins.top,b.left+(S?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(g(d).css("borderLeftWidth"),10)||0)-(parseInt(g(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(S?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(g(d).css("borderTopWidth"),10)||0)-(parseInt(g(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(d,b){b||(b=this.position);var S=d==="absolute"?1:-1,k=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==this.document[0]&&g.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,R=/(html|body)/i.test(k[0].tagName);return{top:b.top+this.offset.relative.top*S+this.offset.parent.top*S-(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():R?0:k.scrollTop())*S,left:b.left+this.offset.relative.left*S+this.offset.parent.left*S-(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():R?0:k.scrollLeft())*S}},_generatePosition:function(d){var b,S,k=this.options,R=d.pageX,W=d.pageY,se=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==this.document[0]&&g.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,le=/(html|body)/i.test(se[0].tagName);return this.cssPosition==="relative"&&!(this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(d.pageX-this.offset.click.left<this.containment[0]&&(R=this.containment[0]+this.offset.click.left),d.pageY-this.offset.click.top<this.containment[1]&&(W=this.containment[1]+this.offset.click.top),d.pageX-this.offset.click.left>this.containment[2]&&(R=this.containment[2]+this.offset.click.left),d.pageY-this.offset.click.top>this.containment[3]&&(W=this.containment[3]+this.offset.click.top)),k.grid&&(b=this.originalPageY+Math.round((W-this.originalPageY)/k.grid[1])*k.grid[1],W=this.containment?b-this.offset.click.top>=this.containment[1]&&b-this.offset.click.top<=this.containment[3]?b:b-this.offset.click.top>=this.containment[1]?b-k.grid[1]:b+k.grid[1]:b,S=this.originalPageX+Math.round((R-this.originalPageX)/k.grid[0])*k.grid[0],R=this.containment?S-this.offset.click.left>=this.containment[0]&&S-this.offset.click.left<=this.containment[2]?S:S-this.offset.click.left>=this.containment[0]?S-k.grid[0]:S+k.grid[0]:S)),{top:W-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():le?0:se.scrollTop()),left:R-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():le?0:se.scrollLeft())}},_rearrange:function(d,b,S,k){S?S[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],this.direction==="down"?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var R=this.counter;this._delay(function(){R===this.counter&&this.refreshPositions(!k)})},_clear:function(d,b){this.reverting=!1;var S,k=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(S in this._storedCSS)(this._storedCSS[S]==="auto"||this._storedCSS[S]==="static")&&(this._storedCSS[S]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!b&&k.push(function(W){this._trigger("receive",W,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!b&&k.push(function(W){this._trigger("update",W,this._uiHash())}),this!==this.currentContainer&&(b||(k.push(function(W){this._trigger("remove",W,this._uiHash())}),k.push((function(W){return function(se){W._trigger("receive",se,this._uiHash(this))}}).call(this,this.currentContainer)),k.push((function(W){return function(se){W._trigger("update",se,this._uiHash(this))}}).call(this,this.currentContainer))));function R(W,se,le){return function(fe){le._trigger(W,fe,se._uiHash(se))}}for(S=this.containers.length-1;S>=0;S--)b||k.push(R("deactivate",this,this.containers[S])),this.containers[S].containerCache.over&&(k.push(R("out",this,this.containers[S])),this.containers[S].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex),this.dragging=!1,b||this._trigger("beforeStop",d,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!b){for(S=0;S<k.length;S++)k[S].call(this,d);this._trigger("stop",d,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){g.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(d){var b=d||this;return{helper:b.helper,placeholder:b.placeholder||g([]),position:b.position,originalPosition:b.originalPosition,offset:b.positionAbs,item:b.currentItem,sender:d?d.element:null}}});/*!
 * jQuery UI Spinner 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */function vi(d){return function(){var b=this.element.val();d.apply(this,arguments),this._refresh(),b!==this.element.val()&&this._trigger("change")}}g.widget("ui.spinner",{version:"1.13.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all","ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this.value()!==""&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var d=this._super(),b=this.element;return g.each(["min","max","step"],function(S,k){var R=b.attr(k);R!=null&&R.length&&(d[k]=R)}),d},_events:{keydown:function(d){this._start(d)&&this._keydown(d)&&d.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(d){if(this.cancelBlur){delete this.cancelBlur;return}this._stop(),this._refresh(),this.previous!==this.element.val()&&this._trigger("change",d)},mousewheel:function(d,b){var S=g.ui.safeActiveElement(this.document[0]),k=this.element[0]===S;if(!(!k||!b)){if(!this.spinning&&!this._start(d))return!1;this._spin((b>0?1:-1)*this.options.step,d),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(d)},100),d.preventDefault()}},"mousedown .ui-spinner-button":function(d){var b;b=this.element[0]===g.ui.safeActiveElement(this.document[0])?this.previous:this.element.val();function S(){var k=this.element[0]===g.ui.safeActiveElement(this.document[0]);k||(this.element.trigger("focus"),this.previous=b,this._delay(function(){this.previous=b}))}d.preventDefault(),S.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,S.call(this)}),this._start(d)!==!1&&this._repeat(null,g(d.currentTarget).hasClass("ui-spinner-up")?1:-1,d)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(d){if(g(d.currentTarget).hasClass("ui-state-active")){if(this._start(d)===!1)return!1;this._repeat(null,g(d.currentTarget).hasClass("ui-spinner-up")?1:-1,d)}},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(this.uiSpinner.height()*.5)&&this.uiSpinner.height()>0&&this.uiSpinner.height(this.uiSpinner.height())},_keydown:function(d){var b=this.options,S=g.ui.keyCode;switch(d.keyCode){case S.UP:return this._repeat(null,1,d),!0;case S.DOWN:return this._repeat(null,-1,d),!0;case S.PAGE_UP:return this._repeat(null,b.page,d),!0;case S.PAGE_DOWN:return this._repeat(null,-b.page,d),!0}return!1},_start:function(d){return!this.spinning&&this._trigger("start",d)===!1?!1:(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(d,b,S){d=d||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,b,S)},d),this._spin(b*this.options.step,S)},_spin:function(d,b){var S=this.value()||0;this.counter||(this.counter=1),S=this._adjustValue(S+d*this._increment(this.counter)),(!this.spinning||this._trigger("spin",b,{value:S})!==!1)&&(this._value(S),this.counter++)},_increment:function(d){var b=this.options.incremental;return b?typeof b=="function"?b(d):Math.floor(d*d*d/5e4-d*d/500+17*d/200+1):1},_precision:function(){var d=this._precisionOf(this.options.step);return this.options.min!==null&&(d=Math.max(d,this._precisionOf(this.options.min))),d},_precisionOf:function(d){var b=d.toString(),S=b.indexOf(".");return S===-1?0:b.length-S-1},_adjustValue:function(d){var b,S,k=this.options;return b=k.min!==null?k.min:0,S=d-b,S=Math.round(S/k.step)*k.step,d=b+S,d=parseFloat(d.toFixed(this._precision())),k.max!==null&&d>k.max?k.max:k.min!==null&&d<k.min?k.min:d},_stop:function(d){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",d))},_setOption:function(d,b){var S,k,R;if(d==="culture"||d==="numberFormat"){S=this._parse(this.element.val()),this.options[d]=b,this.element.val(this._format(S));return}(d==="max"||d==="min"||d==="step")&&typeof b=="string"&&(b=this._parse(b)),d==="icons"&&(k=this.buttons.first().find(".ui-icon"),this._removeClass(k,null,this.options.icons.up),this._addClass(k,null,b.up),R=this.buttons.last().find(".ui-icon"),this._removeClass(R,null,this.options.icons.down),this._addClass(R,null,b.down)),this._super(d,b)},_setOptionDisabled:function(d){this._super(d),this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!d),this.element.prop("disabled",!!d),this.buttons.button(d?"disable":"enable")},_setOptions:vi(function(d){this._super(d)}),_parse:function(d){return typeof d=="string"&&d!==""&&(d=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(d,10,this.options.culture):+d),d===""||isNaN(d)?null:d},_format:function(d){return d===""?"":window.Globalize&&this.options.numberFormat?Globalize.format(d,this.options.numberFormat,this.options.culture):d},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var d=this.value();return d===null?!1:d===this._adjustValue(d)},_value:function(d,b){var S;d!==""&&(S=this._parse(d),S!==null&&(b||(S=this._adjustValue(S)),d=this._format(S))),this.element.val(d),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:vi(function(d){this._stepUp(d)}),_stepUp:function(d){this._start()&&(this._spin((d||1)*this.options.step),this._stop())},stepDown:vi(function(d){this._stepDown(d)}),_stepDown:function(d){this._start()&&(this._spin((d||1)*-this.options.step),this._stop())},pageUp:vi(function(d){this._stepUp((d||1)*this.options.page)}),pageDown:vi(function(d){this._stepDown((d||1)*this.options.page)}),value:function(d){if(!arguments.length)return this._parse(this.element.val());vi(this._value).call(this,d)},widget:function(){return this.uiSpinner}}),g.uiBackCompat!==!1&&g.widget("ui.spinner",g.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}}),g.ui.spinner;/*!
 * jQuery UI Tabs 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.tabs",{version:"1.13.2",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all","ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:function(){var d=/#.*$/;return function(b){var S,k;S=b.href.replace(d,""),k=location.href.replace(d,"");try{S=decodeURIComponent(S)}catch{}try{k=decodeURIComponent(k)}catch{}return b.hash.length>1&&S===k}}(),_create:function(){var d=this,b=this.options;this.running=!1,this._addClass("ui-tabs","ui-widget ui-widget-content"),this._toggleClass("ui-tabs-collapsible",null,b.collapsible),this._processTabs(),b.active=this._initialActive(),Array.isArray(b.disabled)&&(b.disabled=g.uniqueSort(b.disabled.concat(g.map(this.tabs.filter(".ui-state-disabled"),function(S){return d.tabs.index(S)}))).sort()),this.options.active!==!1&&this.anchors.length?this.active=this._findActive(b.active):this.active=g(),this._refresh(),this.active.length&&this.load(b.active)},_initialActive:function(){var d=this.options.active,b=this.options.collapsible,S=location.hash.substring(1);return d===null&&(S&&this.tabs.each(function(k,R){if(g(R).attr("aria-controls")===S)return d=k,!1}),d===null&&(d=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(d===null||d===-1)&&(d=this.tabs.length?0:!1)),d!==!1&&(d=this.tabs.index(this.tabs.eq(d)),d===-1&&(d=b?!1:0)),!b&&d===!1&&this.anchors.length&&(d=0),d},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):g()}},_tabKeydown:function(d){var b=g(g.ui.safeActiveElement(this.document[0])).closest("li"),S=this.tabs.index(b),k=!0;if(!this._handlePageNav(d)){switch(d.keyCode){case g.ui.keyCode.RIGHT:case g.ui.keyCode.DOWN:S++;break;case g.ui.keyCode.UP:case g.ui.keyCode.LEFT:k=!1,S--;break;case g.ui.keyCode.END:S=this.anchors.length-1;break;case g.ui.keyCode.HOME:S=0;break;case g.ui.keyCode.SPACE:d.preventDefault(),clearTimeout(this.activating),this._activate(S);return;case g.ui.keyCode.ENTER:d.preventDefault(),clearTimeout(this.activating),this._activate(S===this.options.active?!1:S);return;default:return}d.preventDefault(),clearTimeout(this.activating),S=this._focusNextTab(S,k),!d.ctrlKey&&!d.metaKey&&(b.attr("aria-selected","false"),this.tabs.eq(S).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",S)},this.delay))}},_panelKeydown:function(d){this._handlePageNav(d)||d.ctrlKey&&d.keyCode===g.ui.keyCode.UP&&(d.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(d){if(d.altKey&&d.keyCode===g.ui.keyCode.PAGE_UP)return this._activate(this._focusNextTab(this.options.active-1,!1)),!0;if(d.altKey&&d.keyCode===g.ui.keyCode.PAGE_DOWN)return this._activate(this._focusNextTab(this.options.active+1,!0)),!0},_findNextTab:function(d,b){var S=this.tabs.length-1;function k(){return d>S&&(d=0),d<0&&(d=S),d}for(;g.inArray(k(),this.options.disabled)!==-1;)d=b?d+1:d-1;return d},_focusNextTab:function(d,b){return d=this._findNextTab(d,b),this.tabs.eq(d).trigger("focus"),d},_setOption:function(d,b){if(d==="active"){this._activate(b);return}this._super(d,b),d==="collapsible"&&(this._toggleClass("ui-tabs-collapsible",null,b),!b&&this.options.active===!1&&this._activate(0)),d==="event"&&this._setupEvents(b),d==="heightStyle"&&this._setupHeightStyle(b)},_sanitizeSelector:function(d){return d?d.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var d=this.options,b=this.tablist.children(":has(a[href])");d.disabled=g.map(b.filter(".ui-state-disabled"),function(S){return b.index(S)}),this._processTabs(),d.active===!1||!this.anchors.length?(d.active=!1,this.active=g()):this.active.length&&!g.contains(this.tablist[0],this.active[0])?this.tabs.length===d.disabled.length?(d.active=!1,this.active=g()):this._activate(this._findNextTab(Math.max(0,d.active-1),!1)):d.active=this.tabs.index(this.active),this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var d=this,b=this.tabs,S=this.anchors,k=this.panels;this.tablist=this._getList().attr("role","tablist"),this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header"),this.tablist.on("mousedown"+this.eventNamespace,"> li",function(R){g(this).is(".ui-state-disabled")&&R.preventDefault()}).on("focus"+this.eventNamespace,".ui-tabs-anchor",function(){g(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1}),this._addClass(this.tabs,"ui-tabs-tab","ui-state-default"),this.anchors=this.tabs.map(function(){return g("a",this)[0]}).attr({tabIndex:-1}),this._addClass(this.anchors,"ui-tabs-anchor"),this.panels=g(),this.anchors.each(function(R,W){var se,le,fe,be=g(W).uniqueId().attr("id"),Te=g(W).closest("li"),Ve=Te.attr("aria-controls");d._isLocal(W)?(se=W.hash,fe=se.substring(1),le=d.element.find(d._sanitizeSelector(se))):(fe=Te.attr("aria-controls")||g({}).uniqueId()[0].id,se="#"+fe,le=d.element.find(se),le.length||(le=d._createPanel(fe),le.insertAfter(d.panels[R-1]||d.tablist)),le.attr("aria-live","polite")),le.length&&(d.panels=d.panels.add(le)),Ve&&Te.data("ui-tabs-aria-controls",Ve),Te.attr({"aria-controls":fe,"aria-labelledby":be}),le.attr("aria-labelledby",be)}),this.panels.attr("role","tabpanel"),this._addClass(this.panels,"ui-tabs-panel","ui-widget-content"),b&&(this._off(b.not(this.tabs)),this._off(S.not(this.anchors)),this._off(k.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(d){return g("<div>").attr("id",d).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(d){var b,S,k;for(Array.isArray(d)&&(d.length?d.length===this.anchors.length&&(d=!0):d=!1),k=0;S=this.tabs[k];k++)b=g(S),d===!0||g.inArray(k,d)!==-1?(b.attr("aria-disabled","true"),this._addClass(b,null,"ui-state-disabled")):(b.removeAttr("aria-disabled"),this._removeClass(b,null,"ui-state-disabled"));this.options.disabled=d,this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,d===!0)},_setupEvents:function(d){var b={};d&&g.each(d.split(" "),function(S,k){b[k]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(S){S.preventDefault()}}),this._on(this.anchors,b),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(d){var b,S=this.element.parent();d==="fill"?(b=S.height(),b-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var k=g(this),R=k.css("position");R==="absolute"||R==="fixed"||(b-=k.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){b-=g(this).outerHeight(!0)}),this.panels.each(function(){g(this).height(Math.max(0,b-g(this).innerHeight()+g(this).height()))}).css("overflow","auto")):d==="auto"&&(b=0,this.panels.each(function(){b=Math.max(b,g(this).height("").height())}).height(b))},_eventHandler:function(d){var b=this.options,S=this.active,k=g(d.currentTarget),R=k.closest("li"),W=R[0]===S[0],se=W&&b.collapsible,le=se?g():this._getPanelForTab(R),fe=S.length?this._getPanelForTab(S):g(),be={oldTab:S,oldPanel:fe,newTab:se?g():R,newPanel:le};d.preventDefault(),!(R.hasClass("ui-state-disabled")||R.hasClass("ui-tabs-loading")||this.running||W&&!b.collapsible||this._trigger("beforeActivate",d,be)===!1)&&(b.active=se?!1:this.tabs.index(R),this.active=W?g():R,this.xhr&&this.xhr.abort(),!fe.length&&!le.length&&g.error("jQuery UI Tabs: Mismatching fragment identifier."),le.length&&this.load(this.tabs.index(R),d),this._toggle(d,be))},_toggle:function(d,b){var S=this,k=b.newPanel,R=b.oldPanel;this.running=!0;function W(){S.running=!1,S._trigger("activate",d,b)}function se(){S._addClass(b.newTab.closest("li"),"ui-tabs-active","ui-state-active"),k.length&&S.options.show?S._show(k,S.options.show,W):(k.show(),W())}R.length&&this.options.hide?this._hide(R,this.options.hide,function(){S._removeClass(b.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),se()}):(this._removeClass(b.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),R.hide(),se()),R.attr("aria-hidden","true"),b.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),k.length&&R.length?b.oldTab.attr("tabIndex",-1):k.length&&this.tabs.filter(function(){return g(this).attr("tabIndex")===0}).attr("tabIndex",-1),k.attr("aria-hidden","false"),b.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(d){var b,S=this._findActive(d);S[0]!==this.active[0]&&(S.length||(S=this.active),b=S.find(".ui-tabs-anchor")[0],this._eventHandler({target:b,currentTarget:b,preventDefault:g.noop}))},_findActive:function(d){return d===!1?g():this.tabs.eq(d)},_getIndex:function(d){return typeof d=="string"&&(d=this.anchors.index(this.anchors.filter("[href$='"+g.escapeSelector(d)+"']"))),d},_destroy:function(){this.xhr&&this.xhr.abort(),this.tablist.removeAttr("role").off(this.eventNamespace),this.anchors.removeAttr("role tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){g.data(this,"ui-tabs-destroy")?g(this).remove():g(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")}),this.tabs.each(function(){var d=g(this),b=d.data("ui-tabs-aria-controls");b?d.attr("aria-controls",b).removeData("ui-tabs-aria-controls"):d.removeAttr("aria-controls")}),this.panels.show(),this.options.heightStyle!=="content"&&this.panels.css("height","")},enable:function(d){var b=this.options.disabled;b!==!1&&(d===void 0?b=!1:(d=this._getIndex(d),Array.isArray(b)?b=g.map(b,function(S){return S!==d?S:null}):b=g.map(this.tabs,function(S,k){return k!==d?k:null})),this._setOptionDisabled(b))},disable:function(d){var b=this.options.disabled;if(b!==!0){if(d===void 0)b=!0;else{if(d=this._getIndex(d),g.inArray(d,b)!==-1)return;Array.isArray(b)?b=g.merge([d],b).sort():b=[d]}this._setOptionDisabled(b)}},load:function(d,b){d=this._getIndex(d);var S=this,k=this.tabs.eq(d),R=k.find(".ui-tabs-anchor"),W=this._getPanelForTab(k),se={tab:k,panel:W},le=function(fe,be){be==="abort"&&S.panels.stop(!1,!0),S._removeClass(k,"ui-tabs-loading"),W.removeAttr("aria-busy"),fe===S.xhr&&delete S.xhr};this._isLocal(R[0])||(this.xhr=g.ajax(this._ajaxSettings(R,b,se)),this.xhr&&this.xhr.statusText!=="canceled"&&(this._addClass(k,"ui-tabs-loading"),W.attr("aria-busy","true"),this.xhr.done(function(fe,be,Te){setTimeout(function(){W.html(fe),S._trigger("load",b,se),le(Te,be)},1)}).fail(function(fe,be){setTimeout(function(){le(fe,be)},1)})))},_ajaxSettings:function(d,b,S){var k=this;return{url:d.attr("href").replace(/#.*$/,""),beforeSend:function(R,W){return k._trigger("beforeLoad",b,g.extend({jqXHR:R,ajaxSettings:W},S))}}},_getPanelForTab:function(d){var b=g(d).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+b))}}),g.uiBackCompat!==!1&&g.widget("ui.tabs",g.ui.tabs,{_processTabs:function(){this._superApply(arguments),this._addClass(this.tabs,"ui-tab")}}),g.ui.tabs;/*!
 * jQuery UI Tooltip 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */g.widget("ui.tooltip",{version:"1.13.2",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var d=g(this).attr("title");return g("<a>").text(d).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,track:!1,close:null,open:null},_addDescribedBy:function(d,b){var S=(d.attr("aria-describedby")||"").split(/\s+/);S.push(b),d.data("ui-tooltip-id",b).attr("aria-describedby",String.prototype.trim.call(S.join(" ")))},_removeDescribedBy:function(d){var b=d.data("ui-tooltip-id"),S=(d.attr("aria-describedby")||"").split(/\s+/),k=g.inArray(b,S);k!==-1&&S.splice(k,1),d.removeData("ui-tooltip-id"),S=String.prototype.trim.call(S.join(" ")),S?d.attr("aria-describedby",S):d.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.liveRegion=g("<div>").attr({role:"log","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this.disabledTitles=g([])},_setOption:function(d,b){var S=this;this._super(d,b),d==="content"&&g.each(this.tooltips,function(k,R){S._updateContent(R.element)})},_setOptionDisabled:function(d){this[d?"_disable":"_enable"]()},_disable:function(){var d=this;g.each(this.tooltips,function(b,S){var k=g.Event("blur");k.target=k.currentTarget=S.element[0],d.close(k,!0)}),this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter(function(){var b=g(this);if(b.is("[title]"))return b.data("ui-tooltip-title",b.attr("title")).removeAttr("title")}))},_enable:function(){this.disabledTitles.each(function(){var d=g(this);d.data("ui-tooltip-title")&&d.attr("title",d.data("ui-tooltip-title"))}),this.disabledTitles=g([])},open:function(d){var b=this,S=g(d?d.target:this.element).closest(this.options.items);!S.length||S.data("ui-tooltip-id")||(S.attr("title")&&S.data("ui-tooltip-title",S.attr("title")),S.data("ui-tooltip-open",!0),d&&d.type==="mouseover"&&S.parents().each(function(){var k=g(this),R;k.data("ui-tooltip-open")&&(R=g.Event("blur"),R.target=R.currentTarget=this,b.close(R,!0)),k.attr("title")&&(k.uniqueId(),b.parents[this.id]={element:this,title:k.attr("title")},k.attr("title",""))}),this._registerCloseHandlers(d,S),this._updateContent(S,d))},_updateContent:function(d,b){var S,k=this.options.content,R=this,W=b?b.type:null;if(typeof k=="string"||k.nodeType||k.jquery)return this._open(b,d,k);S=k.call(d[0],function(se){R._delay(function(){d.data("ui-tooltip-open")&&(b&&(b.type=W),this._open(b,d,se))})}),S&&this._open(b,d,S)},_open:function(d,b,S){var k,R,W,se,le=g.extend({},this.options.position);if(!S)return;if(k=this._find(b),k){k.tooltip.find(".ui-tooltip-content").html(S);return}b.is("[title]")&&(d&&d.type==="mouseover"?b.attr("title",""):b.removeAttr("title")),k=this._tooltip(b),R=k.tooltip,this._addDescribedBy(b,R.attr("id")),R.find(".ui-tooltip-content").html(S),this.liveRegion.children().hide(),se=g("<div>").html(R.find(".ui-tooltip-content").html()),se.removeAttr("name").find("[name]").removeAttr("name"),se.removeAttr("id").find("[id]").removeAttr("id"),se.appendTo(this.liveRegion);function fe(be){le.of=be,!R.is(":hidden")&&R.position(le)}this.options.track&&d&&/^mouse/.test(d.type)?(this._on(this.document,{mousemove:fe}),fe(d)):R.position(g.extend({of:b},this.options.position)),R.hide(),this._show(R,this.options.show),this.options.track&&this.options.show&&this.options.show.delay&&(W=this.delayedShow=setInterval(function(){R.is(":visible")&&(fe(le.of),clearInterval(W))},13)),this._trigger("open",d,{tooltip:R})},_registerCloseHandlers:function(d,b){var S={keyup:function(k){if(k.keyCode===g.ui.keyCode.ESCAPE){var R=g.Event(k);R.currentTarget=b[0],this.close(R,!0)}}};b[0]!==this.element[0]&&(S.remove=function(){var k=this._find(b);k&&this._removeTooltip(k.tooltip)}),(!d||d.type==="mouseover")&&(S.mouseleave="close"),(!d||d.type==="focusin")&&(S.focusout="close"),this._on(!0,b,S)},close:function(d){var b,S=this,k=g(d?d.currentTarget:this.element),R=this._find(k);if(!R){k.removeData("ui-tooltip-open");return}b=R.tooltip,!R.closing&&(clearInterval(this.delayedShow),k.data("ui-tooltip-title")&&!k.attr("title")&&k.attr("title",k.data("ui-tooltip-title")),this._removeDescribedBy(k),R.hiding=!0,b.stop(!0),this._hide(b,this.options.hide,function(){S._removeTooltip(g(this))}),k.removeData("ui-tooltip-open"),this._off(k,"mouseleave focusout keyup"),k[0]!==this.element[0]&&this._off(k,"remove"),this._off(this.document,"mousemove"),d&&d.type==="mouseleave"&&g.each(this.parents,function(W,se){g(se.element).attr("title",se.title),delete S.parents[W]}),R.closing=!0,this._trigger("close",d,{tooltip:b}),R.hiding||(R.closing=!1))},_tooltip:function(d){var b=g("<div>").attr("role","tooltip"),S=g("<div>").appendTo(b),k=b.uniqueId().attr("id");return this._addClass(S,"ui-tooltip-content"),this._addClass(b,"ui-tooltip","ui-widget ui-widget-content"),b.appendTo(this._appendTo(d)),this.tooltips[k]={element:d,tooltip:b}},_find:function(d){var b=d.data("ui-tooltip-id");return b?this.tooltips[b]:null},_removeTooltip:function(d){clearInterval(this.delayedShow),d.remove(),delete this.tooltips[d.attr("id")]},_appendTo:function(d){var b=d.closest(".ui-front, dialog");return b.length||(b=this.document[0].body),b},_destroy:function(){var d=this;g.each(this.tooltips,function(b,S){var k=g.Event("blur"),R=S.element;k.target=k.currentTarget=R[0],d.close(k,!0),g("#"+b).remove(),R.data("ui-tooltip-title")&&(R.attr("title")||R.attr("title",R.data("ui-tooltip-title")),R.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}}),g.uiBackCompat!==!1&&g.widget("ui.tooltip",g.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var d=this._superApply(arguments);return this.options.tooltipClass&&d.tooltip.addClass(this.options.tooltipClass),d}}),g.ui.tooltip});/**
 * @author bbecquet
 * @license MIT
 * @see github.com/bbecquet/Leaflet.PolylineOffset
 */function forEachPair(g,B){if(!(!g||g.length<1))for(let M=1,P=g.length;M<P;M++)B(g[M-1],g[M])}function lineEquation(g,B){if(g.x===B.x)return g.y===B.y?null:{x:g.x};const M=(B.y-g.y)/(B.x-g.x);return{a:M,b:g.y-M*g.x}}function intersection(g,B,M,P){const K=lineEquation(g,B),Y=lineEquation(M,P);if(K===null||Y===null)return null;if(K.hasOwnProperty("x"))return Y.hasOwnProperty("x")?null:{x:K.x,y:Y.a*K.x+Y.b};if(Y.hasOwnProperty("x"))return{x:Y.x,y:K.a*Y.x+K.b};if(K.a===Y.a)return null;const re=(Y.b-K.b)/(K.a-Y.a);return{x:re,y:K.a*re+K.b}}function translatePoint(g,B,M){return{x:g.x+B*Math.cos(M),y:g.y+B*Math.sin(M)}}const PolylineOffset={offsetPointLine:function(g,B){const M=[];return forEachPair(g,L.bind((P,K)=>{if(P.x===K.x&&P.y===K.y)return;const re=Math.atan2(P.y-K.y,P.x-K.x)-Math.PI/2;M.push({offsetAngle:re,original:[P,K],offset:[translatePoint(P,B,re),translatePoint(K,B,re)]})},this)),M},offsetPoints:function(g,B){const M=this.offsetPointLine(L.LineUtil.simplify(g,B.smoothFactor),B.offset);return this.joinLineSegments(M,B.offset)},joinSegments:function(g,B,M){return this.circularArc(g,B,M).filter(P=>P)},joinLineSegments:function(g,B){let M=[];const P=g[0],K=g[g.length-1];return P&&K&&(M.push(P.offset[0]),forEachPair(g,L.bind(function(Y,re){M=M.concat(this.joinSegments(Y,re,B))},this)),M.push(K.offset[1])),M},segmentAsVector:function(g){return{x:g[1].x-g[0].x,y:g[1].y-g[0].y}},getSignedAngle:function(g,B){const M=this.segmentAsVector(g),P=this.segmentAsVector(B);return Math.atan2(M.x*P.y-M.y*P.x,M.x*P.x+M.y*P.y)},circularArc:function(g,B,M){if(g.offsetAngle===B.offsetAngle)return[g.offset[1]];const P=this.getSignedAngle(g.offset,B.offset);if(P*M>0&&P*this.getSignedAngle(g.offset,[g.offset[0],B.offset[1]])>0)return[intersection(g.offset[0],g.offset[1],B.offset[0],B.offset[1])];const K=[],Y=g.original[1],re=M>0,D=re?B.offsetAngle:g.offsetAngle;let ne=re?g.offsetAngle:B.offsetAngle;ne<D&&(ne+=Math.PI*2);const ae=Math.PI/8;for(let ue=D;ue<ne;ue+=ae)K.push(translatePoint(Y,M,ue));return K.push(translatePoint(Y,M,ne)),re?K.reverse():K}};L.Polyline.include({_projectLatlngs:function(g,B,M){if(g.length>0&&g[0]instanceof L.LatLng){let K=g.map(L.bind(function(Y){const re=this._map.latLngToLayerPoint(Y);return M&&M.extend(re),re},this));this.options.offset&&(K=PolylineOffset.offsetPoints(K,this.options)),B.push(K.map(Y=>L.point(Y.x,Y.y)))}else g.forEach(L.bind(function(K){this._projectLatlngs(K,B,M)},this))}});L.Polyline.include({setOffset:function(g){return this.options.offset=g,this.redraw(),this}});L.LatLngBounds.prototype.modify=function(g,B){var M=this.getSouthWest(),P=this.getNorthEast(),K=g.latLngToLayerPoint(M),Y=g.latLngToLayerPoint(P);return M=g.layerPointToLatLng(new L.Point(K.x-B,K.y+B)),P=g.layerPointToLatLng(new L.Point(Y.x+B,Y.y-B)),new L.LatLngBounds(M,P)};L.Control.Button=L.Class.extend({initialize:function(g){L.Util.setOptions(this,g)},addTo:function(g){return g.addButton(this),this},onAdd:function(g){this._buttonContainer=g,this._button=L.DomUtil.create("a",this.options.className,this._buttonContainer.getContainer()),this._button.href="#",this.setText(this.options.text);var B=this;this._onClick=function(M){B.options.onClick.call(B,M)},L.DomEvent.on(this._button,"click",L.DomEvent.stopPropagation).on(this._button,"mousedown",L.DomEvent.stopPropagation).on(this._button,"dblclick",L.DomEvent.stopPropagation).on(this._button,"click",L.DomEvent.preventDefault).on(this._button,"click",this._onClick,this)},remove:function(){L.DomEvent.off(this._button,"click",this._onClick),this._buttonContainer.getContainer().removeChild(this._button)},setText:function(g){this._button.title=g,this._button.innerHTML=g}});L.Control.ButtonContainer=L.Control.extend({options:{position:"topleft"},getContainer:function(){return this._container||(this._container=L.DomUtil.create("div",this.options.className)),this._container},onAdd:function(g){return this._map=g,this.getContainer()},addButton:function(g){g.onAdd(this)},addClass:function(g){L.DomUtil.addClass(this.getContainer(),g)},removeClass:function(g){L.DomUtil.removeClass(this.getContainer(),g)}});L.LocationFilter=L.Layer.extend({includes:L.Mixin.Events,options:{enableButton:{enableText:"Select area",disableText:"Remove selection"},adjustButton:{text:"Select area within current zoom"},buttonPosition:"topleft",showButtons:!0,locked:!1,fixed:!1},initialize:function(g){L.Util.setOptions(this,g)},addTo:function(g){return g.addLayer(this),this},onAdd:function(g){this._map=g,this.options.showButtons&&(this.options.enableButton||this.options.adjustButton)&&this._initializeButtonContainer(),this.options.enable&&this.enable()},onRemove:function(g){this.disable(),this._buttonContainer&&this._buttonContainer.removeFrom(g)},getBounds:function(){return new L.LatLngBounds(this._sw,this._ne)},setBounds:function(g){this._nw=g.getNorthWest(),this._ne=g.getNorthEast(),this._sw=g.getSouthWest(),this._se=g.getSouthEast(),this.isEnabled()&&(this._draw(),this.fire("change",{bounds:g}))},isEnabled:function(){return this._enabled},setLocked:function(g){this.options.locked=g,this._toggleMarkerDragging(this._moveMarker,g,"hide-marker")},isLocked:function(){return this.options.locked},setFixed:function(g){this.options.fixed=g,this._toggleMarkerDragging(this._neMarker,g,"hide-marker"),this._toggleMarkerDragging(this._nwMarker,g,"hide-marker"),this._toggleMarkerDragging(this._seMarker,g,"hide-marker"),this._toggleMarkerDragging(this._swMarker,g,"hide-marker")},_toggleMarkerDragging(g,B,M){B?(g.dragging.disable(),g._icon.classList.add(M)):(g.dragging.enable(),g._icon.classList.remove(M))},_drawRectangle:function(g,B){B=B||{};var M={stroke:!1,fill:!0,fillColor:"black",fillOpacity:.3,clickable:!1};B=L.Util.extend(M,B);var P=new L.Rectangle(g,B);return P.addTo(this._layer),P},_drawImageMarker:function(g,B){var M=new L.Marker(g,{icon:new L.DivIcon({iconAnchor:B.anchor,iconSize:B.size,className:B.className}),draggable:!0});return M.addTo(this._layer),M},_drawMoveMarker:function(g){var B=this;return this._moveMarker=this._drawImageMarker(g,{className:"location-filter move-marker "+(this.options.locked?"hide-marker":""),anchor:[-10,-10],size:[13,13]}),this._moveMarker.on("drag",function(M){var P=B._moveMarker.getLatLng(),K=P.lat-B._nw.lat,Y=P.lng-B._nw.lng;B._nw=new L.LatLng(B._nw.lat+K,B._nw.lng+Y,!0),B._ne=new L.LatLng(B._ne.lat+K,B._ne.lng+Y,!0),B._sw=new L.LatLng(B._sw.lat+K,B._sw.lng+Y,!0),B._se=new L.LatLng(B._se.lat+K,B._se.lng+Y,!0),B._draw()}),this._setupDragendListener(this._moveMarker),this._moveMarker},_drawResizeMarker:function(g,B,M,P,K){return this._drawImageMarker(g,{className:"location-filter resize-marker "+B+" "+(this.options.fixed?"hide-marker":""),anchor:[7,6],size:[13,12]})},_setupResizeMarkerTracking:function(g,B){var M=this;g.on("drag",function(P){var K=g.getLatLng(),Y=B.moveAlong.lat,re=B.moveAlong.lng;Y.setLatLng(new L.LatLng(K.lat,Y.getLatLng().lng,!0)),re.setLatLng(new L.LatLng(re.getLatLng().lat,K.lng,!0));var D=[M._nwMarker.getLatLng(),M._neMarker.getLatLng(),M._swMarker.getLatLng(),M._seMarker.getLatLng()];D.sort(function(ne,ae){return ne.lat!=ae.lat?ae.lat-ne.lat:ne.lng-ae.lng}),M._nw=D[0],M._ne=D[1],M._sw=D[2],M._se=D[3],M._draw({repositionResizeMarkers:!1})}),this._setupDragendListener(g)},_setupDragendListener:function(g){var B=this;g.on("dragend",function(M){B.fire("change",{bounds:B.getBounds()})})},_calculateBounds:function(){var g=this._map.getBounds(),B=new L.LatLngBounds(new L.LatLng(g.getSouthWest().lat-.1,g.getSouthWest().lng-.1,!0),new L.LatLng(g.getNorthEast().lat+.1,g.getNorthEast().lng+.1,!0));this._osw=B.getSouthWest(),this._one=B.getNorthEast(),this._northBounds=new L.LatLngBounds(new L.LatLng(this._ne.lat,this._osw.lng,!0),this._one),this._westBounds=new L.LatLngBounds(new L.LatLng(this._sw.lat,this._osw.lng,!0),this._nw),this._eastBounds=new L.LatLngBounds(this._se,new L.LatLng(this._ne.lat,this._one.lng,!0)),this._southBounds=new L.LatLngBounds(this._osw,new L.LatLng(this._sw.lat,this._one.lng,!0))},_initialDraw:function(){this._initialDrawCalled||(this._layer=new L.LayerGroup,this._calculateBounds(),this._northRect=this._drawRectangle(this._northBounds),this._westRect=this._drawRectangle(this._westBounds),this._eastRect=this._drawRectangle(this._eastBounds),this._southRect=this._drawRectangle(this._southBounds),this._innerRect=this._drawRectangle(this.getBounds(),{fillOpacity:0,stroke:!0,color:"white",weight:1,opacity:.9}),this._nwMarker=this._drawResizeMarker(this._nw,"nw"),this._neMarker=this._drawResizeMarker(this._ne,"ne"),this._swMarker=this._drawResizeMarker(this._sw,"sw"),this._seMarker=this._drawResizeMarker(this._se,"se"),this._setupResizeMarkerTracking(this._nwMarker,{moveAlong:{lat:this._neMarker,lng:this._swMarker}}),this._setupResizeMarkerTracking(this._neMarker,{moveAlong:{lat:this._nwMarker,lng:this._seMarker}}),this._setupResizeMarkerTracking(this._swMarker,{moveAlong:{lat:this._seMarker,lng:this._nwMarker}}),this._setupResizeMarkerTracking(this._seMarker,{moveAlong:{lat:this._swMarker,lng:this._neMarker}}),this._moveMarker=this._drawMoveMarker(this._nw),this._initialDrawCalled=!0)},_draw:function(g){g=L.Util.extend({repositionResizeMarkers:!0},g),this._calculateBounds(),this._northRect.setBounds(this._northBounds),this._westRect.setBounds(this._westBounds),this._eastRect.setBounds(this._eastBounds),this._southRect.setBounds(this._southBounds),this._innerRect.setBounds(this.getBounds()),g.repositionResizeMarkers&&(this._nwMarker.setLatLng(this._nw),this._neMarker.setLatLng(this._ne),this._swMarker.setLatLng(this._sw),this._seMarker.setLatLng(this._se)),this._moveMarker.setLatLng(this._nw)},_adjustToMap:function(){this.setBounds(this._map.getBounds()),this._map.zoomOut()},enable:function(){if(!this._enabled){var g;this._sw&&this._ne?g=new L.LatLngBounds(this._sw,this._ne):this.options.bounds?g=this.options.bounds:g=this._map.getBounds(),this._map.invalidateSize(),this._nw=g.getNorthWest(),this._ne=g.getNorthEast(),this._sw=g.getSouthWest(),this._se=g.getSouthEast(),this.options.showButtons&&(this._buttonContainer&&this._buttonContainer.addClass("enabled"),this._enableButton&&this._enableButton.setText(this.options.enableButton.disableText),this.options.adjustButton&&this._createAdjustButton()),this._initialDraw(),this._draw();var B=this;this._moveHandler=function(){B._draw()},this._map.on("move",this._moveHandler),this._layer.addTo(this._map);var M=this._map.getBounds();g=new L.LatLngBounds(this._sw,this._ne).modify(this._map,10),(!M.contains(g.getSouthWest())||!M.contains(g.getNorthEast()))&&this._map.fitBounds(g),this._enabled=!0,this.fire("enabled")}},disable:function(){this._enabled&&(this.options.showButtons&&(this._buttonContainer&&this._buttonContainer.removeClass("enabled"),this._enableButton&&this._enableButton.setText(this.options.enableButton.enableText),this._adjustButton&&this._adjustButton.remove()),this._map.off("move",this._moveHandler),this._map.removeLayer(this._layer),this._enabled=!1,this.fire("disabled"))},_createAdjustButton:function(){var g=this;this._adjustButton=new L.Control.Button({className:"adjust-button",text:this.options.adjustButton.text,onClick:function(B){g._adjustToMap(),g.fire("adjustToZoomClick")}}).addTo(this._buttonContainer)},_initializeButtonContainer:function(){var g=this;this._buttonContainer=new L.Control.ButtonContainer({className:"location-filter button-container",position:this.options.buttonPosition}),this.options.enableButton&&(this._enableButton=new L.Control.Button({className:"enable-button",text:this.options.enableButton.enableText,onClick:function(B){g._enabled?(g.disable(),g.fire("disableClick")):(g.enable(),g.fire("enableClick"))}}).addTo(this._buttonContainer)),this._buttonContainer.addTo(this._map)}});window.CodeMirror=function(){function g(ce,ye){var xe={},Me=g.defaults;for(var Ge in Me)Me.hasOwnProperty(Ge)&&(xe[Ge]=(ye&&ye.hasOwnProperty(Ge)?ye:Me)[Ge]);var Le=bi("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em");Le.setAttribute("wrap","off"),Le.setAttribute("autocorrect","off"),Le.setAttribute("autocapitalize","off");var Ke=bi("div",[Le],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),st=bi("div",null,"CodeMirror-scrollbar-inner"),_t=bi("div",[st],"CodeMirror-scrollbar"),xt=bi("div"),kt=bi("div",null,null,"position: relative; z-index: -1"),ai=bi("pre","Â ","CodeMirror-cursor"),Di=bi("pre","Â ","CodeMirror-cursor","visibility: hidden"),ni=bi("div",null,null,"position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden;"),ei=bi("div",[ni,ai,Di,kt,xt],null,"position: relative; z-index: 0"),Ui=bi("div",null,"CodeMirror-gutter-text"),Qi=bi("div",[Ui],"CodeMirror-gutter"),hr=bi("div",[Qi,bi("div",[ei],"CodeMirror-lines")],null,"position: relative"),Ki=bi("div",[hr],null,"position: relative"),Xt=bi("div",[Ki],"CodeMirror-scroll");Xt.setAttribute("tabIndex","-1");var br=bi("div",[Ke,_t,Xt],"CodeMirror"+(xe.lineWrapping?" CodeMirror-wrap":""));ce.appendChild?ce.appendChild(br):ce(br),oo(),Pa(),B&&(Le.style.width="0px"),ut||(Xt.draggable=!0),ei.style.outline="none",xe.tabindex!=null&&(Le.tabIndex=xe.tabindex),xe.autofocus&&Rs(),!xe.gutter&&!xe.lineNumbers&&(Qi.style.display="none"),Tt&&(Ke.style.height="1px",Ke.style.position="absolute"),qt?(_t.style.zIndex=-2,_t.style.visibility="hidden"):Oe&&(_t.style.minWidth="18px");var wi=new $t,Ir=new $t,Pr,Zi,pi=new le([new se([new W("")])]),_s=0,dr;no();var Dt={from:{line:0,ch:0},to:{line:0,ch:0},inverted:!1},Yr,Ys,_r,Br=0,Cr,rr=!1,Lr=!1,sr=!1,jr,ss,ps,cr,js,ys,Os,pn=0,Qr=0,es=0,xo=0,Zs,An=er(0),ta=!1,ja=!0,Qn=!1,wa=null;qi(function(){Ba(xe.value||""),jr=!1})();var Nr=new Ue;Mt(Xt,"mousedown",qi(Sa)),Mt(Xt,"dblclick",qi(On)),Mt(ei,"selectstart",qe),De||Mt(Xt,"contextmenu",fa),Mt(Xt,"scroll",Ta),Mt(_t,"scroll",Ea),Mt(_t,"mousedown",function(){dr&&setTimeout(Rs,0)});var Vo=Mt(window,"resize",function(){br.parentNode?Js(!0):Vo()},!0);Mt(Le,"keyup",qi(Co)),Mt(Le,"input",aa),Mt(Le,"keydown",qi(pr)),Mt(Le,"keypress",qi($a)),Mt(Le,"focus",In),Mt(Le,"blur",sa);function Bo(we){xe.onDragEvent&&xe.onDragEvent(wr,ke(we))||pt(we)}xe.dragDrop&&(Mt(Xt,"dragstart",ks),Mt(Xt,"dragenter",Bo),Mt(Xt,"dragover",Bo),Mt(Xt,"drop",qi(Za))),Mt(Xt,"paste",function(){Rs(),aa()}),Mt(Le,"paste",function(){sr=!0,aa()}),Mt(Le,"cut",qi(function(){xe.readOnly||Rn("")})),Tt&&Mt(Ki,"mouseup",function(){document.activeElement==Le&&Le.blur(),Rs()});var xa;try{xa=document.activeElement==Le}catch{}xa||xe.autofocus?setTimeout(In,20):sa();function Tn(we){return we>=0&&we<pi.size}var wr=br.CodeMirror={getValue:Ca,setValue:qi(Ba),getSelection:ka,replaceSelection:qi(Rn),focus:function(){window.focus(),Rs(),In(),aa()},setOption:function(we,Re){var Xe=xe[we];xe[we]=Re,we=="mode"||we=="indentUnit"?no():we=="readOnly"&&Re=="nocursor"?(sa(),Le.blur()):we=="readOnly"&&!Re?hn(!0):we=="theme"?oo():we=="lineWrapping"&&Xe!=Re?qi(ao)():we=="tabSize"?Js(!0):we=="keyMap"?Pa():we=="tabindex"?Le.tabIndex=Re:we=="showCursorWhenSelecting"&&Io(),(we=="lineNumbers"||we=="gutter"||we=="firstLineNumber"||we=="theme"||we=="lineNumberFormatter")&&(Ma(),Js(!0))},getOption:function(we){return xe[we]},getMode:function(){return Zi},undo:qi(na),redo:qi(pl),indentLine:qi(function(we,Re){typeof Re!="string"&&(Re==null?Re=xe.smartIndent?"smart":"prev":Re=Re?"add":"subtract"),Tn(we)&&so(we,Re)}),indentSelection:qi(Fo),historySize:function(){return{undo:Nr.done.length,redo:Nr.undone.length}},clearHistory:function(){Nr=new Ue},setHistory:function(we){Nr=new Ue,Nr.done=we.done,Nr.undone=we.undone},getHistory:function(){function we(Re){for(var Xe=0,je=[],yt;Xe<Re.length;++Xe){je.push(yt=[]);for(var Et=0,Ht=Re[Xe];Et<Ht.length;++Et){var jt=[],hi=Ht[Et];yt.push({start:hi.start,added:hi.added,old:jt});for(var Wt=0;Wt<hi.old.length;++Wt)jt.push(vi(hi.old[Wt]))}}return je}return{done:we(Nr.done),undone:we(Nr.undone)}},matchBrackets:qi(function(){qr(!0)}),getTokenAt:qi(function(we){return we=yr(we),er(we.line).getTokenAt(Zi,Ms(we.line),xe.tabSize,we.ch)}),getStateAfter:function(we){return we=Ji(we??pi.size-1),Ms(we+1)},cursorCoords:function(we,Re){return we==null&&(we=Dt.inverted),this.charCoords(we?Dt.from:Dt.to,Re)},charCoords:function(we,Re){return we=yr(we),Re=="local"?xs(we,!1):Re=="div"?xs(we,!0):jo(we)},coordsChar:function(we){var Re=ii(ei);return Kn(we.x-Re.left,we.y-Re.top)},defaultTextHeight:function(){return Bs()},markText:qi(La),setBookmark:_l,findMarksAt:Yo,setMarker:qi(Wr),clearMarker:qi(Vn),setLineClass:qi(ko),hideLine:qi(function(we){return Aa(we,!0)}),showLine:qi(function(we){return Aa(we,!1)}),onDeleteLine:function(we,Re){if(typeof we=="number"){if(!Tn(we))return null;we=er(we)}return(we.handlers||(we.handlers=[])).push(Re),we},lineInfo:Do,getViewport:function(){return{from:Qr,to:es}},addWidget:function(we,Re,Xe,je,yt){we=xs(yr(we));var Et=we.yBot,Ht=we.x;if(Re.style.position="absolute",Ki.appendChild(Re),je=="over")Et=we.y;else if(je=="near"){var jt=Math.max(Xt.offsetHeight,pi.height*Bs()),hi=Math.max(Ki.clientWidth,ei.clientWidth)-lo();we.yBot+Re.offsetHeight>jt&&we.y>Re.offsetHeight&&(Et=we.y-Re.offsetHeight),Ht+Re.offsetWidth>hi&&(Ht=hi-Re.offsetWidth)}Re.style.top=Et+Qa()+"px",Re.style.left=Re.style.right="",yt=="right"?(Ht=Ki.clientWidth-Re.offsetWidth,Re.style.right="0px"):(yt=="left"?Ht=0:yt=="middle"&&(Ht=(Ki.clientWidth-Re.offsetWidth)/2),Re.style.left=Ht+lo()+"px"),Xe&&to(Ht,Et,Ht+Re.offsetWidth,Et+Re.offsetHeight)},lineCount:function(){return pi.size},clipPos:yr,getCursor:function(we){return(we==null||we=="head")&&(we=Dt.inverted),we=="anchor"&&(we=!Dt.inverted),we=="end"&&(we=!1),mi(we?Dt.from:Dt.to)},somethingSelected:function(){return!Wi(Dt.from,Dt.to)},setCursor:qi(function(we,Re,Xe){Re==null&&typeof we.line=="number"?$s(we.line,we.ch,Xe):$s(we,Re,Xe)}),setSelection:qi(function(we,Re,Xe){(Xe?Hs:Da)(yr(we),yr(Re||we))}),getLine:function(we){if(Tn(we))return er(we).text},getLineHandle:function(we){if(Tn(we))return er(we)},setLine:qi(function(we,Re){Tn(we)&&cn(Re,{line:we,ch:0},{line:we,ch:er(we).text.length})}),removeLine:qi(function(we){Tn(we)&&cn("",{line:we,ch:0},yr({line:we+1,ch:0}))}),replaceRange:qi(cn),getRange:function(we,Re,Xe){return eo(yr(we),yr(Re),Xe)},triggerOnKeyDown:qi(pr),execCommand:function(we){return ne[we](wr)},moveH:qi(Mr),deleteH:qi(zn),moveV:qi(Ua),toggleOverwrite:function(){rr?(rr=!1,ai.className=ai.className.replace(" CodeMirror-overwrite","")):(rr=!0,ai.className+=" CodeMirror-overwrite")},posFromIndex:function(we){var Re=0,Xe;return pi.iter(0,pi.size,function(je){var yt=je.text.length+1;if(yt>we)return Xe=we,!0;we-=yt,++Re}),yr({line:Re,ch:Xe})},indexFromPos:function(we){if(we.line<0||we.ch<0)return 0;var Re=we.ch;return pi.iter(0,we.line,function(Xe){Re+=Xe.text.length+1}),Re},scrollTo:function(we,Re){we!=null&&(Xt.scrollLeft=we),Re!=null&&(_t.scrollTop=Xt.scrollTop=Re),Js([])},getScrollInfo:function(){return{x:Xt.scrollLeft,y:_t.scrollTop,height:_t.scrollHeight,width:Xt.scrollWidth}},scrollIntoView:function(we){var Re=xs(we?yr(we):Dt.inverted?Dt.from:Dt.to);to(Re.x,Re.y,Re.x,Re.yBot)},setSize:function(we,Re){function Xe(je){return je=String(je),/^\d+$/.test(je)?je+"px":je}we!=null&&(br.style.width=Xe(we)),Re!=null&&(Xt.style.height=Xe(Re)),wr.refresh()},operation:function(we){return qi(we)()},compoundChange:function(we){return tn(we)},refresh:function(){Js(!0,null,Br),_t.scrollHeight>Br&&(_t.scrollTop=Br)},getInputField:function(){return Le},getWrapperElement:function(){return br},getScrollerElement:function(){return Xt},getGutterElement:function(){return Qi}};function er(we){return fe(pi,we)}function As(we,Re){ys=!0;for(var Xe=Re-we.height,je=we;je;je=je.parent)je.height+=Xe}function ia(we,Re){return we.styles||we.highlight(Zi,we.stateAfter=Ms(be(we)),xe.tabSize),we.getContent(xe.tabSize,Re,xe.lineWrapping)}function Ba(we){var Re={line:0,ch:0};Eo(Re,{line:pi.size-1,ch:er(pi.size-1).text.length},$r(we),Re,Re),jr=!0}function Ca(we){var Re=[];return pi.iter(0,pi.size,function(Xe){Re.push(Xe.text)}),Re.join(we||`
`)}function Ea(we){Math.abs(_t.scrollTop-Br)>1&&(Br=Xt.scrollTop=_t.scrollTop,Js([]))}function Ta(we){xe.fixedGutter&&Qi.style.left!=Xt.scrollLeft+"px"&&(Qi.style.left=Xt.scrollLeft+"px"),Math.abs(Xt.scrollTop-Br)>1&&(Br=Xt.scrollTop,_t.scrollTop!=Br&&(_t.scrollTop=Br),Js([])),xe.onScroll&&xe.onScroll(wr)}function Sa(we){Xo(Nt(we,"shiftKey"));for(var Re=Ft(we);Re!=br;Re=Re.parentNode)if(Re.parentNode==Ki&&Re!=hr)return;for(var Re=Ft(we);Re!=br;Re=Re.parentNode)if(Re.parentNode==Ui)return xe.onGutterClick&&xe.onGutterClick(wr,ji(Ui.childNodes,Re)+Qr,we),qe(we);var Xe=ua(we);switch(zt(we)){case 3:De&&fa(we);return;case 2:Xe&&$s(Xe.line,Xe.ch,!0),setTimeout(Rs,20),qe(we);return}if(!Xe){Ft(we)==Xt&&qe(we);return}dr||In();var je=+new Date,yt="single";if(_r&&_r.time>je-400&&Wi(_r.pos,Xe))yt="triple",qe(we),setTimeout(Rs,20),ml(Xe.line);else if(Ys&&Ys.time>je-400&&Wi(Ys.pos,Xe)){yt="double",_r={time:je,pos:Xe},qe(we);var Et=ro(Xe);Hs(Et.from,Et.to)}else Ys={time:je,pos:Xe};function Ht(Xi){ut&&(Xt.draggable=!1),Cr=!1,nr(),Wt(),Math.abs(we.clientX-Xi.clientX)+Math.abs(we.clientY-Xi.clientY)<10&&(qe(Xi),$s(Xe.line,Xe.ch,!0),Rs())}var jt=Xe,hi;if(xe.dragDrop&&ci&&!xe.readOnly&&!Wi(Dt.from,Dt.to)&&!Zt(Xe,Dt.from)&&!Zt(Dt.to,Xe)&&yt=="single"){ut&&(Xt.draggable=!0);var nr=Mt(document,"mouseup",qi(Ht),!0),Wt=Mt(Xt,"drop",qi(Ht),!0);Cr=!0,Xt.dragDrop&&Xt.dragDrop();return}qe(we),yt=="single"&&$s(Xe.line,Xe.ch,!0);var Gi=Dt.from,zi=Dt.to;function Oi(Xi){if(yt=="single"){Hs(yr(Xe),Xi);return}if(Gi=yr(Gi),zi=yr(zi),yt=="double"){var Or=ro(Xi);Zt(Xi,Gi)?Hs(Or.from,zi):Hs(Gi,Or.to)}else yt=="triple"&&(Zt(Xi,Gi)?Hs(zi,yr({line:Xi.line,ch:0})):Hs(Gi,yr({line:Xi.line+1,ch:0})))}function mr(Xi){var Or=ua(Xi,!0);if(Or&&!Wi(Or,jt)){dr||In(),jt=Or,Oi(Or),jr=!1;var Sr=gr();(Or.line>=Sr.to||Or.line<Sr.from)&&(hi=setTimeout(qi(function(){mr(Xi)}),150))}}function ur(Xi){clearTimeout(hi);var Or=ua(Xi);Or&&Oi(Or),qe(Xi),Rs(),jr=!0,vr(),nr()}var vr=Mt(document,"mousemove",qi(function(Xi){clearTimeout(hi),qe(Xi),!ze&&!zt(Xi)?ur(Xi):mr(Xi)}),!0),nr=Mt(document,"mouseup",qi(ur),!0)}function On(we){for(var Re=Ft(we);Re!=br;Re=Re.parentNode)if(Re.parentNode==Ui)return qe(we);qe(we)}function Za(we){if(!(xe.onDragEvent&&xe.onDragEvent(wr,ke(we)))){qe(we);var Re=ua(we,!0),Xe=we.dataTransfer.files;if(!(!Re||xe.readOnly))if(Xe&&Xe.length&&window.FileReader&&window.File)for(var je=Xe.length,yt=Array(je),Et=0,Ht=function(hi,Wt){var Gi=new FileReader;Gi.onload=function(){yt[Wt]=Gi.result,++Et==je&&(Re=yr(Re),qi(function(){var zi=cn(yt.join(""),Re,Re);Hs(Re,zi)})())},Gi.readAsText(hi)},jt=0;jt<je;++jt)Ht(Xe[jt],jt);else{if(Cr&&!(Zt(Re,Dt.from)||Zt(Dt.to,Re)))return;try{var yt=we.dataTransfer.getData("Text");yt&&tn(function(){var Wt=Dt.from,Gi=Dt.to;Hs(Re,Re),Cr&&cn("",Wt,Gi),Rn(yt),Rs()})}catch{}}}}function ks(we){var Re=ka();we.dataTransfer.setData("Text",Re),we.dataTransfer.setDragImage&&we.dataTransfer.setDragImage(bi("img"),0,0)}function gs(we,Re){if(typeof we=="string"&&(we=ne[we],!we))return!1;var Xe=Yr;try{xe.readOnly&&(Lr=!0),Re&&(Yr=null),we(wr)}catch(je){if(je!=ri)throw je;return!1}finally{Yr=Xe,Lr=!1}return!0}var Ja;function Ia(we){var Re=ue(xe.keyMap),Xe=Re.auto;clearTimeout(Ja),Xe&&!Be(we)&&(Ja=setTimeout(function(){ue(xe.keyMap)==Re&&(xe.keyMap=Xe.call?Xe.call(null,wr):Xe)},50));var je=Ie[Nt(we,"keyCode")],yt=!1;if(je==null||we.altGraphKey)return!1;Nt(we,"altKey")&&(je="Alt-"+je),Nt(we,vt?"metaKey":"ctrlKey")&&(je="Ctrl-"+je),Nt(we,vt?"ctrlKey":"metaKey")&&(je="Cmd-"+je);var Et=!1;function Ht(){Et=!0}return Nt(we,"shiftKey")?yt=ge("Shift-"+je,xe.extraKeys,xe.keyMap,function(jt){return gs(jt,!0)},Ht)||ge(je,xe.extraKeys,xe.keyMap,function(jt){if(typeof jt=="string"&&/^go[A-Z]/.test(jt))return gs(jt)},Ht):yt=ge(je,xe.extraKeys,xe.keyMap,gs,Ht),Et&&(yt=!1),yt&&(qe(we),Fn(),Je&&(we.oldKeyCode=we.keyCode,we.keyCode=0)),yt}function ra(we,Re){var Xe=ge("'"+Re+"'",xe.extraKeys,xe.keyMap,function(je){return gs(je,!0)});return Xe&&(qe(we),Fn()),Xe}var Sn=null;function pr(we){if(dr||In(),ze&&we.keyCode==27&&(we.returnValue=!1),Qn&&oa()&&(Qn=!1),!(xe.onKeyEvent&&xe.onKeyEvent(wr,ke(we)))){var Re=Nt(we,"keyCode");Xo(Re==16||Nt(we,"shiftKey"));var Xe=Ia(we);nt&&(Sn=Xe?Re:null,!Xe&&Re==88&&Nt(we,M?"metaKey":"ctrlKey")&&Rn(""))}}function $a(we){if(Qn&&oa(),!(xe.onKeyEvent&&xe.onKeyEvent(wr,ke(we)))){var Re=Nt(we,"keyCode"),Xe=Nt(we,"charCode");if(nt&&Re==Sn){Sn=null,qe(we);return}if(!((nt&&(!we.which||we.which<10)||Tt)&&Ia(we))){var je=String.fromCharCode(Xe??Re);xe.electricChars&&Zi.electricChars&&xe.smartIndent&&!xe.readOnly&&Zi.electricChars.indexOf(je)>-1&&setTimeout(qi(function(){so(Dt.to.line,"smart")}),75),!ra(we,je)&&aa()}}}function Co(we){xe.onKeyEvent&&xe.onKeyEvent(wr,ke(we))||Nt(we,"keyCode")==16&&(Yr=null)}function In(){xe.readOnly!="nocursor"&&(dr||(xe.onFocus&&xe.onFocus(wr),dr=!0,Xt.className.search(/\bCodeMirror-focused\b/)==-1&&(Xt.className+=" CodeMirror-focused")),gn(),Fn())}function sa(){dr&&(xe.onBlur&&xe.onBlur(wr),dr=!1,Zs&&qi(function(){Zs&&(Zs(),Zs=null)})(),Xt.className=Xt.className.replace(" CodeMirror-focused","")),clearInterval(Pr),setTimeout(function(){dr||(Yr=null)},150)}function Eo(we,Re,Xe,je,yt){if(!Lr){var Et=[];if(pi.iter(we.line,Re.line+1,function(jt){Et.push(b(jt.text,jt.markedSpans))}),Nr)for(Nr.addChange(we.line,Xe.length,Et);Nr.done.length>xe.undoDepth;)Nr.done.shift();var Ht=Yi(d(Et[0]),d(_i(Et)),we.ch,Re.ch,Xe);Ko(we,Re,Ht,je,yt)}}function To(we,Re){if(we.length){for(var Xe=we.pop(),je=[],yt=Xe.length-1;yt>=0;yt-=1){var Et=Xe[yt],Ht=[],jt=Et.start+Et.added;pi.iter(Et.start,jt,function(Wt){Ht.push(b(Wt.text,Wt.markedSpans))}),je.push({start:Et.start,added:Et.old.length,old:Ht});var hi={line:Et.start+Et.old.length-1,ch:Tr(vi(_i(Ht)),vi(_i(Et.old)))};Ko({line:Et.start,ch:0},{line:jt-1,ch:er(jt-1).text.length},Et.old,hi,hi)}jr=!0,Re.push(je)}}function na(){To(Nr.done,Nr.undone)}function pl(){To(Nr.undone,Nr.done)}function Ko(we,Re,Xe,je,yt){if(Lr)return;var Et=!1,Ht=An.text.length;xe.lineWrapping||pi.iter(we.line,Re.line+1,function(Sr){if(!Sr.hidden&&Sr.text.length==Ht)return Et=!0,!0}),(we.line!=Re.line||Xe.length>1)&&(ys=!0);var jt=Re.line-we.line,hi=er(we.line),Wt=er(Re.line),Gi=_i(Xe);if(we.ch==0&&Re.ch==0&&vi(Gi)==""){for(var zi=[],Oi=0,mr=Xe.length-1;Oi<mr;++Oi)zi.push(new W(vi(Xe[Oi]),d(Xe[Oi])));Wt.update(Wt.text,d(Gi)),jt&&pi.remove(we.line,jt,Os),zi.length&&pi.insert(we.line,zi)}else if(hi==Wt)if(Xe.length==1)hi.update(hi.text.slice(0,we.ch)+vi(Xe[0])+hi.text.slice(Re.ch),d(Xe[0]));else{for(var zi=[],Oi=1,mr=Xe.length-1;Oi<mr;++Oi)zi.push(new W(vi(Xe[Oi]),d(Xe[Oi])));zi.push(new W(vi(Gi)+hi.text.slice(Re.ch),d(Gi))),hi.update(hi.text.slice(0,we.ch)+vi(Xe[0]),d(Xe[0])),pi.insert(we.line+1,zi)}else if(Xe.length==1)hi.update(hi.text.slice(0,we.ch)+vi(Xe[0])+Wt.text.slice(Re.ch),d(Xe[0])),pi.remove(we.line+1,jt,Os);else{var zi=[];hi.update(hi.text.slice(0,we.ch)+vi(Xe[0]),d(Xe[0])),Wt.update(vi(Gi)+Wt.text.slice(Re.ch),d(Gi));for(var Oi=1,mr=Xe.length-1;Oi<mr;++Oi)zi.push(new W(vi(Xe[Oi]),d(Xe[Oi])));jt>1&&pi.remove(we.line+1,jt-1,Os),pi.insert(we.line+1,zi)}if(xe.lineWrapping){var ur=Math.max(5,Xt.clientWidth/Gn()-3);pi.iter(we.line,we.line+Xe.length,function(Sr){if(!Sr.hidden){var bs=Math.ceil(Sr.text.length/ur)||1;bs!=Sr.height&&As(Sr,bs)}})}else pi.iter(we.line,we.line+Xe.length,function(Sr){var bs=Sr.text;!Sr.hidden&&bs.length>Ht&&(An=Sr,Ht=bs.length,ja=!0,Et=!1)}),Et&&(ta=!0);_s=Math.min(_s,we.line),co(400);var vr=Xe.length-jt-1;if(ps.push({from:we.line,to:Re.line+1,diff:vr}),xe.onChange){for(var Oi=0;Oi<Xe.length;++Oi)typeof Xe[Oi]!="string"&&(Xe[Oi]=Xe[Oi].text);var nr={from:we,to:Re,text:Xe};if(cr){for(var Xi=cr;Xi.next;Xi=Xi.next);Xi.next=nr}else cr=nr}function Or(Sr){return Sr<=Math.min(Re.line,Re.line+vr)?Sr:Sr+vr}Da(yr(je),yr(yt),Or(Dt.from.line),Or(Dt.to.line))}function Go(){var we=pi.height*Bs()+2*Qa();return we*.99>Xt.offsetHeight?we:!1}function So(we){var Re=Go();_t.style.display=Re?"block":"none",Re?(st.style.height=Ki.style.minHeight=Re+"px",_t.style.height=Xt.clientHeight+"px",we!=null&&(_t.scrollTop=Xt.scrollTop=we,ut&&setTimeout(function(){_t.scrollTop==we&&(_t.scrollTop=we+(we?-1:1),_t.scrollTop=we)},0))):Ki.style.minHeight="",hr.style.top=pn*Bs()+"px"}function Wo(){An=er(0),ja=!0;var we=An.text.length;pi.iter(1,pi.size,function(Re){var Xe=Re.text;!Re.hidden&&Xe.length>we&&(we=Xe.length,An=Re)}),ta=!1}function cn(we,Re,Xe){Re=yr(Re),Xe?Xe=yr(Xe):Xe=Re,we=$r(we);function je(Et){if(Zt(Et,Re))return Et;if(!Zt(Xe,Et))return yt;var Ht=Et.line+we.length-(Xe.line-Re.line)-1,jt=Et.ch;return Et.line==Xe.line&&(jt+=_i(we).length-(Xe.ch-(Xe.line==Re.line?Re.ch:0))),{line:Ht,ch:jt}}var yt;return Fa(we,Re,Xe,function(Et){return yt=Et,{from:je(Dt.from),to:je(Dt.to)}}),yt}function Rn(we,Re){Fa($r(we),Dt.from,Dt.to,function(Xe){return Re=="end"?{from:Xe,to:Xe}:Re=="start"?{from:Dt.from,to:Dt.from}:{from:Dt.from,to:Xe}})}function Fa(we,Re,Xe,je){var yt=we.length==1?we[0].length+Re.ch:_i(we).length,Et=je({line:Re.line+we.length-1,ch:yt});Eo(Re,Xe,we,Et.from,Et.to)}function eo(we,Re,Xe){var je=we.line,yt=Re.line;if(je==yt)return er(je).text.slice(we.ch,Re.ch);var Et=[er(je).text.slice(we.ch)];return pi.iter(je+1,yt,function(Ht){Et.push(Ht.text)}),Et.push(er(yt).text.slice(0,Re.ch)),Et.join(Xe||`
`)}function ka(we){return eo(Dt.from,Dt.to,we)}function gn(){Qn||wi.set(xe.pollInterval,function(){oa(),dr&&gn()})}function aa(){var we=!1;Qn=!0;function Re(){var Xe=oa();!Xe&&!we?(we=!0,wi.set(60,Re)):(Qn=!1,gn())}wi.set(20,Re)}var Ds="";function oa(){if(!dr||it(Le)||xe.readOnly)return!1;var we=Le.value;if(we==Ds)return!1;Wn||da(),Yr=null;for(var Re=0,Xe=Math.min(Ds.length,we.length);Re<Xe&&Ds[Re]==we[Re];)++Re;return Re<Ds.length?Dt.from={line:Dt.from.line,ch:Dt.from.ch-(Ds.length-Re)}:rr&&Wi(Dt.from,Dt.to)&&!sr&&(Dt.to={line:Dt.to.line,ch:Math.min(er(Dt.to.line).text.length,Dt.to.ch+(we.length-Re))}),Rn(we.slice(Re),"end"),we.length>1e3?Le.value=Ds="":Ds=we,Wn||Zo(),sr=!1,!0}function hn(we){Wi(Dt.from,Dt.to)?we&&(Ds=Le.value=""):(Ds="",Le.value=ka(),dr&&Ti(Le))}function Rs(){xe.readOnly!="nocursor"&&(Je||document.activeElement!=Le)&&Le.focus()}function la(){var we=Hn();if(to(we.x,we.y,we.x,we.yBot),!!dr){var Re=Ki.getBoundingClientRect(),Xe=null;if(we.y+Re.top<0?Xe=!0:we.y+Re.top+Bs()>(window.innerHeight||document.documentElement.clientHeight)&&(Xe=!1),Xe!=null){var je=ai.style.display=="none";je&&(ai.style.display="",ai.style.left=we.x+"px",ai.style.top=we.y-pn+"px"),ai.scrollIntoView(Xe),je&&(ai.style.display="none")}}}function Hn(){var we=xs(Dt.inverted?Dt.from:Dt.to),Re=xe.lineWrapping?Math.min(we.x,ei.offsetWidth):we.x;return{x:Re,y:we.y,yBot:we.yBot}}function to(we,Re,Xe,je){var yt=io(we,Re,Xe,je);yt.scrollLeft!=null&&(Xt.scrollLeft=yt.scrollLeft),yt.scrollTop!=null&&(_t.scrollTop=Xt.scrollTop=yt.scrollTop)}function io(we,Re,Xe,je){var yt=lo(),Et=Qa();Re+=Et,je+=Et,we+=yt,Xe+=yt;var Ht=Xt.clientHeight,jt=_t.scrollTop,hi={},Wt=Go()||1/0,Gi=Re<Et+10,zi=je+Et>Wt-10;Re<jt?hi.scrollTop=Gi?0:Math.max(0,Re):je>jt+Ht&&(hi.scrollTop=(zi?Wt:je)-Ht);var Oi=Xt.clientWidth,mr=Xt.scrollLeft,ur=xe.fixedGutter?Qi.clientWidth:0,vr=we<ur+yt+10;return we<mr+ur||vr?(vr&&(we=0),hi.scrollLeft=Math.max(0,we-10-ur)):Xe>Oi+mr-3&&(hi.scrollLeft=Xe+10-Oi),hi}function gr(we){var Re=Bs(),Xe=(we??_t.scrollTop)-Qa(),je=Math.max(0,Math.floor(Xe/Re)),yt=Math.ceil((Xe+Xt.clientHeight)/Re);return{from:Te(pi,je),to:Te(pi,yt)}}function Js(we,Re,Xe){if(!Xt.clientWidth){Qr=es=pn=0;return}var je=gr(Xe);if(we!==!0&&we.length==0&&je.from>Qr&&je.to<es){So(Xe);return}var yt=Math.max(je.from-100,0),Et=Math.min(pi.size,je.to+100);Qr<yt&&yt-Qr<20&&(yt=Qr),es>Et&&es-Et<20&&(Et=Math.min(pi.size,es));for(var Ht=we===!0?[]:gl([{from:Qr,to:es,domStart:0}],we),jt=0,hi=0;hi<Ht.length;++hi){var Wt=Ht[hi];Wt.from<yt&&(Wt.domStart+=yt-Wt.from,Wt.from=yt),Wt.to>Et&&(Wt.to=Et),Wt.from>=Wt.to?Ht.splice(hi--,1):jt+=Wt.to-Wt.from}if(jt==Et-yt&&yt==Qr&&Et==es){So(Xe);return}Ht.sort(function(ur,vr){return ur.domStart-vr.domStart});var Gi=Bs(),zi=Qi.style.display;xt.style.display="none",qo(yt,Et,Ht),xt.style.display=Qi.style.display="";var Oi=yt!=Qr||Et!=es||xo!=Xt.clientHeight+Gi;if(Oi&&(xo=Xt.clientHeight+Gi),(yt!=Qr||Et!=es&&xe.onViewportChange)&&setTimeout(function(){xe.onViewportChange&&xe.onViewportChange(wr,yt,Et)}),Qr=yt,es=Et,pn=Ve(pi,yt),co(100),xt.childNodes.length!=es-Qr)throw new Error("BAD PATCH! "+JSON.stringify(Ht)+" size="+(es-Qr)+" nodes="+xt.childNodes.length);function mr(){var ur=xt.firstChild,vr=!1;return pi.iter(Qr,es,function(nr){if(ur){if(!nr.hidden){var Xi=Math.round(ur.offsetHeight/Gi)||1;nr.height!=Xi&&(As(nr,Xi),ys=vr=!0)}ur=ur.nextSibling}}),vr}return xe.lineWrapping&&mr(),Qi.style.display=zi,(Oi||ys)&&mn()&&xe.lineWrapping&&mr()&&mn(),So(Xe),Io(),!Re&&xe.onUpdate&&xe.onUpdate(wr),!0}function gl(we,Re){for(var Xe=0,je=Re.length||0;Xe<je;++Xe){for(var yt=Re[Xe],Et=[],Ht=yt.diff||0,jt=0,hi=we.length;jt<hi;++jt){var Wt=we[jt];yt.to<=Wt.from&&yt.diff?Et.push({from:Wt.from+Ht,to:Wt.to+Ht,domStart:Wt.domStart}):yt.to<=Wt.from||yt.from>=Wt.to?Et.push(Wt):(yt.from>Wt.from&&Et.push({from:Wt.from,to:yt.from,domStart:Wt.domStart}),yt.to<Wt.to&&Et.push({from:yt.to+Ht,to:Wt.to+Ht,domStart:Wt.domStart+(yt.to-Wt.from)}))}we=Et}return we}function qo(we,Re,Xe){function je(zi){var Oi=zi.nextSibling;return zi.parentNode.removeChild(zi),Oi}if(!Xe.length)$i(xt);else{for(var yt=0,Wt=xt.firstChild,Et=0;Et<Xe.length;++Et){for(var Ht=Xe[Et];Ht.domStart>yt;)Wt=je(Wt),yt++;for(var Gi=0,jt=Ht.to-Ht.from;Gi<jt;++Gi)Wt=Wt.nextSibling,yt++}for(;Wt;)Wt=je(Wt)}var hi=Xe.shift(),Wt=xt.firstChild,Gi=we;pi.iter(we,Re,function(zi){if(hi&&hi.to==Gi&&(hi=Xe.shift()),!hi||hi.from>Gi){if(zi.hidden)var Oi=bi("pre");else{var Oi=ia(zi);if(zi.className&&(Oi.className=zi.className),zi.bgClassName){var mr=bi("pre","Â ",zi.bgClassName,"position: absolute; left: 0; right: 0; top: 0; bottom: 0; z-index: -2");Oi=bi("div",[mr,Oi],null,"position: relative")}}xt.insertBefore(Oi,Wt)}else Wt=Wt.nextSibling;++Gi})}function mn(){if(!(!xe.gutter&&!xe.lineNumbers)){var we=hr.offsetHeight,Re=Xt.clientHeight;Qi.style.height=(we-Re<2?Re:we)+"px";var Xe=document.createDocumentFragment(),je=Qr,yt;if(pi.iter(Qr,Math.max(es,Qr+1),function(Gi){if(Gi.hidden)Xe.appendChild(bi("pre"));else{var zi=Gi.gutterMarker,Oi=xe.lineNumbers?xe.lineNumberFormatter(je+xe.firstLineNumber):null;zi&&zi.text?Oi=zi.text.replace("%N%",Oi??""):Oi==null&&(Oi="Â ");var mr=Xe.appendChild(bi("pre",null,zi&&zi.style));mr.innerHTML=Oi;for(var ur=1;ur<Gi.height;++ur)mr.appendChild(bi("br")),mr.appendChild(document.createTextNode("Â "));zi||(yt=je)}++je}),Qi.style.display="none",tr(Ui,Xe),yt!=null&&xe.lineNumbers){for(var Et=Ui.childNodes[yt-Qr],Ht=String(pi.size).length,jt=Hi(Et.firstChild),hi="";jt.length+hi.length<Ht;)hi+="Â ";hi&&Et.insertBefore(document.createTextNode(hi),Et.firstChild)}Qi.style.display="";var Wt=Math.abs((parseInt(ei.style.marginLeft)||0)-Qi.offsetWidth)>2;return ei.style.marginLeft=Qi.offsetWidth+"px",ys=!1,Wt}}function Io(){var we=Wi(Dt.from,Dt.to),Re=xs(Dt.from,!0),Xe=we?Re:xs(Dt.to,!0),je=Dt.inverted?Re:Xe,yt=Bs(),Et=ii(br),Ht=ii(xt);if(Ke.style.top=Math.max(0,Math.min(Xt.offsetHeight,je.y+Ht.top-Et.top))+"px",Ke.style.left=Math.max(0,Math.min(Xt.offsetWidth,je.x+Ht.left-Et.left))+"px",we||xe.showCursorWhenSelecting?(ai.style.top=je.y+"px",ai.style.left=(xe.lineWrapping?Math.min(je.x,ei.offsetWidth):je.x)+"px",ai.style.display=""):ai.style.display="none",we)kt.style.display="none";else{var jt=Re.y==Xe.y,hi=document.createDocumentFragment(),Wt=ei.clientWidth||ei.offsetWidth,Gi=ei.clientHeight||ei.offsetHeight,zi=function(vr,nr,Xi,Or){var Sr=We?"width: "+(Xi?Wt-Xi-vr:Wt)+"px":"right: "+(Xi-1)+"px";hi.appendChild(bi("div",null,"CodeMirror-selected","position: absolute; left: "+vr+"px; top: "+nr+"px; "+Sr+"; height: "+Or+"px"))};if(Dt.from.ch&&Re.y>=0){var Oi=jt?Wt-Xe.x:0;zi(Re.x,Re.y,Oi,yt)}var mr=Math.max(0,Re.y+(Dt.from.ch?yt:0)),ur=Math.min(Xe.y,Gi)-mr;ur>.2*yt&&zi(0,mr,0,ur),(!jt||!Dt.from.ch)&&Xe.y<Gi-.5*yt&&zi(0,Xe.y,Wt-Xe.x,yt),tr(kt,hi),kt.style.display=""}}function Xo(we){we?Yr=Yr||(Dt.inverted?Dt.to:Dt.from):Yr=null}function Hs(we,Re){var Xe=Yr&&yr(Yr);Xe&&(Zt(Xe,we)?we=Xe:Zt(Re,Xe)&&(Re=Xe)),Da(we,Re),ss=!0}function Da(we,Re,Xe,je){if(wa=null,Xe==null&&(Xe=Dt.from.line,je=Dt.to.line),!(Wi(Dt.from,we)&&Wi(Dt.to,Re))){if(Zt(Re,we)){var yt=Re;Re=we,we=yt}if(we.line!=Xe){var Et=Ur(we,Xe,Dt.from.ch);Et?we=Et:Aa(we.line,!1)}if(Re.line!=je&&(Re=Ur(Re,je,Dt.to.ch)),Wi(we,Re)||Wi(we,Dt.to)?Dt.inverted=!1:Wi(Re,Dt.from)&&(Dt.inverted=!0),xe.autoClearEmptyLines&&Wi(Dt.from,Dt.to)){var Ht=Dt.inverted?we:Re;if(Ht.line!=Dt.from.line&&Dt.from.line<pi.size){var jt=er(Dt.from.line);/^\s+$/.test(jt.text)&&setTimeout(qi(function(){if(jt.parent&&/^\s+$/.test(jt.text)){var hi=be(jt);cn("",{line:hi,ch:0},{line:hi,ch:jt.text.length})}}))}}Dt.from=we,Dt.to=Re,js=!0}}function Ur(we,Re,Xe){function je(Ht){for(var jt=we.line+Ht,hi=Ht==1?pi.size:-1;jt!=hi;){var Wt=er(jt);if(!Wt.hidden){var Gi=we.ch;return(Et||Gi>Xe||Gi>Wt.text.length)&&(Gi=Wt.text.length),{line:jt,ch:Gi}}jt+=Ht}}var yt=er(we.line),Et=we.ch==yt.text.length&&we.ch!=Xe;return yt.hidden?we.line>=Re?je(1)||je(-1):je(-1)||je(1):we}function $s(we,Re,Xe){var je=yr({line:we,ch:Re||0});(Xe?Hs:Da)(je,je)}function Ji(we){return Math.max(0,Math.min(we,pi.size-1))}function yr(we){if(we.line<0)return{line:0,ch:0};if(we.line>=pi.size)return{line:pi.size-1,ch:er(pi.size-1).text.length};var Re=we.ch,Xe=er(we.line).text.length;return Re==null||Re>Xe?{line:we.line,ch:Xe}:Re<0?{line:we.line,ch:0}:we}function Fr(we,Re){var Xe=Dt.inverted?Dt.from:Dt.to,je=Xe.line,yt=Xe.ch,Et=er(je);function Ht(){for(var Wt=je+we,Gi=we<0?-1:pi.size;Wt!=Gi;Wt+=we){var zi=er(Wt);if(!zi.hidden)return je=Wt,Et=zi,!0}}function jt(Wt){if(yt==(we<0?0:Et.text.length))if(!Wt&&Ht())yt=we<0?Et.text.length:0;else return!1;else yt+=we;return!0}if(Re=="char")jt();else if(Re=="column")jt(!0);else if(Re=="word")for(var hi=!1;!(we<0&&!jt());){if(Qs(Et.text.charAt(yt)))hi=!0;else if(hi){we<0&&(we=1,jt());break}if(we>0&&!jt())break}return{line:je,ch:yt}}function Mr(we,Re){var Xe=we<0?Dt.from:Dt.to;(Yr||Wi(Dt.from,Dt.to))&&(Xe=Fr(we,Re)),$s(Xe.line,Xe.ch,!0)}function zn(we,Re){Wi(Dt.from,Dt.to)?we<0?cn("",Fr(we,Re),Dt.to):cn("",Dt.from,Fr(we,Re)):cn("",Dt.from,Dt.to),ss=!0}function Ua(we,Re){var Xe=xs(Dt.inverted?Dt.from:Dt.to,!0);if(wa!=null&&(Xe.x=wa),Re=="page")var je=Math.min(Xt.clientHeight,window.innerHeight||document.documentElement.clientHeight),yt=Kn(Xe.x,Xe.y+je*we);else if(Re=="line")var Et=Bs(),yt=Kn(Xe.x,Xe.y+.5*Et+we*Et);Re=="page"&&(_t.scrollTop+=xs(yt,!0).y-Xe.y),$s(yt.line,yt.ch,!0),wa=Xe.x}function ro(we){var Re=er(we.line).text,Xe=we.ch,je=we.ch;if(Re){we.after===!1||je==Re.length?--Xe:++je;for(var yt=Re.charAt(Xe),Et=Qs(yt)?Qs:/\s/.test(yt)?function(Ht){return/\s/.test(Ht)}:function(Ht){return!/\s/.test(Ht)&&Qs(Ht)};Xe>0&&Et(Re.charAt(Xe-1));)--Xe;for(;je<Re.length&&Et(Re.charAt(je));)++je}return{from:{line:we.line,ch:Xe},to:{line:we.line,ch:je}}}function ml(we){Hs({line:we,ch:0},yr({line:we+1,ch:0}))}function Fo(we){if(Wi(Dt.from,Dt.to))return so(Dt.from.line,we);for(var Re=Dt.to.line-(Dt.to.ch?0:1),Xe=Dt.from.line;Xe<=Re;++Xe)so(Xe,we)}function so(we,Re){if(Re||(Re="add"),Re=="smart")if(!Zi.indent)Re="prev";else var Xe=Ms(we);var je=er(we),yt=je.indentation(xe.tabSize),Et=je.text.match(/^\s*/)[0],Ht;Re=="smart"&&(Ht=Zi.indent(Xe,je.text.slice(Et.length),je.text),Ht==ri&&(Re="prev")),Re=="prev"?we?Ht=er(we-1).indentation(xe.tabSize):Ht=0:Re=="add"?Ht=yt+xe.indentUnit:Re=="subtract"&&(Ht=yt-xe.indentUnit),Ht=Math.max(0,Ht);var jt="",hi=0;if(xe.indentWithTabs)for(var Wt=Math.floor(Ht/xe.tabSize);Wt;--Wt)hi+=xe.tabSize,jt+="	";hi<Ht&&(jt+=Ot(Ht-hi)),jt!=Et&&cn(jt,{line:we,ch:0},{line:we,ch:Et.length}),je.stateAfter=null}function no(){Zi=g.getMode(xe,xe.mode),pi.iter(0,pi.size,function(we){we.stateAfter=null}),_s=0,co(100)}function Ma(){var we=xe.gutter||xe.lineNumbers;Qi.style.display=we?"":"none",we?ys=!0:xt.parentNode.style.marginLeft=0}function ao(we,Re){if(xe.lineWrapping){br.className+=" CodeMirror-wrap";var Xe=Xt.clientWidth/Gn()-3;pi.iter(0,pi.size,function(je){if(!je.hidden){var yt=Math.ceil(je.text.length/Xe)||1;yt!=1&&As(je,yt)}}),ei.style.minWidth=Di.style.left=""}else br.className=br.className.replace(" CodeMirror-wrap",""),Wo(),pi.iter(0,pi.size,function(je){je.height!=1&&!je.hidden&&As(je,1)});ps.push({from:0,to:pi.size})}function oo(){Xt.className=Xt.className.replace(/\s*cm-s-\S+/g,"")+xe.theme.replace(/(^|\s)\s*/g," cm-s-")}function Pa(){var we=ae[xe.keyMap].style;br.className=br.className.replace(/\s*cm-keymap-\S+/g,"")+(we?" cm-keymap-"+we:"")}function Nn(we,Re){this.lines=[],this.type=we,Re&&(this.style=Re)}Nn.prototype.clear=qi(function(){for(var we,Re,Xe=0;Xe<this.lines.length;++Xe){var je=this.lines[Xe],yt=Ai(je.markedSpans,this);yt.from!=null&&(we=be(je)),yt.to!=null&&(Re=be(je)),je.markedSpans=Ri(je.markedSpans,yt)}we!=null&&ps.push({from:we,to:Re+1}),this.lines.length=0,this.explicitlyCleared=!0}),Nn.prototype.find=function(){for(var we,Re,Xe=0;Xe<this.lines.length;++Xe){var je=this.lines[Xe],yt=Ai(je.markedSpans,this);if(yt.from!=null||yt.to!=null){var Et=be(je);yt.from!=null&&(we={line:Et,ch:yt.from}),yt.to!=null&&(Re={line:Et,ch:yt.to})}}return this.type=="bookmark"?we:we&&{from:we,to:Re}};function La(we,Re,Xe,je){we=yr(we),Re=yr(Re);var yt=new Nn("range",Xe);if(je)for(var Et in je)je.hasOwnProperty(Et)&&(yt[Et]=je[Et]);var Ht=we.line;return pi.iter(Ht,Re.line+1,function(jt){var hi={from:Ht==we.line?we.ch:null,to:Ht==Re.line?Re.ch:null,marker:yt};jt.markedSpans=(jt.markedSpans||[]).concat([hi]),yt.lines.push(jt),++Ht}),ps.push({from:we.line,to:Re.line+1}),yt}function _l(we){we=yr(we);var Re=new Nn("bookmark"),Xe=er(we.line);Nr.addChange(we.line,1,[b(Xe.text,Xe.markedSpans)],!0);var je={from:we.ch,to:we.ch,marker:Re};return Xe.markedSpans=(Xe.markedSpans||[]).concat([je]),Re.lines.push(Xe),Re}function Yo(we){we=yr(we);var Re=[],Xe=er(we.line).markedSpans;if(Xe)for(var je=0;je<Xe.length;++je){var yt=Xe[je];(yt.from==null||yt.from<=we.ch)&&(yt.to==null||yt.to>=we.ch)&&Re.push(yt.marker)}return Re}function Wr(we,Re,Xe){return typeof we=="number"&&(we=er(Ji(we))),we.gutterMarker={text:Re,style:Xe},ys=!0,we}function Vn(we){typeof we=="number"&&(we=er(Ji(we))),we.gutterMarker=null,ys=!0}function Us(we,Re){var Xe=we,je=we;if(typeof we=="number"?je=er(Ji(we)):Xe=be(we),Xe==null)return null;if(Re(je,Xe))ps.push({from:Xe,to:Xe+1});else return null;return je}function ko(we,Re,Xe){return Us(we,function(je){if(je.className!=Re||je.bgClassName!=Xe)return je.className=Re,je.bgClassName=Xe,!0})}function Aa(we,Re){return Us(we,function(Xe,je){if(Xe.hidden!=Re){Xe.hidden=Re,xe.lineWrapping||(Re&&Xe.text.length==An.text.length?ta=!0:!Re&&Xe.text.length>An.text.length&&(An=Xe,ta=!1)),As(Xe,Re?0:1);var yt=Dt.from.line,Et=Dt.to.line;if(Re&&(yt==je||Et==je)){var Ht=yt==je?Ur({line:yt,ch:0},yt,0):Dt.from,jt=Et==je?Ur({line:Et,ch:0},Et,0):Dt.to;if(!jt)return;Da(Ht,jt)}return ys=!0}})}function Do(we){if(typeof we=="number"){if(!Tn(we))return null;var Re=we;if(we=er(we),!we)return null}else{var Re=be(we);if(Re==null)return null}var Xe=we.gutterMarker;return{line:Re,handle:we,text:we.text,markerText:Xe&&Xe.text,markerClass:Xe&&Xe.style,lineClass:we.className,bgClass:we.bgClassName}}function en(we,Re){if(Re==0)return{top:0,left:0};var Xe=ia(we,Re);tr(ni,Xe);var je=Xe.anchor,yt=je.offsetTop,Et=je.offsetLeft;if(ze&&yt==0&&Et==0){var Ht=bi("span","x");je.parentNode.insertBefore(Ht,je.nextSibling),yt=Ht.offsetTop}return{top:yt,left:Et}}function xs(we,Re){var Xe,je=Bs(),yt=je*(Ve(pi,we.line)-(Re?pn:0));if(we.ch==0)Xe=0;else{var Et=en(er(we.line),we.ch);Xe=Et.left,xe.lineWrapping&&(yt+=Math.max(0,Et.top))}return{x:Xe,y:yt,yBot:yt+je}}function Kn(we,Re){var Xe=Bs(),je=Gn(),yt=pn+Math.floor(Re/Xe);if(yt<0)return{line:0,ch:0};var Et=Te(pi,yt);if(Et>=pi.size)return{line:pi.size-1,ch:er(pi.size-1).text.length};var Ht=er(Et),jt=Ht.text,hi=xe.lineWrapping,Wt=hi?yt-Ve(pi,Et):0;if(we<=0&&Wt==0)return{line:Et,ch:0};var Gi=!1;function zi(Ha){var pa=en(Ht,Ha);if(hi){var ns=Math.round(pa.top/Xe);return Gi=ns!=Wt,Math.max(0,pa.left+(ns-Wt)*Xt.clientWidth)}return pa.left}for(var Oi=0,mr=0,ur=jt.length,vr,nr=Math.min(ur,Math.ceil((we+Wt*Xt.clientWidth*.9)/je));;){var Xi=zi(nr);if(Xi<=we&&nr<ur)nr=Math.min(ur,Math.ceil(nr*1.2));else{vr=Xi,ur=nr;break}}if(we>vr)return{line:Et,ch:ur};for(nr=Math.floor(ur*.8),Xi=zi(nr),Xi<we&&(Oi=nr,mr=Xi);;){if(ur-Oi<=1){var Or=we-mr<vr-we;return{line:Et,ch:Or?Oi:ur,after:Or}}var Sr=Math.ceil((Oi+ur)/2),bs=zi(Sr);bs>we?(ur=Sr,vr=bs,Gi&&(vr+=1e3)):(Oi=Sr,mr=bs)}}function jo(we){var Re=xs(we,!0),Xe=ii(ei);return{x:Xe.left+Re.x,y:Xe.top+Re.y,yBot:Xe.top+Re.yBot}}var ca,ha,_n;function Bs(){if(_n==null){_n=bi("pre");for(var we=0;we<49;++we)_n.appendChild(document.createTextNode("x")),_n.appendChild(bi("br"));_n.appendChild(document.createTextNode("x"))}var Re=xt.clientHeight;return Re==ha||(ha=Re,tr(ni,_n.cloneNode(!0)),ca=ni.firstChild.offsetHeight/50||1,$i(ni)),ca}var yn,Uo=0;function Gn(){if(Xt.clientWidth==Uo)return yn;Uo=Xt.clientWidth;var we=bi("span","x"),Re=bi("pre",[we]);return tr(ni,Re),yn=we.offsetWidth||10}function Qa(){return ei.offsetTop}function lo(){return ei.offsetLeft}function ua(we,Re){var Xe=ii(Xt,!0),je,yt;try{je=we.clientX,yt=we.clientY}catch{return null}if(!Re&&(je-Xe.left>Xt.clientWidth||yt-Xe.top>Xt.clientHeight))return null;var Et=ii(ei,!0);return Kn(je-Et.left,yt-Et.top)}var Ao;function fa(we){var Re=ua(we),Xe=_t.scrollTop;if(!Re||nt)return;(Wi(Dt.from,Dt.to)||Zt(Re,Dt.from)||!Zt(Re,Dt.to))&&qi($s)(Re.line,Re.ch);var je=Le.style.cssText;Ke.style.position="absolute",Le.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(we.clientY-5)+"px; left: "+(we.clientX-5)+"px; z-index: 1000; background: white; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",Rs(),hn(!0),Wi(Dt.from,Dt.to)&&(Le.value=Ds=" ");function yt(){if(Ke.style.position="relative",Le.style.cssText=je,Je&&(_t.scrollTop=Xe),gn(),Le.selectionStart!=null){clearTimeout(Ao);var Ht=Le.value=" "+(Wi(Dt.from,Dt.to)?"":Le.value),jt=0;Ds=" ",Le.selectionStart=1,Le.selectionEnd=Ht.length,Ao=setTimeout(function hi(){Ds==" "&&Le.selectionStart==0?qi(ne.selectAll)(wr):jt++<10?Ao=setTimeout(hi,500):hn()},200)}}if(De){pt(we);var Et=Mt(window,"mouseup",function(){Et(),setTimeout(yt,20)},!0)}else setTimeout(yt,50)}function Fn(){clearInterval(Pr);var we=!0;ai.style.visibility="",Pr=setInterval(function(){ai.style.visibility=(we=!we)?"":"hidden"},xe.cursorBlinkRate)}var vs={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"};function qr(we){var Re=Dt.inverted?Dt.from:Dt.to,Xe=er(Re.line),je=Re.ch-1,yt=je>=0&&vs[Xe.text.charAt(je)]||vs[Xe.text.charAt(++je)];if(!yt)return;yt.charAt(0);for(var Et=yt.charAt(1)==">",Ht=Et?1:-1,jt=Xe.styles,hi=je+1,Wt=0,Gi=jt.length;Wt<Gi;Wt+=2)if((hi-=jt[Wt].length)<=0){var nr=jt[Wt+1];break}var zi=[Xe.text.charAt(je)],Oi=/[(){}[\]]/;function mr(bs,Ha,pa){if(bs.text)for(var ns=bs.styles,Er=Et?0:bs.text.length-1,ga,vn=Et?0:ns.length-2,Jo=Et?ns.length:-2;vn!=Jo;vn+=2*Ht){var qn=ns[vn];if(ns[vn+1]!=nr){Er+=Ht*qn.length;continue}for(var ho=Et?0:qn.length-1,yl=Et?qn.length:-1;ho!=yl;ho+=Ht,Er+=Ht)if(Er>=Ha&&Er<pa&&Oi.test(ga=qn.charAt(ho))){var zs=vs[ga];if(zs.charAt(1)==">"==Et)zi.push(ga);else{if(zi.pop()!=zs.charAt(0))return{pos:Er,match:!1};if(!zi.length)return{pos:Er,match:!0}}}}}for(var Wt=Re.line,Gi=Et?Math.min(Wt+100,pi.size):Math.max(-1,Wt-100);Wt!=Gi;Wt+=Ht){var Xe=er(Wt),ur=Wt==Re.line,vr=mr(Xe,ur&&Et?je+1:0,ur&&!Et?je:Xe.text.length);if(vr)break}vr||(vr={pos:null,match:!1});var nr=vr.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket",Xi=La({line:Re.line,ch:je},{line:Re.line,ch:je+1},nr),Or=vr.pos!=null&&La({line:Wt,ch:vr.pos},{line:Wt,ch:vr.pos+1},nr),Sr=qi(function(){Xi.clear(),Or&&Or.clear()});we?setTimeout(Sr,800):Zs=Sr}function Oa(we){for(var Re,Xe,je=we,yt=we-40;je>yt;--je){if(je==0)return 0;var Et=er(je-1);if(Et.stateAfter)return je;var Ht=Et.indentation(xe.tabSize);(Xe==null||Re>Ht)&&(Xe=je-1,Re=Ht)}return Xe}function Ms(we){var Re=Oa(we),Xe=Re&&er(Re-1).stateAfter;return Xe?Xe=Ut(Zi,Xe):Xe=Pt(Zi),pi.iter(Re,we,function(je){je.process(Zi,Xe,xe.tabSize),je.stateAfter=Re==we-1||Re%5==0?Ut(Zi,Xe):null}),Xe}function Ra(){if(!(_s>=es)){var we=+new Date+xe.workTime,Re=Ut(Zi,Ms(_s)),Xe=_s;pi.iter(_s,es,function(je){if(_s>=Qr?(je.highlight(Zi,Re,xe.tabSize),je.stateAfter=Ut(Zi,Re)):(je.process(Zi,Re,xe.tabSize),je.stateAfter=_s%5==0?Ut(Zi,Re):null),++_s,+new Date>we)return co(xe.workDelay),!0}),es>Xe&&_s>=Qr&&qi(function(){ps.push({from:Xe,to:_s})})()}}function co(we){_s<es&&Ir.set(we,Ra)}function da(){jr=ss=cr=null,ps=[],js=!1,Os=[]}function Zo(){if(ta&&Wo(),ja&&!xe.lineWrapping){var we=Di.offsetWidth,Re=en(An,An.text.length).left;Oe||(Di.style.left=Re+"px",ei.style.minWidth=Re+we+"px"),ja=!1}var Xe,je;if(js){var yt=Hn();Xe=io(yt.x,yt.y,yt.x,yt.yBot)}(ps.length||Xe&&Xe.scrollTop!=null)&&(je=Js(ps,!0,Xe&&Xe.scrollTop)),je||(js&&Io(),ys&&mn()),Xe&&la(),js&&Fn(),dr&&(jr===!0||jr!==!1&&js)&&hn(ss),js&&xe.matchBrackets&&setTimeout(qi(function(){Zs&&(Zs(),Zs=null),Wi(Dt.from,Dt.to)&&qr(!1)}),20);var Et=js,Ht=Os;cr&&xe.onChange&&wr&&xe.onChange(wr,cr),Et&&xe.onCursorActivity&&xe.onCursorActivity(wr);for(var jt=0;jt<Ht.length;++jt)Ht[jt](wr);je&&xe.onUpdate&&xe.onUpdate(wr)}var Wn=0;function qi(we){return function(){Wn++||da();try{var Re=we.apply(this,arguments)}finally{--Wn||Zo()}return Re}}function tn(we){Nr.startCompound();try{return we()}finally{Nr.endCompound()}}for(var gi in Y)Y.propertyIsEnumerable(gi)&&!wr.propertyIsEnumerable(gi)&&(wr[gi]=Y[gi]);for(var kn=0;kn<re.length;++kn)re[kn](wr);return wr}g.defaults={value:"",mode:null,theme:"default",indentUnit:2,indentWithTabs:!1,smartIndent:!0,tabSize:4,keyMap:"default",extraKeys:null,electricChars:!0,autoClearEmptyLines:!1,onKeyEvent:null,onDragEvent:null,lineWrapping:!1,lineNumbers:!1,gutter:!1,fixedGutter:!1,firstLineNumber:1,showCursorWhenSelecting:!1,readOnly:!1,dragDrop:!0,onChange:null,onCursorActivity:null,onViewportChange:null,onGutterClick:null,onUpdate:null,onFocus:null,onBlur:null,onScroll:null,matchBrackets:!1,cursorBlinkRate:530,workTime:100,workDelay:200,pollInterval:100,undoDepth:40,tabindex:null,autofocus:null,lineNumberFormatter:function(ce){return ce}};var B=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),M=B||/Mac/.test(navigator.platform),P=g.modes={},K=g.mimeModes={};g.defineMode=function(ce,ye){if(!g.defaults.mode&&ce!="null"&&(g.defaults.mode=ce),arguments.length>2){ye.dependencies=[];for(var xe=2;xe<arguments.length;++xe)ye.dependencies.push(arguments[xe])}P[ce]=ye},g.defineMIME=function(ce,ye){K[ce]=ye},g.resolveMode=function(ce){if(typeof ce=="string"&&K.hasOwnProperty(ce))ce=K[ce];else if(typeof ce=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(ce))return g.resolveMode("application/xml");return typeof ce=="string"?{name:ce}:ce||{name:"null"}},g.getMode=function(ce,xe){var xe=g.resolveMode(xe),Me=P[xe.name];if(!Me)return g.getMode(ce,"text/plain");var Ge=Me(ce,xe);if(D.hasOwnProperty(xe.name)){var Le=D[xe.name];for(var Ke in Le)Le.hasOwnProperty(Ke)&&(Ge.hasOwnProperty(Ke)&&(Ge["_"+Ke]=Ge[Ke]),Ge[Ke]=Le[Ke])}return Ge.name=xe.name,Ge},g.listModes=function(){var ce=[];for(var ye in P)P.propertyIsEnumerable(ye)&&ce.push(ye);return ce},g.listMIMEs=function(){var ce=[];for(var ye in K)K.propertyIsEnumerable(ye)&&ce.push({mime:ye,mode:K[ye]});return ce};var Y=g.extensions={};g.defineExtension=function(ce,ye){Y[ce]=ye};var re=[];g.defineInitHook=function(ce){re.push(ce)};var D=g.modeExtensions={};g.extendMode=function(ce,ye){var xe=D.hasOwnProperty(ce)?D[ce]:D[ce]={};for(var Me in ye)ye.hasOwnProperty(Me)&&(xe[Me]=ye[Me])};var ne=g.commands={selectAll:function(ce){ce.setSelection({line:0,ch:0},{line:ce.lineCount()-1})},killLine:function(ce){var ye=ce.getCursor(!0),xe=ce.getCursor(!1),Me=!Wi(ye,xe);!Me&&ce.getLine(ye.line).length==ye.ch?ce.replaceRange("",ye,{line:ye.line+1,ch:0}):ce.replaceRange("",ye,Me?xe:{line:ye.line})},deleteLine:function(ce){var ye=ce.getCursor().line;ce.replaceRange("",{line:ye,ch:0},{line:ye})},undo:function(ce){ce.undo()},redo:function(ce){ce.redo()},goDocStart:function(ce){ce.setCursor(0,0,!0)},goDocEnd:function(ce){ce.setSelection({line:ce.lineCount()-1},null,!0)},goLineStart:function(ce){ce.setCursor(ce.getCursor().line,0,!0)},goLineStartSmart:function(ce){var ye=ce.getCursor(),xe=ce.getLine(ye.line),Me=Math.max(0,xe.search(/\S/));ce.setCursor(ye.line,ye.ch<=Me&&ye.ch?0:Me,!0)},goLineEnd:function(ce){ce.setSelection({line:ce.getCursor().line},null,!0)},goLineUp:function(ce){ce.moveV(-1,"line")},goLineDown:function(ce){ce.moveV(1,"line")},goPageUp:function(ce){ce.moveV(-1,"page")},goPageDown:function(ce){ce.moveV(1,"page")},goCharLeft:function(ce){ce.moveH(-1,"char")},goCharRight:function(ce){ce.moveH(1,"char")},goColumnLeft:function(ce){ce.moveH(-1,"column")},goColumnRight:function(ce){ce.moveH(1,"column")},goWordLeft:function(ce){ce.moveH(-1,"word")},goWordRight:function(ce){ce.moveH(1,"word")},delCharLeft:function(ce){ce.deleteH(-1,"char")},delCharRight:function(ce){ce.deleteH(1,"char")},delWordLeft:function(ce){ce.deleteH(-1,"word")},delWordRight:function(ce){ce.deleteH(1,"word")},indentAuto:function(ce){ce.indentSelection("smart")},indentMore:function(ce){ce.indentSelection("add")},indentLess:function(ce){ce.indentSelection("subtract")},insertTab:function(ce){ce.replaceSelection("	","end")},defaultTab:function(ce){ce.somethingSelected()?ce.indentSelection("add"):ce.replaceSelection("	","end")},transposeChars:function(ce){var ye=ce.getCursor(),xe=ce.getLine(ye.line);ye.ch>0&&ye.ch<xe.length-1&&ce.replaceRange(xe.charAt(ye.ch)+xe.charAt(ye.ch-1),{line:ye.line,ch:ye.ch-1},{line:ye.line,ch:ye.ch+1})},newlineAndIndent:function(ce){ce.replaceSelection(`
`,"end"),ce.indentLine(ce.getCursor().line)},toggleOverwrite:function(ce){ce.toggleOverwrite()}},ae=g.keyMap={};ae.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharRight",Backspace:"delCharLeft",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"},ae.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goWordLeft","Ctrl-Right":"goWordRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delWordLeft","Ctrl-Delete":"delWordRight","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"},ae.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goWordLeft","Alt-Right":"goWordRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delWordLeft","Ctrl-Alt-Backspace":"delWordRight","Alt-Delete":"delWordRight","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore",fallthrough:["basic","emacsy"]},ae.default=M?ae.macDefault:ae.pcDefault,ae.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharRight","Ctrl-H":"delCharLeft","Alt-D":"delWordRight","Alt-Backspace":"delWordLeft","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};function ue(ce){return typeof ce=="string"?ae[ce]:ce}function ge(ce,ye,xe,Me,Ge){function Le(Ke){Ke=ue(Ke);var st=Ke[ce];if(st===!1)return Ge&&Ge(),!0;if(st!=null&&Me(st))return!0;if(Ke.nofallthrough)return Ge&&Ge(),!0;var _t=Ke.fallthrough;if(_t==null)return!1;if(Object.prototype.toString.call(_t)!="[object Array]")return Le(_t);for(var xt=0,kt=_t.length;xt<kt;++xt)if(Le(_t[xt]))return!0;return!1}return ye&&Le(ye)?!0:Le(xe)}function Be(ce){var ye=Ie[Nt(ce,"keyCode")];return ye=="Ctrl"||ye=="Alt"||ye=="Shift"||ye=="Mod"}g.isModifierKey=Be,g.fromTextArea=function(ce,ye){if(ye||(ye={}),ye.value=ce.value,!ye.tabindex&&ce.tabindex&&(ye.tabindex=ce.tabindex),ye.autofocus==null){var xe=document.body;try{xe=document.activeElement}catch{}ye.autofocus=xe==ce||ce.getAttribute("autofocus")!=null&&xe==document.body}function Me(){ce.value=st.getValue()}if(ce.form){var Ge=Mt(ce.form,"submit",Me,!0),Le=ce.form,Ke=Le.submit;ce.form.submit=function _t(){Me(),Le.submit=Ke,Le.submit(),Le.submit=_t}}ce.style.display="none";var st=g(function(_t){ce.parentNode.insertBefore(_t,ce.nextSibling)},ye);return st.save=Me,st.getTextArea=function(){return ce},st.toTextArea=function(){Me(),ce.parentNode.removeChild(st.getWrapperElement()),ce.style.display="",ce.form&&(Ge(),typeof ce.form.submit=="function"&&(ce.form.submit=Ke))},st};var De=/gecko\/\d/i.test(navigator.userAgent),ze=/MSIE \d/.test(navigator.userAgent),Oe=/MSIE [1-7]\b/.test(navigator.userAgent),Je=/MSIE [1-8]\b/.test(navigator.userAgent),We=ze&&document.documentMode==5,ut=/WebKit\//.test(navigator.userAgent),et=ut&&/Qt\/\d+\.\d+/.test(navigator.userAgent),At=/Chrome\//.test(navigator.userAgent),nt=/Opera\//.test(navigator.userAgent),ft=/Apple Computer/.test(navigator.vendor),Tt=/KHTML\//.test(navigator.userAgent),qt=/Mac OS X 10\D([7-9]|\d\d)\D/.test(navigator.userAgent),Vt=nt&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);Vt&&(Vt=Number(Vt[1]));var vt=M&&(et||nt&&(Vt==null||Vt<12.11));function Ut(ce,ye){if(ye===!0)return ye;if(ce.copyState)return ce.copyState(ye);var xe={};for(var Me in ye){var Ge=ye[Me];Ge instanceof Array&&(Ge=Ge.concat([])),xe[Me]=Ge}return xe}g.copyState=Ut;function Pt(ce,ye,xe){return ce.startState?ce.startState(ye,xe):!0}g.startState=Pt,g.innerMode=function(ce,ye){for(;ce.innerMode;){var xe=ce.innerMode(ye);ye=xe.state,ce=xe.mode}return xe||{mode:ce,state:ye}};function Yt(ce,ye){this.pos=this.start=0,this.string=ce,this.tabSize=ye||8}Yt.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==0},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(ce){var ye=this.string.charAt(this.pos);if(typeof ce=="string")var xe=ye==ce;else var xe=ye&&(ce.test?ce.test(ye):ce(ye));if(xe)return++this.pos,ye},eatWhile:function(ce){for(var ye=this.pos;this.eat(ce););return this.pos>ye},eatSpace:function(){for(var ce=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>ce},skipToEnd:function(){this.pos=this.string.length},skipTo:function(ce){var ye=this.string.indexOf(ce,this.pos);if(ye>-1)return this.pos=ye,!0},backUp:function(ce){this.pos-=ce},column:function(){return di(this.string,this.start,this.tabSize)},indentation:function(){return di(this.string,null,this.tabSize)},match:function(ce,ye,xe){if(typeof ce=="string"){var Me=function(Le){return xe?Le.toLowerCase():Le};if(Me(this.string).indexOf(Me(ce),this.pos)==this.pos)return ye!==!1&&(this.pos+=ce.length),!0}else{var Ge=this.string.slice(this.pos).match(ce);return Ge&&Ge.index>0?null:(Ge&&ye!==!1&&(this.pos+=Ge[0].length),Ge)}},current:function(){return this.string.slice(this.start,this.pos)}},g.StringStream=Yt;function Ai(ce,ye){if(ce)for(var xe=0;xe<ce.length;++xe){var Me=ce[xe];if(Me.marker==ye)return Me}}function Ri(ce,ye){for(var xe,Me=0;Me<ce.length;++Me)ce[Me]!=ye&&(xe||(xe=[])).push(ce[Me]);return xe}function Ei(ce,ye,xe){if(ce)for(var Me=0,Ge;Me<ce.length;++Me){var Le=ce[Me],Ke=Le.marker,st=Le.from==null||(Ke.inclusiveLeft?Le.from<=ye:Le.from<ye);if(st||Ke.type=="bookmark"&&Le.from==ye&&Le.from!=xe){var _t=Le.to==null||(Ke.inclusiveRight?Le.to>=ye:Le.to>ye);(Ge||(Ge=[])).push({from:Le.from,to:_t?null:Le.to,marker:Ke})}}return Ge}function Li(ce,ye){if(ce)for(var xe=0,Me;xe<ce.length;++xe){var Ge=ce[xe],Le=Ge.marker,Ke=Ge.to==null||(Le.inclusiveRight?Ge.to>=ye:Ge.to>ye);if(Ke||Le.type=="bookmark"&&Ge.from==ye){var st=Ge.from==null||(Le.inclusiveLeft?Ge.from<=ye:Ge.from<ye);(Me||(Me=[])).push({from:st?null:Ge.from-ye,to:Ge.to==null?null:Ge.to-ye,marker:Le})}}return Me}function Yi(ce,ye,xe,Me,Ge){if(!ce&&!ye)return Ge;var Le=Ei(ce,xe),Ke=Li(ye,Me),st=Ge.length==1,_t=_i(Ge).length+(st?xe:0);if(Le)for(var xt=0;xt<Le.length;++xt){var kt=Le[xt];if(kt.to==null){var ai=Ai(Ke,kt.marker);ai?st&&(kt.to=ai.to==null?null:ai.to+_t):kt.to=xe}}if(Ke)for(var xt=0;xt<Ke.length;++xt){var kt=Ke[xt];if(kt.to!=null&&(kt.to+=_t),kt.from==null){var ai=Ai(Le,kt.marker);ai||(kt.from=_t,st&&(Le||(Le=[])).push(kt))}else kt.from+=_t,st&&(Le||(Le=[])).push(kt)}var Di=[b(Ge[0],Le)];if(!st){var ni=Ge.length-2,ei;if(ni>0&&Le)for(var xt=0;xt<Le.length;++xt)Le[xt].to==null&&(ei||(ei=[])).push({from:null,to:null,marker:Le[xt].marker});for(var xt=0;xt<ni;++xt)Di.push(b(Ge[xt+1],ei));Di.push(b(_i(Ge),Ke))}return Di}function vi(ce){return typeof ce=="string"?ce:ce.text}function d(ce){if(typeof ce=="string")return null;for(var ye=ce.markedSpans,xe=null,Me=0;Me<ye.length;++Me)ye[Me].marker.explicitlyCleared?xe||(xe=ye.slice(0,Me)):xe&&xe.push(ye[Me]);return xe?xe.length?xe:null:ye}function b(ce,ye){return ye?{text:ce,markedSpans:ye}:ce}function S(ce){var ye=ce.markedSpans;if(ye){for(var xe=0;xe<ye.length;++xe){var Me=ye[xe].marker.lines,Ge=ji(Me,ce);Me.splice(Ge,1)}ce.markedSpans=null}}function k(ce,ye){if(ye){for(var xe=0;xe<ye.length;++xe)var Me=ye[xe].marker.lines.push(ce);ce.markedSpans=ye}}var R=" ";De||ze&&!Oe?R="â":nt&&(R="");function W(ce,ye){this.text=ce,this.height=1,k(this,ye)}W.prototype={update:function(ce,ye){this.text=ce,this.stateAfter=this.styles=null,S(this),k(this,ye)},highlight:function(ce,ye,xe){var Me=new Yt(this.text,xe),Ge=this.styles||(this.styles=[]),Le=Ge.length=0;for(this.text==""&&ce.blankLine&&ce.blankLine(ye);!Me.eol();){var Ke=ce.token(Me,ye),st=Me.current();if(Me.start=Me.pos,Le&&Ge[Le-1]==Ke?Ge[Le-2]+=st:st&&(Ge[Le++]=st,Ge[Le++]=Ke),Me.pos>5e3){Ge[Le++]=this.text.slice(Me.pos),Ge[Le++]=null;break}}},process:function(ce,ye,xe){var Me=new Yt(this.text,xe);for(this.text==""&&ce.blankLine&&ce.blankLine(ye);!Me.eol()&&Me.pos<=5e3;)ce.token(Me,ye),Me.start=Me.pos},getTokenAt:function(ce,ye,xe,Me){for(var Ge=this.text,Le=new Yt(Ge,xe);Le.pos<Me&&!Le.eol();){Le.start=Le.pos;var Ke=ce.token(Le,ye)}return{start:Le.start,end:Le.pos,string:Le.current(),className:Ke||null,state:ye}},indentation:function(ce){return di(this.text,null,ce)},getContent:function(ce,ye,xe){var Me=!0,Ge=0,Le=/[\t\u0000-\u0019\u200b\u2028\u2029\uFEFF]/g,Ke=bi("pre");function st(Br,Cr,rr){if(Cr){if(Me&&ze&&Cr.charAt(0)==" "&&(Cr="Â "+Cr.slice(1)),Me=!1,Le.test(Cr))for(var Lr=document.createDocumentFragment(),sr=0;;){Le.lastIndex=sr;var jr=Le.exec(Cr),ss=jr?jr.index-sr:Cr.length-sr;if(ss&&(Lr.appendChild(document.createTextNode(Cr.slice(sr,sr+ss))),Ge+=ss),!jr)break;if(sr+=ss+1,jr[0]=="	"){var ps=ce-Ge%ce;Lr.appendChild(bi("span",Ot(ps),"cm-tab")),Ge+=ps}else{var cr=bi("span","â¢","cm-invalidchar");cr.title="\\u"+jr[0].charCodeAt(0).toString(16),Lr.appendChild(cr),Ge+=1}}else{Ge+=Cr.length;var Lr=document.createTextNode(Cr)}rr?Br.appendChild(bi("span",[Lr],rr)):Br.appendChild(Lr)}}var _t=st;if(ye!=null){var xt=0,kt=Ke.anchor=bi("span");_t=function(Br,Cr,rr){var Lr=Cr.length;if(ye>=xt&&ye<xt+Lr){var sr=ye-xt;if(sr&&(st(Br,Cr.slice(0,sr),rr),xe)){var jr=Cr.slice(sr-1,sr+1);wt.test(jr)?Br.appendChild(bi("wbr")):!Oe&&/\w\w/.test(jr)&&Br.appendChild(document.createTextNode("â"))}Br.appendChild(kt),st(kt,nt?Cr.slice(sr,sr+1):Cr.slice(sr),rr),nt&&st(Br,Cr.slice(sr+1),rr),ye--,xt+=Lr}else xt+=Lr,st(Br,Cr,rr),xt==ye&&xt==ei?(Ar(kt,R),Br.appendChild(kt)):xt>ye+10&&/\s/.test(Cr)&&(_t=function(){})}}var ai=this.styles,Di=this.text,ni=this.markedSpans,ei=Di.length;function Ui(Br){return Br?"cm-"+Br.replace(/ +/g," cm-"):null}if(!Di&&ye==null)_t(Ke," ");else if(!ni||!ni.length)for(var Qi=0,hr=0;hr<ei;Qi+=2){var Ki=ai[Qi],Xt=ai[Qi+1],br=Ki.length;hr+br>ei&&(Ki=Ki.slice(0,ei-hr)),hr+=br,_t(Ke,Ki,Ui(Xt))}else{ni.sort(function(rr,Lr){return rr.from-Lr.from});for(var wi=0,Qi=0,Ir="",Xt,Pr=ni[0].from||0,Zi=[],pi=0,_s=function(){for(var rr;pi<ni.length&&((rr=ni[pi]).from==wi||rr.from==null);)rr.marker.type=="range"&&Zi.push(rr),++pi;Pr=pi<ni.length?ni[pi].from:1/0;for(var Lr=0;Lr<Zi.length;++Lr){var sr=Zi[Lr].to;sr==null&&(sr=1/0),sr==wi?Zi.splice(Lr--,1):Pr=Math.min(sr,Pr)}};wi<ei;){Pr==wi&&_s();for(var dr=Math.min(ei,Pr);;){if(Ir){for(var Dt=wi+Ir.length,Yr=Xt,Ys=0;Ys<Zi.length;++Ys){var _r=Zi[Ys];Yr=(Yr?Yr+" ":"")+_r.marker.style,_r.marker.endStyle&&_r.to===Math.min(Dt,dr)&&(Yr+=" "+_r.marker.endStyle),_r.marker.startStyle&&_r.from===wi&&(Yr+=" "+_r.marker.startStyle)}if(_t(Ke,Dt>dr?Ir.slice(0,dr-wi):Ir,Yr),Dt>=dr){Ir=Ir.slice(dr-wi),wi=dr;break}wi=Dt}Ir=ai[Qi++],Xt=Ui(ai[Qi++])}}}return Ke},cleanUp:function(){this.parent=null,S(this)}};function se(ce){this.lines=ce,this.parent=null;for(var ye=0,xe=ce.length,Me=0;ye<xe;++ye)ce[ye].parent=this,Me+=ce[ye].height;this.height=Me}se.prototype={chunkSize:function(){return this.lines.length},remove:function(ce,ye,xe){for(var Me=ce,Ge=ce+ye;Me<Ge;++Me){var Le=this.lines[Me];if(this.height-=Le.height,Le.cleanUp(),Le.handlers)for(var Ke=0;Ke<Le.handlers.length;++Ke)xe.push(Le.handlers[Ke])}this.lines.splice(ce,ye)},collapse:function(ce){ce.splice.apply(ce,[ce.length,0].concat(this.lines))},insertHeight:function(ce,ye,xe){this.height+=xe,this.lines=this.lines.slice(0,ce).concat(ye).concat(this.lines.slice(ce));for(var Me=0,Ge=ye.length;Me<Ge;++Me)ye[Me].parent=this},iterN:function(ce,ye,xe){for(var Me=ce+ye;ce<Me;++ce)if(xe(this.lines[ce]))return!0}};function le(ce){this.children=ce;for(var ye=0,xe=0,Me=0,Ge=ce.length;Me<Ge;++Me){var Le=ce[Me];ye+=Le.chunkSize(),xe+=Le.height,Le.parent=this}this.size=ye,this.height=xe,this.parent=null}le.prototype={chunkSize:function(){return this.size},remove:function(ce,ye,xe){this.size-=ye;for(var Me=0;Me<this.children.length;++Me){var Ge=this.children[Me],Le=Ge.chunkSize();if(ce<Le){var Ke=Math.min(ye,Le-ce),st=Ge.height;if(Ge.remove(ce,Ke,xe),this.height-=st-Ge.height,Le==Ke&&(this.children.splice(Me--,1),Ge.parent=null),(ye-=Ke)==0)break;ce=0}else ce-=Le}if(this.size-ye<25){var _t=[];this.collapse(_t),this.children=[new se(_t)],this.children[0].parent=this}},collapse:function(ce){for(var ye=0,xe=this.children.length;ye<xe;++ye)this.children[ye].collapse(ce)},insert:function(ce,ye){for(var xe=0,Me=0,Ge=ye.length;Me<Ge;++Me)xe+=ye[Me].height;this.insertHeight(ce,ye,xe)},insertHeight:function(ce,ye,xe){this.size+=ye.length,this.height+=xe;for(var Me=0,Ge=this.children.length;Me<Ge;++Me){var Le=this.children[Me],Ke=Le.chunkSize();if(ce<=Ke){if(Le.insertHeight(ce,ye,xe),Le.lines&&Le.lines.length>50){for(;Le.lines.length>50;){var st=Le.lines.splice(Le.lines.length-25,25),_t=new se(st);Le.height-=_t.height,this.children.splice(Me+1,0,_t),_t.parent=this}this.maybeSpill()}break}ce-=Ke}},maybeSpill:function(){if(!(this.children.length<=10)){var ce=this;do{var ye=ce.children.splice(ce.children.length-5,5),xe=new le(ye);if(ce.parent){ce.size-=xe.size,ce.height-=xe.height;var Ge=ji(ce.parent.children,ce);ce.parent.children.splice(Ge+1,0,xe)}else{var Me=new le(ce.children);Me.parent=ce,ce.children=[Me,xe],ce=Me}xe.parent=ce.parent}while(ce.children.length>10);ce.parent.maybeSpill()}},iter:function(ce,ye,xe){this.iterN(ce,ye-ce,xe)},iterN:function(ce,ye,xe){for(var Me=0,Ge=this.children.length;Me<Ge;++Me){var Le=this.children[Me],Ke=Le.chunkSize();if(ce<Ke){var st=Math.min(ye,Ke-ce);if(Le.iterN(ce,st,xe))return!0;if((ye-=st)==0)break;ce=0}else ce-=Ke}}};function fe(ce,ye){for(;!ce.lines;)for(var xe=0;;++xe){var Me=ce.children[xe],Ge=Me.chunkSize();if(ye<Ge){ce=Me;break}ye-=Ge}return ce.lines[ye]}function be(ce){if(ce.parent==null)return null;for(var ye=ce.parent,xe=ji(ye.lines,ce),Me=ye.parent;Me;ye=Me,Me=Me.parent)for(var Ge=0;Me.children[Ge]!=ye;++Ge)xe+=Me.children[Ge].chunkSize();return xe}function Te(ce,ye){var xe=0;e:do{for(var Me=0,Ge=ce.children.length;Me<Ge;++Me){var Le=ce.children[Me],Ke=Le.height;if(ye<Ke){ce=Le;continue e}ye-=Ke,xe+=Le.chunkSize()}return xe}while(!ce.lines);for(var Me=0,Ge=ce.lines.length;Me<Ge;++Me){var st=ce.lines[Me],_t=st.height;if(ye<_t)break;ye-=_t}return xe+Me}function Ve(ce,ye){var xe=0;e:do{for(var Me=0,Ge=ce.children.length;Me<Ge;++Me){var Le=ce.children[Me],Ke=Le.chunkSize();if(ye<Ke){ce=Le;continue e}ye-=Ke,xe+=Le.height}return xe}while(!ce.lines);for(var Me=0;Me<ye;++Me)xe+=ce.lines[Me].height;return xe}function Ue(){this.time=0,this.done=[],this.undone=[],this.compound=0,this.closed=!1}Ue.prototype={addChange:function(ce,ye,xe){this.undone.length=0;var Me=+new Date,Ge=_i(this.done),Le=Ge&&_i(Ge),Ke=Me-this.time;if(Ge&&!this.closed&&this.compound)Ge.push({start:ce,added:ye,old:xe});else if(Ke>400||!Le||this.closed||Le.start>ce+xe.length||Le.start+Le.added<ce)this.done.push([{start:ce,added:ye,old:xe}]),this.closed=!1;else{for(var st=Math.max(0,Le.start-ce),_t=Math.max(0,ce+xe.length-(Le.start+Le.added)),xt=st;xt>0;--xt)Le.old.unshift(xe[xt-1]);for(var xt=_t;xt>0;--xt)Le.old.push(xe[xe.length-xt]);st&&(Le.start=ce),Le.added+=ye-(xe.length-st-_t)}this.time=Me},startCompound:function(){this.compound++||(this.closed=!0)},endCompound:function(){--this.compound||(this.closed=!0)}};function me(){pt(this)}function ke(ce){return ce.stop||(ce.stop=me),ce}function qe(ce){ce.preventDefault?ce.preventDefault():ce.returnValue=!1}function lt(ce){ce.stopPropagation?ce.stopPropagation():ce.cancelBubble=!0}function pt(ce){qe(ce),lt(ce)}g.e_stop=pt,g.e_preventDefault=qe,g.e_stopPropagation=lt;function Ft(ce){return ce.target||ce.srcElement}function zt(ce){var ye=ce.which;return ye==null&&(ce.button&1?ye=1:ce.button&2?ye=3:ce.button&4&&(ye=2)),M&&ce.ctrlKey&&ye==1&&(ye=3),ye}function Nt(ce,ye){var xe=ce.override&&ce.override.hasOwnProperty(ye);return xe?ce.override[ye]:ce[ye]}function Mt(ce,ye,xe,Me){if(typeof ce.addEventListener=="function"){if(ce.addEventListener(ye,xe,!1),Me)return function(){ce.removeEventListener(ye,xe,!1)}}else{var Ge=function(Le){xe(Le||window.event)};if(ce.attachEvent("on"+ye,Ge),Me)return function(){ce.detachEvent("on"+ye,Ge)}}}g.connect=Mt;function $t(){this.id=null}$t.prototype={set:function(ce,ye){clearTimeout(this.id),this.id=setTimeout(ye,ce)}};var ri=g.Pass={toString:function(){return"CodeMirror.Pass"}},ci=function(){if(Je)return!1;var ce=bi("div");return"draggable"in ce||"dragDrop"in ce}();(function(){var ce=bi("textarea");return ce.value=`foo
bar`,ce.value.indexOf("\r")>-1?`\r
`:`
`})();var wt=/^$/;De?wt=/$'/:ft?wt=/\-[^ \-?]|\?[^ !'\"\),.\-\/:;\?\]\}]/:At&&(wt=/\-[^ \-\.?]|\?[^ \-\.?\]\}:;!'\"\),\/]|[\.!\"#&%\)*+,:;=>\]|\}~][\(\{\[<]|\$'/);function di(ce,ye,xe){ye==null&&(ye=ce.search(/[^\s\u00a0]/),ye==-1&&(ye=ce.length));for(var Me=0,Ge=0;Me<ye;++Me)ce.charAt(Me)=="	"?Ge+=xe-Ge%xe:++Ge;return Ge}function ii(ce,ye){try{var xe=ce.getBoundingClientRect();xe={top:xe.top,left:xe.left}}catch{xe={top:0,left:0}}if(!ye)if(window.pageYOffset==null){var Me=document.documentElement||document.body.parentNode;Me.scrollTop==null&&(Me=document.body),xe.top+=Me.scrollTop,xe.left+=Me.scrollLeft}else xe.top+=window.pageYOffset,xe.left+=window.pageXOffset;return xe}function Hi(ce){return ce.textContent||ce.innerText||ce.nodeValue||""}var Vi=[""];function Ot(ce){for(;Vi.length<=ce;)Vi.push(_i(Vi)+" ");return Vi[ce]}function _i(ce){return ce[ce.length-1]}function Ti(ce){B?(ce.selectionStart=0,ce.selectionEnd=ce.value.length):ce.select()}function Wi(ce,ye){return ce.line==ye.line&&ce.ch==ye.ch}function Zt(ce,ye){return ce.line<ye.line||ce.line==ye.line&&ce.ch<ye.ch}function mi(ce){return{line:ce.line,ch:ce.ch}}function bi(ce,ye,xe,Me){var Ge=document.createElement(ce);if(xe&&(Ge.className=xe),Me&&(Ge.style.cssText=Me),typeof ye=="string")Ar(Ge,ye);else if(ye)for(var Le=0;Le<ye.length;++Le)Ge.appendChild(ye[Le]);return Ge}function $i(ce){return ce.innerHTML="",ce}function tr(ce,ye){$i(ce).appendChild(ye)}function Ar(ce,ye){Je?(ce.innerHTML="",ce.appendChild(document.createTextNode(ye))):ce.textContent=ye}function Tr(ce,ye){if(!ye)return 0;if(!ce)return ye.length;for(var xe=ce.length,Me=ye.length;xe>=0&&Me>=0&&ce.charAt(xe)==ye.charAt(Me);--xe,--Me);return Me+1}function ji(ce,ye){if(ce.indexOf)return ce.indexOf(ye);for(var xe=0,Me=ce.length;xe<Me;++xe)if(ce[xe]==ye)return xe;return-1}var Ii=/[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc]/;function Qs(ce){return/\w/.test(ce)||ce>"Â"&&(ce.toUpperCase()!=ce.toLowerCase()||Ii.test(ce))}var $r=`

b`.split(/\n/).length!=3?function(ce){for(var ye=0,xe=[],Me=ce.length;ye<=Me;){var Ge=ce.indexOf(`
`,ye);Ge==-1&&(Ge=ce.length);var Le=ce.slice(ye,ce.charAt(Ge-1)=="\r"?Ge-1:Ge),Ke=Le.indexOf("\r");Ke!=-1?(xe.push(Le.slice(0,Ke)),ye+=Ke+1):(xe.push(Le),ye=Ge+1)}return xe}:function(ce){return ce.split(/\r\n?|\n/)};g.splitLines=$r;var it=window.getSelection?function(ce){try{return ce.selectionStart!=ce.selectionEnd}catch{return!1}}:function(ce){try{var ye=ce.ownerDocument.selection.createRange()}catch{}return!ye||ye.parentElement()!=ce?!1:ye.compareEndPoints("StartToEnd",ye)!=0};g.defineMode("null",function(){return{token:function(ce){ce.skipToEnd()}}}),g.defineMIME("text/plain","null");var Ie={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};return g.keyNames=Ie,function(){for(var ce=0;ce<10;ce++)Ie[ce+48]=String(ce);for(var ce=65;ce<=90;ce++)Ie[ce]=String.fromCharCode(ce);for(var ce=1;ce<=12;ce++)Ie[ce+111]=Ie[ce+63235]="F"+ce}(),g.version="2.38",g}();CodeMirror.defineMode("javascript",function(g,B){var M=g.indentUnit,P=B.json,K=B.typescript,Y=function(){function Ue($t){return{type:$t,style:"keyword"}}var me=Ue("keyword a"),ke=Ue("keyword b"),qe=Ue("keyword c"),lt=Ue("operator"),pt={type:"atom",style:"atom"},Ft={if:me,while:me,with:me,else:ke,do:ke,try:ke,finally:ke,return:qe,break:qe,continue:qe,new:qe,delete:qe,throw:qe,var:Ue("var"),const:Ue("var"),let:Ue("var"),function:Ue("function"),catch:Ue("catch"),for:Ue("for"),switch:Ue("switch"),case:Ue("case"),default:Ue("default"),in:lt,typeof:lt,instanceof:lt,true:pt,false:pt,null:pt,undefined:pt,NaN:pt,Infinity:pt};if(K){var zt={type:"variable",style:"variable-3"},Nt={interface:Ue("interface"),class:Ue("class"),extends:Ue("extends"),constructor:Ue("constructor"),public:Ue("public"),private:Ue("private"),protected:Ue("protected"),static:Ue("static"),super:Ue("super"),string:zt,number:zt,bool:zt,any:zt};for(var Mt in Nt)Ft[Mt]=Nt[Mt]}return Ft}(),re=/[+\-*&%=<>!?|]/;function D(Ue,me,ke){return me.tokenize=ke,ke(Ue,me)}function ne(Ue,me){for(var ke=!1,qe;(qe=Ue.next())!=null;){if(qe==me&&!ke)return!1;ke=!ke&&qe=="\\"}return ke}var ae,ue;function ge(Ue,me,ke){return ae=Ue,ue=ke,me}function Be(Ue,me){var ke=Ue.next();if(ke=='"'||ke=="'")return D(Ue,me,De(ke));if(/[\[\]{}\(\),;\:\.]/.test(ke))return ge(ke);if(ke=="0"&&Ue.eat(/x/i))return Ue.eatWhile(/[\da-f]/i),ge("number","number");if(/\d/.test(ke)||ke=="-"&&Ue.eat(/\d/))return Ue.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),ge("number","number");if(ke=="/")return Ue.eat("*")?D(Ue,me,ze):Ue.eat("/")?(Ue.skipToEnd(),ge("comment","comment")):me.lastType=="operator"||me.lastType=="keyword c"||/^[\[{}\(,;:]$/.test(me.lastType)?(ne(Ue,"/"),Ue.eatWhile(/[gimy]/),ge("regexp","string-2")):(Ue.eatWhile(re),ge("operator",null,Ue.current()));if(ke=="#")return Ue.skipToEnd(),ge("error","error");if(re.test(ke))return Ue.eatWhile(re),ge("operator",null,Ue.current());Ue.eatWhile(/[\w\$_]/);var qe=Ue.current(),lt=Y.propertyIsEnumerable(qe)&&Y[qe];return lt&&me.lastType!="."?ge(lt.type,lt.style,qe):ge("variable","variable",qe)}function De(Ue){return function(me,ke){return ne(me,Ue)||(ke.tokenize=Be),ge("string","string")}}function ze(Ue,me){for(var ke=!1,qe;qe=Ue.next();){if(qe=="/"&&ke){me.tokenize=Be;break}ke=qe=="*"}return ge("comment","comment")}var Oe={atom:!0,number:!0,variable:!0,string:!0,regexp:!0};function Je(Ue,me,ke,qe,lt,pt){this.indented=Ue,this.column=me,this.type=ke,this.prev=lt,this.info=pt,qe!=null&&(this.align=qe)}function We(Ue,me){for(var ke=Ue.localVars;ke;ke=ke.next)if(ke.name==me)return!0}function ut(Ue,me,ke,qe,lt){var pt=Ue.cc;for(et.state=Ue,et.stream=lt,et.marked=null,et.cc=pt,Ue.lexical.hasOwnProperty("align")||(Ue.lexical.align=!0);;){var Ft=pt.length?pt.pop():P?Ai:Yt;if(Ft(ke,qe)){for(;pt.length&&pt[pt.length-1].lex;)pt.pop()();return et.marked?et.marked:ke=="variable"&&We(Ue,qe)?"variable-2":me}}}var et={state:null,column:null,marked:null,cc:null};function At(){for(var Ue=arguments.length-1;Ue>=0;Ue--)et.cc.push(arguments[Ue])}function nt(){return At.apply(null,arguments),!0}function ft(Ue){function me(qe){for(var lt=qe;lt;lt=lt.next)if(lt.name==Ue)return!0;return!1}var ke=et.state;if(ke.context){if(et.marked="def",me(ke.localVars))return;ke.localVars={name:Ue,next:ke.localVars}}else{if(me(ke.globalVars))return;ke.globalVars={name:Ue,next:ke.globalVars}}}var Tt={name:"this",next:{name:"arguments"}};function qt(){et.state.context={prev:et.state.context,vars:et.state.localVars},et.state.localVars=Tt}function Vt(){et.state.localVars=et.state.context.vars,et.state.context=et.state.context.prev}function vt(Ue,me){var ke=function(){var qe=et.state;qe.lexical=new Je(qe.indented,et.stream.column(),Ue,null,qe.lexical,me)};return ke.lex=!0,ke}function Ut(){var Ue=et.state;Ue.lexical.prev&&(Ue.lexical.type==")"&&(Ue.indented=Ue.lexical.indented),Ue.lexical=Ue.lexical.prev)}Ut.lex=!0;function Pt(Ue){return function(ke){return ke==Ue?nt():Ue==";"?At():nt(arguments.callee)}}function Yt(Ue){return Ue=="var"?nt(vt("vardef"),R,Pt(";"),Ut):Ue=="keyword a"?nt(vt("form"),Ai,Yt,Ut):Ue=="keyword b"?nt(vt("form"),Yt,Ut):Ue=="{"?nt(vt("}"),b,Ut):Ue==";"?nt():Ue=="function"?nt(Te):Ue=="for"?nt(vt("form"),Pt("("),vt(")"),se,Pt(")"),Ut,Yt,Ut):Ue=="variable"?nt(vt("stat"),Li):Ue=="switch"?nt(vt("form"),Ai,vt("}","switch"),Pt("{"),b,Ut,Ut):Ue=="case"?nt(Ai,Pt(":")):Ue=="default"?nt(Pt(":")):Ue=="catch"?nt(vt("form"),qt,Pt("("),Ve,Pt(")"),Yt,Ut,Vt):At(vt("stat"),Ai,Pt(";"),Ut)}function Ai(Ue){return Oe.hasOwnProperty(Ue)?nt(Ei):Ue=="function"?nt(Te):Ue=="keyword c"?nt(Ri):Ue=="("?nt(vt(")"),Ri,Pt(")"),Ut,Ei):Ue=="operator"?nt(Ai):Ue=="["?nt(vt("]"),d(Ai,"]"),Ut,Ei):Ue=="{"?nt(vt("}"),d(vi,"}"),Ut,Ei):nt()}function Ri(Ue){return Ue.match(/[;\}\)\],]/)?At():At(Ai)}function Ei(Ue,me){if(Ue=="operator"&&/\+\+|--/.test(me))return nt(Ei);if(Ue=="operator"&&me=="?")return nt(Ai,Pt(":"),Ai);if(Ue!=";"){if(Ue=="(")return nt(vt(")"),d(Ai,")"),Ut,Ei);if(Ue==".")return nt(Yi,Ei);if(Ue=="[")return nt(vt("]"),Ai,Pt("]"),Ut,Ei)}}function Li(Ue){return Ue==":"?nt(Ut,Yt):At(Ei,Pt(";"),Ut)}function Yi(Ue){if(Ue=="variable")return et.marked="property",nt()}function vi(Ue){if(Ue=="variable"&&(et.marked="property"),Oe.hasOwnProperty(Ue))return nt(Pt(":"),Ai)}function d(Ue,me){function ke(qe){return qe==","?nt(Ue,ke):qe==me?nt():nt(Pt(me))}return function(lt){return lt==me?nt():At(Ue,ke)}}function b(Ue){return Ue=="}"?nt():At(Yt,b)}function S(Ue){return Ue==":"?nt(k):At()}function k(Ue){return Ue=="variable"?(et.marked="variable-3",nt()):At()}function R(Ue,me){return Ue=="variable"?(ft(me),K?nt(S,W):nt(W)):At()}function W(Ue,me){if(me=="=")return nt(Ai,W);if(Ue==",")return nt(R)}function se(Ue){return Ue=="var"?nt(R,Pt(";"),fe):Ue==";"?nt(fe):Ue=="variable"?nt(le):nt(fe)}function le(Ue,me){return me=="in"?nt(Ai):nt(Ei,fe)}function fe(Ue,me){return Ue==";"?nt(be):me=="in"?nt(Ai):nt(Ai,Pt(";"),be)}function be(Ue){Ue!=")"&&nt(Ai)}function Te(Ue,me){if(Ue=="variable")return ft(me),nt(Te);if(Ue=="(")return nt(vt(")"),qt,d(Ve,")"),Ut,Yt,Vt)}function Ve(Ue,me){if(Ue=="variable")return ft(me),K?nt(S):nt()}return{startState:function(Ue){return{tokenize:Be,lastType:null,cc:[],lexical:new Je((Ue||0)-M,0,"block",!1),localVars:B.localVars,globalVars:B.globalVars,context:B.localVars&&{vars:B.localVars},indented:0}},token:function(Ue,me){if(Ue.sol()&&(me.lexical.hasOwnProperty("align")||(me.lexical.align=!1),me.indented=Ue.indentation()),Ue.eatSpace())return null;var ke=me.tokenize(Ue,me);return ae=="comment"?ke:(me.lastType=ae,ut(me,ke,ae,ue,Ue))},indent:function(Ue,me){if(Ue.tokenize==ze)return CodeMirror.Pass;if(Ue.tokenize!=Be)return 0;var ke=me&&me.charAt(0),qe=Ue.lexical;qe.type=="stat"&&ke=="}"&&(qe=qe.prev);var lt=qe.type,pt=ke==lt;return lt=="vardef"?qe.indented+(Ue.lastType=="operator"||Ue.lastType==","?4:0):lt=="form"&&ke=="{"?qe.indented:lt=="form"?qe.indented+M:lt=="stat"?qe.indented+(Ue.lastType=="operator"||Ue.lastType==","?M:0):qe.info=="switch"&&!pt?qe.indented+(/^(?:case|default)\b/.test(me)?M:2*M):qe.align?qe.column+(pt?0:1):qe.indented+(pt?0:M)},electricChars:":{}",jsonMode:P}});CodeMirror.defineMIME("text/javascript","javascript");CodeMirror.defineMIME("text/ecmascript","javascript");CodeMirror.defineMIME("application/javascript","javascript");CodeMirror.defineMIME("application/ecmascript","javascript");CodeMirror.defineMIME("application/json",{name:"javascript",json:!0});CodeMirror.defineMIME("text/typescript",{name:"javascript",typescript:!0});CodeMirror.defineMIME("application/typescript",{name:"javascript",typescript:!0});CodeMirror.defineMode("xml",function(g,B){var M=g.indentUnit,P=B.htmlMode?{autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0}:{autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1},K=B.alignCDATA,Y,re;function D(vt,Ut){function Pt(Li){return Ut.tokenize=Li,Li(vt,Ut)}var Yt=vt.next();if(Yt=="<"){if(vt.eat("!"))return vt.eat("[")?vt.match("CDATA[")?Pt(ue("atom","]]>")):null:vt.match("--")?Pt(ue("comment","-->")):vt.match("DOCTYPE",!0,!0)?(vt.eatWhile(/[\w\._\-]/),Pt(ge(1))):null;if(vt.eat("?"))return vt.eatWhile(/[\w\._\-]/),Ut.tokenize=ue("meta","?>"),"meta";var Ai=vt.eat("/");Y="";for(var Ri;Ri=vt.eat(/[^\s\u00a0=<>\"\'\/?]/);)Y+=Ri;return Y?(re=Ai?"closeTag":"openTag",Ut.tokenize=ne,"tag"):"error"}else if(Yt=="&"){var Ei;return vt.eat("#")?vt.eat("x")?Ei=vt.eatWhile(/[a-fA-F\d]/)&&vt.eat(";"):Ei=vt.eatWhile(/[\d]/)&&vt.eat(";"):Ei=vt.eatWhile(/[\w\.\-:]/)&&vt.eat(";"),Ei?"atom":"error"}else return vt.eatWhile(/[^&<]/),null}function ne(vt,Ut){var Pt=vt.next();return Pt==">"||Pt=="/"&&vt.eat(">")?(Ut.tokenize=D,re=Pt==">"?"endTag":"selfcloseTag","tag"):Pt=="="?(re="equals",null):/[\'\"]/.test(Pt)?(Ut.tokenize=ae(Pt),Ut.tokenize(vt,Ut)):(vt.eatWhile(/[^\s\u00a0=<>\"\']/),"word")}function ae(vt){return function(Ut,Pt){for(;!Ut.eol();)if(Ut.next()==vt){Pt.tokenize=ne;break}return"string"}}function ue(vt,Ut){return function(Pt,Yt){for(;!Pt.eol();){if(Pt.match(Ut)){Yt.tokenize=D;break}Pt.next()}return vt}}function ge(vt){return function(Ut,Pt){for(var Yt;(Yt=Ut.next())!=null;){if(Yt=="<")return Pt.tokenize=ge(vt+1),Pt.tokenize(Ut,Pt);if(Yt==">")if(vt==1){Pt.tokenize=D;break}else return Pt.tokenize=ge(vt-1),Pt.tokenize(Ut,Pt)}return"meta"}}var Be,De;function ze(){for(var vt=arguments.length-1;vt>=0;vt--)Be.cc.push(arguments[vt])}function Oe(){return ze.apply(null,arguments),!0}function Je(vt,Ut){var Pt=P.doNotIndent.hasOwnProperty(vt)||Be.context&&Be.context.noIndent;Be.context={prev:Be.context,tagName:vt,indent:Be.indented,startOfLine:Ut,noIndent:Pt}}function We(){Be.context&&(Be.context=Be.context.prev)}function ut(vt){if(vt=="openTag")return Be.tagName=Y,Oe(ft,et(Be.startOfLine));if(vt=="closeTag"){var Ut=!1;return Be.context?Be.context.tagName!=Y&&(P.implicitlyClosed.hasOwnProperty(Be.context.tagName.toLowerCase())&&We(),Ut=!Be.context||Be.context.tagName!=Y):Ut=!0,Ut&&(De="error"),Oe(At(Ut))}return Oe()}function et(vt){return function(Ut){return Ut=="selfcloseTag"||Ut=="endTag"&&P.autoSelfClosers.hasOwnProperty(Be.tagName.toLowerCase())?(nt(Be.tagName.toLowerCase()),Oe()):(Ut=="endTag"&&(nt(Be.tagName.toLowerCase()),Je(Be.tagName,vt)),Oe())}}function At(vt){return function(Ut){return vt&&(De="error"),Ut=="endTag"?(We(),Oe()):(De="error",Oe(arguments.callee))}}function nt(vt){for(var Ut;;){if(!Be.context||(Ut=Be.context.tagName.toLowerCase(),!P.contextGrabbers.hasOwnProperty(Ut)||!P.contextGrabbers[Ut].hasOwnProperty(vt)))return;We()}}function ft(vt){return vt=="word"?(De="attribute",Oe(Tt,ft)):vt=="endTag"||vt=="selfcloseTag"?ze():(De="error",Oe(ft))}function Tt(vt){return vt=="equals"?Oe(qt,ft):(P.allowMissing?vt=="word"&&(De="attribute"):De="error",vt=="endTag"||vt=="selfcloseTag"?ze():Oe())}function qt(vt){return vt=="string"?Oe(Vt):vt=="word"&&P.allowUnquoted?(De="string",Oe()):(De="error",vt=="endTag"||vt=="selfCloseTag"?ze():Oe())}function Vt(vt){return vt=="string"?Oe(Vt):ze()}return{startState:function(){return{tokenize:D,cc:[],indented:0,startOfLine:!0,tagName:null,context:null}},token:function(vt,Ut){if(vt.sol()&&(Ut.startOfLine=!0,Ut.indented=vt.indentation()),vt.eatSpace())return null;De=re=Y=null;var Pt=Ut.tokenize(vt,Ut);if(Ut.type=re,(Pt||re)&&Pt!="comment")for(Be=Ut;;){var Yt=Ut.cc.pop()||ut;if(Yt(re||Pt))break}return Ut.startOfLine=!1,De||Pt},indent:function(vt,Ut,Pt){var Yt=vt.context;if(vt.tokenize!=ne&&vt.tokenize!=D||Yt&&Yt.noIndent)return Pt?Pt.match(/^(\s*)/)[0].length:0;if(K&&/<!\[CDATA\[/.test(Ut))return 0;for(Yt&&/^<\//.test(Ut)&&(Yt=Yt.prev);Yt&&!Yt.startOfLine;)Yt=Yt.prev;return Yt?Yt.indent+M:0},electricChars:"/",configuration:B.htmlMode?"html":"xml"}});CodeMirror.defineMIME("text/xml","xml");CodeMirror.defineMIME("application/xml","xml");CodeMirror.mimeModes.hasOwnProperty("text/html")||CodeMirror.defineMIME("text/html",{name:"xml",htmlMode:!0});CodeMirror.defineMode("clike",function(g,B){var M=g.indentUnit,P=B.statementIndentUnit||M,K=B.dontAlignCalls,Y=B.keywords||{},re=B.builtin||{},D=B.blockKeywords||{},ne=B.atoms||{},ae=B.hooks||{},ue=B.multiLineStrings,ge=/[+\-*&%=<>!?|\/]/,Be;function De(et,At){var nt=et.next();if(ae[nt]){var ft=ae[nt](et,At);if(ft!==!1)return ft}if(nt=='"'||nt=="'")return At.tokenize=ze(nt),At.tokenize(et,At);if(/[\[\]{}\(\),;\:\.]/.test(nt))return Be=nt,null;if(/\d/.test(nt))return et.eatWhile(/[\w\.]/),"number";if(nt=="/"){if(et.eat("*"))return At.tokenize=Oe,Oe(et,At);if(et.eat("/"))return et.skipToEnd(),"comment"}if(ge.test(nt))return et.eatWhile(ge),"operator";et.eatWhile(/[\w\$_]/);var Tt=et.current();return Y.propertyIsEnumerable(Tt)?(D.propertyIsEnumerable(Tt)&&(Be="newstatement"),"keyword"):re.propertyIsEnumerable(Tt)?(D.propertyIsEnumerable(Tt)&&(Be="newstatement"),"builtin"):ne.propertyIsEnumerable(Tt)?"atom":"variable"}function ze(et){return function(At,nt){for(var ft=!1,Tt,qt=!1;(Tt=At.next())!=null;){if(Tt==et&&!ft){qt=!0;break}ft=!ft&&Tt=="\\"}return(qt||!(ft||ue))&&(nt.tokenize=null),"string"}}function Oe(et,At){for(var nt=!1,ft;ft=et.next();){if(ft=="/"&&nt){At.tokenize=null;break}nt=ft=="*"}return"comment"}function Je(et,At,nt,ft,Tt){this.indented=et,this.column=At,this.type=nt,this.align=ft,this.prev=Tt}function We(et,At,nt){var ft=et.indented;return et.context&&et.context.type=="statement"&&(ft=et.context.indented),et.context=new Je(ft,At,nt,null,et.context)}function ut(et){var At=et.context.type;return(At==")"||At=="]"||At=="}")&&(et.indented=et.context.indented),et.context=et.context.prev}return{startState:function(et){return{tokenize:null,context:new Je((et||0)-M,0,"top",!1),indented:0,startOfLine:!0}},token:function(et,At){var nt=At.context;if(et.sol()&&(nt.align==null&&(nt.align=!1),At.indented=et.indentation(),At.startOfLine=!0),et.eatSpace())return null;Be=null;var ft=(At.tokenize||De)(et,At);if(ft=="comment"||ft=="meta")return ft;if(nt.align==null&&(nt.align=!0),(Be==";"||Be==":"||Be==",")&&nt.type=="statement")ut(At);else if(Be=="{")We(At,et.column(),"}");else if(Be=="[")We(At,et.column(),"]");else if(Be=="(")We(At,et.column(),")");else if(Be=="}"){for(;nt.type=="statement";)nt=ut(At);for(nt.type=="}"&&(nt=ut(At));nt.type=="statement";)nt=ut(At)}else Be==nt.type?ut(At):((nt.type=="}"||nt.type=="top")&&Be!=";"||nt.type=="statement"&&Be=="newstatement")&&We(At,et.column(),"statement");return At.startOfLine=!1,ft},indent:function(et,At){if(et.tokenize==Oe)return CodeMirror.Pass;if(et.tokenize!=De&&et.tokenize!=null)return 0;var nt=et.context,ft=At&&At.charAt(0);nt.type=="statement"&&ft=="}"&&(nt=nt.prev);var Tt=ft==nt.type;return nt.type=="statement"?nt.indented+(ft=="{"?0:P):K&&nt.type==")"&&!Tt?nt.indented+P:nt.align?nt.column+(Tt?0:1):nt.indented+(Tt?0:M)},electricChars:"{}"}});(function(){function g(Y){for(var re={},D=Y.split(" "),ne=0;ne<D.length;++ne)re[D[ne]]=!0;return re}var B="auto if break int case long char register continue return default short do sizeof double static else struct entry switch extern typedef float union for unsigned goto while enum void const signed volatile";function M(Y,re){if(!re.startOfLine)return!1;for(;;)if(Y.skipTo("\\")){if(Y.next(),Y.eol()){re.tokenize=M;break}}else{Y.skipToEnd(),re.tokenize=null;break}return"meta"}function P(Y,re){for(var D;(D=Y.next())!=null;)if(D=='"'&&!Y.eat('"')){re.tokenize=null;break}return"string"}function K(Y,re){for(var D=0;D<Y.length;++D)CodeMirror.defineMIME(Y[D],re)}K(["text/x-csrc","text/x-c","text/x-chdr"],{name:"clike",keywords:g(B),blockKeywords:g("case do else for if switch while struct"),atoms:g("null"),hooks:{"#":M}}),K(["text/x-c++src","text/x-c++hdr"],{name:"clike",keywords:g(B+" asm dynamic_cast namespace reinterpret_cast try bool explicit new static_cast typeid catch operator template typename class friend private this using const_cast inline public throw virtual delete mutable protected wchar_t"),blockKeywords:g("catch class do else finally for if struct switch try while"),atoms:g("true false null"),hooks:{"#":M}}),CodeMirror.defineMIME("text/x-java",{name:"clike",keywords:g("abstract assert boolean break byte case catch char class const continue default do double else enum extends final finally float for goto if implements import instanceof int interface long native new package private protected public return short static strictfp super switch synchronized this throw throws transient try void volatile while"),blockKeywords:g("catch class do else finally for if switch try while"),atoms:g("true false null"),hooks:{"@":function(Y,re){return Y.eatWhile(/[\w\$_]/),"meta"}}}),CodeMirror.defineMIME("text/x-csharp",{name:"clike",keywords:g("abstract as base break case catch checked class const continue default delegate do else enum event explicit extern finally fixed for foreach goto if implicit in interface internal is lock namespace new operator out override params private protected public readonly ref return sealed sizeof stackalloc static struct switch this throw try typeof unchecked unsafe using virtual void volatile while add alias ascending descending dynamic from get global group into join let orderby partial remove select set value var yield"),blockKeywords:g("catch class do else finally for foreach if struct switch try while"),builtin:g("Boolean Byte Char DateTime DateTimeOffset Decimal Double Guid Int16 Int32 Int64 Object SByte Single String TimeSpan UInt16 UInt32 UInt64 bool byte char decimal double short int long object sbyte float string ushort uint ulong"),atoms:g("true false null"),hooks:{"@":function(Y,re){return Y.eat('"')?(re.tokenize=P,P(Y,re)):(Y.eatWhile(/[\w\$_]/),"meta")}}}),CodeMirror.defineMIME("text/x-scala",{name:"clike",keywords:g("abstract case catch class def do else extends false final finally for forSome if implicit import lazy match new null object override package private protected return sealed super this throw trait try trye type val var while with yield _ : = => <- <: <% >: # @ assert assume require print println printf readLine readBoolean readByte readShort readChar readInt readLong readFloat readDouble AnyVal App Application Array BufferedIterator BigDecimal BigInt Char Console Either Enumeration Equiv Error Exception Fractional Function IndexedSeq Integral Iterable Iterator List Map Numeric Nil NotNull Option Ordered Ordering PartialFunction PartialOrdering Product Proxy Range Responder Seq Serializable Set Specializable Stream StringBuilder StringContext Symbol Throwable Traversable TraversableOnce Tuple Unit Vector :: #:: Boolean Byte Character CharSequence Class ClassLoader Cloneable Comparable Compiler Double Exception Float Integer Long Math Number Object Package Pair Process Runtime Runnable SecurityManager Short StackTraceElement StrictMath String StringBuffer System Thread ThreadGroup ThreadLocal Throwable Triple Void"),blockKeywords:g("catch class do else finally for forSome if match switch try while"),atoms:g("true false null"),hooks:{"@":function(Y,re){return Y.eatWhile(/[\w\$_]/),"meta"}}})})();CodeMirror.defineMode("css",function(g){var B=g.indentUnit,M,P=ne(["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"]),K=ne(["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid"]),Y=ne(["align-content","align-items","align-self","alignment-adjust","alignment-baseline","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backface-visibility","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","baseline-shift","binding","bleed","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","font","font-feature-settings","font-family","font-kerning","font-language-override","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-weight","grid-cell","grid-column","grid-column-align","grid-column-sizing","grid-column-span","grid-columns","grid-flow","grid-row","grid-row-align","grid-row-sizing","grid-row-span","grid-rows","grid-template","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","justify-content","left","letter-spacing","line-break","line-height","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marker-offset","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","max-height","max-width","min-height","min-width","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","play-during","position","presentation-level","punctuation-trim","quotes","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotation","rotation-point","ruby-align","ruby-overhang","ruby-position","ruby-span","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-outline","text-shadow","text-space-collapse","text-transform","text-underline-position","text-wrap","top","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","unicode-bidi","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","word-break","word-spacing","word-wrap","z-index"]),re=ne(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua"]),D=ne(["above","absolute","activeborder","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","auto","avoid","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break-all","break-word","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","compact","condensed","contain","content","content-box","context-menu","continuous","copy","cover","crop","cross","crosshair","currentcolor","cursive","dashed","decimal","decimal-leading-zero","default","default-button","destination-atop","destination-in","destination-out","destination-over","devanagari","disc","discard","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ew-resize","expanded","extra-condensed","extra-expanded","fantasy","fast","fill","fixed","flat","footnotes","forwards","from","geometricPrecision","georgian","graytext","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-table","inset","inside","intrinsic","invert","italic","justify","kannada","katakana","katakana-iroha","khmer","landscape","lao","large","larger","left","level","lighter","line-through","linear","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","malayalam","match","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","myanmar","n-resize","narrower","navy","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","nw-resize","nwse-resize","oblique","octal","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","overlay","overline","padding","padding-box","painted","paused","persian","plus-darker","plus-lighter","pointer","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radio","read-only","read-write","read-write-plaintext-only","relative","repeat","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","round","row-resize","rtl","run-in","running","s-resize","sans-serif","scroll","scrollbar","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","semi-condensed","semi-expanded","separate","serif","show","sidama","single","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","solid","somali","source-atop","source-in","source-out","source-over","space","square","square-button","start","static","status-bar","stretch","stroke","sub","subpixel-antialiased","super","sw-resize","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","transparent","ultra-condensed","ultra-expanded","underline","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","vertical","vertical-text","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","white","wider","window","windowframe","windowtext","x-large","x-small","xor","xx-large","xx-small","yellow"]);function ne(Oe){for(var Je={},We=0;We<Oe.length;++We)Je[Oe[We]]=!0;return Je}function ae(Oe,Je){return M=Je,Oe}function ue(Oe,Je){var We=Oe.next();if(We=="@")return Oe.eatWhile(/[\w\\\-]/),ae("def",Oe.current());if(We=="/"&&Oe.eat("*"))return Je.tokenize=ge,ge(Oe,Je);if(We=="<"&&Oe.eat("!"))return Je.tokenize=Be,Be(Oe,Je);if(We=="=")ae(null,"compare");else{if((We=="~"||We=="|")&&Oe.eat("="))return ae(null,"compare");if(We=='"'||We=="'")return Je.tokenize=De(We),Je.tokenize(Oe,Je);if(We=="#")return Oe.eatWhile(/[\w\\\-]/),ae("atom","hash");if(We=="!")return Oe.match(/^\s*\w*/),ae("keyword","important");if(/\d/.test(We))return Oe.eatWhile(/[\w.%]/),ae("number","unit");if(We==="-"){if(/\d/.test(Oe.peek()))return Oe.eatWhile(/[\w.%]/),ae("number","unit");if(Oe.match(/^[^-]+-/))return ae("meta",M)}else return/[,+>*\/]/.test(We)?ae(null,"select-op"):We=="."&&Oe.match(/^-?[_a-z][_a-z0-9-]*/i)?ae("qualifier",M):We==":"?ae("operator",We):/[;{}\[\]\(\)]/.test(We)?ae(null,We):We=="u"&&Oe.match("rl(")?(Oe.backUp(1),Je.tokenize=ze,ae("property","variable")):(Oe.eatWhile(/[\w\\\-]/),ae("property","variable"))}}function ge(Oe,Je){for(var We=!1,ut;(ut=Oe.next())!=null;){if(We&&ut=="/"){Je.tokenize=ue;break}We=ut=="*"}return ae("comment","comment")}function Be(Oe,Je){for(var We=0,ut;(ut=Oe.next())!=null;){if(We>=2&&ut==">"){Je.tokenize=ue;break}We=ut=="-"?We+1:0}return ae("comment","comment")}function De(Oe,Je){return function(We,ut){for(var et=!1,At;(At=We.next())!=null&&!(At==Oe&&!et);)et=!et&&At=="\\";return et||(Je&&We.backUp(1),ut.tokenize=ue),ae("string","string")}}function ze(Oe,Je){return Oe.next(),Oe.match(/\s*[\"\']/,!1)?Je.tokenize=ue:Je.tokenize=De(")",!0),ae(null,"(")}return{startState:function(Oe){return{tokenize:ue,baseIndent:Oe||0,stack:[]}},token:function(Oe,Je){if(Je.tokenize==ue&&Oe.eatSpace())return null;var We=Je.tokenize(Oe,Je),ut=Je.stack[Je.stack.length-1];return We=="property"?ut=="propertyValue"?D[Oe.current()]?We="string-2":re[Oe.current()]?We="keyword":We="variable-2":ut=="rule"?Y[Oe.current()]||(We+=" error"):!ut||ut=="@media{"?We="tag":ut=="@media"?P[Oe.current()]?We="attribute":/^(only|not)$/i.test(Oe.current())?We="keyword":Oe.current().toLowerCase()=="and"||K[Oe.current()]?We="error":We="attribute error":ut=="@mediaType"?P[Oe.current()]?We="attribute":Oe.current().toLowerCase()=="and"?We="operator":(/^(only|not)$/i.test(Oe.current())||K[Oe.current()],We="error"):ut=="@mediaType("?Y[Oe.current()]||(P[Oe.current()]?We="error":Oe.current().toLowerCase()=="and"?We="operator":/^(only|not)$/i.test(Oe.current())?We="error":We+=" error"):We="error":We=="atom"?!ut||ut=="@media{"?We="builtin":ut=="propertyValue"?/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(Oe.current())||(We+=" error"):We="error":ut=="@media"&&M=="{"&&(We="error"),M=="{"?ut=="@media"||ut=="@mediaType"?(Je.stack.pop(),Je.stack[Je.stack.length-1]="@media{"):Je.stack.push("rule"):M=="}"?(Je.stack.pop(),ut=="propertyValue"&&Je.stack.pop()):M=="@media"?Je.stack.push("@media"):ut=="@media"&&/\b(keyword|attribute)\b/.test(We)?Je.stack.push("@mediaType"):ut=="@mediaType"&&Oe.current()==","?Je.stack.pop():ut=="@mediaType"&&M=="("?Je.stack.push("@mediaType("):ut=="@mediaType("&&M==")"?Je.stack.pop():ut=="rule"&&M==":"?Je.stack.push("propertyValue"):ut=="propertyValue"&&M==";"&&Je.stack.pop(),We},indent:function(Oe,Je){var We=Oe.stack.length;return/^\}/.test(Je)&&(We-=Oe.stack[Oe.stack.length-1]=="propertyValue"?2:1),Oe.baseIndent+We*B},electricChars:"}"}});CodeMirror.defineMIME("text/css","css");CodeMirror.multiplexingMode=function(g){var B=Array.prototype.slice.call(arguments,1),M=B.length;function P(K,Y,re){if(typeof Y=="string")return K.indexOf(Y,re);var D=Y.exec(re?K.slice(re):K);return D?D.index+re:-1}return{startState:function(){return{outer:CodeMirror.startState(g),innerActive:null,inner:null}},copyState:function(K){return{outer:CodeMirror.copyState(g,K.outer),innerActive:K.innerActive,inner:K.innerActive&&CodeMirror.copyState(K.innerActive.mode,K.inner)}},token:function(K,Y){if(Y.innerActive){var Be=Y.innerActive,D=K.string,ue=P(D,Be.close,K.pos);if(ue==K.pos)return K.match(Be.close),Y.innerActive=Y.inner=null,Be.delimStyle;ue>-1&&(K.string=D.slice(0,ue));var De=Be.mode.token(K,Y.inner);ue>-1&&(K.string=D);var ze=K.current(),ue=ze.indexOf(Be.close);return ue>-1&&K.backUp(ze.length-ue),De}else{for(var re=1/0,D=K.string,ne=0;ne<M;++ne){var ae=B[ne],ue=P(D,ae.open,K.pos);if(ue==K.pos)return K.match(ae.open),Y.innerActive=ae,Y.inner=CodeMirror.startState(ae.mode,g.indent?g.indent(Y.outer,""):0),ae.delimStyle;ue!=-1&&ue<re&&(re=ue)}re!=1/0&&(K.string=D.slice(0,re));var ge=g.token(K,Y.outer);return re!=1/0&&(K.string=D),ge}},indent:function(K,Y){var re=K.innerActive?K.innerActive.mode:g;return re.indent?re.indent(K.innerActive?K.inner:K.outer,Y):CodeMirror.Pass},blankLine:function(K){var Y=K.innerActive?K.innerActive.mode:g;if(Y.blankLine&&Y.blankLine(K.innerActive?K.inner:K.outer),K.innerActive)Y.close===`
`&&(K.innerActive=K.inner=null);else for(var re=0;re<M;++re){var D=B[re];D.open===`
`&&(K.innerActive=D,K.inner=CodeMirror.startState(D.mode,Y.indent?Y.indent(K.outer,""):0))}},electricChars:g.electricChars,innerMode:function(K){return K.inner?{state:K.inner,mode:K.innerActive.mode}:{state:K.outer,mode:g}}}};(function(){CodeMirror.defaults.closeTagEnabled=!0,CodeMirror.defaults.closeTagIndent=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"],CodeMirror.defaults.closeTagVoid=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function g(re,D){var ne=CodeMirror.innerMode(re.getMode(),D);if(ne.mode.name=="xml")return ne.state}CodeMirror.defineExtension("closeTag",function(re,D,ne,ae){if(!re.getOption("closeTagEnabled"))throw CodeMirror.Pass;var ue=re.getCursor(),ge=re.getTokenAt(ue),Be=g(re,ge.state);if(Be){if(D==">"){var De=Be.type;if(ge.className=="tag"&&De=="closeTag"||(re.replaceSelection(">"),ue={line:ue.line,ch:ue.ch+1},re.setCursor(ue),ge=re.getTokenAt(re.getCursor()),Be=g(re,ge.state),!Be))throw CodeMirror.Pass;var De=Be.type;if(ge.className=="tag"&&De!="selfcloseTag"){var ze=Be.tagName;ze.length>0&&P(re,ae,ze)&&B(re,ne,ue,ze);return}re.setSelection({line:ue.line,ch:ue.ch-1},ue),re.replaceSelection("")}else if(D=="/"&&ge.className=="tag"&&ge.string=="<"){var Oe=Be.context,ze=Oe?Oe.tagName:"";if(ze.length>0){Y(re,ue,ze);return}}}throw CodeMirror.Pass});function B(re,D,ne,ae){M(re,D,ae)?(re.replaceSelection(`

</`+ae+">","end"),re.indentLine(ne.line+1),re.indentLine(ne.line+2),re.setCursor({line:ne.line+1,ch:re.getLine(ne.line+1).length})):(re.replaceSelection("</"+ae+">"),re.setCursor(ne))}function M(re,D,ne){return(typeof D>"u"||D==null||D==!0)&&(D=re.getOption("closeTagIndent")),D||(D=[]),K(D,ne.toLowerCase())!=-1}function P(re,D,ne){return re.getOption("mode")=="xml"?!0:((typeof D>"u"||D==null)&&(D=re.getOption("closeTagVoid")),D||(D=[]),K(D,ne.toLowerCase())==-1)}function K(re,D){if(re.indexOf)return re.indexOf(D);for(var ne=0,ae=re.length;ne<ae;++ne)if(re[ne]==D)return ne;return-1}function Y(re,D,ne){re.replaceSelection("/"+ne+">"),re.setCursor({line:D.line,ch:D.ch+ne.length+2})}})();/*!
 * html2canvas 1.4.1 <https://html2canvas.hertzen.com>
 * Copyright (c) 2022 Niklas von Hertzen <https://hertzen.com>
 * Released under MIT License
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var extendStatics=function(g,B){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,P){M.__proto__=P}||function(M,P){for(var K in P)Object.prototype.hasOwnProperty.call(P,K)&&(M[K]=P[K])},extendStatics(g,B)};function __extends(g,B){if(typeof B!="function"&&B!==null)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");extendStatics(g,B);function M(){this.constructor=g}g.prototype=B===null?Object.create(B):(M.prototype=B.prototype,new M)}var __assign=function(){return __assign=Object.assign||function(B){for(var M,P=1,K=arguments.length;P<K;P++){M=arguments[P];for(var Y in M)Object.prototype.hasOwnProperty.call(M,Y)&&(B[Y]=M[Y])}return B},__assign.apply(this,arguments)};function __awaiter(g,B,M,P){function K(Y){return Y instanceof M?Y:new M(function(re){re(Y)})}return new(M||(M=Promise))(function(Y,re){function D(ue){try{ae(P.next(ue))}catch(ge){re(ge)}}function ne(ue){try{ae(P.throw(ue))}catch(ge){re(ge)}}function ae(ue){ue.done?Y(ue.value):K(ue.value).then(D,ne)}ae((P=P.apply(g,[])).next())})}function __generator(g,B){var M={label:0,sent:function(){if(Y[0]&1)throw Y[1];return Y[1]},trys:[],ops:[]},P,K,Y,re;return re={next:D(0),throw:D(1),return:D(2)},typeof Symbol=="function"&&(re[Symbol.iterator]=function(){return this}),re;function D(ae){return function(ue){return ne([ae,ue])}}function ne(ae){if(P)throw new TypeError("Generator is already executing.");for(;M;)try{if(P=1,K&&(Y=ae[0]&2?K.return:ae[0]?K.throw||((Y=K.return)&&Y.call(K),0):K.next)&&!(Y=Y.call(K,ae[1])).done)return Y;switch(K=0,Y&&(ae=[ae[0]&2,Y.value]),ae[0]){case 0:case 1:Y=ae;break;case 4:return M.label++,{value:ae[1],done:!1};case 5:M.label++,K=ae[1],ae=[0];continue;case 7:ae=M.ops.pop(),M.trys.pop();continue;default:if(Y=M.trys,!(Y=Y.length>0&&Y[Y.length-1])&&(ae[0]===6||ae[0]===2)){M=0;continue}if(ae[0]===3&&(!Y||ae[1]>Y[0]&&ae[1]<Y[3])){M.label=ae[1];break}if(ae[0]===6&&M.label<Y[1]){M.label=Y[1],Y=ae;break}if(Y&&M.label<Y[2]){M.label=Y[2],M.ops.push(ae);break}Y[2]&&M.ops.pop(),M.trys.pop();continue}ae=B.call(g,M)}catch(ue){ae=[6,ue],K=0}finally{P=Y=0}if(ae[0]&5)throw ae[1];return{value:ae[0]?ae[1]:void 0,done:!0}}}function __spreadArray(g,B,M){if(arguments.length===2)for(var P=0,K=B.length,Y;P<K;P++)(Y||!(P in B))&&(Y||(Y=Array.prototype.slice.call(B,0,P)),Y[P]=B[P]);return g.concat(Y||B)}var Bounds=function(){function g(B,M,P,K){this.left=B,this.top=M,this.width=P,this.height=K}return g.prototype.add=function(B,M,P,K){return new g(this.left+B,this.top+M,this.width+P,this.height+K)},g.fromClientRect=function(B,M){return new g(M.left+B.windowBounds.left,M.top+B.windowBounds.top,M.width,M.height)},g.fromDOMRectList=function(B,M){var P=Array.from(M).find(function(K){return K.width!==0});return P?new g(P.left+B.windowBounds.left,P.top+B.windowBounds.top,P.width,P.height):g.EMPTY},g.EMPTY=new g(0,0,0,0),g}(),parseBounds=function(g,B){return Bounds.fromClientRect(g,B.getBoundingClientRect())},parseDocumentSize=function(g){var B=g.body,M=g.documentElement;if(!B||!M)throw new Error("Unable to get document size");var P=Math.max(Math.max(B.scrollWidth,M.scrollWidth),Math.max(B.offsetWidth,M.offsetWidth),Math.max(B.clientWidth,M.clientWidth)),K=Math.max(Math.max(B.scrollHeight,M.scrollHeight),Math.max(B.offsetHeight,M.offsetHeight),Math.max(B.clientHeight,M.clientHeight));return new Bounds(0,0,P,K)},toCodePoints$1=function(g){for(var B=[],M=0,P=g.length;M<P;){var K=g.charCodeAt(M++);if(K>=55296&&K<=56319&&M<P){var Y=g.charCodeAt(M++);(Y&64512)===56320?B.push(((K&1023)<<10)+(Y&1023)+65536):(B.push(K),M--)}else B.push(K)}return B},fromCodePoint$1=function(){for(var g=[],B=0;B<arguments.length;B++)g[B]=arguments[B];if(String.fromCodePoint)return String.fromCodePoint.apply(String,g);var M=g.length;if(!M)return"";for(var P=[],K=-1,Y="";++K<M;){var re=g[K];re<=65535?P.push(re):(re-=65536,P.push((re>>10)+55296,re%1024+56320)),(K+1===M||P.length>16384)&&(Y+=String.fromCharCode.apply(String,P),P.length=0)}return Y},chars$2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$2=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var i$2=0;i$2<chars$2.length;i$2++)lookup$2[chars$2.charCodeAt(i$2)]=i$2;var chars$1$1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1$1=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var i$1$1=0;i$1$1<chars$1$1.length;i$1$1++)lookup$1$1[chars$1$1.charCodeAt(i$1$1)]=i$1$1;var decode$1=function(g){var B=g.length*.75,M=g.length,P,K=0,Y,re,D,ne;g[g.length-1]==="="&&(B--,g[g.length-2]==="="&&B--);var ae=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(B):new Array(B),ue=Array.isArray(ae)?ae:new Uint8Array(ae);for(P=0;P<M;P+=4)Y=lookup$1$1[g.charCodeAt(P)],re=lookup$1$1[g.charCodeAt(P+1)],D=lookup$1$1[g.charCodeAt(P+2)],ne=lookup$1$1[g.charCodeAt(P+3)],ue[K++]=Y<<2|re>>4,ue[K++]=(re&15)<<4|D>>2,ue[K++]=(D&3)<<6|ne&63;return ae},polyUint16Array$1=function(g){for(var B=g.length,M=[],P=0;P<B;P+=2)M.push(g[P+1]<<8|g[P]);return M},polyUint32Array$1=function(g){for(var B=g.length,M=[],P=0;P<B;P+=4)M.push(g[P+3]<<24|g[P+2]<<16|g[P+1]<<8|g[P]);return M},UTRIE2_SHIFT_2$1=5,UTRIE2_SHIFT_1$1=11,UTRIE2_INDEX_SHIFT$1=2,UTRIE2_SHIFT_1_2$1=UTRIE2_SHIFT_1$1-UTRIE2_SHIFT_2$1,UTRIE2_LSCP_INDEX_2_OFFSET$1=65536>>UTRIE2_SHIFT_2$1,UTRIE2_DATA_BLOCK_LENGTH$1=1<<UTRIE2_SHIFT_2$1,UTRIE2_DATA_MASK$1=UTRIE2_DATA_BLOCK_LENGTH$1-1,UTRIE2_LSCP_INDEX_2_LENGTH$1=1024>>UTRIE2_SHIFT_2$1,UTRIE2_INDEX_2_BMP_LENGTH$1=UTRIE2_LSCP_INDEX_2_OFFSET$1+UTRIE2_LSCP_INDEX_2_LENGTH$1,UTRIE2_UTF8_2B_INDEX_2_OFFSET$1=UTRIE2_INDEX_2_BMP_LENGTH$1,UTRIE2_UTF8_2B_INDEX_2_LENGTH$1=32,UTRIE2_INDEX_1_OFFSET$1=UTRIE2_UTF8_2B_INDEX_2_OFFSET$1+UTRIE2_UTF8_2B_INDEX_2_LENGTH$1,UTRIE2_OMITTED_BMP_INDEX_1_LENGTH$1=65536>>UTRIE2_SHIFT_1$1,UTRIE2_INDEX_2_BLOCK_LENGTH$1=1<<UTRIE2_SHIFT_1_2$1,UTRIE2_INDEX_2_MASK$1=UTRIE2_INDEX_2_BLOCK_LENGTH$1-1,slice16$1=function(g,B,M){return g.slice?g.slice(B,M):new Uint16Array(Array.prototype.slice.call(g,B,M))},slice32$1=function(g,B,M){return g.slice?g.slice(B,M):new Uint32Array(Array.prototype.slice.call(g,B,M))},createTrieFromBase64$1=function(g,B){var M=decode$1(g),P=Array.isArray(M)?polyUint32Array$1(M):new Uint32Array(M),K=Array.isArray(M)?polyUint16Array$1(M):new Uint16Array(M),Y=24,re=slice16$1(K,Y/2,P[4]/2),D=P[5]===2?slice16$1(K,(Y+P[4])/2):slice32$1(P,Math.ceil((Y+P[4])/4));return new Trie$1(P[0],P[1],P[2],P[3],re,D)},Trie$1=function(){function g(B,M,P,K,Y,re){this.initialValue=B,this.errorValue=M,this.highStart=P,this.highValueIndex=K,this.index=Y,this.data=re}return g.prototype.get=function(B){var M;if(B>=0){if(B<55296||B>56319&&B<=65535)return M=this.index[B>>UTRIE2_SHIFT_2$1],M=(M<<UTRIE2_INDEX_SHIFT$1)+(B&UTRIE2_DATA_MASK$1),this.data[M];if(B<=65535)return M=this.index[UTRIE2_LSCP_INDEX_2_OFFSET$1+(B-55296>>UTRIE2_SHIFT_2$1)],M=(M<<UTRIE2_INDEX_SHIFT$1)+(B&UTRIE2_DATA_MASK$1),this.data[M];if(B<this.highStart)return M=UTRIE2_INDEX_1_OFFSET$1-UTRIE2_OMITTED_BMP_INDEX_1_LENGTH$1+(B>>UTRIE2_SHIFT_1$1),M=this.index[M],M+=B>>UTRIE2_SHIFT_2$1&UTRIE2_INDEX_2_MASK$1,M=this.index[M],M=(M<<UTRIE2_INDEX_SHIFT$1)+(B&UTRIE2_DATA_MASK$1),this.data[M];if(B<=1114111)return this.data[this.highValueIndex]}return this.errorValue},g}(),chars$3="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$3=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var i$3=0;i$3<chars$3.length;i$3++)lookup$3[chars$3.charCodeAt(i$3)]=i$3;var base64$1="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",LETTER_NUMBER_MODIFIER=50,BK=1,CR$1=2,LF$1=3,CM=4,NL=5,WJ=7,ZW=8,GL=9,SP=10,ZWJ$1=11,B2=12,BA=13,BB=14,HY=15,CB=16,CL=17,CP=18,EX=19,IN=20,NS=21,OP=22,QU=23,IS=24,NU=25,PO=26,PR=27,SY=28,AI=29,AL=30,CJ=31,EB=32,EM=33,H2=34,H3=35,HL=36,ID=37,JL=38,JV=39,JT=40,RI$1=41,SA=42,XX=43,ea_OP=[9001,65288],BREAK_MANDATORY="!",BREAK_NOT_ALLOWED$1="Ã",BREAK_ALLOWED$1="Ã·",UnicodeTrie$1=createTrieFromBase64$1(base64$1),ALPHABETICS=[AL,HL],HARD_LINE_BREAKS=[BK,CR$1,LF$1,NL],SPACE$1=[SP,ZW],PREFIX_POSTFIX=[PR,PO],LINE_BREAKS=HARD_LINE_BREAKS.concat(SPACE$1),KOREAN_SYLLABLE_BLOCK=[JL,JV,JT,H2,H3],HYPHEN=[HY,BA],codePointsToCharacterClasses=function(g,B){B===void 0&&(B="strict");var M=[],P=[],K=[];return g.forEach(function(Y,re){var D=UnicodeTrie$1.get(Y);if(D>LETTER_NUMBER_MODIFIER?(K.push(!0),D-=LETTER_NUMBER_MODIFIER):K.push(!1),["normal","auto","loose"].indexOf(B)!==-1&&[8208,8211,12316,12448].indexOf(Y)!==-1)return P.push(re),M.push(CB);if(D===CM||D===ZWJ$1){if(re===0)return P.push(re),M.push(AL);var ne=M[re-1];return LINE_BREAKS.indexOf(ne)===-1?(P.push(P[re-1]),M.push(ne)):(P.push(re),M.push(AL))}if(P.push(re),D===CJ)return M.push(B==="strict"?NS:ID);if(D===SA||D===AI)return M.push(AL);if(D===XX)return Y>=131072&&Y<=196605||Y>=196608&&Y<=262141?M.push(ID):M.push(AL);M.push(D)}),[P,M,K]},isAdjacentWithSpaceIgnored=function(g,B,M,P){var K=P[M];if(Array.isArray(g)?g.indexOf(K)!==-1:g===K)for(var Y=M;Y<=P.length;){Y++;var re=P[Y];if(re===B)return!0;if(re!==SP)break}if(K===SP)for(var Y=M;Y>0;){Y--;var D=P[Y];if(Array.isArray(g)?g.indexOf(D)!==-1:g===D)for(var ne=M;ne<=P.length;){ne++;var re=P[ne];if(re===B)return!0;if(re!==SP)break}if(D!==SP)break}return!1},previousNonSpaceClassType=function(g,B){for(var M=g;M>=0;){var P=B[M];if(P===SP)M--;else return P}return 0},_lineBreakAtIndex=function(g,B,M,P,K){if(M[P]===0)return BREAK_NOT_ALLOWED$1;var Y=P-1;if(Array.isArray(K)&&K[Y]===!0)return BREAK_NOT_ALLOWED$1;var re=Y-1,D=Y+1,ne=B[Y],ae=re>=0?B[re]:0,ue=B[D];if(ne===CR$1&&ue===LF$1)return BREAK_NOT_ALLOWED$1;if(HARD_LINE_BREAKS.indexOf(ne)!==-1)return BREAK_MANDATORY;if(HARD_LINE_BREAKS.indexOf(ue)!==-1||SPACE$1.indexOf(ue)!==-1)return BREAK_NOT_ALLOWED$1;if(previousNonSpaceClassType(Y,B)===ZW)return BREAK_ALLOWED$1;if(UnicodeTrie$1.get(g[Y])===ZWJ$1||(ne===EB||ne===EM)&&UnicodeTrie$1.get(g[D])===ZWJ$1||ne===WJ||ue===WJ||ne===GL||[SP,BA,HY].indexOf(ne)===-1&&ue===GL||[CL,CP,EX,IS,SY].indexOf(ue)!==-1||previousNonSpaceClassType(Y,B)===OP||isAdjacentWithSpaceIgnored(QU,OP,Y,B)||isAdjacentWithSpaceIgnored([CL,CP],NS,Y,B)||isAdjacentWithSpaceIgnored(B2,B2,Y,B))return BREAK_NOT_ALLOWED$1;if(ne===SP)return BREAK_ALLOWED$1;if(ne===QU||ue===QU)return BREAK_NOT_ALLOWED$1;if(ue===CB||ne===CB)return BREAK_ALLOWED$1;if([BA,HY,NS].indexOf(ue)!==-1||ne===BB||ae===HL&&HYPHEN.indexOf(ne)!==-1||ne===SY&&ue===HL||ue===IN||ALPHABETICS.indexOf(ue)!==-1&&ne===NU||ALPHABETICS.indexOf(ne)!==-1&&ue===NU||ne===PR&&[ID,EB,EM].indexOf(ue)!==-1||[ID,EB,EM].indexOf(ne)!==-1&&ue===PO||ALPHABETICS.indexOf(ne)!==-1&&PREFIX_POSTFIX.indexOf(ue)!==-1||PREFIX_POSTFIX.indexOf(ne)!==-1&&ALPHABETICS.indexOf(ue)!==-1||[PR,PO].indexOf(ne)!==-1&&(ue===NU||[OP,HY].indexOf(ue)!==-1&&B[D+1]===NU)||[OP,HY].indexOf(ne)!==-1&&ue===NU||ne===NU&&[NU,SY,IS].indexOf(ue)!==-1)return BREAK_NOT_ALLOWED$1;if([NU,SY,IS,CL,CP].indexOf(ue)!==-1)for(var ge=Y;ge>=0;){var Be=B[ge];if(Be===NU)return BREAK_NOT_ALLOWED$1;if([SY,IS].indexOf(Be)!==-1)ge--;else break}if([PR,PO].indexOf(ue)!==-1)for(var ge=[CL,CP].indexOf(ne)!==-1?re:Y;ge>=0;){var Be=B[ge];if(Be===NU)return BREAK_NOT_ALLOWED$1;if([SY,IS].indexOf(Be)!==-1)ge--;else break}if(JL===ne&&[JL,JV,H2,H3].indexOf(ue)!==-1||[JV,H2].indexOf(ne)!==-1&&[JV,JT].indexOf(ue)!==-1||[JT,H3].indexOf(ne)!==-1&&ue===JT||KOREAN_SYLLABLE_BLOCK.indexOf(ne)!==-1&&[IN,PO].indexOf(ue)!==-1||KOREAN_SYLLABLE_BLOCK.indexOf(ue)!==-1&&ne===PR||ALPHABETICS.indexOf(ne)!==-1&&ALPHABETICS.indexOf(ue)!==-1||ne===IS&&ALPHABETICS.indexOf(ue)!==-1||ALPHABETICS.concat(NU).indexOf(ne)!==-1&&ue===OP&&ea_OP.indexOf(g[D])===-1||ALPHABETICS.concat(NU).indexOf(ue)!==-1&&ne===CP)return BREAK_NOT_ALLOWED$1;if(ne===RI$1&&ue===RI$1){for(var De=M[Y],ze=1;De>0&&(De--,B[De]===RI$1);)ze++;if(ze%2!==0)return BREAK_NOT_ALLOWED$1}return ne===EB&&ue===EM?BREAK_NOT_ALLOWED$1:BREAK_ALLOWED$1},cssFormattedClasses=function(g,B){B||(B={lineBreak:"normal",wordBreak:"normal"});var M=codePointsToCharacterClasses(g,B.lineBreak),P=M[0],K=M[1],Y=M[2];(B.wordBreak==="break-all"||B.wordBreak==="break-word")&&(K=K.map(function(D){return[NU,AL,SA].indexOf(D)!==-1?ID:D}));var re=B.wordBreak==="keep-all"?Y.map(function(D,ne){return D&&g[ne]>=19968&&g[ne]<=40959}):void 0;return[P,K,re]},Break=function(){function g(B,M,P,K){this.codePoints=B,this.required=M===BREAK_MANDATORY,this.start=P,this.end=K}return g.prototype.slice=function(){return fromCodePoint$1.apply(void 0,this.codePoints.slice(this.start,this.end))},g}(),LineBreaker=function(g,B){var M=toCodePoints$1(g),P=cssFormattedClasses(M,B),K=P[0],Y=P[1],re=P[2],D=M.length,ne=0,ae=0;return{next:function(){if(ae>=D)return{done:!0,value:null};for(var ue=BREAK_NOT_ALLOWED$1;ae<D&&(ue=_lineBreakAtIndex(M,Y,K,++ae,re))===BREAK_NOT_ALLOWED$1;);if(ue!==BREAK_NOT_ALLOWED$1||ae===D){var ge=new Break(M,ue,ne,ae);return ne=ae,{value:ge,done:!1}}return{done:!0,value:null}}}},FLAG_UNRESTRICTED=1,FLAG_ID=2,FLAG_INTEGER=4,FLAG_NUMBER=8,LINE_FEED=10,SOLIDUS=47,REVERSE_SOLIDUS=92,CHARACTER_TABULATION=9,SPACE=32,QUOTATION_MARK=34,EQUALS_SIGN=61,NUMBER_SIGN=35,DOLLAR_SIGN=36,PERCENTAGE_SIGN=37,APOSTROPHE=39,LEFT_PARENTHESIS=40,RIGHT_PARENTHESIS=41,LOW_LINE=95,HYPHEN_MINUS=45,EXCLAMATION_MARK=33,LESS_THAN_SIGN=60,GREATER_THAN_SIGN=62,COMMERCIAL_AT=64,LEFT_SQUARE_BRACKET=91,RIGHT_SQUARE_BRACKET=93,CIRCUMFLEX_ACCENT=61,LEFT_CURLY_BRACKET=123,QUESTION_MARK=63,RIGHT_CURLY_BRACKET=125,VERTICAL_LINE=124,TILDE=126,CONTROL=128,REPLACEMENT_CHARACTER=65533,ASTERISK=42,PLUS_SIGN=43,COMMA=44,COLON=58,SEMICOLON=59,FULL_STOP=46,NULL=0,BACKSPACE=8,LINE_TABULATION=11,SHIFT_OUT=14,INFORMATION_SEPARATOR_ONE=31,DELETE=127,EOF=-1,ZERO=48,a$1=97,e$1=101,f$1=102,u$1=117,z=122,A=65,E=69,F=70,U=85,Z=90,isDigit=function(g){return g>=ZERO&&g<=57},isSurrogateCodePoint=function(g){return g>=55296&&g<=57343},isHex=function(g){return isDigit(g)||g>=A&&g<=F||g>=a$1&&g<=f$1},isLowerCaseLetter=function(g){return g>=a$1&&g<=z},isUpperCaseLetter=function(g){return g>=A&&g<=Z},isLetter=function(g){return isLowerCaseLetter(g)||isUpperCaseLetter(g)},isNonASCIICodePoint=function(g){return g>=CONTROL},isWhiteSpace=function(g){return g===LINE_FEED||g===CHARACTER_TABULATION||g===SPACE},isNameStartCodePoint=function(g){return isLetter(g)||isNonASCIICodePoint(g)||g===LOW_LINE},isNameCodePoint=function(g){return isNameStartCodePoint(g)||isDigit(g)||g===HYPHEN_MINUS},isNonPrintableCodePoint=function(g){return g>=NULL&&g<=BACKSPACE||g===LINE_TABULATION||g>=SHIFT_OUT&&g<=INFORMATION_SEPARATOR_ONE||g===DELETE},isValidEscape=function(g,B){return g!==REVERSE_SOLIDUS?!1:B!==LINE_FEED},isIdentifierStart=function(g,B,M){return g===HYPHEN_MINUS?isNameStartCodePoint(B)||isValidEscape(B,M):isNameStartCodePoint(g)?!0:!!(g===REVERSE_SOLIDUS&&isValidEscape(g,B))},isNumberStart=function(g,B,M){return g===PLUS_SIGN||g===HYPHEN_MINUS?isDigit(B)?!0:B===FULL_STOP&&isDigit(M):isDigit(g===FULL_STOP?B:g)},stringToNumber=function(g){var B=0,M=1;(g[B]===PLUS_SIGN||g[B]===HYPHEN_MINUS)&&(g[B]===HYPHEN_MINUS&&(M=-1),B++);for(var P=[];isDigit(g[B]);)P.push(g[B++]);var K=P.length?parseInt(fromCodePoint$1.apply(void 0,P),10):0;g[B]===FULL_STOP&&B++;for(var Y=[];isDigit(g[B]);)Y.push(g[B++]);var re=Y.length,D=re?parseInt(fromCodePoint$1.apply(void 0,Y),10):0;(g[B]===E||g[B]===e$1)&&B++;var ne=1;(g[B]===PLUS_SIGN||g[B]===HYPHEN_MINUS)&&(g[B]===HYPHEN_MINUS&&(ne=-1),B++);for(var ae=[];isDigit(g[B]);)ae.push(g[B++]);var ue=ae.length?parseInt(fromCodePoint$1.apply(void 0,ae),10):0;return M*(K+D*Math.pow(10,-re))*Math.pow(10,ne*ue)},LEFT_PARENTHESIS_TOKEN={type:2},RIGHT_PARENTHESIS_TOKEN={type:3},COMMA_TOKEN={type:4},SUFFIX_MATCH_TOKEN={type:13},PREFIX_MATCH_TOKEN={type:8},COLUMN_TOKEN={type:21},DASH_MATCH_TOKEN={type:9},INCLUDE_MATCH_TOKEN={type:10},LEFT_CURLY_BRACKET_TOKEN={type:11},RIGHT_CURLY_BRACKET_TOKEN={type:12},SUBSTRING_MATCH_TOKEN={type:14},BAD_URL_TOKEN={type:23},BAD_STRING_TOKEN={type:1},CDO_TOKEN={type:25},CDC_TOKEN={type:24},COLON_TOKEN={type:26},SEMICOLON_TOKEN={type:27},LEFT_SQUARE_BRACKET_TOKEN={type:28},RIGHT_SQUARE_BRACKET_TOKEN={type:29},WHITESPACE_TOKEN={type:31},EOF_TOKEN={type:32},Tokenizer=function(){function g(){this._value=[]}return g.prototype.write=function(B){this._value=this._value.concat(toCodePoints$1(B))},g.prototype.read=function(){for(var B=[],M=this.consumeToken();M!==EOF_TOKEN;)B.push(M),M=this.consumeToken();return B},g.prototype.consumeToken=function(){var B=this.consumeCodePoint();switch(B){case QUOTATION_MARK:return this.consumeStringToken(QUOTATION_MARK);case NUMBER_SIGN:var M=this.peekCodePoint(0),P=this.peekCodePoint(1),K=this.peekCodePoint(2);if(isNameCodePoint(M)||isValidEscape(P,K)){var Y=isIdentifierStart(M,P,K)?FLAG_ID:FLAG_UNRESTRICTED,re=this.consumeName();return{type:5,value:re,flags:Y}}break;case DOLLAR_SIGN:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),SUFFIX_MATCH_TOKEN;break;case APOSTROPHE:return this.consumeStringToken(APOSTROPHE);case LEFT_PARENTHESIS:return LEFT_PARENTHESIS_TOKEN;case RIGHT_PARENTHESIS:return RIGHT_PARENTHESIS_TOKEN;case ASTERISK:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),SUBSTRING_MATCH_TOKEN;break;case PLUS_SIGN:if(isNumberStart(B,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(B),this.consumeNumericToken();break;case COMMA:return COMMA_TOKEN;case HYPHEN_MINUS:var D=B,ne=this.peekCodePoint(0),ae=this.peekCodePoint(1);if(isNumberStart(D,ne,ae))return this.reconsumeCodePoint(B),this.consumeNumericToken();if(isIdentifierStart(D,ne,ae))return this.reconsumeCodePoint(B),this.consumeIdentLikeToken();if(ne===HYPHEN_MINUS&&ae===GREATER_THAN_SIGN)return this.consumeCodePoint(),this.consumeCodePoint(),CDC_TOKEN;break;case FULL_STOP:if(isNumberStart(B,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(B),this.consumeNumericToken();break;case SOLIDUS:if(this.peekCodePoint(0)===ASTERISK)for(this.consumeCodePoint();;){var ue=this.consumeCodePoint();if(ue===ASTERISK&&(ue=this.consumeCodePoint(),ue===SOLIDUS))return this.consumeToken();if(ue===EOF)return this.consumeToken()}break;case COLON:return COLON_TOKEN;case SEMICOLON:return SEMICOLON_TOKEN;case LESS_THAN_SIGN:if(this.peekCodePoint(0)===EXCLAMATION_MARK&&this.peekCodePoint(1)===HYPHEN_MINUS&&this.peekCodePoint(2)===HYPHEN_MINUS)return this.consumeCodePoint(),this.consumeCodePoint(),CDO_TOKEN;break;case COMMERCIAL_AT:var ge=this.peekCodePoint(0),Be=this.peekCodePoint(1),De=this.peekCodePoint(2);if(isIdentifierStart(ge,Be,De)){var re=this.consumeName();return{type:7,value:re}}break;case LEFT_SQUARE_BRACKET:return LEFT_SQUARE_BRACKET_TOKEN;case REVERSE_SOLIDUS:if(isValidEscape(B,this.peekCodePoint(0)))return this.reconsumeCodePoint(B),this.consumeIdentLikeToken();break;case RIGHT_SQUARE_BRACKET:return RIGHT_SQUARE_BRACKET_TOKEN;case CIRCUMFLEX_ACCENT:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),PREFIX_MATCH_TOKEN;break;case LEFT_CURLY_BRACKET:return LEFT_CURLY_BRACKET_TOKEN;case RIGHT_CURLY_BRACKET:return RIGHT_CURLY_BRACKET_TOKEN;case u$1:case U:var ze=this.peekCodePoint(0),Oe=this.peekCodePoint(1);return ze===PLUS_SIGN&&(isHex(Oe)||Oe===QUESTION_MARK)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(B),this.consumeIdentLikeToken();case VERTICAL_LINE:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),DASH_MATCH_TOKEN;if(this.peekCodePoint(0)===VERTICAL_LINE)return this.consumeCodePoint(),COLUMN_TOKEN;break;case TILDE:if(this.peekCodePoint(0)===EQUALS_SIGN)return this.consumeCodePoint(),INCLUDE_MATCH_TOKEN;break;case EOF:return EOF_TOKEN}return isWhiteSpace(B)?(this.consumeWhiteSpace(),WHITESPACE_TOKEN):isDigit(B)?(this.reconsumeCodePoint(B),this.consumeNumericToken()):isNameStartCodePoint(B)?(this.reconsumeCodePoint(B),this.consumeIdentLikeToken()):{type:6,value:fromCodePoint$1(B)}},g.prototype.consumeCodePoint=function(){var B=this._value.shift();return typeof B>"u"?-1:B},g.prototype.reconsumeCodePoint=function(B){this._value.unshift(B)},g.prototype.peekCodePoint=function(B){return B>=this._value.length?-1:this._value[B]},g.prototype.consumeUnicodeRangeToken=function(){for(var B=[],M=this.consumeCodePoint();isHex(M)&&B.length<6;)B.push(M),M=this.consumeCodePoint();for(var P=!1;M===QUESTION_MARK&&B.length<6;)B.push(M),M=this.consumeCodePoint(),P=!0;if(P){var K=parseInt(fromCodePoint$1.apply(void 0,B.map(function(ne){return ne===QUESTION_MARK?ZERO:ne})),16),Y=parseInt(fromCodePoint$1.apply(void 0,B.map(function(ne){return ne===QUESTION_MARK?F:ne})),16);return{type:30,start:K,end:Y}}var re=parseInt(fromCodePoint$1.apply(void 0,B),16);if(this.peekCodePoint(0)===HYPHEN_MINUS&&isHex(this.peekCodePoint(1))){this.consumeCodePoint(),M=this.consumeCodePoint();for(var D=[];isHex(M)&&D.length<6;)D.push(M),M=this.consumeCodePoint();var Y=parseInt(fromCodePoint$1.apply(void 0,D),16);return{type:30,start:re,end:Y}}else return{type:30,start:re,end:re}},g.prototype.consumeIdentLikeToken=function(){var B=this.consumeName();return B.toLowerCase()==="url"&&this.peekCodePoint(0)===LEFT_PARENTHESIS?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===LEFT_PARENTHESIS?(this.consumeCodePoint(),{type:19,value:B}):{type:20,value:B}},g.prototype.consumeUrlToken=function(){var B=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===EOF)return{type:22,value:""};var M=this.peekCodePoint(0);if(M===APOSTROPHE||M===QUOTATION_MARK){var P=this.consumeStringToken(this.consumeCodePoint());return P.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===EOF||this.peekCodePoint(0)===RIGHT_PARENTHESIS)?(this.consumeCodePoint(),{type:22,value:P.value}):(this.consumeBadUrlRemnants(),BAD_URL_TOKEN)}for(;;){var K=this.consumeCodePoint();if(K===EOF||K===RIGHT_PARENTHESIS)return{type:22,value:fromCodePoint$1.apply(void 0,B)};if(isWhiteSpace(K))return this.consumeWhiteSpace(),this.peekCodePoint(0)===EOF||this.peekCodePoint(0)===RIGHT_PARENTHESIS?(this.consumeCodePoint(),{type:22,value:fromCodePoint$1.apply(void 0,B)}):(this.consumeBadUrlRemnants(),BAD_URL_TOKEN);if(K===QUOTATION_MARK||K===APOSTROPHE||K===LEFT_PARENTHESIS||isNonPrintableCodePoint(K))return this.consumeBadUrlRemnants(),BAD_URL_TOKEN;if(K===REVERSE_SOLIDUS)if(isValidEscape(K,this.peekCodePoint(0)))B.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),BAD_URL_TOKEN;else B.push(K)}},g.prototype.consumeWhiteSpace=function(){for(;isWhiteSpace(this.peekCodePoint(0));)this.consumeCodePoint()},g.prototype.consumeBadUrlRemnants=function(){for(;;){var B=this.consumeCodePoint();if(B===RIGHT_PARENTHESIS||B===EOF)return;isValidEscape(B,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},g.prototype.consumeStringSlice=function(B){for(var M=5e4,P="";B>0;){var K=Math.min(M,B);P+=fromCodePoint$1.apply(void 0,this._value.splice(0,K)),B-=K}return this._value.shift(),P},g.prototype.consumeStringToken=function(B){var M="",P=0;do{var K=this._value[P];if(K===EOF||K===void 0||K===B)return M+=this.consumeStringSlice(P),{type:0,value:M};if(K===LINE_FEED)return this._value.splice(0,P),BAD_STRING_TOKEN;if(K===REVERSE_SOLIDUS){var Y=this._value[P+1];Y!==EOF&&Y!==void 0&&(Y===LINE_FEED?(M+=this.consumeStringSlice(P),P=-1,this._value.shift()):isValidEscape(K,Y)&&(M+=this.consumeStringSlice(P),M+=fromCodePoint$1(this.consumeEscapedCodePoint()),P=-1))}P++}while(!0)},g.prototype.consumeNumber=function(){var B=[],M=FLAG_INTEGER,P=this.peekCodePoint(0);for((P===PLUS_SIGN||P===HYPHEN_MINUS)&&B.push(this.consumeCodePoint());isDigit(this.peekCodePoint(0));)B.push(this.consumeCodePoint());P=this.peekCodePoint(0);var K=this.peekCodePoint(1);if(P===FULL_STOP&&isDigit(K))for(B.push(this.consumeCodePoint(),this.consumeCodePoint()),M=FLAG_NUMBER;isDigit(this.peekCodePoint(0));)B.push(this.consumeCodePoint());P=this.peekCodePoint(0),K=this.peekCodePoint(1);var Y=this.peekCodePoint(2);if((P===E||P===e$1)&&((K===PLUS_SIGN||K===HYPHEN_MINUS)&&isDigit(Y)||isDigit(K)))for(B.push(this.consumeCodePoint(),this.consumeCodePoint()),M=FLAG_NUMBER;isDigit(this.peekCodePoint(0));)B.push(this.consumeCodePoint());return[stringToNumber(B),M]},g.prototype.consumeNumericToken=function(){var B=this.consumeNumber(),M=B[0],P=B[1],K=this.peekCodePoint(0),Y=this.peekCodePoint(1),re=this.peekCodePoint(2);if(isIdentifierStart(K,Y,re)){var D=this.consumeName();return{type:15,number:M,flags:P,unit:D}}return K===PERCENTAGE_SIGN?(this.consumeCodePoint(),{type:16,number:M,flags:P}):{type:17,number:M,flags:P}},g.prototype.consumeEscapedCodePoint=function(){var B=this.consumeCodePoint();if(isHex(B)){for(var M=fromCodePoint$1(B);isHex(this.peekCodePoint(0))&&M.length<6;)M+=fromCodePoint$1(this.consumeCodePoint());isWhiteSpace(this.peekCodePoint(0))&&this.consumeCodePoint();var P=parseInt(M,16);return P===0||isSurrogateCodePoint(P)||P>1114111?REPLACEMENT_CHARACTER:P}return B===EOF?REPLACEMENT_CHARACTER:B},g.prototype.consumeName=function(){for(var B="";;){var M=this.consumeCodePoint();if(isNameCodePoint(M))B+=fromCodePoint$1(M);else if(isValidEscape(M,this.peekCodePoint(0)))B+=fromCodePoint$1(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(M),B}},g}(),Parser$1=function(){function g(B){this._tokens=B}return g.create=function(B){var M=new Tokenizer;return M.write(B),new g(M.read())},g.parseValue=function(B){return g.create(B).parseComponentValue()},g.parseValues=function(B){return g.create(B).parseComponentValues()},g.prototype.parseComponentValue=function(){for(var B=this.consumeToken();B.type===31;)B=this.consumeToken();if(B.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(B);var M=this.consumeComponentValue();do B=this.consumeToken();while(B.type===31);if(B.type===32)return M;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},g.prototype.parseComponentValues=function(){for(var B=[];;){var M=this.consumeComponentValue();if(M.type===32)return B;B.push(M),B.push()}},g.prototype.consumeComponentValue=function(){var B=this.consumeToken();switch(B.type){case 11:case 28:case 2:return this.consumeSimpleBlock(B.type);case 19:return this.consumeFunction(B)}return B},g.prototype.consumeSimpleBlock=function(B){for(var M={type:B,values:[]},P=this.consumeToken();;){if(P.type===32||isEndingTokenFor(P,B))return M;this.reconsumeToken(P),M.values.push(this.consumeComponentValue()),P=this.consumeToken()}},g.prototype.consumeFunction=function(B){for(var M={name:B.value,values:[],type:18};;){var P=this.consumeToken();if(P.type===32||P.type===3)return M;this.reconsumeToken(P),M.values.push(this.consumeComponentValue())}},g.prototype.consumeToken=function(){var B=this._tokens.shift();return typeof B>"u"?EOF_TOKEN:B},g.prototype.reconsumeToken=function(B){this._tokens.unshift(B)},g}(),isDimensionToken=function(g){return g.type===15},isNumberToken=function(g){return g.type===17},isIdentToken=function(g){return g.type===20},isStringToken=function(g){return g.type===0},isIdentWithValue=function(g,B){return isIdentToken(g)&&g.value===B},nonWhiteSpace=function(g){return g.type!==31},nonFunctionArgSeparator=function(g){return g.type!==31&&g.type!==4},parseFunctionArgs=function(g){var B=[],M=[];return g.forEach(function(P){if(P.type===4){if(M.length===0)throw new Error("Error parsing function args, zero tokens for arg");B.push(M),M=[];return}P.type!==31&&M.push(P)}),M.length&&B.push(M),B},isEndingTokenFor=function(g,B){return B===11&&g.type===12||B===28&&g.type===29?!0:B===2&&g.type===3},isLength=function(g){return g.type===17||g.type===15},isLengthPercentage=function(g){return g.type===16||isLength(g)},parseLengthPercentageTuple=function(g){return g.length>1?[g[0],g[1]]:[g[0]]},ZERO_LENGTH={type:17,number:0,flags:FLAG_INTEGER},FIFTY_PERCENT={type:16,number:50,flags:FLAG_INTEGER},HUNDRED_PERCENT={type:16,number:100,flags:FLAG_INTEGER},getAbsoluteValueForTuple=function(g,B,M){var P=g[0],K=g[1];return[getAbsoluteValue(P,B),getAbsoluteValue(typeof K<"u"?K:P,M)]},getAbsoluteValue=function(g,B){if(g.type===16)return g.number/100*B;if(isDimensionToken(g))switch(g.unit){case"rem":case"em":return 16*g.number;case"px":default:return g.number}return g.number},DEG="deg",GRAD="grad",RAD="rad",TURN="turn",angle={name:"angle",parse:function(g,B){if(B.type===15)switch(B.unit){case DEG:return Math.PI*B.number/180;case GRAD:return Math.PI/200*B.number;case RAD:return B.number;case TURN:return Math.PI*2*B.number}throw new Error("Unsupported angle type")}},isAngle=function(g){return g.type===15&&(g.unit===DEG||g.unit===GRAD||g.unit===RAD||g.unit===TURN)},parseNamedSide=function(g){var B=g.filter(isIdentToken).map(function(M){return M.value}).join(" ");switch(B){case"to bottom right":case"to right bottom":case"left top":case"top left":return[ZERO_LENGTH,ZERO_LENGTH];case"to top":case"bottom":return deg(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[ZERO_LENGTH,HUNDRED_PERCENT];case"to right":case"left":return deg(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[HUNDRED_PERCENT,HUNDRED_PERCENT];case"to bottom":case"top":return deg(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[HUNDRED_PERCENT,ZERO_LENGTH];case"to left":case"right":return deg(270)}return 0},deg=function(g){return Math.PI*g/180},color$1={name:"color",parse:function(g,B){if(B.type===18){var M=SUPPORTED_COLOR_FUNCTIONS[B.name];if(typeof M>"u")throw new Error('Attempting to parse an unsupported color function "'+B.name+'"');return M(g,B.values)}if(B.type===5){if(B.value.length===3){var P=B.value.substring(0,1),K=B.value.substring(1,2),Y=B.value.substring(2,3);return pack(parseInt(P+P,16),parseInt(K+K,16),parseInt(Y+Y,16),1)}if(B.value.length===4){var P=B.value.substring(0,1),K=B.value.substring(1,2),Y=B.value.substring(2,3),re=B.value.substring(3,4);return pack(parseInt(P+P,16),parseInt(K+K,16),parseInt(Y+Y,16),parseInt(re+re,16)/255)}if(B.value.length===6){var P=B.value.substring(0,2),K=B.value.substring(2,4),Y=B.value.substring(4,6);return pack(parseInt(P,16),parseInt(K,16),parseInt(Y,16),1)}if(B.value.length===8){var P=B.value.substring(0,2),K=B.value.substring(2,4),Y=B.value.substring(4,6),re=B.value.substring(6,8);return pack(parseInt(P,16),parseInt(K,16),parseInt(Y,16),parseInt(re,16)/255)}}if(B.type===20){var D=COLORS[B.value.toUpperCase()];if(typeof D<"u")return D}return COLORS.TRANSPARENT}},isTransparent=function(g){return(255&g)===0},asString=function(g){var B=255&g,M=255&g>>8,P=255&g>>16,K=255&g>>24;return B<255?"rgba("+K+","+P+","+M+","+B/255+")":"rgb("+K+","+P+","+M+")"},pack=function(g,B,M,P){return(g<<24|B<<16|M<<8|Math.round(P*255)<<0)>>>0},getTokenColorValue=function(g,B){if(g.type===17)return g.number;if(g.type===16){var M=B===3?1:255;return B===3?g.number/100*M:Math.round(g.number/100*M)}return 0},rgb=function(g,B){var M=B.filter(nonFunctionArgSeparator);if(M.length===3){var P=M.map(getTokenColorValue),K=P[0],Y=P[1],re=P[2];return pack(K,Y,re,1)}if(M.length===4){var D=M.map(getTokenColorValue),K=D[0],Y=D[1],re=D[2],ne=D[3];return pack(K,Y,re,ne)}return 0};function hue2rgb(g,B,M){return M<0&&(M+=1),M>=1&&(M-=1),M<1/6?(B-g)*M*6+g:M<1/2?B:M<2/3?(B-g)*6*(2/3-M)+g:g}var hsl=function(g,B){var M=B.filter(nonFunctionArgSeparator),P=M[0],K=M[1],Y=M[2],re=M[3],D=(P.type===17?deg(P.number):angle.parse(g,P))/(Math.PI*2),ne=isLengthPercentage(K)?K.number/100:0,ae=isLengthPercentage(Y)?Y.number/100:0,ue=typeof re<"u"&&isLengthPercentage(re)?getAbsoluteValue(re,1):1;if(ne===0)return pack(ae*255,ae*255,ae*255,1);var ge=ae<=.5?ae*(ne+1):ae+ne-ae*ne,Be=ae*2-ge,De=hue2rgb(Be,ge,D+1/3),ze=hue2rgb(Be,ge,D),Oe=hue2rgb(Be,ge,D-1/3);return pack(De*255,ze*255,Oe*255,ue)},SUPPORTED_COLOR_FUNCTIONS={hsl,hsla:hsl,rgb,rgba:rgb},parseColor=function(g,B){return color$1.parse(g,Parser$1.create(B).parseComponentValue())},COLORS={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},backgroundClip={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(g,B){return B.map(function(M){if(isIdentToken(M))switch(M.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},backgroundColor={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},parseColorStop=function(g,B){var M=color$1.parse(g,B[0]),P=B[1];return P&&isLengthPercentage(P)?{color:M,stop:P}:{color:M,stop:null}},processColorStops=function(g,B){var M=g[0],P=g[g.length-1];M.stop===null&&(M.stop=ZERO_LENGTH),P.stop===null&&(P.stop=HUNDRED_PERCENT);for(var K=[],Y=0,re=0;re<g.length;re++){var D=g[re].stop;if(D!==null){var ne=getAbsoluteValue(D,B);ne>Y?K.push(ne):K.push(Y),Y=ne}else K.push(null)}for(var ae=null,re=0;re<K.length;re++){var ue=K[re];if(ue===null)ae===null&&(ae=re);else if(ae!==null){for(var ge=re-ae,Be=K[ae-1],De=(ue-Be)/(ge+1),ze=1;ze<=ge;ze++)K[ae+ze-1]=De*ze;ae=null}}return g.map(function(Oe,Je){var We=Oe.color;return{color:We,stop:Math.max(Math.min(1,K[Je]/B),0)}})},getAngleFromCorner=function(g,B,M){var P=B/2,K=M/2,Y=getAbsoluteValue(g[0],B)-P,re=K-getAbsoluteValue(g[1],M);return(Math.atan2(re,Y)+Math.PI*2)%(Math.PI*2)},calculateGradientDirection=function(g,B,M){var P=typeof g=="number"?g:getAngleFromCorner(g,B,M),K=Math.abs(B*Math.sin(P))+Math.abs(M*Math.cos(P)),Y=B/2,re=M/2,D=K/2,ne=Math.sin(P-Math.PI/2)*D,ae=Math.cos(P-Math.PI/2)*D;return[K,Y-ae,Y+ae,re-ne,re+ne]},distance=function(g,B){return Math.sqrt(g*g+B*B)},findCorner=function(g,B,M,P,K){var Y=[[0,0],[0,B],[g,0],[g,B]];return Y.reduce(function(re,D){var ne=D[0],ae=D[1],ue=distance(M-ne,P-ae);return(K?ue<re.optimumDistance:ue>re.optimumDistance)?{optimumCorner:D,optimumDistance:ue}:re},{optimumDistance:K?1/0:-1/0,optimumCorner:null}).optimumCorner},calculateRadius=function(g,B,M,P,K){var Y=0,re=0;switch(g.size){case 0:g.shape===0?Y=re=Math.min(Math.abs(B),Math.abs(B-P),Math.abs(M),Math.abs(M-K)):g.shape===1&&(Y=Math.min(Math.abs(B),Math.abs(B-P)),re=Math.min(Math.abs(M),Math.abs(M-K)));break;case 2:if(g.shape===0)Y=re=Math.min(distance(B,M),distance(B,M-K),distance(B-P,M),distance(B-P,M-K));else if(g.shape===1){var D=Math.min(Math.abs(M),Math.abs(M-K))/Math.min(Math.abs(B),Math.abs(B-P)),ne=findCorner(P,K,B,M,!0),ae=ne[0],ue=ne[1];Y=distance(ae-B,(ue-M)/D),re=D*Y}break;case 1:g.shape===0?Y=re=Math.max(Math.abs(B),Math.abs(B-P),Math.abs(M),Math.abs(M-K)):g.shape===1&&(Y=Math.max(Math.abs(B),Math.abs(B-P)),re=Math.max(Math.abs(M),Math.abs(M-K)));break;case 3:if(g.shape===0)Y=re=Math.max(distance(B,M),distance(B,M-K),distance(B-P,M),distance(B-P,M-K));else if(g.shape===1){var D=Math.max(Math.abs(M),Math.abs(M-K))/Math.max(Math.abs(B),Math.abs(B-P)),ge=findCorner(P,K,B,M,!1),ae=ge[0],ue=ge[1];Y=distance(ae-B,(ue-M)/D),re=D*Y}break}return Array.isArray(g.size)&&(Y=getAbsoluteValue(g.size[0],P),re=g.size.length===2?getAbsoluteValue(g.size[1],K):Y),[Y,re]},linearGradient=function(g,B){var M=deg(180),P=[];return parseFunctionArgs(B).forEach(function(K,Y){if(Y===0){var re=K[0];if(re.type===20&&re.value==="to"){M=parseNamedSide(K);return}else if(isAngle(re)){M=angle.parse(g,re);return}}var D=parseColorStop(g,K);P.push(D)}),{angle:M,stops:P,type:1}},prefixLinearGradient=function(g,B){var M=deg(180),P=[];return parseFunctionArgs(B).forEach(function(K,Y){if(Y===0){var re=K[0];if(re.type===20&&["top","left","right","bottom"].indexOf(re.value)!==-1){M=parseNamedSide(K);return}else if(isAngle(re)){M=(angle.parse(g,re)+deg(270))%deg(360);return}}var D=parseColorStop(g,K);P.push(D)}),{angle:M,stops:P,type:1}},webkitGradient=function(g,B){var M=deg(180),P=[],K=1,Y=0,re=3,D=[];return parseFunctionArgs(B).forEach(function(ne,ae){var ue=ne[0];if(ae===0){if(isIdentToken(ue)&&ue.value==="linear"){K=1;return}else if(isIdentToken(ue)&&ue.value==="radial"){K=2;return}}if(ue.type===18){if(ue.name==="from"){var ge=color$1.parse(g,ue.values[0]);P.push({stop:ZERO_LENGTH,color:ge})}else if(ue.name==="to"){var ge=color$1.parse(g,ue.values[0]);P.push({stop:HUNDRED_PERCENT,color:ge})}else if(ue.name==="color-stop"){var Be=ue.values.filter(nonFunctionArgSeparator);if(Be.length===2){var ge=color$1.parse(g,Be[1]),De=Be[0];isNumberToken(De)&&P.push({stop:{type:16,number:De.number*100,flags:De.flags},color:ge})}}}}),K===1?{angle:(M+deg(180))%deg(360),stops:P,type:K}:{size:re,shape:Y,stops:P,position:D,type:K}},CLOSEST_SIDE="closest-side",FARTHEST_SIDE="farthest-side",CLOSEST_CORNER="closest-corner",FARTHEST_CORNER="farthest-corner",CIRCLE="circle",ELLIPSE="ellipse",COVER="cover",CONTAIN="contain",radialGradient=function(g,B){var M=0,P=3,K=[],Y=[];return parseFunctionArgs(B).forEach(function(re,D){var ne=!0;if(D===0){var ae=!1;ne=re.reduce(function(ge,Be){if(ae)if(isIdentToken(Be))switch(Be.value){case"center":return Y.push(FIFTY_PERCENT),ge;case"top":case"left":return Y.push(ZERO_LENGTH),ge;case"right":case"bottom":return Y.push(HUNDRED_PERCENT),ge}else(isLengthPercentage(Be)||isLength(Be))&&Y.push(Be);else if(isIdentToken(Be))switch(Be.value){case CIRCLE:return M=0,!1;case ELLIPSE:return M=1,!1;case"at":return ae=!0,!1;case CLOSEST_SIDE:return P=0,!1;case COVER:case FARTHEST_SIDE:return P=1,!1;case CONTAIN:case CLOSEST_CORNER:return P=2,!1;case FARTHEST_CORNER:return P=3,!1}else if(isLength(Be)||isLengthPercentage(Be))return Array.isArray(P)||(P=[]),P.push(Be),!1;return ge},ne)}if(ne){var ue=parseColorStop(g,re);K.push(ue)}}),{size:P,shape:M,stops:K,position:Y,type:2}},prefixRadialGradient=function(g,B){var M=0,P=3,K=[],Y=[];return parseFunctionArgs(B).forEach(function(re,D){var ne=!0;if(D===0?ne=re.reduce(function(ue,ge){if(isIdentToken(ge))switch(ge.value){case"center":return Y.push(FIFTY_PERCENT),!1;case"top":case"left":return Y.push(ZERO_LENGTH),!1;case"right":case"bottom":return Y.push(HUNDRED_PERCENT),!1}else if(isLengthPercentage(ge)||isLength(ge))return Y.push(ge),!1;return ue},ne):D===1&&(ne=re.reduce(function(ue,ge){if(isIdentToken(ge))switch(ge.value){case CIRCLE:return M=0,!1;case ELLIPSE:return M=1,!1;case CONTAIN:case CLOSEST_SIDE:return P=0,!1;case FARTHEST_SIDE:return P=1,!1;case CLOSEST_CORNER:return P=2,!1;case COVER:case FARTHEST_CORNER:return P=3,!1}else if(isLength(ge)||isLengthPercentage(ge))return Array.isArray(P)||(P=[]),P.push(ge),!1;return ue},ne)),ne){var ae=parseColorStop(g,re);K.push(ae)}}),{size:P,shape:M,stops:K,position:Y,type:2}},isLinearGradient=function(g){return g.type===1},isRadialGradient=function(g){return g.type===2},image={name:"image",parse:function(g,B){if(B.type===22){var M={url:B.value,type:0};return g.cache.addImage(B.value),M}if(B.type===18){var P=SUPPORTED_IMAGE_FUNCTIONS[B.name];if(typeof P>"u")throw new Error('Attempting to parse an unsupported image function "'+B.name+'"');return P(g,B.values)}throw new Error("Unsupported image type "+B.type)}};function isSupportedImage(g){return!(g.type===20&&g.value==="none")&&(g.type!==18||!!SUPPORTED_IMAGE_FUNCTIONS[g.name])}var SUPPORTED_IMAGE_FUNCTIONS={"linear-gradient":linearGradient,"-moz-linear-gradient":prefixLinearGradient,"-ms-linear-gradient":prefixLinearGradient,"-o-linear-gradient":prefixLinearGradient,"-webkit-linear-gradient":prefixLinearGradient,"radial-gradient":radialGradient,"-moz-radial-gradient":prefixRadialGradient,"-ms-radial-gradient":prefixRadialGradient,"-o-radial-gradient":prefixRadialGradient,"-webkit-radial-gradient":prefixRadialGradient,"-webkit-gradient":webkitGradient},backgroundImage={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(g,B){if(B.length===0)return[];var M=B[0];return M.type===20&&M.value==="none"?[]:B.filter(function(P){return nonFunctionArgSeparator(P)&&isSupportedImage(P)}).map(function(P){return image.parse(g,P)})}},backgroundOrigin={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(g,B){return B.map(function(M){if(isIdentToken(M))switch(M.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},backgroundPosition={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(g,B){return parseFunctionArgs(B).map(function(M){return M.filter(isLengthPercentage)}).map(parseLengthPercentageTuple)}},backgroundRepeat={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(g,B){return parseFunctionArgs(B).map(function(M){return M.filter(isIdentToken).map(function(P){return P.value}).join(" ")}).map(parseBackgroundRepeat)}},parseBackgroundRepeat=function(g){switch(g){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},BACKGROUND_SIZE;(function(g){g.AUTO="auto",g.CONTAIN="contain",g.COVER="cover"})(BACKGROUND_SIZE||(BACKGROUND_SIZE={}));var backgroundSize={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(g,B){return parseFunctionArgs(B).map(function(M){return M.filter(isBackgroundSizeInfoToken)})}},isBackgroundSizeInfoToken=function(g){return isIdentToken(g)||isLengthPercentage(g)},borderColorForSide=function(g){return{name:"border-"+g+"-color",initialValue:"transparent",prefix:!1,type:3,format:"color"}},borderTopColor=borderColorForSide("top"),borderRightColor=borderColorForSide("right"),borderBottomColor=borderColorForSide("bottom"),borderLeftColor=borderColorForSide("left"),borderRadiusForSide=function(g){return{name:"border-radius-"+g,initialValue:"0 0",prefix:!1,type:1,parse:function(B,M){return parseLengthPercentageTuple(M.filter(isLengthPercentage))}}},borderTopLeftRadius=borderRadiusForSide("top-left"),borderTopRightRadius=borderRadiusForSide("top-right"),borderBottomRightRadius=borderRadiusForSide("bottom-right"),borderBottomLeftRadius=borderRadiusForSide("bottom-left"),borderStyleForSide=function(g){return{name:"border-"+g+"-style",initialValue:"solid",prefix:!1,type:2,parse:function(B,M){switch(M){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},borderTopStyle=borderStyleForSide("top"),borderRightStyle=borderStyleForSide("right"),borderBottomStyle=borderStyleForSide("bottom"),borderLeftStyle=borderStyleForSide("left"),borderWidthForSide=function(g){return{name:"border-"+g+"-width",initialValue:"0",type:0,prefix:!1,parse:function(B,M){return isDimensionToken(M)?M.number:0}}},borderTopWidth=borderWidthForSide("top"),borderRightWidth=borderWidthForSide("right"),borderBottomWidth=borderWidthForSide("bottom"),borderLeftWidth=borderWidthForSide("left"),color={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},direction={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(g,B){switch(B){case"rtl":return 1;case"ltr":default:return 0}}},display={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(g,B){return B.filter(isIdentToken).reduce(function(M,P){return M|parseDisplayValue(P.value)},0)}},parseDisplayValue=function(g){switch(g){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},float={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(g,B){switch(B){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},letterSpacing={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(g,B){return B.type===20&&B.value==="normal"?0:B.type===17||B.type===15?B.number:0}},LINE_BREAK;(function(g){g.NORMAL="normal",g.STRICT="strict"})(LINE_BREAK||(LINE_BREAK={}));var lineBreak={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(g,B){switch(B){case"strict":return LINE_BREAK.STRICT;case"normal":default:return LINE_BREAK.NORMAL}}},lineHeight={name:"line-height",initialValue:"normal",prefix:!1,type:4},computeLineHeight=function(g,B){return isIdentToken(g)&&g.value==="normal"?1.2*B:g.type===17?B*g.number:isLengthPercentage(g)?getAbsoluteValue(g,B):B},listStyleImage={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(g,B){return B.type===20&&B.value==="none"?null:image.parse(g,B)}},listStylePosition={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(g,B){switch(B){case"inside":return 0;case"outside":default:return 1}}},listStyleType={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(g,B){switch(B){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},marginForSide=function(g){return{name:"margin-"+g,initialValue:"0",prefix:!1,type:4}},marginTop=marginForSide("top"),marginRight=marginForSide("right"),marginBottom=marginForSide("bottom"),marginLeft=marginForSide("left"),overflow={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(g,B){return B.filter(isIdentToken).map(function(M){switch(M.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},overflowWrap={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(g,B){switch(B){case"break-word":return"break-word";case"normal":default:return"normal"}}},paddingForSide=function(g){return{name:"padding-"+g,initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},paddingTop=paddingForSide("top"),paddingRight=paddingForSide("right"),paddingBottom=paddingForSide("bottom"),paddingLeft=paddingForSide("left"),textAlign={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(g,B){switch(B){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},position={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(g,B){switch(B){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},textShadow={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(g,B){return B.length===1&&isIdentWithValue(B[0],"none")?[]:parseFunctionArgs(B).map(function(M){for(var P={color:COLORS.TRANSPARENT,offsetX:ZERO_LENGTH,offsetY:ZERO_LENGTH,blur:ZERO_LENGTH},K=0,Y=0;Y<M.length;Y++){var re=M[Y];isLength(re)?(K===0?P.offsetX=re:K===1?P.offsetY=re:P.blur=re,K++):P.color=color$1.parse(g,re)}return P})}},textTransform={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(g,B){switch(B){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},transform$1={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(g,B){if(B.type===20&&B.value==="none")return null;if(B.type===18){var M=SUPPORTED_TRANSFORM_FUNCTIONS[B.name];if(typeof M>"u")throw new Error('Attempting to parse an unsupported transform function "'+B.name+'"');return M(B.values)}return null}},matrix=function(g){var B=g.filter(function(M){return M.type===17}).map(function(M){return M.number});return B.length===6?B:null},matrix3d=function(g){var B=g.filter(function(ne){return ne.type===17}).map(function(ne){return ne.number}),M=B[0],P=B[1];B[2],B[3];var K=B[4],Y=B[5];B[6],B[7],B[8],B[9],B[10],B[11];var re=B[12],D=B[13];return B[14],B[15],B.length===16?[M,P,K,Y,re,D]:null},SUPPORTED_TRANSFORM_FUNCTIONS={matrix,matrix3d},DEFAULT_VALUE={type:16,number:50,flags:FLAG_INTEGER},DEFAULT=[DEFAULT_VALUE,DEFAULT_VALUE],transformOrigin={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(g,B){var M=B.filter(isLengthPercentage);return M.length!==2?DEFAULT:[M[0],M[1]]}},visibility={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(g,B){switch(B){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},WORD_BREAK;(function(g){g.NORMAL="normal",g.BREAK_ALL="break-all",g.KEEP_ALL="keep-all"})(WORD_BREAK||(WORD_BREAK={}));var wordBreak={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(g,B){switch(B){case"break-all":return WORD_BREAK.BREAK_ALL;case"keep-all":return WORD_BREAK.KEEP_ALL;case"normal":default:return WORD_BREAK.NORMAL}}},zIndex={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(g,B){if(B.type===20)return{auto:!0,order:0};if(isNumberToken(B))return{auto:!1,order:B.number};throw new Error("Invalid z-index number parsed")}},time={name:"time",parse:function(g,B){if(B.type===15)switch(B.unit.toLowerCase()){case"s":return 1e3*B.number;case"ms":return B.number}throw new Error("Unsupported time type")}},opacity={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(g,B){return isNumberToken(B)?B.number:1}},textDecorationColor={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},textDecorationLine={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(g,B){return B.filter(isIdentToken).map(function(M){switch(M.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(M){return M!==0})}},fontFamily={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(g,B){var M=[],P=[];return B.forEach(function(K){switch(K.type){case 20:case 0:M.push(K.value);break;case 17:M.push(K.number.toString());break;case 4:P.push(M.join(" ")),M.length=0;break}}),M.length&&P.push(M.join(" ")),P.map(function(K){return K.indexOf(" ")===-1?K:"'"+K+"'"})}},fontSize={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},fontWeight={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(g,B){if(isNumberToken(B))return B.number;if(isIdentToken(B))switch(B.value){case"bold":return 700;case"normal":default:return 400}return 400}},fontVariant={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(g,B){return B.filter(isIdentToken).map(function(M){return M.value})}},fontStyle={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(g,B){switch(B){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},contains=function(g,B){return(g&B)!==0},content={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(g,B){if(B.length===0)return[];var M=B[0];return M.type===20&&M.value==="none"?[]:B}},counterIncrement={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(g,B){if(B.length===0)return null;var M=B[0];if(M.type===20&&M.value==="none")return null;for(var P=[],K=B.filter(nonWhiteSpace),Y=0;Y<K.length;Y++){var re=K[Y],D=K[Y+1];if(re.type===20){var ne=D&&isNumberToken(D)?D.number:1;P.push({counter:re.value,increment:ne})}}return P}},counterReset={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(g,B){if(B.length===0)return[];for(var M=[],P=B.filter(nonWhiteSpace),K=0;K<P.length;K++){var Y=P[K],re=P[K+1];if(isIdentToken(Y)&&Y.value!=="none"){var D=re&&isNumberToken(re)?re.number:0;M.push({counter:Y.value,reset:D})}}return M}},duration={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(g,B){return B.filter(isDimensionToken).map(function(M){return time.parse(g,M)})}},quotes={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(g,B){if(B.length===0)return null;var M=B[0];if(M.type===20&&M.value==="none")return null;var P=[],K=B.filter(isStringToken);if(K.length%2!==0)return null;for(var Y=0;Y<K.length;Y+=2){var re=K[Y].value,D=K[Y+1].value;P.push({open:re,close:D})}return P}},getQuote=function(g,B,M){if(!g)return"";var P=g[Math.min(B,g.length-1)];return P?M?P.open:P.close:""},boxShadow={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(g,B){return B.length===1&&isIdentWithValue(B[0],"none")?[]:parseFunctionArgs(B).map(function(M){for(var P={color:255,offsetX:ZERO_LENGTH,offsetY:ZERO_LENGTH,blur:ZERO_LENGTH,spread:ZERO_LENGTH,inset:!1},K=0,Y=0;Y<M.length;Y++){var re=M[Y];isIdentWithValue(re,"inset")?P.inset=!0:isLength(re)?(K===0?P.offsetX=re:K===1?P.offsetY=re:K===2?P.blur=re:P.spread=re,K++):P.color=color$1.parse(g,re)}return P})}},paintOrder={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(g,B){var M=[0,1,2],P=[];return B.filter(isIdentToken).forEach(function(K){switch(K.value){case"stroke":P.push(1);break;case"fill":P.push(0);break;case"markers":P.push(2);break}}),M.forEach(function(K){P.indexOf(K)===-1&&P.push(K)}),P}},webkitTextStrokeColor={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},webkitTextStrokeWidth={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(g,B){return isDimensionToken(B)?B.number:0}},CSSParsedDeclaration=function(){function g(B,M){var P,K;this.animationDuration=parse(B,duration,M.animationDuration),this.backgroundClip=parse(B,backgroundClip,M.backgroundClip),this.backgroundColor=parse(B,backgroundColor,M.backgroundColor),this.backgroundImage=parse(B,backgroundImage,M.backgroundImage),this.backgroundOrigin=parse(B,backgroundOrigin,M.backgroundOrigin),this.backgroundPosition=parse(B,backgroundPosition,M.backgroundPosition),this.backgroundRepeat=parse(B,backgroundRepeat,M.backgroundRepeat),this.backgroundSize=parse(B,backgroundSize,M.backgroundSize),this.borderTopColor=parse(B,borderTopColor,M.borderTopColor),this.borderRightColor=parse(B,borderRightColor,M.borderRightColor),this.borderBottomColor=parse(B,borderBottomColor,M.borderBottomColor),this.borderLeftColor=parse(B,borderLeftColor,M.borderLeftColor),this.borderTopLeftRadius=parse(B,borderTopLeftRadius,M.borderTopLeftRadius),this.borderTopRightRadius=parse(B,borderTopRightRadius,M.borderTopRightRadius),this.borderBottomRightRadius=parse(B,borderBottomRightRadius,M.borderBottomRightRadius),this.borderBottomLeftRadius=parse(B,borderBottomLeftRadius,M.borderBottomLeftRadius),this.borderTopStyle=parse(B,borderTopStyle,M.borderTopStyle),this.borderRightStyle=parse(B,borderRightStyle,M.borderRightStyle),this.borderBottomStyle=parse(B,borderBottomStyle,M.borderBottomStyle),this.borderLeftStyle=parse(B,borderLeftStyle,M.borderLeftStyle),this.borderTopWidth=parse(B,borderTopWidth,M.borderTopWidth),this.borderRightWidth=parse(B,borderRightWidth,M.borderRightWidth),this.borderBottomWidth=parse(B,borderBottomWidth,M.borderBottomWidth),this.borderLeftWidth=parse(B,borderLeftWidth,M.borderLeftWidth),this.boxShadow=parse(B,boxShadow,M.boxShadow),this.color=parse(B,color,M.color),this.direction=parse(B,direction,M.direction),this.display=parse(B,display,M.display),this.float=parse(B,float,M.cssFloat),this.fontFamily=parse(B,fontFamily,M.fontFamily),this.fontSize=parse(B,fontSize,M.fontSize),this.fontStyle=parse(B,fontStyle,M.fontStyle),this.fontVariant=parse(B,fontVariant,M.fontVariant),this.fontWeight=parse(B,fontWeight,M.fontWeight),this.letterSpacing=parse(B,letterSpacing,M.letterSpacing),this.lineBreak=parse(B,lineBreak,M.lineBreak),this.lineHeight=parse(B,lineHeight,M.lineHeight),this.listStyleImage=parse(B,listStyleImage,M.listStyleImage),this.listStylePosition=parse(B,listStylePosition,M.listStylePosition),this.listStyleType=parse(B,listStyleType,M.listStyleType),this.marginTop=parse(B,marginTop,M.marginTop),this.marginRight=parse(B,marginRight,M.marginRight),this.marginBottom=parse(B,marginBottom,M.marginBottom),this.marginLeft=parse(B,marginLeft,M.marginLeft),this.opacity=parse(B,opacity,M.opacity);var Y=parse(B,overflow,M.overflow);this.overflowX=Y[0],this.overflowY=Y[Y.length>1?1:0],this.overflowWrap=parse(B,overflowWrap,M.overflowWrap),this.paddingTop=parse(B,paddingTop,M.paddingTop),this.paddingRight=parse(B,paddingRight,M.paddingRight),this.paddingBottom=parse(B,paddingBottom,M.paddingBottom),this.paddingLeft=parse(B,paddingLeft,M.paddingLeft),this.paintOrder=parse(B,paintOrder,M.paintOrder),this.position=parse(B,position,M.position),this.textAlign=parse(B,textAlign,M.textAlign),this.textDecorationColor=parse(B,textDecorationColor,(P=M.textDecorationColor)!==null&&P!==void 0?P:M.color),this.textDecorationLine=parse(B,textDecorationLine,(K=M.textDecorationLine)!==null&&K!==void 0?K:M.textDecoration),this.textShadow=parse(B,textShadow,M.textShadow),this.textTransform=parse(B,textTransform,M.textTransform),this.transform=parse(B,transform$1,M.transform),this.transformOrigin=parse(B,transformOrigin,M.transformOrigin),this.visibility=parse(B,visibility,M.visibility),this.webkitTextStrokeColor=parse(B,webkitTextStrokeColor,M.webkitTextStrokeColor),this.webkitTextStrokeWidth=parse(B,webkitTextStrokeWidth,M.webkitTextStrokeWidth),this.wordBreak=parse(B,wordBreak,M.wordBreak),this.zIndex=parse(B,zIndex,M.zIndex)}return g.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},g.prototype.isTransparent=function(){return isTransparent(this.backgroundColor)},g.prototype.isTransformed=function(){return this.transform!==null},g.prototype.isPositioned=function(){return this.position!==0},g.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},g.prototype.isFloating=function(){return this.float!==0},g.prototype.isInlineLevel=function(){return contains(this.display,4)||contains(this.display,33554432)||contains(this.display,268435456)||contains(this.display,536870912)||contains(this.display,67108864)||contains(this.display,134217728)},g}(),CSSParsedPseudoDeclaration=function(){function g(B,M){this.content=parse(B,content,M.content),this.quotes=parse(B,quotes,M.quotes)}return g}(),CSSParsedCounterDeclaration=function(){function g(B,M){this.counterIncrement=parse(B,counterIncrement,M.counterIncrement),this.counterReset=parse(B,counterReset,M.counterReset)}return g}(),parse=function(g,B,M){var P=new Tokenizer,K=M!==null&&typeof M<"u"?M.toString():B.initialValue;P.write(K);var Y=new Parser$1(P.read());switch(B.type){case 2:var re=Y.parseComponentValue();return B.parse(g,isIdentToken(re)?re.value:B.initialValue);case 0:return B.parse(g,Y.parseComponentValue());case 1:return B.parse(g,Y.parseComponentValues());case 4:return Y.parseComponentValue();case 3:switch(B.format){case"angle":return angle.parse(g,Y.parseComponentValue());case"color":return color$1.parse(g,Y.parseComponentValue());case"image":return image.parse(g,Y.parseComponentValue());case"length":var D=Y.parseComponentValue();return isLength(D)?D:ZERO_LENGTH;case"length-percentage":var ne=Y.parseComponentValue();return isLengthPercentage(ne)?ne:ZERO_LENGTH;case"time":return time.parse(g,Y.parseComponentValue())}break}},elementDebuggerAttribute="data-html2canvas-debug",getElementDebugType=function(g){var B=g.getAttribute(elementDebuggerAttribute);switch(B){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},isDebugging=function(g,B){var M=getElementDebugType(g);return M===1||B===M},ElementContainer=function(){function g(B,M){if(this.context=B,this.textNodes=[],this.elements=[],this.flags=0,isDebugging(M,3))debugger;this.styles=new CSSParsedDeclaration(B,window.getComputedStyle(M,null)),isHTMLElementNode(M)&&(this.styles.animationDuration.some(function(P){return P>0})&&(M.style.animationDuration="0s"),this.styles.transform!==null&&(M.style.transform="none")),this.bounds=parseBounds(this.context,M),isDebugging(M,4)&&(this.flags|=16)}return g}(),base64$2="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",chars$1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var i$1$2=0;i$1$2<chars$1.length;i$1$2++)lookup$1[chars$1.charCodeAt(i$1$2)]=i$1$2;var decode=function(g){var B=g.length*.75,M=g.length,P,K=0,Y,re,D,ne;g[g.length-1]==="="&&(B--,g[g.length-2]==="="&&B--);var ae=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(B):new Array(B),ue=Array.isArray(ae)?ae:new Uint8Array(ae);for(P=0;P<M;P+=4)Y=lookup$1[g.charCodeAt(P)],re=lookup$1[g.charCodeAt(P+1)],D=lookup$1[g.charCodeAt(P+2)],ne=lookup$1[g.charCodeAt(P+3)],ue[K++]=Y<<2|re>>4,ue[K++]=(re&15)<<4|D>>2,ue[K++]=(D&3)<<6|ne&63;return ae},polyUint16Array=function(g){for(var B=g.length,M=[],P=0;P<B;P+=2)M.push(g[P+1]<<8|g[P]);return M},polyUint32Array=function(g){for(var B=g.length,M=[],P=0;P<B;P+=4)M.push(g[P+3]<<24|g[P+2]<<16|g[P+1]<<8|g[P]);return M},UTRIE2_SHIFT_2=5,UTRIE2_SHIFT_1=11,UTRIE2_INDEX_SHIFT=2,UTRIE2_SHIFT_1_2=UTRIE2_SHIFT_1-UTRIE2_SHIFT_2,UTRIE2_LSCP_INDEX_2_OFFSET=65536>>UTRIE2_SHIFT_2,UTRIE2_DATA_BLOCK_LENGTH=1<<UTRIE2_SHIFT_2,UTRIE2_DATA_MASK=UTRIE2_DATA_BLOCK_LENGTH-1,UTRIE2_LSCP_INDEX_2_LENGTH=1024>>UTRIE2_SHIFT_2,UTRIE2_INDEX_2_BMP_LENGTH=UTRIE2_LSCP_INDEX_2_OFFSET+UTRIE2_LSCP_INDEX_2_LENGTH,UTRIE2_UTF8_2B_INDEX_2_OFFSET=UTRIE2_INDEX_2_BMP_LENGTH,UTRIE2_UTF8_2B_INDEX_2_LENGTH=32,UTRIE2_INDEX_1_OFFSET=UTRIE2_UTF8_2B_INDEX_2_OFFSET+UTRIE2_UTF8_2B_INDEX_2_LENGTH,UTRIE2_OMITTED_BMP_INDEX_1_LENGTH=65536>>UTRIE2_SHIFT_1,UTRIE2_INDEX_2_BLOCK_LENGTH=1<<UTRIE2_SHIFT_1_2,UTRIE2_INDEX_2_MASK=UTRIE2_INDEX_2_BLOCK_LENGTH-1,slice16=function(g,B,M){return g.slice?g.slice(B,M):new Uint16Array(Array.prototype.slice.call(g,B,M))},slice32=function(g,B,M){return g.slice?g.slice(B,M):new Uint32Array(Array.prototype.slice.call(g,B,M))},createTrieFromBase64=function(g,B){var M=decode(g),P=Array.isArray(M)?polyUint32Array(M):new Uint32Array(M),K=Array.isArray(M)?polyUint16Array(M):new Uint16Array(M),Y=24,re=slice16(K,Y/2,P[4]/2),D=P[5]===2?slice16(K,(Y+P[4])/2):slice32(P,Math.ceil((Y+P[4])/4));return new Trie(P[0],P[1],P[2],P[3],re,D)},Trie=function(){function g(B,M,P,K,Y,re){this.initialValue=B,this.errorValue=M,this.highStart=P,this.highValueIndex=K,this.index=Y,this.data=re}return g.prototype.get=function(B){var M;if(B>=0){if(B<55296||B>56319&&B<=65535)return M=this.index[B>>UTRIE2_SHIFT_2],M=(M<<UTRIE2_INDEX_SHIFT)+(B&UTRIE2_DATA_MASK),this.data[M];if(B<=65535)return M=this.index[UTRIE2_LSCP_INDEX_2_OFFSET+(B-55296>>UTRIE2_SHIFT_2)],M=(M<<UTRIE2_INDEX_SHIFT)+(B&UTRIE2_DATA_MASK),this.data[M];if(B<this.highStart)return M=UTRIE2_INDEX_1_OFFSET-UTRIE2_OMITTED_BMP_INDEX_1_LENGTH+(B>>UTRIE2_SHIFT_1),M=this.index[M],M+=B>>UTRIE2_SHIFT_2&UTRIE2_INDEX_2_MASK,M=this.index[M],M=(M<<UTRIE2_INDEX_SHIFT)+(B&UTRIE2_DATA_MASK),this.data[M];if(B<=1114111)return this.data[this.highValueIndex]}return this.errorValue},g}(),chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var i$4=0;i$4<chars.length;i$4++)lookup[chars.charCodeAt(i$4)]=i$4;var Prepend=1,CR=2,LF=3,Control=4,Extend=5,SpacingMark=7,L$1=8,V=9,T$1=10,LV=11,LVT=12,ZWJ=13,Extended_Pictographic=14,RI=15,toCodePoints=function(g){for(var B=[],M=0,P=g.length;M<P;){var K=g.charCodeAt(M++);if(K>=55296&&K<=56319&&M<P){var Y=g.charCodeAt(M++);(Y&64512)===56320?B.push(((K&1023)<<10)+(Y&1023)+65536):(B.push(K),M--)}else B.push(K)}return B},fromCodePoint=function(){for(var g=[],B=0;B<arguments.length;B++)g[B]=arguments[B];if(String.fromCodePoint)return String.fromCodePoint.apply(String,g);var M=g.length;if(!M)return"";for(var P=[],K=-1,Y="";++K<M;){var re=g[K];re<=65535?P.push(re):(re-=65536,P.push((re>>10)+55296,re%1024+56320)),(K+1===M||P.length>16384)&&(Y+=String.fromCharCode.apply(String,P),P.length=0)}return Y},UnicodeTrie=createTrieFromBase64(base64$2),BREAK_NOT_ALLOWED="Ã",BREAK_ALLOWED="Ã·",codePointToClass=function(g){return UnicodeTrie.get(g)},_graphemeBreakAtIndex=function(g,B,M){var P=M-2,K=B[P],Y=B[M-1],re=B[M];if(Y===CR&&re===LF)return BREAK_NOT_ALLOWED;if(Y===CR||Y===LF||Y===Control||re===CR||re===LF||re===Control)return BREAK_ALLOWED;if(Y===L$1&&[L$1,V,LV,LVT].indexOf(re)!==-1||(Y===LV||Y===V)&&(re===V||re===T$1)||(Y===LVT||Y===T$1)&&re===T$1||re===ZWJ||re===Extend||re===SpacingMark||Y===Prepend)return BREAK_NOT_ALLOWED;if(Y===ZWJ&&re===Extended_Pictographic){for(;K===Extend;)K=B[--P];if(K===Extended_Pictographic)return BREAK_NOT_ALLOWED}if(Y===RI&&re===RI){for(var D=0;K===RI;)D++,K=B[--P];if(D%2===0)return BREAK_NOT_ALLOWED}return BREAK_ALLOWED},GraphemeBreaker=function(g){var B=toCodePoints(g),M=B.length,P=0,K=0,Y=B.map(codePointToClass);return{next:function(){if(P>=M)return{done:!0,value:null};for(var re=BREAK_NOT_ALLOWED;P<M&&(re=_graphemeBreakAtIndex(B,Y,++P))===BREAK_NOT_ALLOWED;);if(re!==BREAK_NOT_ALLOWED||P===M){var D=fromCodePoint.apply(null,B.slice(K,P));return K=P,{value:D,done:!1}}return{done:!0,value:null}}}},splitGraphemes=function(g){for(var B=GraphemeBreaker(g),M=[],P;!(P=B.next()).done;)P.value&&M.push(P.value.slice());return M},testRangeBounds=function(g){var B=123;if(g.createRange){var M=g.createRange();if(M.getBoundingClientRect){var P=g.createElement("boundtest");P.style.height=B+"px",P.style.display="block",g.body.appendChild(P),M.selectNode(P);var K=M.getBoundingClientRect(),Y=Math.round(K.height);if(g.body.removeChild(P),Y===B)return!0}}return!1},testIOSLineBreak=function(g){var B=g.createElement("boundtest");B.style.width="50px",B.style.display="block",B.style.fontSize="12px",B.style.letterSpacing="0px",B.style.wordSpacing="0px",g.body.appendChild(B);var M=g.createRange();B.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var P=B.firstChild,K=toCodePoints$1(P.data).map(function(ne){return fromCodePoint$1(ne)}),Y=0,re={},D=K.every(function(ne,ae){M.setStart(P,Y),M.setEnd(P,Y+ne.length);var ue=M.getBoundingClientRect();Y+=ne.length;var ge=ue.x>re.x||ue.y>re.y;return re=ue,ae===0?!0:ge});return g.body.removeChild(B),D},testCORS=function(){return typeof new Image().crossOrigin<"u"},testResponseType=function(){return typeof new XMLHttpRequest().responseType=="string"},testSVG=function(g){var B=new Image,M=g.createElement("canvas"),P=M.getContext("2d");if(!P)return!1;B.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{P.drawImage(B,0,0),M.toDataURL()}catch{return!1}return!0},isGreenPixel=function(g){return g[0]===0&&g[1]===255&&g[2]===0&&g[3]===255},testForeignObject=function(g){var B=g.createElement("canvas"),M=100;B.width=M,B.height=M;var P=B.getContext("2d");if(!P)return Promise.reject(!1);P.fillStyle="rgb(0, 255, 0)",P.fillRect(0,0,M,M);var K=new Image,Y=B.toDataURL();K.src=Y;var re=createForeignObjectSVG(M,M,0,0,K);return P.fillStyle="red",P.fillRect(0,0,M,M),loadSerializedSVG$1(re).then(function(D){P.drawImage(D,0,0);var ne=P.getImageData(0,0,M,M).data;P.fillStyle="red",P.fillRect(0,0,M,M);var ae=g.createElement("div");return ae.style.backgroundImage="url("+Y+")",ae.style.height=M+"px",isGreenPixel(ne)?loadSerializedSVG$1(createForeignObjectSVG(M,M,0,0,ae)):Promise.reject(!1)}).then(function(D){return P.drawImage(D,0,0),isGreenPixel(P.getImageData(0,0,M,M).data)}).catch(function(){return!1})},createForeignObjectSVG=function(g,B,M,P,K){var Y="http://www.w3.org/2000/svg",re=document.createElementNS(Y,"svg"),D=document.createElementNS(Y,"foreignObject");return re.setAttributeNS(null,"width",g.toString()),re.setAttributeNS(null,"height",B.toString()),D.setAttributeNS(null,"width","100%"),D.setAttributeNS(null,"height","100%"),D.setAttributeNS(null,"x",M.toString()),D.setAttributeNS(null,"y",P.toString()),D.setAttributeNS(null,"externalResourcesRequired","true"),re.appendChild(D),D.appendChild(K),re},loadSerializedSVG$1=function(g){return new Promise(function(B,M){var P=new Image;P.onload=function(){return B(P)},P.onerror=M,P.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(g))})},FEATURES={get SUPPORT_RANGE_BOUNDS(){var g=testRangeBounds(document);return Object.defineProperty(FEATURES,"SUPPORT_RANGE_BOUNDS",{value:g}),g},get SUPPORT_WORD_BREAKING(){var g=FEATURES.SUPPORT_RANGE_BOUNDS&&testIOSLineBreak(document);return Object.defineProperty(FEATURES,"SUPPORT_WORD_BREAKING",{value:g}),g},get SUPPORT_SVG_DRAWING(){var g=testSVG(document);return Object.defineProperty(FEATURES,"SUPPORT_SVG_DRAWING",{value:g}),g},get SUPPORT_FOREIGNOBJECT_DRAWING(){var g=typeof Array.from=="function"&&typeof window.fetch=="function"?testForeignObject(document):Promise.resolve(!1);return Object.defineProperty(FEATURES,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:g}),g},get SUPPORT_CORS_IMAGES(){var g=testCORS();return Object.defineProperty(FEATURES,"SUPPORT_CORS_IMAGES",{value:g}),g},get SUPPORT_RESPONSE_TYPE(){var g=testResponseType();return Object.defineProperty(FEATURES,"SUPPORT_RESPONSE_TYPE",{value:g}),g},get SUPPORT_CORS_XHR(){var g="withCredentials"in new XMLHttpRequest;return Object.defineProperty(FEATURES,"SUPPORT_CORS_XHR",{value:g}),g},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var g=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(FEATURES,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:g}),g}},TextBounds=function(){function g(B,M){this.text=B,this.bounds=M}return g}(),parseTextBounds=function(g,B,M,P){var K=breakText(B,M),Y=[],re=0;return K.forEach(function(D){if(M.textDecorationLine.length||D.trim().length>0)if(FEATURES.SUPPORT_RANGE_BOUNDS){var ne=createRange(P,re,D.length).getClientRects();if(ne.length>1){var ae=segmentGraphemes(D),ue=0;ae.forEach(function(Be){Y.push(new TextBounds(Be,Bounds.fromDOMRectList(g,createRange(P,ue+re,Be.length).getClientRects()))),ue+=Be.length})}else Y.push(new TextBounds(D,Bounds.fromDOMRectList(g,ne)))}else{var ge=P.splitText(D.length);Y.push(new TextBounds(D,getWrapperBounds(g,P))),P=ge}else FEATURES.SUPPORT_RANGE_BOUNDS||(P=P.splitText(D.length));re+=D.length}),Y},getWrapperBounds=function(g,B){var M=B.ownerDocument;if(M){var P=M.createElement("html2canvaswrapper");P.appendChild(B.cloneNode(!0));var K=B.parentNode;if(K){K.replaceChild(P,B);var Y=parseBounds(g,P);return P.firstChild&&K.replaceChild(P.firstChild,P),Y}}return Bounds.EMPTY},createRange=function(g,B,M){var P=g.ownerDocument;if(!P)throw new Error("Node has no owner document");var K=P.createRange();return K.setStart(g,B),K.setEnd(g,B+M),K},segmentGraphemes=function(g){if(FEATURES.SUPPORT_NATIVE_TEXT_SEGMENTATION){var B=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(B.segment(g)).map(function(M){return M.segment})}return splitGraphemes(g)},segmentWords=function(g,B){if(FEATURES.SUPPORT_NATIVE_TEXT_SEGMENTATION){var M=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(M.segment(g)).map(function(P){return P.segment})}return breakWords(g,B)},breakText=function(g,B){return B.letterSpacing!==0?segmentGraphemes(g):segmentWords(g,B)},wordSeparators=[32,160,4961,65792,65793,4153,4241],breakWords=function(g,B){for(var M=LineBreaker(g,{lineBreak:B.lineBreak,wordBreak:B.overflowWrap==="break-word"?"break-word":B.wordBreak}),P=[],K,Y=function(){if(K.value){var re=K.value.slice(),D=toCodePoints$1(re),ne="";D.forEach(function(ae){wordSeparators.indexOf(ae)===-1?ne+=fromCodePoint$1(ae):(ne.length&&P.push(ne),P.push(fromCodePoint$1(ae)),ne="")}),ne.length&&P.push(ne)}};!(K=M.next()).done;)Y();return P},TextContainer=function(){function g(B,M,P){this.text=transform(M.data,P.textTransform),this.textBounds=parseTextBounds(B,this.text,P,M)}return g}(),transform=function(g,B){switch(B){case 1:return g.toLowerCase();case 3:return g.replace(CAPITALIZE,capitalize);case 2:return g.toUpperCase();default:return g}},CAPITALIZE=/(^|\s|:|-|\(|\))([a-z])/g,capitalize=function(g,B,M){return g.length>0?B+M.toUpperCase():g},ImageElementContainer=function(g){__extends(B,g);function B(M,P){var K=g.call(this,M,P)||this;return K.src=P.currentSrc||P.src,K.intrinsicWidth=P.naturalWidth,K.intrinsicHeight=P.naturalHeight,K.context.cache.addImage(K.src),K}return B}(ElementContainer),CanvasElementContainer=function(g){__extends(B,g);function B(M,P){var K=g.call(this,M,P)||this;return K.canvas=P,K.intrinsicWidth=P.width,K.intrinsicHeight=P.height,K}return B}(ElementContainer),SVGElementContainer=function(g){__extends(B,g);function B(M,P){var K=g.call(this,M,P)||this,Y=new XMLSerializer,re=parseBounds(M,P);return P.setAttribute("width",re.width+"px"),P.setAttribute("height",re.height+"px"),K.svg="data:image/svg+xml,"+encodeURIComponent(Y.serializeToString(P)),K.intrinsicWidth=P.width.baseVal.value,K.intrinsicHeight=P.height.baseVal.value,K.context.cache.addImage(K.svg),K}return B}(ElementContainer),LIElementContainer=function(g){__extends(B,g);function B(M,P){var K=g.call(this,M,P)||this;return K.value=P.value,K}return B}(ElementContainer),OLElementContainer=function(g){__extends(B,g);function B(M,P){var K=g.call(this,M,P)||this;return K.start=P.start,K.reversed=typeof P.reversed=="boolean"&&P.reversed===!0,K}return B}(ElementContainer),CHECKBOX_BORDER_RADIUS=[{type:15,flags:0,unit:"px",number:3}],RADIO_BORDER_RADIUS=[{type:16,flags:0,number:50}],reformatInputBounds=function(g){return g.width>g.height?new Bounds(g.left+(g.width-g.height)/2,g.top,g.height,g.height):g.width<g.height?new Bounds(g.left,g.top+(g.height-g.width)/2,g.width,g.width):g},getInputValue=function(g){var B=g.type===PASSWORD?new Array(g.value.length+1).join("â¢"):g.value;return B.length===0?g.placeholder||"":B},CHECKBOX="checkbox",RADIO="radio",PASSWORD="password",INPUT_COLOR=707406591,InputElementContainer=function(g){__extends(B,g);function B(M,P){var K=g.call(this,M,P)||this;switch(K.type=P.type.toLowerCase(),K.checked=P.checked,K.value=getInputValue(P),(K.type===CHECKBOX||K.type===RADIO)&&(K.styles.backgroundColor=3739148031,K.styles.borderTopColor=K.styles.borderRightColor=K.styles.borderBottomColor=K.styles.borderLeftColor=2779096575,K.styles.borderTopWidth=K.styles.borderRightWidth=K.styles.borderBottomWidth=K.styles.borderLeftWidth=1,K.styles.borderTopStyle=K.styles.borderRightStyle=K.styles.borderBottomStyle=K.styles.borderLeftStyle=1,K.styles.backgroundClip=[0],K.styles.backgroundOrigin=[0],K.bounds=reformatInputBounds(K.bounds)),K.type){case CHECKBOX:K.styles.borderTopRightRadius=K.styles.borderTopLeftRadius=K.styles.borderBottomRightRadius=K.styles.borderBottomLeftRadius=CHECKBOX_BORDER_RADIUS;break;case RADIO:K.styles.borderTopRightRadius=K.styles.borderTopLeftRadius=K.styles.borderBottomRightRadius=K.styles.borderBottomLeftRadius=RADIO_BORDER_RADIUS;break}return K}return B}(ElementContainer),SelectElementContainer=function(g){__extends(B,g);function B(M,P){var K=g.call(this,M,P)||this,Y=P.options[P.selectedIndex||0];return K.value=Y&&Y.text||"",K}return B}(ElementContainer),TextareaElementContainer=function(g){__extends(B,g);function B(M,P){var K=g.call(this,M,P)||this;return K.value=P.value,K}return B}(ElementContainer),IFrameElementContainer=function(g){__extends(B,g);function B(M,P){var K=g.call(this,M,P)||this;K.src=P.src,K.width=parseInt(P.width,10)||0,K.height=parseInt(P.height,10)||0,K.backgroundColor=K.styles.backgroundColor;try{if(P.contentWindow&&P.contentWindow.document&&P.contentWindow.document.documentElement){K.tree=parseTree(M,P.contentWindow.document.documentElement);var Y=P.contentWindow.document.documentElement?parseColor(M,getComputedStyle(P.contentWindow.document.documentElement).backgroundColor):COLORS.TRANSPARENT,re=P.contentWindow.document.body?parseColor(M,getComputedStyle(P.contentWindow.document.body).backgroundColor):COLORS.TRANSPARENT;K.backgroundColor=isTransparent(Y)?isTransparent(re)?K.styles.backgroundColor:re:Y}}catch{}return K}return B}(ElementContainer),LIST_OWNERS=["OL","UL","MENU"],parseNodeTree=function(g,B,M,P){for(var K=B.firstChild,Y=void 0;K;K=Y)if(Y=K.nextSibling,isTextNode(K)&&K.data.trim().length>0)M.textNodes.push(new TextContainer(g,K,M.styles));else if(isElementNode(K))if(isSlotElement(K)&&K.assignedNodes)K.assignedNodes().forEach(function(D){return parseNodeTree(g,D,M,P)});else{var re=createContainer(g,K);re.styles.isVisible()&&(createsRealStackingContext(K,re,P)?re.flags|=4:createsStackingContext(re.styles)&&(re.flags|=2),LIST_OWNERS.indexOf(K.tagName)!==-1&&(re.flags|=8),M.elements.push(re),K.slot,K.shadowRoot?parseNodeTree(g,K.shadowRoot,re,P):!isTextareaElement(K)&&!isSVGElement(K)&&!isSelectElement(K)&&parseNodeTree(g,K,re,P))}},createContainer=function(g,B){return isImageElement(B)?new ImageElementContainer(g,B):isCanvasElement(B)?new CanvasElementContainer(g,B):isSVGElement(B)?new SVGElementContainer(g,B):isLIElement(B)?new LIElementContainer(g,B):isOLElement(B)?new OLElementContainer(g,B):isInputElement(B)?new InputElementContainer(g,B):isSelectElement(B)?new SelectElementContainer(g,B):isTextareaElement(B)?new TextareaElementContainer(g,B):isIFrameElement(B)?new IFrameElementContainer(g,B):new ElementContainer(g,B)},parseTree=function(g,B){var M=createContainer(g,B);return M.flags|=4,parseNodeTree(g,B,M,M),M},createsRealStackingContext=function(g,B,M){return B.styles.isPositionedWithZIndex()||B.styles.opacity<1||B.styles.isTransformed()||isBodyElement(g)&&M.styles.isTransparent()},createsStackingContext=function(g){return g.isPositioned()||g.isFloating()},isTextNode=function(g){return g.nodeType===Node.TEXT_NODE},isElementNode=function(g){return g.nodeType===Node.ELEMENT_NODE},isHTMLElementNode=function(g){return isElementNode(g)&&typeof g.style<"u"&&!isSVGElementNode(g)},isSVGElementNode=function(g){return typeof g.className=="object"},isLIElement=function(g){return g.tagName==="LI"},isOLElement=function(g){return g.tagName==="OL"},isInputElement=function(g){return g.tagName==="INPUT"},isHTMLElement=function(g){return g.tagName==="HTML"},isSVGElement=function(g){return g.tagName==="svg"},isBodyElement=function(g){return g.tagName==="BODY"},isCanvasElement=function(g){return g.tagName==="CANVAS"},isVideoElement=function(g){return g.tagName==="VIDEO"},isImageElement=function(g){return g.tagName==="IMG"},isIFrameElement=function(g){return g.tagName==="IFRAME"},isStyleElement=function(g){return g.tagName==="STYLE"},isScriptElement=function(g){return g.tagName==="SCRIPT"},isTextareaElement=function(g){return g.tagName==="TEXTAREA"},isSelectElement=function(g){return g.tagName==="SELECT"},isSlotElement=function(g){return g.tagName==="SLOT"},isCustomElement=function(g){return g.tagName.indexOf("-")>0},CounterState=function(){function g(){this.counters={}}return g.prototype.getCounterValue=function(B){var M=this.counters[B];return M&&M.length?M[M.length-1]:1},g.prototype.getCounterValues=function(B){var M=this.counters[B];return M||[]},g.prototype.pop=function(B){var M=this;B.forEach(function(P){return M.counters[P].pop()})},g.prototype.parse=function(B){var M=this,P=B.counterIncrement,K=B.counterReset,Y=!0;P!==null&&P.forEach(function(D){var ne=M.counters[D.counter];ne&&D.increment!==0&&(Y=!1,ne.length||ne.push(1),ne[Math.max(0,ne.length-1)]+=D.increment)});var re=[];return Y&&K.forEach(function(D){var ne=M.counters[D.counter];re.push(D.counter),ne||(ne=M.counters[D.counter]=[]),ne.push(D.reset)}),re},g}(),ROMAN_UPPER={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},ARMENIAN={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["Õ","Õ","Õ","Õ","Õ","Õ","Õ","Õ","Õ","Õ","Õ","Õ","Õ","Õ","Õ","Õ","Õ","Õ","Õ","Õ","Õ","Ô¿","Ô¾","Ô½","Ô¼","Ô»","Ôº","Ô¹","Ô¸","Ô·","Ô¶","Ôµ","Ô´","Ô³","Ô²","Ô±"]},HEBREW={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["××³","××³","××³","××³","××³","××³","××³","××³","××³","××³","×ª","×©","×¨","×§","×¦","×¤","×¢","×¡","× ","×","×","×","××","××","××","××","××","×","×","×","×","×","×","×","×","×","×"]},GEORGIAN={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["áµ","á°","á¯","á´","á®","á­","á¬","á«","áª","á©","á¨","á§","á¦","á¥","á¤","á³","á¢","á¡","á ","á","á","á","á²","á","á","á","á","á","á","á±","á","á","á","á","á","á","á"]},createAdditiveCounter=function(g,B,M,P,K,Y){return g<B||g>M?createCounterText(g,K,Y.length>0):P.integers.reduce(function(re,D,ne){for(;g>=D;)g-=D,re+=P.values[ne];return re},"")+Y},createCounterStyleWithSymbolResolver=function(g,B,M,P){var K="";do M||g--,K=P(g)+K,g/=B;while(g*B>=B);return K},createCounterStyleFromRange=function(g,B,M,P,K){var Y=M-B+1;return(g<0?"-":"")+(createCounterStyleWithSymbolResolver(Math.abs(g),Y,P,function(re){return fromCodePoint$1(Math.floor(re%Y)+B)})+K)},createCounterStyleFromSymbols=function(g,B,M){M===void 0&&(M=". ");var P=B.length;return createCounterStyleWithSymbolResolver(Math.abs(g),P,!1,function(K){return B[Math.floor(K%P)]})+M},CJK_ZEROS=1,CJK_TEN_COEFFICIENTS=2,CJK_TEN_HIGH_COEFFICIENTS=4,CJK_HUNDRED_COEFFICIENTS=8,createCJKCounter=function(g,B,M,P,K,Y){if(g<-9999||g>9999)return createCounterText(g,4,K.length>0);var re=Math.abs(g),D=K;if(re===0)return B[0]+D;for(var ne=0;re>0&&ne<=4;ne++){var ae=re%10;ae===0&&contains(Y,CJK_ZEROS)&&D!==""?D=B[ae]+D:ae>1||ae===1&&ne===0||ae===1&&ne===1&&contains(Y,CJK_TEN_COEFFICIENTS)||ae===1&&ne===1&&contains(Y,CJK_TEN_HIGH_COEFFICIENTS)&&g>100||ae===1&&ne>1&&contains(Y,CJK_HUNDRED_COEFFICIENTS)?D=B[ae]+(ne>0?M[ne-1]:"")+D:ae===1&&ne>0&&(D=M[ne-1]+D),re=Math.floor(re/10)}return(g<0?P:"")+D},CHINESE_INFORMAL_MULTIPLIERS="åç¾åè¬",CHINESE_FORMAL_MULTIPLIERS="æ¾ä½°ä»è¬",JAPANESE_NEGATIVE="ãã¤ãã¹",KOREAN_NEGATIVE="ë§ì´ëì¤",createCounterText=function(g,B,M){var P=M?". ":"",K=M?"ã":"",Y=M?", ":"",re=M?" ":"";switch(B){case 0:return"â¢"+re;case 1:return"â¦"+re;case 2:return"â¾"+re;case 5:var D=createCounterStyleFromRange(g,48,57,!0,P);return D.length<4?"0"+D:D;case 4:return createCounterStyleFromSymbols(g,"ãä¸äºä¸åäºå­ä¸å«ä¹",K);case 6:return createAdditiveCounter(g,1,3999,ROMAN_UPPER,3,P).toLowerCase();case 7:return createAdditiveCounter(g,1,3999,ROMAN_UPPER,3,P);case 8:return createCounterStyleFromRange(g,945,969,!1,P);case 9:return createCounterStyleFromRange(g,97,122,!1,P);case 10:return createCounterStyleFromRange(g,65,90,!1,P);case 11:return createCounterStyleFromRange(g,1632,1641,!0,P);case 12:case 49:return createAdditiveCounter(g,1,9999,ARMENIAN,3,P);case 35:return createAdditiveCounter(g,1,9999,ARMENIAN,3,P).toLowerCase();case 13:return createCounterStyleFromRange(g,2534,2543,!0,P);case 14:case 30:return createCounterStyleFromRange(g,6112,6121,!0,P);case 15:return createCounterStyleFromSymbols(g,"å­ä¸å¯å¯è¾°å·³åæªç³éæäº¥",K);case 16:return createCounterStyleFromSymbols(g,"ç²ä¹ä¸ä¸æå·±åºè¾å£¬ç¸",K);case 17:case 48:return createCJKCounter(g,"é¶ä¸äºä¸åäºå­ä¸å«ä¹",CHINESE_INFORMAL_MULTIPLIERS,"è² ",K,CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 47:return createCJKCounter(g,"é¶å£¹è²³åèä¼é¸ææç",CHINESE_FORMAL_MULTIPLIERS,"è² ",K,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 42:return createCJKCounter(g,"é¶ä¸äºä¸åäºå­ä¸å«ä¹",CHINESE_INFORMAL_MULTIPLIERS,"è´",K,CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 41:return createCJKCounter(g,"é¶å£¹è´°åèä¼éææç",CHINESE_FORMAL_MULTIPLIERS,"è´",K,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS|CJK_HUNDRED_COEFFICIENTS);case 26:return createCJKCounter(g,"ãä¸äºä¸åäºå­ä¸å«ä¹","åç¾åä¸",JAPANESE_NEGATIVE,K,0);case 25:return createCJKCounter(g,"é¶å£±å¼ååä¼å­ä¸å«ä¹","æ¾ç¾åä¸",JAPANESE_NEGATIVE,K,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case 31:return createCJKCounter(g,"ìì¼ì´ì¼ì¬ì¤ì¡ì¹ íêµ¬","ì­ë°±ì²ë§",KOREAN_NEGATIVE,Y,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case 33:return createCJKCounter(g,"é¶ä¸äºä¸åäºå­ä¸å«ä¹","åç¾åè¬",KOREAN_NEGATIVE,Y,0);case 32:return createCJKCounter(g,"é¶å£¹è²³ååäºå­ä¸å«ä¹","æ¾ç¾å",KOREAN_NEGATIVE,Y,CJK_ZEROS|CJK_TEN_COEFFICIENTS|CJK_TEN_HIGH_COEFFICIENTS);case 18:return createCounterStyleFromRange(g,2406,2415,!0,P);case 20:return createAdditiveCounter(g,1,19999,GEORGIAN,3,P);case 21:return createCounterStyleFromRange(g,2790,2799,!0,P);case 22:return createCounterStyleFromRange(g,2662,2671,!0,P);case 22:return createAdditiveCounter(g,1,10999,HEBREW,3,P);case 23:return createCounterStyleFromSymbols(g,"ããããããããããããããããã¡ã¤ã¦ã¨ãªã«ã¬ã­ã®ã¯ã²ãµã¸ã»ã¾ã¿ãããããããããããããããã");case 24:return createCounterStyleFromSymbols(g,"ããã¯ã«ã»ã¸ã¨ã¡ãã¬ããããããããã¤ã­ãªããããã®ãããã¾ããµããã¦ãããããã¿ããã²ããã");case 27:return createCounterStyleFromRange(g,3302,3311,!0,P);case 28:return createCounterStyleFromSymbols(g,"ã¢ã¤ã¦ã¨ãªã«ã­ã¯ã±ã³ãµã·ã¹ã»ã½ã¿ããããããããããããããããã ã¡ã¢ã¤ã¦ã¨ã©ãªã«ã¬ã­ã¯ã°ã±ã²ã³",K);case 29:return createCounterStyleFromSymbols(g,"ã¤ã­ãããããããªãã«ã²ã¯ã«ã¨ã¿ã¬ã½ãããã©ã ã¦ã°ããªã¯ã¤ãã±ãã³ã¨ãã¢ãµã­ã¦ã¡ãã·ã±ãã¢ã»ã¹",K);case 34:return createCounterStyleFromRange(g,3792,3801,!0,P);case 37:return createCounterStyleFromRange(g,6160,6169,!0,P);case 38:return createCounterStyleFromRange(g,4160,4169,!0,P);case 39:return createCounterStyleFromRange(g,2918,2927,!0,P);case 40:return createCounterStyleFromRange(g,1776,1785,!0,P);case 43:return createCounterStyleFromRange(g,3046,3055,!0,P);case 44:return createCounterStyleFromRange(g,3174,3183,!0,P);case 45:return createCounterStyleFromRange(g,3664,3673,!0,P);case 46:return createCounterStyleFromRange(g,3872,3881,!0,P);case 3:default:return createCounterStyleFromRange(g,48,57,!0,P)}},IGNORE_ATTRIBUTE="data-html2canvas-ignore",DocumentCloner=function(){function g(B,M,P){if(this.context=B,this.options=P,this.scrolledElements=[],this.referenceElement=M,this.counters=new CounterState,this.quoteDepth=0,!M.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(M.ownerDocument.documentElement,!1)}return g.prototype.toIFrame=function(B,M){var P=this,K=createIFrameContainer(B,M);if(!K.contentWindow)return Promise.reject("Unable to find iframe window");var Y=B.defaultView.pageXOffset,re=B.defaultView.pageYOffset,D=K.contentWindow,ne=D.document,ae=iframeLoader(K).then(function(){return __awaiter(P,void 0,void 0,function(){var ue,ge;return __generator(this,function(Be){switch(Be.label){case 0:return this.scrolledElements.forEach(restoreNodeScroll),D&&(D.scrollTo(M.left,M.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(D.scrollY!==M.top||D.scrollX!==M.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(D.scrollX-M.left,D.scrollY-M.top,0,0))),ue=this.options.onclone,ge=this.clonedReferenceElement,typeof ge>"u"?[2,Promise.reject("Error finding the "+this.referenceElement.nodeName+" in the cloned document")]:ne.fonts&&ne.fonts.ready?[4,ne.fonts.ready]:[3,2];case 1:Be.sent(),Be.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,imagesReady(ne)]:[3,4];case 3:Be.sent(),Be.label=4;case 4:return typeof ue=="function"?[2,Promise.resolve().then(function(){return ue(ne,ge)}).then(function(){return K})]:[2,K]}})})});return ne.open(),ne.write(serializeDoctype(document.doctype)+"<html></html>"),restoreOwnerScroll(this.referenceElement.ownerDocument,Y,re),ne.replaceChild(ne.adoptNode(this.documentElement),ne.documentElement),ne.close(),ae},g.prototype.createElementClone=function(B){if(isDebugging(B,2))debugger;if(isCanvasElement(B))return this.createCanvasClone(B);if(isVideoElement(B))return this.createVideoClone(B);if(isStyleElement(B))return this.createStyleClone(B);var M=B.cloneNode(!1);return isImageElement(M)&&(isImageElement(B)&&B.currentSrc&&B.currentSrc!==B.src&&(M.src=B.currentSrc,M.srcset=""),M.loading==="lazy"&&(M.loading="eager")),isCustomElement(M)?this.createCustomElementClone(M):M},g.prototype.createCustomElementClone=function(B){var M=document.createElement("html2canvascustomelement");return copyCSSStyles(B.style,M),M},g.prototype.createStyleClone=function(B){try{var M=B.sheet;if(M&&M.cssRules){var P=[].slice.call(M.cssRules,0).reduce(function(Y,re){return re&&typeof re.cssText=="string"?Y+re.cssText:Y},""),K=B.cloneNode(!1);return K.textContent=P,K}}catch(Y){if(this.context.logger.error("Unable to access cssRules property",Y),Y.name!=="SecurityError")throw Y}return B.cloneNode(!1)},g.prototype.createCanvasClone=function(B){var M;if(this.options.inlineImages&&B.ownerDocument){var P=B.ownerDocument.createElement("img");try{return P.src=B.toDataURL(),P}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",B)}}var K=B.cloneNode(!1);try{K.width=B.width,K.height=B.height;var Y=B.getContext("2d"),re=K.getContext("2d");if(re)if(!this.options.allowTaint&&Y)re.putImageData(Y.getImageData(0,0,B.width,B.height),0,0);else{var D=(M=B.getContext("webgl2"))!==null&&M!==void 0?M:B.getContext("webgl");if(D){var ne=D.getContextAttributes();(ne==null?void 0:ne.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",B)}re.drawImage(B,0,0)}return K}catch{this.context.logger.info("Unable to clone canvas as it is tainted",B)}return K},g.prototype.createVideoClone=function(B){var M=B.ownerDocument.createElement("canvas");M.width=B.offsetWidth,M.height=B.offsetHeight;var P=M.getContext("2d");try{return P&&(P.drawImage(B,0,0,M.width,M.height),this.options.allowTaint||P.getImageData(0,0,M.width,M.height)),M}catch{this.context.logger.info("Unable to clone video as it is tainted",B)}var K=B.ownerDocument.createElement("canvas");return K.width=B.offsetWidth,K.height=B.offsetHeight,K},g.prototype.appendChildNode=function(B,M,P){(!isElementNode(M)||!isScriptElement(M)&&!M.hasAttribute(IGNORE_ATTRIBUTE)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(M)))&&(!this.options.copyStyles||!isElementNode(M)||!isStyleElement(M))&&B.appendChild(this.cloneNode(M,P))},g.prototype.cloneChildNodes=function(B,M,P){for(var K=this,Y=B.shadowRoot?B.shadowRoot.firstChild:B.firstChild;Y;Y=Y.nextSibling)if(isElementNode(Y)&&isSlotElement(Y)&&typeof Y.assignedNodes=="function"){var re=Y.assignedNodes();re.length&&re.forEach(function(D){return K.appendChildNode(M,D,P)})}else this.appendChildNode(M,Y,P)},g.prototype.cloneNode=function(B,M){if(isTextNode(B))return document.createTextNode(B.data);if(!B.ownerDocument)return B.cloneNode(!1);var P=B.ownerDocument.defaultView;if(P&&isElementNode(B)&&(isHTMLElementNode(B)||isSVGElementNode(B))){var K=this.createElementClone(B);K.style.transitionProperty="none";var Y=P.getComputedStyle(B),re=P.getComputedStyle(B,":before"),D=P.getComputedStyle(B,":after");this.referenceElement===B&&isHTMLElementNode(K)&&(this.clonedReferenceElement=K),isBodyElement(K)&&createPseudoHideStyles(K);var ne=this.counters.parse(new CSSParsedCounterDeclaration(this.context,Y)),ae=this.resolvePseudoContent(B,K,re,PseudoElementType.BEFORE);isCustomElement(B)&&(M=!0),isVideoElement(B)||this.cloneChildNodes(B,K,M),ae&&K.insertBefore(ae,K.firstChild);var ue=this.resolvePseudoContent(B,K,D,PseudoElementType.AFTER);return ue&&K.appendChild(ue),this.counters.pop(ne),(Y&&(this.options.copyStyles||isSVGElementNode(B))&&!isIFrameElement(B)||M)&&copyCSSStyles(Y,K),(B.scrollTop!==0||B.scrollLeft!==0)&&this.scrolledElements.push([K,B.scrollLeft,B.scrollTop]),(isTextareaElement(B)||isSelectElement(B))&&(isTextareaElement(K)||isSelectElement(K))&&(K.value=B.value),K}return B.cloneNode(!1)},g.prototype.resolvePseudoContent=function(B,M,P,K){var Y=this;if(P){var re=P.content,D=M.ownerDocument;if(!(!D||!re||re==="none"||re==="-moz-alt-content"||P.display==="none")){this.counters.parse(new CSSParsedCounterDeclaration(this.context,P));var ne=new CSSParsedPseudoDeclaration(this.context,P),ae=D.createElement("html2canvaspseudoelement");copyCSSStyles(P,ae),ne.content.forEach(function(ge){if(ge.type===0)ae.appendChild(D.createTextNode(ge.value));else if(ge.type===22){var Be=D.createElement("img");Be.src=ge.value,Be.style.opacity="1",ae.appendChild(Be)}else if(ge.type===18){if(ge.name==="attr"){var De=ge.values.filter(isIdentToken);De.length&&ae.appendChild(D.createTextNode(B.getAttribute(De[0].value)||""))}else if(ge.name==="counter"){var ze=ge.values.filter(nonFunctionArgSeparator),Oe=ze[0],Je=ze[1];if(Oe&&isIdentToken(Oe)){var We=Y.counters.getCounterValue(Oe.value),ut=Je&&isIdentToken(Je)?listStyleType.parse(Y.context,Je.value):3;ae.appendChild(D.createTextNode(createCounterText(We,ut,!1)))}}else if(ge.name==="counters"){var et=ge.values.filter(nonFunctionArgSeparator),Oe=et[0],At=et[1],Je=et[2];if(Oe&&isIdentToken(Oe)){var nt=Y.counters.getCounterValues(Oe.value),ft=Je&&isIdentToken(Je)?listStyleType.parse(Y.context,Je.value):3,Tt=At&&At.type===0?At.value:"",qt=nt.map(function(Ut){return createCounterText(Ut,ft,!1)}).join(Tt);ae.appendChild(D.createTextNode(qt))}}}else if(ge.type===20)switch(ge.value){case"open-quote":ae.appendChild(D.createTextNode(getQuote(ne.quotes,Y.quoteDepth++,!0)));break;case"close-quote":ae.appendChild(D.createTextNode(getQuote(ne.quotes,--Y.quoteDepth,!1)));break;default:ae.appendChild(D.createTextNode(ge.value))}}),ae.className=PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+PSEUDO_HIDE_ELEMENT_CLASS_AFTER;var ue=K===PseudoElementType.BEFORE?" "+PSEUDO_HIDE_ELEMENT_CLASS_BEFORE:" "+PSEUDO_HIDE_ELEMENT_CLASS_AFTER;return isSVGElementNode(M)?M.className.baseValue+=ue:M.className+=ue,ae}}},g.destroy=function(B){return B.parentNode?(B.parentNode.removeChild(B),!0):!1},g}(),PseudoElementType;(function(g){g[g.BEFORE=0]="BEFORE",g[g.AFTER=1]="AFTER"})(PseudoElementType||(PseudoElementType={}));var createIFrameContainer=function(g,B){var M=g.createElement("iframe");return M.className="html2canvas-container",M.style.visibility="hidden",M.style.position="fixed",M.style.left="-10000px",M.style.top="0px",M.style.border="0",M.width=B.width.toString(),M.height=B.height.toString(),M.scrolling="no",M.setAttribute(IGNORE_ATTRIBUTE,"true"),g.body.appendChild(M),M},imageReady=function(g){return new Promise(function(B){if(g.complete){B();return}if(!g.src){B();return}g.onload=B,g.onerror=B})},imagesReady=function(g){return Promise.all([].slice.call(g.images,0).map(imageReady))},iframeLoader=function(g){return new Promise(function(B,M){var P=g.contentWindow;if(!P)return M("No window assigned for iframe");var K=P.document;P.onload=g.onload=function(){P.onload=g.onload=null;var Y=setInterval(function(){K.body.childNodes.length>0&&K.readyState==="complete"&&(clearInterval(Y),B(g))},50)}})},ignoredStyleProperties=["all","d","content"],copyCSSStyles=function(g,B){for(var M=g.length-1;M>=0;M--){var P=g.item(M);ignoredStyleProperties.indexOf(P)===-1&&B.style.setProperty(P,g.getPropertyValue(P))}return B},serializeDoctype=function(g){var B="";return g&&(B+="<!DOCTYPE ",g.name&&(B+=g.name),g.internalSubset&&(B+=g.internalSubset),g.publicId&&(B+='"'+g.publicId+'"'),g.systemId&&(B+='"'+g.systemId+'"'),B+=">"),B},restoreOwnerScroll=function(g,B,M){g&&g.defaultView&&(B!==g.defaultView.pageXOffset||M!==g.defaultView.pageYOffset)&&g.defaultView.scrollTo(B,M)},restoreNodeScroll=function(g){var B=g[0],M=g[1],P=g[2];B.scrollLeft=M,B.scrollTop=P},PSEUDO_BEFORE=":before",PSEUDO_AFTER=":after",PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",PSEUDO_HIDE_ELEMENT_STYLE=`{
    content: "" !important;
    display: none !important;
}`,createPseudoHideStyles=function(g){createStyles(g,"."+PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+PSEUDO_BEFORE+PSEUDO_HIDE_ELEMENT_STYLE+`
         .`+PSEUDO_HIDE_ELEMENT_CLASS_AFTER+PSEUDO_AFTER+PSEUDO_HIDE_ELEMENT_STYLE)},createStyles=function(g,B){var M=g.ownerDocument;if(M){var P=M.createElement("style");P.textContent=B,g.appendChild(P)}},CacheStorage=function(){function g(){}return g.getOrigin=function(B){var M=g._link;return M?(M.href=B,M.href=M.href,M.protocol+M.hostname+M.port):"about:blank"},g.isSameOrigin=function(B){return g.getOrigin(B)===g._origin},g.setContext=function(B){g._link=B.document.createElement("a"),g._origin=g.getOrigin(B.location.href)},g._origin="about:blank",g}(),Cache=function(){function g(B,M){this.context=B,this._options=M,this._cache={}}return g.prototype.addImage=function(B){var M=Promise.resolve();return this.has(B)||(isBlobImage(B)||isRenderable(B))&&(this._cache[B]=this.loadImage(B)).catch(function(){}),M},g.prototype.match=function(B){return this._cache[B]},g.prototype.loadImage=function(B){return __awaiter(this,void 0,void 0,function(){var M,P,K,Y,re=this;return __generator(this,function(D){switch(D.label){case 0:return M=CacheStorage.isSameOrigin(B),P=!isInlineImage(B)&&this._options.useCORS===!0&&FEATURES.SUPPORT_CORS_IMAGES&&!M,K=!isInlineImage(B)&&!M&&!isBlobImage(B)&&typeof this._options.proxy=="string"&&FEATURES.SUPPORT_CORS_XHR&&!P,!M&&this._options.allowTaint===!1&&!isInlineImage(B)&&!isBlobImage(B)&&!K&&!P?[2]:(Y=B,K?[4,this.proxy(Y)]:[3,2]);case 1:Y=D.sent(),D.label=2;case 2:return this.context.logger.debug("Added image "+B.substring(0,256)),[4,new Promise(function(ne,ae){var ue=new Image;ue.onload=function(){return ne(ue)},ue.onerror=ae,(isInlineBase64Image(Y)||P)&&(ue.crossOrigin="anonymous"),ue.src=Y,ue.complete===!0&&setTimeout(function(){return ne(ue)},500),re._options.imageTimeout>0&&setTimeout(function(){return ae("Timed out ("+re._options.imageTimeout+"ms) loading image")},re._options.imageTimeout)})];case 3:return[2,D.sent()]}})})},g.prototype.has=function(B){return typeof this._cache[B]<"u"},g.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},g.prototype.proxy=function(B){var M=this,P=this._options.proxy;if(!P)throw new Error("No proxy defined");var K=B.substring(0,256);return new Promise(function(Y,re){var D=FEATURES.SUPPORT_RESPONSE_TYPE?"blob":"text",ne=new XMLHttpRequest;ne.onload=function(){if(ne.status===200)if(D==="text")Y(ne.response);else{var ge=new FileReader;ge.addEventListener("load",function(){return Y(ge.result)},!1),ge.addEventListener("error",function(Be){return re(Be)},!1),ge.readAsDataURL(ne.response)}else re("Failed to proxy resource "+K+" with status code "+ne.status)},ne.onerror=re;var ae=P.indexOf("?")>-1?"&":"?";if(ne.open("GET",""+P+ae+"url="+encodeURIComponent(B)+"&responseType="+D),D!=="text"&&ne instanceof XMLHttpRequest&&(ne.responseType=D),M._options.imageTimeout){var ue=M._options.imageTimeout;ne.timeout=ue,ne.ontimeout=function(){return re("Timed out ("+ue+"ms) proxying "+K)}}ne.send()})},g}(),INLINE_SVG=/^data:image\/svg\+xml/i,INLINE_BASE64=/^data:image\/.*;base64,/i,INLINE_IMG=/^data:image\/.*/i,isRenderable=function(g){return FEATURES.SUPPORT_SVG_DRAWING||!isSVG(g)},isInlineImage=function(g){return INLINE_IMG.test(g)},isInlineBase64Image=function(g){return INLINE_BASE64.test(g)},isBlobImage=function(g){return g.substr(0,4)==="blob"},isSVG=function(g){return g.substr(-3).toLowerCase()==="svg"||INLINE_SVG.test(g)},Vector=function(){function g(B,M){this.type=0,this.x=B,this.y=M}return g.prototype.add=function(B,M){return new g(this.x+B,this.y+M)},g}(),lerp$2=function(g,B,M){return new Vector(g.x+(B.x-g.x)*M,g.y+(B.y-g.y)*M)},BezierCurve=function(){function g(B,M,P,K){this.type=1,this.start=B,this.startControl=M,this.endControl=P,this.end=K}return g.prototype.subdivide=function(B,M){var P=lerp$2(this.start,this.startControl,B),K=lerp$2(this.startControl,this.endControl,B),Y=lerp$2(this.endControl,this.end,B),re=lerp$2(P,K,B),D=lerp$2(K,Y,B),ne=lerp$2(re,D,B);return M?new g(this.start,P,re,ne):new g(ne,D,Y,this.end)},g.prototype.add=function(B,M){return new g(this.start.add(B,M),this.startControl.add(B,M),this.endControl.add(B,M),this.end.add(B,M))},g.prototype.reverse=function(){return new g(this.end,this.endControl,this.startControl,this.start)},g}(),isBezierCurve=function(g){return g.type===1},BoundCurves=function(){function g(B){var M=B.styles,P=B.bounds,K=getAbsoluteValueForTuple(M.borderTopLeftRadius,P.width,P.height),Y=K[0],re=K[1],D=getAbsoluteValueForTuple(M.borderTopRightRadius,P.width,P.height),ne=D[0],ae=D[1],ue=getAbsoluteValueForTuple(M.borderBottomRightRadius,P.width,P.height),ge=ue[0],Be=ue[1],De=getAbsoluteValueForTuple(M.borderBottomLeftRadius,P.width,P.height),ze=De[0],Oe=De[1],Je=[];Je.push((Y+ne)/P.width),Je.push((ze+ge)/P.width),Je.push((re+Oe)/P.height),Je.push((ae+Be)/P.height);var We=Math.max.apply(Math,Je);We>1&&(Y/=We,re/=We,ne/=We,ae/=We,ge/=We,Be/=We,ze/=We,Oe/=We);var ut=P.width-ne,et=P.height-Be,At=P.width-ge,nt=P.height-Oe,ft=M.borderTopWidth,Tt=M.borderRightWidth,qt=M.borderBottomWidth,Vt=M.borderLeftWidth,vt=getAbsoluteValue(M.paddingTop,B.bounds.width),Ut=getAbsoluteValue(M.paddingRight,B.bounds.width),Pt=getAbsoluteValue(M.paddingBottom,B.bounds.width),Yt=getAbsoluteValue(M.paddingLeft,B.bounds.width);this.topLeftBorderDoubleOuterBox=Y>0||re>0?getCurvePoints(P.left+Vt/3,P.top+ft/3,Y-Vt/3,re-ft/3,CORNER.TOP_LEFT):new Vector(P.left+Vt/3,P.top+ft/3),this.topRightBorderDoubleOuterBox=Y>0||re>0?getCurvePoints(P.left+ut,P.top+ft/3,ne-Tt/3,ae-ft/3,CORNER.TOP_RIGHT):new Vector(P.left+P.width-Tt/3,P.top+ft/3),this.bottomRightBorderDoubleOuterBox=ge>0||Be>0?getCurvePoints(P.left+At,P.top+et,ge-Tt/3,Be-qt/3,CORNER.BOTTOM_RIGHT):new Vector(P.left+P.width-Tt/3,P.top+P.height-qt/3),this.bottomLeftBorderDoubleOuterBox=ze>0||Oe>0?getCurvePoints(P.left+Vt/3,P.top+nt,ze-Vt/3,Oe-qt/3,CORNER.BOTTOM_LEFT):new Vector(P.left+Vt/3,P.top+P.height-qt/3),this.topLeftBorderDoubleInnerBox=Y>0||re>0?getCurvePoints(P.left+Vt*2/3,P.top+ft*2/3,Y-Vt*2/3,re-ft*2/3,CORNER.TOP_LEFT):new Vector(P.left+Vt*2/3,P.top+ft*2/3),this.topRightBorderDoubleInnerBox=Y>0||re>0?getCurvePoints(P.left+ut,P.top+ft*2/3,ne-Tt*2/3,ae-ft*2/3,CORNER.TOP_RIGHT):new Vector(P.left+P.width-Tt*2/3,P.top+ft*2/3),this.bottomRightBorderDoubleInnerBox=ge>0||Be>0?getCurvePoints(P.left+At,P.top+et,ge-Tt*2/3,Be-qt*2/3,CORNER.BOTTOM_RIGHT):new Vector(P.left+P.width-Tt*2/3,P.top+P.height-qt*2/3),this.bottomLeftBorderDoubleInnerBox=ze>0||Oe>0?getCurvePoints(P.left+Vt*2/3,P.top+nt,ze-Vt*2/3,Oe-qt*2/3,CORNER.BOTTOM_LEFT):new Vector(P.left+Vt*2/3,P.top+P.height-qt*2/3),this.topLeftBorderStroke=Y>0||re>0?getCurvePoints(P.left+Vt/2,P.top+ft/2,Y-Vt/2,re-ft/2,CORNER.TOP_LEFT):new Vector(P.left+Vt/2,P.top+ft/2),this.topRightBorderStroke=Y>0||re>0?getCurvePoints(P.left+ut,P.top+ft/2,ne-Tt/2,ae-ft/2,CORNER.TOP_RIGHT):new Vector(P.left+P.width-Tt/2,P.top+ft/2),this.bottomRightBorderStroke=ge>0||Be>0?getCurvePoints(P.left+At,P.top+et,ge-Tt/2,Be-qt/2,CORNER.BOTTOM_RIGHT):new Vector(P.left+P.width-Tt/2,P.top+P.height-qt/2),this.bottomLeftBorderStroke=ze>0||Oe>0?getCurvePoints(P.left+Vt/2,P.top+nt,ze-Vt/2,Oe-qt/2,CORNER.BOTTOM_LEFT):new Vector(P.left+Vt/2,P.top+P.height-qt/2),this.topLeftBorderBox=Y>0||re>0?getCurvePoints(P.left,P.top,Y,re,CORNER.TOP_LEFT):new Vector(P.left,P.top),this.topRightBorderBox=ne>0||ae>0?getCurvePoints(P.left+ut,P.top,ne,ae,CORNER.TOP_RIGHT):new Vector(P.left+P.width,P.top),this.bottomRightBorderBox=ge>0||Be>0?getCurvePoints(P.left+At,P.top+et,ge,Be,CORNER.BOTTOM_RIGHT):new Vector(P.left+P.width,P.top+P.height),this.bottomLeftBorderBox=ze>0||Oe>0?getCurvePoints(P.left,P.top+nt,ze,Oe,CORNER.BOTTOM_LEFT):new Vector(P.left,P.top+P.height),this.topLeftPaddingBox=Y>0||re>0?getCurvePoints(P.left+Vt,P.top+ft,Math.max(0,Y-Vt),Math.max(0,re-ft),CORNER.TOP_LEFT):new Vector(P.left+Vt,P.top+ft),this.topRightPaddingBox=ne>0||ae>0?getCurvePoints(P.left+Math.min(ut,P.width-Tt),P.top+ft,ut>P.width+Tt?0:Math.max(0,ne-Tt),Math.max(0,ae-ft),CORNER.TOP_RIGHT):new Vector(P.left+P.width-Tt,P.top+ft),this.bottomRightPaddingBox=ge>0||Be>0?getCurvePoints(P.left+Math.min(At,P.width-Vt),P.top+Math.min(et,P.height-qt),Math.max(0,ge-Tt),Math.max(0,Be-qt),CORNER.BOTTOM_RIGHT):new Vector(P.left+P.width-Tt,P.top+P.height-qt),this.bottomLeftPaddingBox=ze>0||Oe>0?getCurvePoints(P.left+Vt,P.top+Math.min(nt,P.height-qt),Math.max(0,ze-Vt),Math.max(0,Oe-qt),CORNER.BOTTOM_LEFT):new Vector(P.left+Vt,P.top+P.height-qt),this.topLeftContentBox=Y>0||re>0?getCurvePoints(P.left+Vt+Yt,P.top+ft+vt,Math.max(0,Y-(Vt+Yt)),Math.max(0,re-(ft+vt)),CORNER.TOP_LEFT):new Vector(P.left+Vt+Yt,P.top+ft+vt),this.topRightContentBox=ne>0||ae>0?getCurvePoints(P.left+Math.min(ut,P.width+Vt+Yt),P.top+ft+vt,ut>P.width+Vt+Yt?0:ne-Vt+Yt,ae-(ft+vt),CORNER.TOP_RIGHT):new Vector(P.left+P.width-(Tt+Ut),P.top+ft+vt),this.bottomRightContentBox=ge>0||Be>0?getCurvePoints(P.left+Math.min(At,P.width-(Vt+Yt)),P.top+Math.min(et,P.height+ft+vt),Math.max(0,ge-(Tt+Ut)),Be-(qt+Pt),CORNER.BOTTOM_RIGHT):new Vector(P.left+P.width-(Tt+Ut),P.top+P.height-(qt+Pt)),this.bottomLeftContentBox=ze>0||Oe>0?getCurvePoints(P.left+Vt+Yt,P.top+nt,Math.max(0,ze-(Vt+Yt)),Oe-(qt+Pt),CORNER.BOTTOM_LEFT):new Vector(P.left+Vt+Yt,P.top+P.height-(qt+Pt))}return g}(),CORNER;(function(g){g[g.TOP_LEFT=0]="TOP_LEFT",g[g.TOP_RIGHT=1]="TOP_RIGHT",g[g.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",g[g.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(CORNER||(CORNER={}));var getCurvePoints=function(g,B,M,P,K){var Y=4*((Math.sqrt(2)-1)/3),re=M*Y,D=P*Y,ne=g+M,ae=B+P;switch(K){case CORNER.TOP_LEFT:return new BezierCurve(new Vector(g,ae),new Vector(g,ae-D),new Vector(ne-re,B),new Vector(ne,B));case CORNER.TOP_RIGHT:return new BezierCurve(new Vector(g,B),new Vector(g+re,B),new Vector(ne,ae-D),new Vector(ne,ae));case CORNER.BOTTOM_RIGHT:return new BezierCurve(new Vector(ne,B),new Vector(ne,B+D),new Vector(g+re,ae),new Vector(g,ae));case CORNER.BOTTOM_LEFT:default:return new BezierCurve(new Vector(ne,ae),new Vector(ne-re,ae),new Vector(g,B+D),new Vector(g,B))}},calculateBorderBoxPath=function(g){return[g.topLeftBorderBox,g.topRightBorderBox,g.bottomRightBorderBox,g.bottomLeftBorderBox]},calculateContentBoxPath=function(g){return[g.topLeftContentBox,g.topRightContentBox,g.bottomRightContentBox,g.bottomLeftContentBox]},calculatePaddingBoxPath=function(g){return[g.topLeftPaddingBox,g.topRightPaddingBox,g.bottomRightPaddingBox,g.bottomLeftPaddingBox]},TransformEffect=function(){function g(B,M,P){this.offsetX=B,this.offsetY=M,this.matrix=P,this.type=0,this.target=6}return g}(),ClipEffect=function(){function g(B,M){this.path=B,this.target=M,this.type=1}return g}(),OpacityEffect=function(){function g(B){this.opacity=B,this.type=2,this.target=6}return g}(),isTransformEffect=function(g){return g.type===0},isClipEffect=function(g){return g.type===1},isOpacityEffect=function(g){return g.type===2},equalPath=function(g,B){return g.length===B.length?g.some(function(M,P){return M===B[P]}):!1},transformPath=function(g,B,M,P,K){return g.map(function(Y,re){switch(re){case 0:return Y.add(B,M);case 1:return Y.add(B+P,M);case 2:return Y.add(B+P,M+K);case 3:return Y.add(B,M+K)}return Y})},StackingContext=function(){function g(B){this.element=B,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return g}(),ElementPaint=function(){function g(B,M){if(this.container=B,this.parent=M,this.effects=[],this.curves=new BoundCurves(this.container),this.container.styles.opacity<1&&this.effects.push(new OpacityEffect(this.container.styles.opacity)),this.container.styles.transform!==null){var P=this.container.bounds.left+this.container.styles.transformOrigin[0].number,K=this.container.bounds.top+this.container.styles.transformOrigin[1].number,Y=this.container.styles.transform;this.effects.push(new TransformEffect(P,K,Y))}if(this.container.styles.overflowX!==0){var re=calculateBorderBoxPath(this.curves),D=calculatePaddingBoxPath(this.curves);equalPath(re,D)?this.effects.push(new ClipEffect(re,6)):(this.effects.push(new ClipEffect(re,2)),this.effects.push(new ClipEffect(D,4)))}}return g.prototype.getEffects=function(B){for(var M=[2,3].indexOf(this.container.styles.position)===-1,P=this.parent,K=this.effects.slice(0);P;){var Y=P.effects.filter(function(ne){return!isClipEffect(ne)});if(M||P.container.styles.position!==0||!P.parent){if(K.unshift.apply(K,Y),M=[2,3].indexOf(P.container.styles.position)===-1,P.container.styles.overflowX!==0){var re=calculateBorderBoxPath(P.curves),D=calculatePaddingBoxPath(P.curves);equalPath(re,D)||K.unshift(new ClipEffect(D,6))}}else K.unshift.apply(K,Y);P=P.parent}return K.filter(function(ne){return contains(ne.target,B)})},g}(),parseStackTree=function(g,B,M,P){g.container.elements.forEach(function(K){var Y=contains(K.flags,4),re=contains(K.flags,2),D=new ElementPaint(K,g);contains(K.styles.display,2048)&&P.push(D);var ne=contains(K.flags,8)?[]:P;if(Y||re){var ae=Y||K.styles.isPositioned()?M:B,ue=new StackingContext(D);if(K.styles.isPositioned()||K.styles.opacity<1||K.styles.isTransformed()){var ge=K.styles.zIndex.order;if(ge<0){var Be=0;ae.negativeZIndex.some(function(ze,Oe){return ge>ze.element.container.styles.zIndex.order?(Be=Oe,!1):Be>0}),ae.negativeZIndex.splice(Be,0,ue)}else if(ge>0){var De=0;ae.positiveZIndex.some(function(ze,Oe){return ge>=ze.element.container.styles.zIndex.order?(De=Oe+1,!1):De>0}),ae.positiveZIndex.splice(De,0,ue)}else ae.zeroOrAutoZIndexOrTransformedOrOpacity.push(ue)}else K.styles.isFloating()?ae.nonPositionedFloats.push(ue):ae.nonPositionedInlineLevel.push(ue);parseStackTree(D,ue,Y?ue:M,ne)}else K.styles.isInlineLevel()?B.inlineLevel.push(D):B.nonInlineLevel.push(D),parseStackTree(D,B,M,ne);contains(K.flags,8)&&processListItems(K,ne)})},processListItems=function(g,B){for(var M=g instanceof OLElementContainer?g.start:1,P=g instanceof OLElementContainer?g.reversed:!1,K=0;K<B.length;K++){var Y=B[K];Y.container instanceof LIElementContainer&&typeof Y.container.value=="number"&&Y.container.value!==0&&(M=Y.container.value),Y.listValue=createCounterText(M,Y.container.styles.listStyleType,!0),M+=P?-1:1}},parseStackingContexts=function(g){var B=new ElementPaint(g,null),M=new StackingContext(B),P=[];return parseStackTree(B,M,M,P),processListItems(B.container,P),M},parsePathForBorder=function(g,B){switch(B){case 0:return createPathFromCurves(g.topLeftBorderBox,g.topLeftPaddingBox,g.topRightBorderBox,g.topRightPaddingBox);case 1:return createPathFromCurves(g.topRightBorderBox,g.topRightPaddingBox,g.bottomRightBorderBox,g.bottomRightPaddingBox);case 2:return createPathFromCurves(g.bottomRightBorderBox,g.bottomRightPaddingBox,g.bottomLeftBorderBox,g.bottomLeftPaddingBox);case 3:default:return createPathFromCurves(g.bottomLeftBorderBox,g.bottomLeftPaddingBox,g.topLeftBorderBox,g.topLeftPaddingBox)}},parsePathForBorderDoubleOuter=function(g,B){switch(B){case 0:return createPathFromCurves(g.topLeftBorderBox,g.topLeftBorderDoubleOuterBox,g.topRightBorderBox,g.topRightBorderDoubleOuterBox);case 1:return createPathFromCurves(g.topRightBorderBox,g.topRightBorderDoubleOuterBox,g.bottomRightBorderBox,g.bottomRightBorderDoubleOuterBox);case 2:return createPathFromCurves(g.bottomRightBorderBox,g.bottomRightBorderDoubleOuterBox,g.bottomLeftBorderBox,g.bottomLeftBorderDoubleOuterBox);case 3:default:return createPathFromCurves(g.bottomLeftBorderBox,g.bottomLeftBorderDoubleOuterBox,g.topLeftBorderBox,g.topLeftBorderDoubleOuterBox)}},parsePathForBorderDoubleInner=function(g,B){switch(B){case 0:return createPathFromCurves(g.topLeftBorderDoubleInnerBox,g.topLeftPaddingBox,g.topRightBorderDoubleInnerBox,g.topRightPaddingBox);case 1:return createPathFromCurves(g.topRightBorderDoubleInnerBox,g.topRightPaddingBox,g.bottomRightBorderDoubleInnerBox,g.bottomRightPaddingBox);case 2:return createPathFromCurves(g.bottomRightBorderDoubleInnerBox,g.bottomRightPaddingBox,g.bottomLeftBorderDoubleInnerBox,g.bottomLeftPaddingBox);case 3:default:return createPathFromCurves(g.bottomLeftBorderDoubleInnerBox,g.bottomLeftPaddingBox,g.topLeftBorderDoubleInnerBox,g.topLeftPaddingBox)}},parsePathForBorderStroke=function(g,B){switch(B){case 0:return createStrokePathFromCurves(g.topLeftBorderStroke,g.topRightBorderStroke);case 1:return createStrokePathFromCurves(g.topRightBorderStroke,g.bottomRightBorderStroke);case 2:return createStrokePathFromCurves(g.bottomRightBorderStroke,g.bottomLeftBorderStroke);case 3:default:return createStrokePathFromCurves(g.bottomLeftBorderStroke,g.topLeftBorderStroke)}},createStrokePathFromCurves=function(g,B){var M=[];return isBezierCurve(g)?M.push(g.subdivide(.5,!1)):M.push(g),isBezierCurve(B)?M.push(B.subdivide(.5,!0)):M.push(B),M},createPathFromCurves=function(g,B,M,P){var K=[];return isBezierCurve(g)?K.push(g.subdivide(.5,!1)):K.push(g),isBezierCurve(M)?K.push(M.subdivide(.5,!0)):K.push(M),isBezierCurve(P)?K.push(P.subdivide(.5,!0).reverse()):K.push(P),isBezierCurve(B)?K.push(B.subdivide(.5,!1).reverse()):K.push(B),K},paddingBox=function(g){var B=g.bounds,M=g.styles;return B.add(M.borderLeftWidth,M.borderTopWidth,-(M.borderRightWidth+M.borderLeftWidth),-(M.borderTopWidth+M.borderBottomWidth))},contentBox=function(g){var B=g.styles,M=g.bounds,P=getAbsoluteValue(B.paddingLeft,M.width),K=getAbsoluteValue(B.paddingRight,M.width),Y=getAbsoluteValue(B.paddingTop,M.width),re=getAbsoluteValue(B.paddingBottom,M.width);return M.add(P+B.borderLeftWidth,Y+B.borderTopWidth,-(B.borderRightWidth+B.borderLeftWidth+P+K),-(B.borderTopWidth+B.borderBottomWidth+Y+re))},calculateBackgroundPositioningArea=function(g,B){return g===0?B.bounds:g===2?contentBox(B):paddingBox(B)},calculateBackgroundPaintingArea=function(g,B){return g===0?B.bounds:g===2?contentBox(B):paddingBox(B)},calculateBackgroundRendering=function(g,B,M){var P=calculateBackgroundPositioningArea(getBackgroundValueForIndex(g.styles.backgroundOrigin,B),g),K=calculateBackgroundPaintingArea(getBackgroundValueForIndex(g.styles.backgroundClip,B),g),Y=calculateBackgroundSize(getBackgroundValueForIndex(g.styles.backgroundSize,B),M,P),re=Y[0],D=Y[1],ne=getAbsoluteValueForTuple(getBackgroundValueForIndex(g.styles.backgroundPosition,B),P.width-re,P.height-D),ae=calculateBackgroundRepeatPath(getBackgroundValueForIndex(g.styles.backgroundRepeat,B),ne,Y,P,K),ue=Math.round(P.left+ne[0]),ge=Math.round(P.top+ne[1]);return[ae,ue,ge,re,D]},isAuto=function(g){return isIdentToken(g)&&g.value===BACKGROUND_SIZE.AUTO},hasIntrinsicValue=function(g){return typeof g=="number"},calculateBackgroundSize=function(g,B,M){var P=B[0],K=B[1],Y=B[2],re=g[0],D=g[1];if(!re)return[0,0];if(isLengthPercentage(re)&&D&&isLengthPercentage(D))return[getAbsoluteValue(re,M.width),getAbsoluteValue(D,M.height)];var ne=hasIntrinsicValue(Y);if(isIdentToken(re)&&(re.value===BACKGROUND_SIZE.CONTAIN||re.value===BACKGROUND_SIZE.COVER)){if(hasIntrinsicValue(Y)){var ae=M.width/M.height;return ae<Y!=(re.value===BACKGROUND_SIZE.COVER)?[M.width,M.width/Y]:[M.height*Y,M.height]}return[M.width,M.height]}var ue=hasIntrinsicValue(P),ge=hasIntrinsicValue(K),Be=ue||ge;if(isAuto(re)&&(!D||isAuto(D))){if(ue&&ge)return[P,K];if(!ne&&!Be)return[M.width,M.height];if(Be&&ne){var De=ue?P:K*Y,ze=ge?K:P/Y;return[De,ze]}var Oe=ue?P:M.width,Je=ge?K:M.height;return[Oe,Je]}if(ne){var We=0,ut=0;return isLengthPercentage(re)?We=getAbsoluteValue(re,M.width):isLengthPercentage(D)&&(ut=getAbsoluteValue(D,M.height)),isAuto(re)?We=ut*Y:(!D||isAuto(D))&&(ut=We/Y),[We,ut]}var et=null,At=null;if(isLengthPercentage(re)?et=getAbsoluteValue(re,M.width):D&&isLengthPercentage(D)&&(At=getAbsoluteValue(D,M.height)),et!==null&&(!D||isAuto(D))&&(At=ue&&ge?et/P*K:M.height),At!==null&&isAuto(re)&&(et=ue&&ge?At/K*P:M.width),et!==null&&At!==null)return[et,At];throw new Error("Unable to calculate background-size for element")},getBackgroundValueForIndex=function(g,B){var M=g[B];return typeof M>"u"?g[0]:M},calculateBackgroundRepeatPath=function(g,B,M,P,K){var Y=B[0],re=B[1],D=M[0],ne=M[1];switch(g){case 2:return[new Vector(Math.round(P.left),Math.round(P.top+re)),new Vector(Math.round(P.left+P.width),Math.round(P.top+re)),new Vector(Math.round(P.left+P.width),Math.round(ne+P.top+re)),new Vector(Math.round(P.left),Math.round(ne+P.top+re))];case 3:return[new Vector(Math.round(P.left+Y),Math.round(P.top)),new Vector(Math.round(P.left+Y+D),Math.round(P.top)),new Vector(Math.round(P.left+Y+D),Math.round(P.height+P.top)),new Vector(Math.round(P.left+Y),Math.round(P.height+P.top))];case 1:return[new Vector(Math.round(P.left+Y),Math.round(P.top+re)),new Vector(Math.round(P.left+Y+D),Math.round(P.top+re)),new Vector(Math.round(P.left+Y+D),Math.round(P.top+re+ne)),new Vector(Math.round(P.left+Y),Math.round(P.top+re+ne))];default:return[new Vector(Math.round(K.left),Math.round(K.top)),new Vector(Math.round(K.left+K.width),Math.round(K.top)),new Vector(Math.round(K.left+K.width),Math.round(K.height+K.top)),new Vector(Math.round(K.left),Math.round(K.height+K.top))]}},SMALL_IMAGE="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",SAMPLE_TEXT="Hidden Text",FontMetrics=function(){function g(B){this._data={},this._document=B}return g.prototype.parseMetrics=function(B,M){var P=this._document.createElement("div"),K=this._document.createElement("img"),Y=this._document.createElement("span"),re=this._document.body;P.style.visibility="hidden",P.style.fontFamily=B,P.style.fontSize=M,P.style.margin="0",P.style.padding="0",P.style.whiteSpace="nowrap",re.appendChild(P),K.src=SMALL_IMAGE,K.width=1,K.height=1,K.style.margin="0",K.style.padding="0",K.style.verticalAlign="baseline",Y.style.fontFamily=B,Y.style.fontSize=M,Y.style.margin="0",Y.style.padding="0",Y.appendChild(this._document.createTextNode(SAMPLE_TEXT)),P.appendChild(Y),P.appendChild(K);var D=K.offsetTop-Y.offsetTop+2;P.removeChild(Y),P.appendChild(this._document.createTextNode(SAMPLE_TEXT)),P.style.lineHeight="normal",K.style.verticalAlign="super";var ne=K.offsetTop-P.offsetTop+2;return re.removeChild(P),{baseline:D,middle:ne}},g.prototype.getMetrics=function(B,M){var P=B+" "+M;return typeof this._data[P]>"u"&&(this._data[P]=this.parseMetrics(B,M)),this._data[P]},g}(),Renderer=function(){function g(B,M){this.context=B,this.options=M}return g}(),MASK_OFFSET=1e4,CanvasRenderer=function(g){__extends(B,g);function B(M,P){var K=g.call(this,M,P)||this;return K._activeEffects=[],K.canvas=P.canvas?P.canvas:document.createElement("canvas"),K.ctx=K.canvas.getContext("2d"),P.canvas||(K.canvas.width=Math.floor(P.width*P.scale),K.canvas.height=Math.floor(P.height*P.scale),K.canvas.style.width=P.width+"px",K.canvas.style.height=P.height+"px"),K.fontMetrics=new FontMetrics(document),K.ctx.scale(K.options.scale,K.options.scale),K.ctx.translate(-P.x,-P.y),K.ctx.textBaseline="bottom",K._activeEffects=[],K.context.logger.debug("Canvas renderer initialized ("+P.width+"x"+P.height+") with scale "+P.scale),K}return B.prototype.applyEffects=function(M){for(var P=this;this._activeEffects.length;)this.popEffect();M.forEach(function(K){return P.applyEffect(K)})},B.prototype.applyEffect=function(M){this.ctx.save(),isOpacityEffect(M)&&(this.ctx.globalAlpha=M.opacity),isTransformEffect(M)&&(this.ctx.translate(M.offsetX,M.offsetY),this.ctx.transform(M.matrix[0],M.matrix[1],M.matrix[2],M.matrix[3],M.matrix[4],M.matrix[5]),this.ctx.translate(-M.offsetX,-M.offsetY)),isClipEffect(M)&&(this.path(M.path),this.ctx.clip()),this._activeEffects.push(M)},B.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},B.prototype.renderStack=function(M){return __awaiter(this,void 0,void 0,function(){var P;return __generator(this,function(K){switch(K.label){case 0:return P=M.element.container.styles,P.isVisible()?[4,this.renderStackContent(M)]:[3,2];case 1:K.sent(),K.label=2;case 2:return[2]}})})},B.prototype.renderNode=function(M){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(P){switch(P.label){case 0:if(contains(M.container.flags,16))debugger;return M.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(M)]:[3,3];case 1:return P.sent(),[4,this.renderNodeContent(M)];case 2:P.sent(),P.label=3;case 3:return[2]}})})},B.prototype.renderTextWithLetterSpacing=function(M,P,K){var Y=this;if(P===0)this.ctx.fillText(M.text,M.bounds.left,M.bounds.top+K);else{var re=segmentGraphemes(M.text);re.reduce(function(D,ne){return Y.ctx.fillText(ne,D,M.bounds.top+K),D+Y.ctx.measureText(ne).width},M.bounds.left)}},B.prototype.createFontStyle=function(M){var P=M.fontVariant.filter(function(re){return re==="normal"||re==="small-caps"}).join(""),K=fixIOSSystemFonts(M.fontFamily).join(", "),Y=isDimensionToken(M.fontSize)?""+M.fontSize.number+M.fontSize.unit:M.fontSize.number+"px";return[[M.fontStyle,P,M.fontWeight,Y,K].join(" "),K,Y]},B.prototype.renderTextNode=function(M,P){return __awaiter(this,void 0,void 0,function(){var K,Y,re,D,ne,ae,ue,ge,Be=this;return __generator(this,function(De){return K=this.createFontStyle(P),Y=K[0],re=K[1],D=K[2],this.ctx.font=Y,this.ctx.direction=P.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",ne=this.fontMetrics.getMetrics(re,D),ae=ne.baseline,ue=ne.middle,ge=P.paintOrder,M.textBounds.forEach(function(ze){ge.forEach(function(Oe){switch(Oe){case 0:Be.ctx.fillStyle=asString(P.color),Be.renderTextWithLetterSpacing(ze,P.letterSpacing,ae);var Je=P.textShadow;Je.length&&ze.text.trim().length&&(Je.slice(0).reverse().forEach(function(We){Be.ctx.shadowColor=asString(We.color),Be.ctx.shadowOffsetX=We.offsetX.number*Be.options.scale,Be.ctx.shadowOffsetY=We.offsetY.number*Be.options.scale,Be.ctx.shadowBlur=We.blur.number,Be.renderTextWithLetterSpacing(ze,P.letterSpacing,ae)}),Be.ctx.shadowColor="",Be.ctx.shadowOffsetX=0,Be.ctx.shadowOffsetY=0,Be.ctx.shadowBlur=0),P.textDecorationLine.length&&(Be.ctx.fillStyle=asString(P.textDecorationColor||P.color),P.textDecorationLine.forEach(function(We){switch(We){case 1:Be.ctx.fillRect(ze.bounds.left,Math.round(ze.bounds.top+ae),ze.bounds.width,1);break;case 2:Be.ctx.fillRect(ze.bounds.left,Math.round(ze.bounds.top),ze.bounds.width,1);break;case 3:Be.ctx.fillRect(ze.bounds.left,Math.ceil(ze.bounds.top+ue),ze.bounds.width,1);break}}));break;case 1:P.webkitTextStrokeWidth&&ze.text.trim().length&&(Be.ctx.strokeStyle=asString(P.webkitTextStrokeColor),Be.ctx.lineWidth=P.webkitTextStrokeWidth,Be.ctx.lineJoin=window.chrome?"miter":"round",Be.ctx.strokeText(ze.text,ze.bounds.left,ze.bounds.top+ae)),Be.ctx.strokeStyle="",Be.ctx.lineWidth=0,Be.ctx.lineJoin="miter";break}})}),[2]})})},B.prototype.renderReplacedElement=function(M,P,K){if(K&&M.intrinsicWidth>0&&M.intrinsicHeight>0){var Y=contentBox(M),re=calculatePaddingBoxPath(P);this.path(re),this.ctx.save(),this.ctx.clip(),this.ctx.drawImage(K,0,0,M.intrinsicWidth,M.intrinsicHeight,Y.left,Y.top,Y.width,Y.height),this.ctx.restore()}},B.prototype.renderNodeContent=function(M){return __awaiter(this,void 0,void 0,function(){var P,K,Y,re,D,ne,ut,ut,ae,ue,ge,Be,At,De,ze,nt,Oe,Je,We,ut,et,At,nt;return __generator(this,function(ft){switch(ft.label){case 0:this.applyEffects(M.getEffects(4)),P=M.container,K=M.curves,Y=P.styles,re=0,D=P.textNodes,ft.label=1;case 1:return re<D.length?(ne=D[re],[4,this.renderTextNode(ne,Y)]):[3,4];case 2:ft.sent(),ft.label=3;case 3:return re++,[3,1];case 4:if(!(P instanceof ImageElementContainer))return[3,8];ft.label=5;case 5:return ft.trys.push([5,7,,8]),[4,this.context.cache.match(P.src)];case 6:return ut=ft.sent(),this.renderReplacedElement(P,K,ut),[3,8];case 7:return ft.sent(),this.context.logger.error("Error loading image "+P.src),[3,8];case 8:if(P instanceof CanvasElementContainer&&this.renderReplacedElement(P,K,P.canvas),!(P instanceof SVGElementContainer))return[3,12];ft.label=9;case 9:return ft.trys.push([9,11,,12]),[4,this.context.cache.match(P.svg)];case 10:return ut=ft.sent(),this.renderReplacedElement(P,K,ut),[3,12];case 11:return ft.sent(),this.context.logger.error("Error loading svg "+P.svg.substring(0,255)),[3,12];case 12:return P instanceof IFrameElementContainer&&P.tree?(ae=new B(this.context,{scale:this.options.scale,backgroundColor:P.backgroundColor,x:0,y:0,width:P.width,height:P.height}),[4,ae.render(P.tree)]):[3,14];case 13:ue=ft.sent(),P.width&&P.height&&this.ctx.drawImage(ue,0,0,P.width,P.height,P.bounds.left,P.bounds.top,P.bounds.width,P.bounds.height),ft.label=14;case 14:if(P instanceof InputElementContainer&&(ge=Math.min(P.bounds.width,P.bounds.height),P.type===CHECKBOX?P.checked&&(this.ctx.save(),this.path([new Vector(P.bounds.left+ge*.39363,P.bounds.top+ge*.79),new Vector(P.bounds.left+ge*.16,P.bounds.top+ge*.5549),new Vector(P.bounds.left+ge*.27347,P.bounds.top+ge*.44071),new Vector(P.bounds.left+ge*.39694,P.bounds.top+ge*.5649),new Vector(P.bounds.left+ge*.72983,P.bounds.top+ge*.23),new Vector(P.bounds.left+ge*.84,P.bounds.top+ge*.34085),new Vector(P.bounds.left+ge*.39363,P.bounds.top+ge*.79)]),this.ctx.fillStyle=asString(INPUT_COLOR),this.ctx.fill(),this.ctx.restore()):P.type===RADIO&&P.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(P.bounds.left+ge/2,P.bounds.top+ge/2,ge/4,0,Math.PI*2,!0),this.ctx.fillStyle=asString(INPUT_COLOR),this.ctx.fill(),this.ctx.restore())),isTextInputElement(P)&&P.value.length){switch(Be=this.createFontStyle(Y),At=Be[0],De=Be[1],ze=this.fontMetrics.getMetrics(At,De).baseline,this.ctx.font=At,this.ctx.fillStyle=asString(Y.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=canvasTextAlign(P.styles.textAlign),nt=contentBox(P),Oe=0,P.styles.textAlign){case 1:Oe+=nt.width/2;break;case 2:Oe+=nt.width;break}Je=nt.add(Oe,0,0,-nt.height/2+1),this.ctx.save(),this.path([new Vector(nt.left,nt.top),new Vector(nt.left+nt.width,nt.top),new Vector(nt.left+nt.width,nt.top+nt.height),new Vector(nt.left,nt.top+nt.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new TextBounds(P.value,Je),Y.letterSpacing,ze),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!contains(P.styles.display,2048))return[3,20];if(P.styles.listStyleImage===null)return[3,19];if(We=P.styles.listStyleImage,We.type!==0)return[3,18];ut=void 0,et=We.url,ft.label=15;case 15:return ft.trys.push([15,17,,18]),[4,this.context.cache.match(et)];case 16:return ut=ft.sent(),this.ctx.drawImage(ut,P.bounds.left-(ut.width+10),P.bounds.top),[3,18];case 17:return ft.sent(),this.context.logger.error("Error loading list-style-image "+et),[3,18];case 18:return[3,20];case 19:M.listValue&&P.styles.listStyleType!==-1&&(At=this.createFontStyle(Y)[0],this.ctx.font=At,this.ctx.fillStyle=asString(Y.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",nt=new Bounds(P.bounds.left,P.bounds.top+getAbsoluteValue(P.styles.paddingTop,P.bounds.width),P.bounds.width,computeLineHeight(Y.lineHeight,Y.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new TextBounds(M.listValue,nt),Y.letterSpacing,computeLineHeight(Y.lineHeight,Y.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),ft.label=20;case 20:return[2]}})})},B.prototype.renderStackContent=function(M){return __awaiter(this,void 0,void 0,function(){var P,K,We,Y,re,We,D,ne,We,ae,ue,We,ge,Be,We,De,ze,We,Oe,Je,We;return __generator(this,function(ut){switch(ut.label){case 0:if(contains(M.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(M.element)];case 1:ut.sent(),P=0,K=M.negativeZIndex,ut.label=2;case 2:return P<K.length?(We=K[P],[4,this.renderStack(We)]):[3,5];case 3:ut.sent(),ut.label=4;case 4:return P++,[3,2];case 5:return[4,this.renderNodeContent(M.element)];case 6:ut.sent(),Y=0,re=M.nonInlineLevel,ut.label=7;case 7:return Y<re.length?(We=re[Y],[4,this.renderNode(We)]):[3,10];case 8:ut.sent(),ut.label=9;case 9:return Y++,[3,7];case 10:D=0,ne=M.nonPositionedFloats,ut.label=11;case 11:return D<ne.length?(We=ne[D],[4,this.renderStack(We)]):[3,14];case 12:ut.sent(),ut.label=13;case 13:return D++,[3,11];case 14:ae=0,ue=M.nonPositionedInlineLevel,ut.label=15;case 15:return ae<ue.length?(We=ue[ae],[4,this.renderStack(We)]):[3,18];case 16:ut.sent(),ut.label=17;case 17:return ae++,[3,15];case 18:ge=0,Be=M.inlineLevel,ut.label=19;case 19:return ge<Be.length?(We=Be[ge],[4,this.renderNode(We)]):[3,22];case 20:ut.sent(),ut.label=21;case 21:return ge++,[3,19];case 22:De=0,ze=M.zeroOrAutoZIndexOrTransformedOrOpacity,ut.label=23;case 23:return De<ze.length?(We=ze[De],[4,this.renderStack(We)]):[3,26];case 24:ut.sent(),ut.label=25;case 25:return De++,[3,23];case 26:Oe=0,Je=M.positiveZIndex,ut.label=27;case 27:return Oe<Je.length?(We=Je[Oe],[4,this.renderStack(We)]):[3,30];case 28:ut.sent(),ut.label=29;case 29:return Oe++,[3,27];case 30:return[2]}})})},B.prototype.mask=function(M){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(M.slice(0).reverse()),this.ctx.closePath()},B.prototype.path=function(M){this.ctx.beginPath(),this.formatPath(M),this.ctx.closePath()},B.prototype.formatPath=function(M){var P=this;M.forEach(function(K,Y){var re=isBezierCurve(K)?K.start:K;Y===0?P.ctx.moveTo(re.x,re.y):P.ctx.lineTo(re.x,re.y),isBezierCurve(K)&&P.ctx.bezierCurveTo(K.startControl.x,K.startControl.y,K.endControl.x,K.endControl.y,K.end.x,K.end.y)})},B.prototype.renderRepeat=function(M,P,K,Y){this.path(M),this.ctx.fillStyle=P,this.ctx.translate(K,Y),this.ctx.fill(),this.ctx.translate(-K,-Y)},B.prototype.resizeImage=function(M,P,K){var Y;if(M.width===P&&M.height===K)return M;var re=(Y=this.canvas.ownerDocument)!==null&&Y!==void 0?Y:document,D=re.createElement("canvas");D.width=Math.max(1,P),D.height=Math.max(1,K);var ne=D.getContext("2d");return ne.drawImage(M,0,0,M.width,M.height,0,0,P,K),D},B.prototype.renderBackgroundImage=function(M){return __awaiter(this,void 0,void 0,function(){var P,K,Y,re,D,ne;return __generator(this,function(ae){switch(ae.label){case 0:P=M.styles.backgroundImage.length-1,K=function(ue){var ge,Be,De,vt,Ei,Li,Yt,Ai,qt,ze,vt,Ei,Li,Yt,Ai,Oe,Je,We,ut,et,At,nt,ft,Tt,qt,Vt,vt,Ut,Pt,Yt,Ai,Ri,Ei,Li,Yi,vi,d,b,S,k,R,W;return __generator(this,function(se){switch(se.label){case 0:if(ue.type!==0)return[3,5];ge=void 0,Be=ue.url,se.label=1;case 1:return se.trys.push([1,3,,4]),[4,Y.context.cache.match(Be)];case 2:return ge=se.sent(),[3,4];case 3:return se.sent(),Y.context.logger.error("Error loading background-image "+Be),[3,4];case 4:return ge&&(De=calculateBackgroundRendering(M,P,[ge.width,ge.height,ge.width/ge.height]),vt=De[0],Ei=De[1],Li=De[2],Yt=De[3],Ai=De[4],qt=Y.ctx.createPattern(Y.resizeImage(ge,Yt,Ai),"repeat"),Y.renderRepeat(vt,qt,Ei,Li)),[3,6];case 5:isLinearGradient(ue)?(ze=calculateBackgroundRendering(M,P,[null,null,null]),vt=ze[0],Ei=ze[1],Li=ze[2],Yt=ze[3],Ai=ze[4],Oe=calculateGradientDirection(ue.angle,Yt,Ai),Je=Oe[0],We=Oe[1],ut=Oe[2],et=Oe[3],At=Oe[4],nt=document.createElement("canvas"),nt.width=Yt,nt.height=Ai,ft=nt.getContext("2d"),Tt=ft.createLinearGradient(We,et,ut,At),processColorStops(ue.stops,Je).forEach(function(le){return Tt.addColorStop(le.stop,asString(le.color))}),ft.fillStyle=Tt,ft.fillRect(0,0,Yt,Ai),Yt>0&&Ai>0&&(qt=Y.ctx.createPattern(nt,"repeat"),Y.renderRepeat(vt,qt,Ei,Li))):isRadialGradient(ue)&&(Vt=calculateBackgroundRendering(M,P,[null,null,null]),vt=Vt[0],Ut=Vt[1],Pt=Vt[2],Yt=Vt[3],Ai=Vt[4],Ri=ue.position.length===0?[FIFTY_PERCENT]:ue.position,Ei=getAbsoluteValue(Ri[0],Yt),Li=getAbsoluteValue(Ri[Ri.length-1],Ai),Yi=calculateRadius(ue,Ei,Li,Yt,Ai),vi=Yi[0],d=Yi[1],vi>0&&d>0&&(b=Y.ctx.createRadialGradient(Ut+Ei,Pt+Li,0,Ut+Ei,Pt+Li,vi),processColorStops(ue.stops,vi*2).forEach(function(le){return b.addColorStop(le.stop,asString(le.color))}),Y.path(vt),Y.ctx.fillStyle=b,vi!==d?(S=M.bounds.left+.5*M.bounds.width,k=M.bounds.top+.5*M.bounds.height,R=d/vi,W=1/R,Y.ctx.save(),Y.ctx.translate(S,k),Y.ctx.transform(1,0,0,R,0,0),Y.ctx.translate(-S,-k),Y.ctx.fillRect(Ut,W*(Pt-k)+k,Yt,Ai*W),Y.ctx.restore()):Y.ctx.fill())),se.label=6;case 6:return P--,[2]}})},Y=this,re=0,D=M.styles.backgroundImage.slice(0).reverse(),ae.label=1;case 1:return re<D.length?(ne=D[re],[5,K(ne)]):[3,4];case 2:ae.sent(),ae.label=3;case 3:return re++,[3,1];case 4:return[2]}})})},B.prototype.renderSolidBorder=function(M,P,K){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(Y){return this.path(parsePathForBorder(K,P)),this.ctx.fillStyle=asString(M),this.ctx.fill(),[2]})})},B.prototype.renderDoubleBorder=function(M,P,K,Y){return __awaiter(this,void 0,void 0,function(){var re,D;return __generator(this,function(ne){switch(ne.label){case 0:return P<3?[4,this.renderSolidBorder(M,K,Y)]:[3,2];case 1:return ne.sent(),[2];case 2:return re=parsePathForBorderDoubleOuter(Y,K),this.path(re),this.ctx.fillStyle=asString(M),this.ctx.fill(),D=parsePathForBorderDoubleInner(Y,K),this.path(D),this.ctx.fill(),[2]}})})},B.prototype.renderNodeBackgroundAndBorders=function(M){return __awaiter(this,void 0,void 0,function(){var P,K,Y,re,D,ne,ae,ue,ge=this;return __generator(this,function(Be){switch(Be.label){case 0:return this.applyEffects(M.getEffects(2)),P=M.container.styles,K=!isTransparent(P.backgroundColor)||P.backgroundImage.length,Y=[{style:P.borderTopStyle,color:P.borderTopColor,width:P.borderTopWidth},{style:P.borderRightStyle,color:P.borderRightColor,width:P.borderRightWidth},{style:P.borderBottomStyle,color:P.borderBottomColor,width:P.borderBottomWidth},{style:P.borderLeftStyle,color:P.borderLeftColor,width:P.borderLeftWidth}],re=calculateBackgroundCurvedPaintingArea(getBackgroundValueForIndex(P.backgroundClip,0),M.curves),K||P.boxShadow.length?(this.ctx.save(),this.path(re),this.ctx.clip(),isTransparent(P.backgroundColor)||(this.ctx.fillStyle=asString(P.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(M.container)]):[3,2];case 1:Be.sent(),this.ctx.restore(),P.boxShadow.slice(0).reverse().forEach(function(De){ge.ctx.save();var ze=calculateBorderBoxPath(M.curves),Oe=De.inset?0:MASK_OFFSET,Je=transformPath(ze,-Oe+(De.inset?1:-1)*De.spread.number,(De.inset?1:-1)*De.spread.number,De.spread.number*(De.inset?-2:2),De.spread.number*(De.inset?-2:2));De.inset?(ge.path(ze),ge.ctx.clip(),ge.mask(Je)):(ge.mask(ze),ge.ctx.clip(),ge.path(Je)),ge.ctx.shadowOffsetX=De.offsetX.number+Oe,ge.ctx.shadowOffsetY=De.offsetY.number,ge.ctx.shadowColor=asString(De.color),ge.ctx.shadowBlur=De.blur.number,ge.ctx.fillStyle=De.inset?asString(De.color):"rgba(0,0,0,1)",ge.ctx.fill(),ge.ctx.restore()}),Be.label=2;case 2:D=0,ne=0,ae=Y,Be.label=3;case 3:return ne<ae.length?(ue=ae[ne],ue.style!==0&&!isTransparent(ue.color)&&ue.width>0?ue.style!==2?[3,5]:[4,this.renderDashedDottedBorder(ue.color,ue.width,D,M.curves,2)]:[3,11]):[3,13];case 4:return Be.sent(),[3,11];case 5:return ue.style!==3?[3,7]:[4,this.renderDashedDottedBorder(ue.color,ue.width,D,M.curves,3)];case 6:return Be.sent(),[3,11];case 7:return ue.style!==4?[3,9]:[4,this.renderDoubleBorder(ue.color,ue.width,D,M.curves)];case 8:return Be.sent(),[3,11];case 9:return[4,this.renderSolidBorder(ue.color,D,M.curves)];case 10:Be.sent(),Be.label=11;case 11:D++,Be.label=12;case 12:return ne++,[3,3];case 13:return[2]}})})},B.prototype.renderDashedDottedBorder=function(M,P,K,Y,re){return __awaiter(this,void 0,void 0,function(){var D,ne,ae,ue,ge,Be,De,ze,Oe,Je,We,ut,et,At,nt,ft,nt,ft;return __generator(this,function(Tt){return this.ctx.save(),D=parsePathForBorderStroke(Y,K),ne=parsePathForBorder(Y,K),re===2&&(this.path(ne),this.ctx.clip()),isBezierCurve(ne[0])?(ae=ne[0].start.x,ue=ne[0].start.y):(ae=ne[0].x,ue=ne[0].y),isBezierCurve(ne[1])?(ge=ne[1].end.x,Be=ne[1].end.y):(ge=ne[1].x,Be=ne[1].y),K===0||K===2?De=Math.abs(ae-ge):De=Math.abs(ue-Be),this.ctx.beginPath(),re===3?this.formatPath(D):this.formatPath(ne.slice(0,2)),ze=P<3?P*3:P*2,Oe=P<3?P*2:P,re===3&&(ze=P,Oe=P),Je=!0,De<=ze*2?Je=!1:De<=ze*2+Oe?(We=De/(2*ze+Oe),ze*=We,Oe*=We):(ut=Math.floor((De+Oe)/(ze+Oe)),et=(De-ut*ze)/(ut-1),At=(De-(ut+1)*ze)/ut,Oe=At<=0||Math.abs(Oe-et)<Math.abs(Oe-At)?et:At),Je&&(re===3?this.ctx.setLineDash([0,ze+Oe]):this.ctx.setLineDash([ze,Oe])),re===3?(this.ctx.lineCap="round",this.ctx.lineWidth=P):this.ctx.lineWidth=P*2+1.1,this.ctx.strokeStyle=asString(M),this.ctx.stroke(),this.ctx.setLineDash([]),re===2&&(isBezierCurve(ne[0])&&(nt=ne[3],ft=ne[0],this.ctx.beginPath(),this.formatPath([new Vector(nt.end.x,nt.end.y),new Vector(ft.start.x,ft.start.y)]),this.ctx.stroke()),isBezierCurve(ne[1])&&(nt=ne[1],ft=ne[2],this.ctx.beginPath(),this.formatPath([new Vector(nt.end.x,nt.end.y),new Vector(ft.start.x,ft.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},B.prototype.render=function(M){return __awaiter(this,void 0,void 0,function(){var P;return __generator(this,function(K){switch(K.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=asString(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),P=parseStackingContexts(M),[4,this.renderStack(P)];case 1:return K.sent(),this.applyEffects([]),[2,this.canvas]}})})},B}(Renderer),isTextInputElement=function(g){return g instanceof TextareaElementContainer||g instanceof SelectElementContainer?!0:g instanceof InputElementContainer&&g.type!==RADIO&&g.type!==CHECKBOX},calculateBackgroundCurvedPaintingArea=function(g,B){switch(g){case 0:return calculateBorderBoxPath(B);case 2:return calculateContentBoxPath(B);case 1:default:return calculatePaddingBoxPath(B)}},canvasTextAlign=function(g){switch(g){case 1:return"center";case 2:return"right";case 0:default:return"left"}},iOSBrokenFonts=["-apple-system","system-ui"],fixIOSSystemFonts=function(g){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?g.filter(function(B){return iOSBrokenFonts.indexOf(B)===-1}):g},ForeignObjectRenderer=function(g){__extends(B,g);function B(M,P){var K=g.call(this,M,P)||this;return K.canvas=P.canvas?P.canvas:document.createElement("canvas"),K.ctx=K.canvas.getContext("2d"),K.options=P,K.canvas.width=Math.floor(P.width*P.scale),K.canvas.height=Math.floor(P.height*P.scale),K.canvas.style.width=P.width+"px",K.canvas.style.height=P.height+"px",K.ctx.scale(K.options.scale,K.options.scale),K.ctx.translate(-P.x,-P.y),K.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized ("+P.width+"x"+P.height+" at "+P.x+","+P.y+") with scale "+P.scale),K}return B.prototype.render=function(M){return __awaiter(this,void 0,void 0,function(){var P,K;return __generator(this,function(Y){switch(Y.label){case 0:return P=createForeignObjectSVG(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,M),[4,loadSerializedSVG(P)];case 1:return K=Y.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=asString(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(K,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},B}(Renderer),loadSerializedSVG=function(g){return new Promise(function(B,M){var P=new Image;P.onload=function(){B(P)},P.onerror=M,P.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(new XMLSerializer().serializeToString(g))})},Logger=function(){function g(B){var M=B.id,P=B.enabled;this.id=M,this.enabled=P,this.start=Date.now()}return g.prototype.debug=function(){for(var B=[],M=0;M<arguments.length;M++)B[M]=arguments[M];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,__spreadArray([this.id,this.getTime()+"ms"],B)):this.info.apply(this,B))},g.prototype.getTime=function(){return Date.now()-this.start},g.prototype.info=function(){for(var B=[],M=0;M<arguments.length;M++)B[M]=arguments[M];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,__spreadArray([this.id,this.getTime()+"ms"],B))},g.prototype.warn=function(){for(var B=[],M=0;M<arguments.length;M++)B[M]=arguments[M];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,__spreadArray([this.id,this.getTime()+"ms"],B)):this.info.apply(this,B))},g.prototype.error=function(){for(var B=[],M=0;M<arguments.length;M++)B[M]=arguments[M];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,__spreadArray([this.id,this.getTime()+"ms"],B)):this.info.apply(this,B))},g.instances={},g}(),Context=function(){function g(B,M){var P;this.windowBounds=M,this.instanceName="#"+g.instanceCount++,this.logger=new Logger({id:this.instanceName,enabled:B.logging}),this.cache=(P=B.cache)!==null&&P!==void 0?P:new Cache(this,B)}return g.instanceCount=1,g}(),html2canvas=function(g,B){return B===void 0&&(B={}),renderElement(g,B)};typeof window<"u"&&CacheStorage.setContext(window);var renderElement=function(g,B){return __awaiter(void 0,void 0,void 0,function(){var M,P,K,Y,re,D,ne,ae,ue,ge,Be,De,ze,Oe,Je,We,ut,et,At,nt,Tt,ft,Tt,qt,Vt,vt,Ut,Pt,Yt,Ai,Ri,Ei,Li,Yi,vi,d,b,S,k,R;return __generator(this,function(W){switch(W.label){case 0:if(!g||typeof g!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(M=g.ownerDocument,!M)throw new Error("Element is not attached to a Document");if(P=M.defaultView,!P)throw new Error("Document is not attached to a Window");return K={allowTaint:(qt=B.allowTaint)!==null&&qt!==void 0?qt:!1,imageTimeout:(Vt=B.imageTimeout)!==null&&Vt!==void 0?Vt:15e3,proxy:B.proxy,useCORS:(vt=B.useCORS)!==null&&vt!==void 0?vt:!1},Y=__assign({logging:(Ut=B.logging)!==null&&Ut!==void 0?Ut:!0,cache:B.cache},K),re={windowWidth:(Pt=B.windowWidth)!==null&&Pt!==void 0?Pt:P.innerWidth,windowHeight:(Yt=B.windowHeight)!==null&&Yt!==void 0?Yt:P.innerHeight,scrollX:(Ai=B.scrollX)!==null&&Ai!==void 0?Ai:P.pageXOffset,scrollY:(Ri=B.scrollY)!==null&&Ri!==void 0?Ri:P.pageYOffset},D=new Bounds(re.scrollX,re.scrollY,re.windowWidth,re.windowHeight),ne=new Context(Y,D),ae=(Ei=B.foreignObjectRendering)!==null&&Ei!==void 0?Ei:!1,ue={allowTaint:(Li=B.allowTaint)!==null&&Li!==void 0?Li:!1,onclone:B.onclone,ignoreElements:B.ignoreElements,inlineImages:ae,copyStyles:ae},ne.logger.debug("Starting document clone with size "+D.width+"x"+D.height+" scrolled to "+-D.left+","+-D.top),ge=new DocumentCloner(ne,g,ue),Be=ge.clonedReferenceElement,Be?[4,ge.toIFrame(M,D)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return De=W.sent(),ze=isBodyElement(Be)||isHTMLElement(Be)?parseDocumentSize(Be.ownerDocument):parseBounds(ne,Be),Oe=ze.width,Je=ze.height,We=ze.left,ut=ze.top,et=parseBackgroundColor(ne,Be,B.backgroundColor),At={canvas:B.canvas,backgroundColor:et,scale:(vi=(Yi=B.scale)!==null&&Yi!==void 0?Yi:P.devicePixelRatio)!==null&&vi!==void 0?vi:1,x:((d=B.x)!==null&&d!==void 0?d:0)+We,y:((b=B.y)!==null&&b!==void 0?b:0)+ut,width:(S=B.width)!==null&&S!==void 0?S:Math.ceil(Oe),height:(k=B.height)!==null&&k!==void 0?k:Math.ceil(Je)},ae?(ne.logger.debug("Document cloned, using foreign object rendering"),Tt=new ForeignObjectRenderer(ne,At),[4,Tt.render(Be)]):[3,3];case 2:return nt=W.sent(),[3,5];case 3:return ne.logger.debug("Document cloned, element located at "+We+","+ut+" with size "+Oe+"x"+Je+" using computed rendering"),ne.logger.debug("Starting DOM parsing"),ft=parseTree(ne,Be),et===ft.styles.backgroundColor&&(ft.styles.backgroundColor=COLORS.TRANSPARENT),ne.logger.debug("Starting renderer for element at "+At.x+","+At.y+" with size "+At.width+"x"+At.height),Tt=new CanvasRenderer(ne,At),[4,Tt.render(ft)];case 4:nt=W.sent(),W.label=5;case 5:return(!((R=B.removeContainer)!==null&&R!==void 0)||R)&&(DocumentCloner.destroy(De)||ne.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),ne.logger.debug("Finished rendering"),[2,nt]}})})},parseBackgroundColor=function(g,B,M){var P=B.ownerDocument,K=P.documentElement?parseColor(g,getComputedStyle(P.documentElement).backgroundColor):COLORS.TRANSPARENT,Y=P.body?parseColor(g,getComputedStyle(P.body).backgroundColor):COLORS.TRANSPARENT,re=typeof M=="string"?parseColor(g,M):M===null?COLORS.TRANSPARENT:4294967295;return B===P.documentElement?isTransparent(K)?isTransparent(Y)?re:Y:K:re},raf$1={exports:{}},performanceNow={exports:{}};(function(){var g,B,M,P,K,Y;typeof performance<"u"&&performance!==null&&performance.now?performanceNow.exports=function(){return performance.now()}:typeof process<"u"&&process!==null&&process.hrtime?(performanceNow.exports=function(){return(g()-K)/1e6},B=process.hrtime,g=function(){var re;return re=B(),re[0]*1e9+re[1]},P=g(),Y=process.uptime()*1e9,K=P-Y):Date.now?(performanceNow.exports=function(){return Date.now()-M},M=Date.now()):(performanceNow.exports=function(){return new Date().getTime()-M},M=new Date().getTime())}).call(commonjsGlobal);var performanceNowExports=performanceNow.exports,now=performanceNowExports,root$1=typeof window>"u"?commonjsGlobal:window,vendors=["moz","webkit"],suffix="AnimationFrame",raf=root$1["request"+suffix],caf=root$1["cancel"+suffix]||root$1["cancelRequest"+suffix];for(var i$1=0;!raf&&i$1<vendors.length;i$1++)raf=root$1[vendors[i$1]+"Request"+suffix],caf=root$1[vendors[i$1]+"Cancel"+suffix]||root$1[vendors[i$1]+"CancelRequest"+suffix];if(!raf||!caf){var last=0,id=0,queue=[],frameDuration=1e3/60;raf=function(g){if(queue.length===0){var B=now(),M=Math.max(0,frameDuration-(B-last));last=M+B,setTimeout(function(){var P=queue.slice(0);queue.length=0;for(var K=0;K<P.length;K++)if(!P[K].cancelled)try{P[K].callback(last)}catch(Y){setTimeout(function(){throw Y},0)}},Math.round(M))}return queue.push({handle:++id,callback:g,cancelled:!1}),id},caf=function(g){for(var B=0;B<queue.length;B++)queue[B].handle===g&&(queue[B].cancelled=!0)}}raf$1.exports=function(g){return raf.call(root$1,g)};raf$1.exports.cancel=function(){caf.apply(root$1,arguments)};raf$1.exports.polyfill=function(g){g||(g=root$1),g.requestAnimationFrame=raf,g.cancelAnimationFrame=caf};var rafExports=raf$1.exports;const requestAnimationFrame$1=getDefaultExportFromCjs(rafExports);var rgbcolor=function(g){this.ok=!1,this.alpha=1,g.charAt(0)=="#"&&(g=g.substr(1,6)),g=g.replace(/ /g,""),g=g.toLowerCase();var B={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};g=B[g]||g;for(var M=[{re:/^rgba\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3}),\s*((?:\d?\.)?\d)\)$/,example:["rgba(123, 234, 45, 0.8)","rgba(255,234,245,1.0)"],process:function(ne){return[parseInt(ne[1]),parseInt(ne[2]),parseInt(ne[3]),parseFloat(ne[4])]}},{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(ne){return[parseInt(ne[1]),parseInt(ne[2]),parseInt(ne[3])]}},{re:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,example:["#00ff00","336699"],process:function(ne){return[parseInt(ne[1],16),parseInt(ne[2],16),parseInt(ne[3],16)]}},{re:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,example:["#fb0","f0f"],process:function(ne){return[parseInt(ne[1]+ne[1],16),parseInt(ne[2]+ne[2],16),parseInt(ne[3]+ne[3],16)]}}],P=0;P<M.length;P++){var K=M[P].re,Y=M[P].process,re=K.exec(g);if(re){var D=Y(re);this.r=D[0],this.g=D[1],this.b=D[2],D.length>3&&(this.alpha=D[3]),this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.alpha=this.alpha<0?0:this.alpha>1||isNaN(this.alpha)?1:this.alpha,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toRGBA=function(){return"rgba("+this.r+", "+this.g+", "+this.b+", "+this.alpha+")"},this.toHex=function(){var ne=this.r.toString(16),ae=this.g.toString(16),ue=this.b.toString(16);return ne.length==1&&(ne="0"+ne),ae.length==1&&(ae="0"+ae),ue.length==1&&(ue="0"+ue),"#"+ne+ae+ue},this.getHelpXML=function(){for(var ne=new Array,ae=0;ae<M.length;ae++)for(var ue=M[ae].example,ge=0;ge<ue.length;ge++)ne[ne.length]=ue[ge];for(var Be in B)ne[ne.length]=Be;var De=document.createElement("ul");De.setAttribute("id","rgbcolor-examples");for(var ae=0;ae<ne.length;ae++)try{var ze=document.createElement("li"),Oe=new RGBColor(ne[ae]),Je=document.createElement("div");Je.style.cssText="margin: 3px; border: 1px solid black; background:"+Oe.toHex()+"; color:"+Oe.toHex(),Je.appendChild(document.createTextNode("test"));var We=document.createTextNode(" "+ne[ae]+" -> "+Oe.toRGB()+" -> "+Oe.toHex());ze.appendChild(Je),ze.appendChild(We),De.appendChild(ze)}catch{}return De}};const RGBColor$1=getDefaultExportFromCjs(rgbcolor);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var t=function(g,B){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(M,P){M.__proto__=P}||function(M,P){for(var K in P)Object.prototype.hasOwnProperty.call(P,K)&&(M[K]=P[K])})(g,B)};function r(g,B){if(typeof B!="function"&&B!==null)throw new TypeError("Class extends value "+String(B)+" is not a constructor or null");function M(){this.constructor=g}t(g,B),g.prototype=B===null?Object.create(B):(M.prototype=B.prototype,new M)}function e(g){var B="";Array.isArray(g)||(g=[g]);for(var M=0;M<g.length;M++){var P=g[M];if(P.type===_.CLOSE_PATH)B+="z";else if(P.type===_.HORIZ_LINE_TO)B+=(P.relative?"h":"H")+P.x;else if(P.type===_.VERT_LINE_TO)B+=(P.relative?"v":"V")+P.y;else if(P.type===_.MOVE_TO)B+=(P.relative?"m":"M")+P.x+" "+P.y;else if(P.type===_.LINE_TO)B+=(P.relative?"l":"L")+P.x+" "+P.y;else if(P.type===_.CURVE_TO)B+=(P.relative?"c":"C")+P.x1+" "+P.y1+" "+P.x2+" "+P.y2+" "+P.x+" "+P.y;else if(P.type===_.SMOOTH_CURVE_TO)B+=(P.relative?"s":"S")+P.x2+" "+P.y2+" "+P.x+" "+P.y;else if(P.type===_.QUAD_TO)B+=(P.relative?"q":"Q")+P.x1+" "+P.y1+" "+P.x+" "+P.y;else if(P.type===_.SMOOTH_QUAD_TO)B+=(P.relative?"t":"T")+P.x+" "+P.y;else{if(P.type!==_.ARC)throw new Error('Unexpected command type "'+P.type+'" at index '+M+".");B+=(P.relative?"a":"A")+P.rX+" "+P.rY+" "+P.xRot+" "+ +P.lArcFlag+" "+ +P.sweepFlag+" "+P.x+" "+P.y}}return B}function i(g,B){var M=g[0],P=g[1];return[M*Math.cos(B)-P*Math.sin(B),M*Math.sin(B)+P*Math.cos(B)]}function a(){for(var g=[],B=0;B<arguments.length;B++)g[B]=arguments[B];for(var M=0;M<g.length;M++)if(typeof g[M]!="number")throw new Error("assertNumbers arguments["+M+"] is not a number. "+typeof g[M]+" == typeof "+g[M]);return!0}var n=Math.PI;function o(g,B,M){g.lArcFlag=g.lArcFlag===0?0:1,g.sweepFlag=g.sweepFlag===0?0:1;var P=g.rX,K=g.rY,Y=g.x,re=g.y;P=Math.abs(g.rX),K=Math.abs(g.rY);var D=i([(B-Y)/2,(M-re)/2],-g.xRot/180*n),ne=D[0],ae=D[1],ue=Math.pow(ne,2)/Math.pow(P,2)+Math.pow(ae,2)/Math.pow(K,2);1<ue&&(P*=Math.sqrt(ue),K*=Math.sqrt(ue)),g.rX=P,g.rY=K;var ge=Math.pow(P,2)*Math.pow(ae,2)+Math.pow(K,2)*Math.pow(ne,2),Be=(g.lArcFlag!==g.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(P,2)*Math.pow(K,2)-ge)/ge)),De=P*ae/K*Be,ze=-K*ne/P*Be,Oe=i([De,ze],g.xRot/180*n);g.cX=Oe[0]+(B+Y)/2,g.cY=Oe[1]+(M+re)/2,g.phi1=Math.atan2((ae-ze)/K,(ne-De)/P),g.phi2=Math.atan2((-ae-ze)/K,(-ne-De)/P),g.sweepFlag===0&&g.phi2>g.phi1&&(g.phi2-=2*n),g.sweepFlag===1&&g.phi2<g.phi1&&(g.phi2+=2*n),g.phi1*=180/n,g.phi2*=180/n}function s(g,B,M){a(g,B,M);var P=g*g+B*B-M*M;if(0>P)return[];if(P===0)return[[g*M/(g*g+B*B),B*M/(g*g+B*B)]];var K=Math.sqrt(P);return[[(g*M+B*K)/(g*g+B*B),(B*M-g*K)/(g*g+B*B)],[(g*M-B*K)/(g*g+B*B),(B*M+g*K)/(g*g+B*B)]]}var u,h=Math.PI/180;function c$1(g,B,M){return(1-M)*g+M*B}function y(g,B,M,P){return g+Math.cos(P/180*n)*B+Math.sin(P/180*n)*M}function p(g,B,M,P){var K=1e-6,Y=B-g,re=M-B,D=3*Y+3*(P-M)-6*re,ne=6*(re-Y),ae=3*Y;return Math.abs(D)<K?[-ae/ne]:function(ue,ge,Be){var De=ue*ue/4-ge;if(De<-Be)return[];if(De<=Be)return[-ue/2];var ze=Math.sqrt(De);return[-ue/2-ze,-ue/2+ze]}(ne/D,ae/D,K)}function m$1(g,B,M,P,K){var Y=1-K;return g*(Y*Y*Y)+B*(3*Y*Y*K)+M*(3*Y*K*K)+P*(K*K*K)}(function(g){function B(){return K(function(D,ne,ae){return D.relative&&(D.x1!==void 0&&(D.x1+=ne),D.y1!==void 0&&(D.y1+=ae),D.x2!==void 0&&(D.x2+=ne),D.y2!==void 0&&(D.y2+=ae),D.x!==void 0&&(D.x+=ne),D.y!==void 0&&(D.y+=ae),D.relative=!1),D})}function M(){var D=NaN,ne=NaN,ae=NaN,ue=NaN;return K(function(ge,Be,De){return ge.type&_.SMOOTH_CURVE_TO&&(ge.type=_.CURVE_TO,D=isNaN(D)?Be:D,ne=isNaN(ne)?De:ne,ge.x1=ge.relative?Be-D:2*Be-D,ge.y1=ge.relative?De-ne:2*De-ne),ge.type&_.CURVE_TO?(D=ge.relative?Be+ge.x2:ge.x2,ne=ge.relative?De+ge.y2:ge.y2):(D=NaN,ne=NaN),ge.type&_.SMOOTH_QUAD_TO&&(ge.type=_.QUAD_TO,ae=isNaN(ae)?Be:ae,ue=isNaN(ue)?De:ue,ge.x1=ge.relative?Be-ae:2*Be-ae,ge.y1=ge.relative?De-ue:2*De-ue),ge.type&_.QUAD_TO?(ae=ge.relative?Be+ge.x1:ge.x1,ue=ge.relative?De+ge.y1:ge.y1):(ae=NaN,ue=NaN),ge})}function P(){var D=NaN,ne=NaN;return K(function(ae,ue,ge){if(ae.type&_.SMOOTH_QUAD_TO&&(ae.type=_.QUAD_TO,D=isNaN(D)?ue:D,ne=isNaN(ne)?ge:ne,ae.x1=ae.relative?ue-D:2*ue-D,ae.y1=ae.relative?ge-ne:2*ge-ne),ae.type&_.QUAD_TO){D=ae.relative?ue+ae.x1:ae.x1,ne=ae.relative?ge+ae.y1:ae.y1;var Be=ae.x1,De=ae.y1;ae.type=_.CURVE_TO,ae.x1=((ae.relative?0:ue)+2*Be)/3,ae.y1=((ae.relative?0:ge)+2*De)/3,ae.x2=(ae.x+2*Be)/3,ae.y2=(ae.y+2*De)/3}else D=NaN,ne=NaN;return ae})}function K(D){var ne=0,ae=0,ue=NaN,ge=NaN;return function(Be){if(isNaN(ue)&&!(Be.type&_.MOVE_TO))throw new Error("path must start with moveto");var De=D(Be,ne,ae,ue,ge);return Be.type&_.CLOSE_PATH&&(ne=ue,ae=ge),Be.x!==void 0&&(ne=Be.relative?ne+Be.x:Be.x),Be.y!==void 0&&(ae=Be.relative?ae+Be.y:Be.y),Be.type&_.MOVE_TO&&(ue=ne,ge=ae),De}}function Y(D,ne,ae,ue,ge,Be){return a(D,ne,ae,ue,ge,Be),K(function(De,ze,Oe,Je){var We=De.x1,ut=De.x2,et=De.relative&&!isNaN(Je),At=De.x!==void 0?De.x:et?0:ze,nt=De.y!==void 0?De.y:et?0:Oe;function ft(S){return S*S}De.type&_.HORIZ_LINE_TO&&ne!==0&&(De.type=_.LINE_TO,De.y=De.relative?0:Oe),De.type&_.VERT_LINE_TO&&ae!==0&&(De.type=_.LINE_TO,De.x=De.relative?0:ze),De.x!==void 0&&(De.x=De.x*D+nt*ae+(et?0:ge)),De.y!==void 0&&(De.y=At*ne+De.y*ue+(et?0:Be)),De.x1!==void 0&&(De.x1=De.x1*D+De.y1*ae+(et?0:ge)),De.y1!==void 0&&(De.y1=We*ne+De.y1*ue+(et?0:Be)),De.x2!==void 0&&(De.x2=De.x2*D+De.y2*ae+(et?0:ge)),De.y2!==void 0&&(De.y2=ut*ne+De.y2*ue+(et?0:Be));var Tt=D*ue-ne*ae;if(De.xRot!==void 0&&(D!==1||ne!==0||ae!==0||ue!==1))if(Tt===0)delete De.rX,delete De.rY,delete De.xRot,delete De.lArcFlag,delete De.sweepFlag,De.type=_.LINE_TO;else{var qt=De.xRot*Math.PI/180,Vt=Math.sin(qt),vt=Math.cos(qt),Ut=1/ft(De.rX),Pt=1/ft(De.rY),Yt=ft(vt)*Ut+ft(Vt)*Pt,Ai=2*Vt*vt*(Ut-Pt),Ri=ft(Vt)*Ut+ft(vt)*Pt,Ei=Yt*ue*ue-Ai*ne*ue+Ri*ne*ne,Li=Ai*(D*ue+ne*ae)-2*(Yt*ae*ue+Ri*D*ne),Yi=Yt*ae*ae-Ai*D*ae+Ri*D*D,vi=(Math.atan2(Li,Ei-Yi)+Math.PI)%Math.PI/2,d=Math.sin(vi),b=Math.cos(vi);De.rX=Math.abs(Tt)/Math.sqrt(Ei*ft(b)+Li*d*b+Yi*ft(d)),De.rY=Math.abs(Tt)/Math.sqrt(Ei*ft(d)-Li*d*b+Yi*ft(b)),De.xRot=180*vi/Math.PI}return De.sweepFlag!==void 0&&0>Tt&&(De.sweepFlag=+!De.sweepFlag),De})}function re(){return function(D){var ne={};for(var ae in D)ne[ae]=D[ae];return ne}}g.ROUND=function(D){function ne(ae){return Math.round(ae*D)/D}return D===void 0&&(D=1e13),a(D),function(ae){return ae.x1!==void 0&&(ae.x1=ne(ae.x1)),ae.y1!==void 0&&(ae.y1=ne(ae.y1)),ae.x2!==void 0&&(ae.x2=ne(ae.x2)),ae.y2!==void 0&&(ae.y2=ne(ae.y2)),ae.x!==void 0&&(ae.x=ne(ae.x)),ae.y!==void 0&&(ae.y=ne(ae.y)),ae.rX!==void 0&&(ae.rX=ne(ae.rX)),ae.rY!==void 0&&(ae.rY=ne(ae.rY)),ae}},g.TO_ABS=B,g.TO_REL=function(){return K(function(D,ne,ae){return D.relative||(D.x1!==void 0&&(D.x1-=ne),D.y1!==void 0&&(D.y1-=ae),D.x2!==void 0&&(D.x2-=ne),D.y2!==void 0&&(D.y2-=ae),D.x!==void 0&&(D.x-=ne),D.y!==void 0&&(D.y-=ae),D.relative=!0),D})},g.NORMALIZE_HVZ=function(D,ne,ae){return D===void 0&&(D=!0),ne===void 0&&(ne=!0),ae===void 0&&(ae=!0),K(function(ue,ge,Be,De,ze){if(isNaN(De)&&!(ue.type&_.MOVE_TO))throw new Error("path must start with moveto");return ne&&ue.type&_.HORIZ_LINE_TO&&(ue.type=_.LINE_TO,ue.y=ue.relative?0:Be),ae&&ue.type&_.VERT_LINE_TO&&(ue.type=_.LINE_TO,ue.x=ue.relative?0:ge),D&&ue.type&_.CLOSE_PATH&&(ue.type=_.LINE_TO,ue.x=ue.relative?De-ge:De,ue.y=ue.relative?ze-Be:ze),ue.type&_.ARC&&(ue.rX===0||ue.rY===0)&&(ue.type=_.LINE_TO,delete ue.rX,delete ue.rY,delete ue.xRot,delete ue.lArcFlag,delete ue.sweepFlag),ue})},g.NORMALIZE_ST=M,g.QT_TO_C=P,g.INFO=K,g.SANITIZE=function(D){D===void 0&&(D=0),a(D);var ne=NaN,ae=NaN,ue=NaN,ge=NaN;return K(function(Be,De,ze,Oe,Je){var We=Math.abs,ut=!1,et=0,At=0;if(Be.type&_.SMOOTH_CURVE_TO&&(et=isNaN(ne)?0:De-ne,At=isNaN(ae)?0:ze-ae),Be.type&(_.CURVE_TO|_.SMOOTH_CURVE_TO)?(ne=Be.relative?De+Be.x2:Be.x2,ae=Be.relative?ze+Be.y2:Be.y2):(ne=NaN,ae=NaN),Be.type&_.SMOOTH_QUAD_TO?(ue=isNaN(ue)?De:2*De-ue,ge=isNaN(ge)?ze:2*ze-ge):Be.type&_.QUAD_TO?(ue=Be.relative?De+Be.x1:Be.x1,ge=Be.relative?ze+Be.y1:Be.y2):(ue=NaN,ge=NaN),Be.type&_.LINE_COMMANDS||Be.type&_.ARC&&(Be.rX===0||Be.rY===0||!Be.lArcFlag)||Be.type&_.CURVE_TO||Be.type&_.SMOOTH_CURVE_TO||Be.type&_.QUAD_TO||Be.type&_.SMOOTH_QUAD_TO){var nt=Be.x===void 0?0:Be.relative?Be.x:Be.x-De,ft=Be.y===void 0?0:Be.relative?Be.y:Be.y-ze;et=isNaN(ue)?Be.x1===void 0?et:Be.relative?Be.x:Be.x1-De:ue-De,At=isNaN(ge)?Be.y1===void 0?At:Be.relative?Be.y:Be.y1-ze:ge-ze;var Tt=Be.x2===void 0?0:Be.relative?Be.x:Be.x2-De,qt=Be.y2===void 0?0:Be.relative?Be.y:Be.y2-ze;We(nt)<=D&&We(ft)<=D&&We(et)<=D&&We(At)<=D&&We(Tt)<=D&&We(qt)<=D&&(ut=!0)}return Be.type&_.CLOSE_PATH&&We(De-Oe)<=D&&We(ze-Je)<=D&&(ut=!0),ut?[]:Be})},g.MATRIX=Y,g.ROTATE=function(D,ne,ae){ne===void 0&&(ne=0),ae===void 0&&(ae=0),a(D,ne,ae);var ue=Math.sin(D),ge=Math.cos(D);return Y(ge,ue,-ue,ge,ne-ne*ge+ae*ue,ae-ne*ue-ae*ge)},g.TRANSLATE=function(D,ne){return ne===void 0&&(ne=0),a(D,ne),Y(1,0,0,1,D,ne)},g.SCALE=function(D,ne){return ne===void 0&&(ne=D),a(D,ne),Y(D,0,0,ne,0,0)},g.SKEW_X=function(D){return a(D),Y(1,0,Math.atan(D),1,0,0)},g.SKEW_Y=function(D){return a(D),Y(1,Math.atan(D),0,1,0,0)},g.X_AXIS_SYMMETRY=function(D){return D===void 0&&(D=0),a(D),Y(-1,0,0,1,D,0)},g.Y_AXIS_SYMMETRY=function(D){return D===void 0&&(D=0),a(D),Y(1,0,0,-1,0,D)},g.A_TO_C=function(){return K(function(D,ne,ae){return _.ARC===D.type?function(ue,ge,Be){var De,ze,Oe,Je;ue.cX||o(ue,ge,Be);for(var We=Math.min(ue.phi1,ue.phi2),ut=Math.max(ue.phi1,ue.phi2)-We,et=Math.ceil(ut/90),At=new Array(et),nt=ge,ft=Be,Tt=0;Tt<et;Tt++){var qt=c$1(ue.phi1,ue.phi2,Tt/et),Vt=c$1(ue.phi1,ue.phi2,(Tt+1)/et),vt=Vt-qt,Ut=4/3*Math.tan(vt*h/4),Pt=[Math.cos(qt*h)-Ut*Math.sin(qt*h),Math.sin(qt*h)+Ut*Math.cos(qt*h)],Yt=Pt[0],Ai=Pt[1],Ri=[Math.cos(Vt*h),Math.sin(Vt*h)],Ei=Ri[0],Li=Ri[1],Yi=[Ei+Ut*Math.sin(Vt*h),Li-Ut*Math.cos(Vt*h)],vi=Yi[0],d=Yi[1];At[Tt]={relative:ue.relative,type:_.CURVE_TO};var b=function(S,k){var R=i([S*ue.rX,k*ue.rY],ue.xRot),W=R[0],se=R[1];return[ue.cX+W,ue.cY+se]};De=b(Yt,Ai),At[Tt].x1=De[0],At[Tt].y1=De[1],ze=b(vi,d),At[Tt].x2=ze[0],At[Tt].y2=ze[1],Oe=b(Ei,Li),At[Tt].x=Oe[0],At[Tt].y=Oe[1],ue.relative&&(At[Tt].x1-=nt,At[Tt].y1-=ft,At[Tt].x2-=nt,At[Tt].y2-=ft,At[Tt].x-=nt,At[Tt].y-=ft),nt=(Je=[At[Tt].x,At[Tt].y])[0],ft=Je[1]}return At}(D,D.relative?0:ne,D.relative?0:ae):D})},g.ANNOTATE_ARCS=function(){return K(function(D,ne,ae){return D.relative&&(ne=0,ae=0),_.ARC===D.type&&o(D,ne,ae),D})},g.CLONE=re,g.CALCULATE_BOUNDS=function(){var D=function(Be){var De={};for(var ze in Be)De[ze]=Be[ze];return De},ne=B(),ae=P(),ue=M(),ge=K(function(Be,De,ze){var Oe=ue(ae(ne(D(Be))));function Je(d){d>ge.maxX&&(ge.maxX=d),d<ge.minX&&(ge.minX=d)}function We(d){d>ge.maxY&&(ge.maxY=d),d<ge.minY&&(ge.minY=d)}if(Oe.type&_.DRAWING_COMMANDS&&(Je(De),We(ze)),Oe.type&_.HORIZ_LINE_TO&&Je(Oe.x),Oe.type&_.VERT_LINE_TO&&We(Oe.y),Oe.type&_.LINE_TO&&(Je(Oe.x),We(Oe.y)),Oe.type&_.CURVE_TO){Je(Oe.x),We(Oe.y);for(var ut=0,et=p(De,Oe.x1,Oe.x2,Oe.x);ut<et.length;ut++)0<(vi=et[ut])&&1>vi&&Je(m$1(De,Oe.x1,Oe.x2,Oe.x,vi));for(var At=0,nt=p(ze,Oe.y1,Oe.y2,Oe.y);At<nt.length;At++)0<(vi=nt[At])&&1>vi&&We(m$1(ze,Oe.y1,Oe.y2,Oe.y,vi))}if(Oe.type&_.ARC){Je(Oe.x),We(Oe.y),o(Oe,De,ze);for(var ft=Oe.xRot/180*Math.PI,Tt=Math.cos(ft)*Oe.rX,qt=Math.sin(ft)*Oe.rX,Vt=-Math.sin(ft)*Oe.rY,vt=Math.cos(ft)*Oe.rY,Ut=Oe.phi1<Oe.phi2?[Oe.phi1,Oe.phi2]:-180>Oe.phi2?[Oe.phi2+360,Oe.phi1+360]:[Oe.phi2,Oe.phi1],Pt=Ut[0],Yt=Ut[1],Ai=function(d){var b=d[0],S=d[1],k=180*Math.atan2(S,b)/Math.PI;return k<Pt?k+360:k},Ri=0,Ei=s(Vt,-Tt,0).map(Ai);Ri<Ei.length;Ri++)(vi=Ei[Ri])>Pt&&vi<Yt&&Je(y(Oe.cX,Tt,Vt,vi));for(var Li=0,Yi=s(vt,-qt,0).map(Ai);Li<Yi.length;Li++){var vi;(vi=Yi[Li])>Pt&&vi<Yt&&We(y(Oe.cY,qt,vt,vi))}}return Be});return ge.minX=1/0,ge.maxX=-1/0,ge.minY=1/0,ge.maxY=-1/0,ge}})(u||(u={}));var O,l=function(){function g(){}return g.prototype.round=function(B){return this.transform(u.ROUND(B))},g.prototype.toAbs=function(){return this.transform(u.TO_ABS())},g.prototype.toRel=function(){return this.transform(u.TO_REL())},g.prototype.normalizeHVZ=function(B,M,P){return this.transform(u.NORMALIZE_HVZ(B,M,P))},g.prototype.normalizeST=function(){return this.transform(u.NORMALIZE_ST())},g.prototype.qtToC=function(){return this.transform(u.QT_TO_C())},g.prototype.aToC=function(){return this.transform(u.A_TO_C())},g.prototype.sanitize=function(B){return this.transform(u.SANITIZE(B))},g.prototype.translate=function(B,M){return this.transform(u.TRANSLATE(B,M))},g.prototype.scale=function(B,M){return this.transform(u.SCALE(B,M))},g.prototype.rotate=function(B,M,P){return this.transform(u.ROTATE(B,M,P))},g.prototype.matrix=function(B,M,P,K,Y,re){return this.transform(u.MATRIX(B,M,P,K,Y,re))},g.prototype.skewX=function(B){return this.transform(u.SKEW_X(B))},g.prototype.skewY=function(B){return this.transform(u.SKEW_Y(B))},g.prototype.xSymmetry=function(B){return this.transform(u.X_AXIS_SYMMETRY(B))},g.prototype.ySymmetry=function(B){return this.transform(u.Y_AXIS_SYMMETRY(B))},g.prototype.annotateArcs=function(){return this.transform(u.ANNOTATE_ARCS())},g}(),T=function(g){return g===" "||g==="	"||g==="\r"||g===`
`},v=function(g){return 48<=g.charCodeAt(0)&&g.charCodeAt(0)<=57},f=function(g){function B(){var M=g.call(this)||this;return M.curNumber="",M.curCommandType=-1,M.curCommandRelative=!1,M.canParseCommandOrComma=!0,M.curNumberHasExp=!1,M.curNumberHasExpDigits=!1,M.curNumberHasDecimal=!1,M.curArgs=[],M}return r(B,g),B.prototype.finish=function(M){if(M===void 0&&(M=[]),this.parse(" ",M),this.curArgs.length!==0||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return M},B.prototype.parse=function(M,P){var K=this;P===void 0&&(P=[]);for(var Y=function(ge){P.push(ge),K.curArgs.length=0,K.canParseCommandOrComma=!0},re=0;re<M.length;re++){var D=M[re],ne=!(this.curCommandType!==_.ARC||this.curArgs.length!==3&&this.curArgs.length!==4||this.curNumber.length!==1||this.curNumber!=="0"&&this.curNumber!=="1"),ae=v(D)&&(this.curNumber==="0"&&D==="0"||ne);if(!v(D)||ae)if(D!=="e"&&D!=="E")if(D!=="-"&&D!=="+"||!this.curNumberHasExp||this.curNumberHasExpDigits)if(D!=="."||this.curNumberHasExp||this.curNumberHasDecimal||ne){if(this.curNumber&&this.curCommandType!==-1){var ue=Number(this.curNumber);if(isNaN(ue))throw new SyntaxError("Invalid number ending at "+re);if(this.curCommandType===_.ARC){if(this.curArgs.length===0||this.curArgs.length===1){if(0>ue)throw new SyntaxError('Expected positive number, got "'+ue+'" at index "'+re+'"')}else if((this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber!=="0"&&this.curNumber!=="1")throw new SyntaxError('Expected a flag, got "'+this.curNumber+'" at index "'+re+'"')}this.curArgs.push(ue),this.curArgs.length===N[this.curCommandType]&&(_.HORIZ_LINE_TO===this.curCommandType?Y({type:_.HORIZ_LINE_TO,relative:this.curCommandRelative,x:ue}):_.VERT_LINE_TO===this.curCommandType?Y({type:_.VERT_LINE_TO,relative:this.curCommandRelative,y:ue}):this.curCommandType===_.MOVE_TO||this.curCommandType===_.LINE_TO||this.curCommandType===_.SMOOTH_QUAD_TO?(Y({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),_.MOVE_TO===this.curCommandType&&(this.curCommandType=_.LINE_TO)):this.curCommandType===_.CURVE_TO?Y({type:_.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===_.SMOOTH_CURVE_TO?Y({type:_.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===_.QUAD_TO?Y({type:_.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===_.ARC&&Y({type:_.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!T(D))if(D===","&&this.canParseCommandOrComma)this.canParseCommandOrComma=!1;else if(D!=="+"&&D!=="-"&&D!==".")if(ae)this.curNumber=D,this.curNumberHasDecimal=!1;else{if(this.curArgs.length!==0)throw new SyntaxError("Unterminated command at index "+re+".");if(!this.canParseCommandOrComma)throw new SyntaxError('Unexpected character "'+D+'" at index '+re+". Command cannot follow comma");if(this.canParseCommandOrComma=!1,D!=="z"&&D!=="Z")if(D==="h"||D==="H")this.curCommandType=_.HORIZ_LINE_TO,this.curCommandRelative=D==="h";else if(D==="v"||D==="V")this.curCommandType=_.VERT_LINE_TO,this.curCommandRelative=D==="v";else if(D==="m"||D==="M")this.curCommandType=_.MOVE_TO,this.curCommandRelative=D==="m";else if(D==="l"||D==="L")this.curCommandType=_.LINE_TO,this.curCommandRelative=D==="l";else if(D==="c"||D==="C")this.curCommandType=_.CURVE_TO,this.curCommandRelative=D==="c";else if(D==="s"||D==="S")this.curCommandType=_.SMOOTH_CURVE_TO,this.curCommandRelative=D==="s";else if(D==="q"||D==="Q")this.curCommandType=_.QUAD_TO,this.curCommandRelative=D==="q";else if(D==="t"||D==="T")this.curCommandType=_.SMOOTH_QUAD_TO,this.curCommandRelative=D==="t";else{if(D!=="a"&&D!=="A")throw new SyntaxError('Unexpected character "'+D+'" at index '+re+".");this.curCommandType=_.ARC,this.curCommandRelative=D==="a"}else P.push({type:_.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1}else this.curNumber=D,this.curNumberHasDecimal=D==="."}else this.curNumber+=D,this.curNumberHasDecimal=!0;else this.curNumber+=D;else this.curNumber+=D,this.curNumberHasExp=!0;else this.curNumber+=D,this.curNumberHasExpDigits=this.curNumberHasExp}return P},B.prototype.transform=function(M){return Object.create(this,{parse:{value:function(P,K){K===void 0&&(K=[]);for(var Y=0,re=Object.getPrototypeOf(this).parse.call(this,P);Y<re.length;Y++){var D=re[Y],ne=M(D);Array.isArray(ne)?K.push.apply(K,ne):K.push(ne)}return K}}})},B}(l),_=function(g){function B(M){var P=g.call(this)||this;return P.commands=typeof M=="string"?B.parse(M):M,P}return r(B,g),B.prototype.encode=function(){return B.encode(this.commands)},B.prototype.getBounds=function(){var M=u.CALCULATE_BOUNDS();return this.transform(M),M},B.prototype.transform=function(M){for(var P=[],K=0,Y=this.commands;K<Y.length;K++){var re=M(Y[K]);Array.isArray(re)?P.push.apply(P,re):P.push(re)}return this.commands=P,this},B.encode=function(M){return e(M)},B.parse=function(M){var P=new f,K=[];return P.parse(M,K),P.finish(K),K},B.CLOSE_PATH=1,B.MOVE_TO=2,B.HORIZ_LINE_TO=4,B.VERT_LINE_TO=8,B.LINE_TO=16,B.CURVE_TO=32,B.SMOOTH_CURVE_TO=64,B.QUAD_TO=128,B.SMOOTH_QUAD_TO=256,B.ARC=512,B.LINE_COMMANDS=B.LINE_TO|B.HORIZ_LINE_TO|B.VERT_LINE_TO,B.DRAWING_COMMANDS=B.HORIZ_LINE_TO|B.VERT_LINE_TO|B.LINE_TO|B.CURVE_TO|B.SMOOTH_CURVE_TO|B.QUAD_TO|B.SMOOTH_QUAD_TO|B.ARC,B}(l),N=((O={})[_.MOVE_TO]=2,O[_.LINE_TO]=2,O[_.HORIZ_LINE_TO]=1,O[_.VERT_LINE_TO]=1,O[_.CLOSE_PATH]=0,O[_.QUAD_TO]=4,O[_.SMOOTH_QUAD_TO]=2,O[_.CURVE_TO]=6,O[_.SMOOTH_CURVE_TO]=4,O[_.ARC]=7,O);function _typeof(g){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_typeof=function(B){return typeof B}:_typeof=function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},_typeof(g)}function _classCallCheck(g,B){if(!(g instanceof B))throw new TypeError("Cannot call a class as a function")}var mulTable=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shgTable=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function getImageDataFromCanvas(g,B,M,P,K){if(typeof g=="string"&&(g=document.getElementById(g)),!g||_typeof(g)!=="object"||!("getContext"in g))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var Y=g.getContext("2d");try{return Y.getImageData(B,M,P,K)}catch(re){throw new Error("unable to access image data: "+re)}}function processCanvasRGBA(g,B,M,P,K,Y){if(!(isNaN(Y)||Y<1)){Y|=0;var re=getImageDataFromCanvas(g,B,M,P,K);re=processImageDataRGBA(re,B,M,P,K,Y),g.getContext("2d").putImageData(re,B,M)}}function processImageDataRGBA(g,B,M,P,K,Y){for(var re=g.data,D=2*Y+1,ne=P-1,ae=K-1,ue=Y+1,ge=ue*(ue+1)/2,Be=new BlurStack,De=Be,ze,Oe=1;Oe<D;Oe++)De=De.next=new BlurStack,Oe===ue&&(ze=De);De.next=Be;for(var Je=null,We=null,ut=0,et=0,At=mulTable[Y],nt=shgTable[Y],ft=0;ft<K;ft++){De=Be;for(var Tt=re[et],qt=re[et+1],Vt=re[et+2],vt=re[et+3],Ut=0;Ut<ue;Ut++)De.r=Tt,De.g=qt,De.b=Vt,De.a=vt,De=De.next;for(var Pt=0,Yt=0,Ai=0,Ri=0,Ei=ue*Tt,Li=ue*qt,Yi=ue*Vt,vi=ue*vt,d=ge*Tt,b=ge*qt,S=ge*Vt,k=ge*vt,R=1;R<ue;R++){var W=et+((ne<R?ne:R)<<2),se=re[W],le=re[W+1],fe=re[W+2],be=re[W+3],Te=ue-R;d+=(De.r=se)*Te,b+=(De.g=le)*Te,S+=(De.b=fe)*Te,k+=(De.a=be)*Te,Pt+=se,Yt+=le,Ai+=fe,Ri+=be,De=De.next}Je=Be,We=ze;for(var Ve=0;Ve<P;Ve++){var Ue=k*At>>nt;if(re[et+3]=Ue,Ue!==0){var me=255/Ue;re[et]=(d*At>>nt)*me,re[et+1]=(b*At>>nt)*me,re[et+2]=(S*At>>nt)*me}else re[et]=re[et+1]=re[et+2]=0;d-=Ei,b-=Li,S-=Yi,k-=vi,Ei-=Je.r,Li-=Je.g,Yi-=Je.b,vi-=Je.a;var ke=Ve+Y+1;ke=ut+(ke<ne?ke:ne)<<2,Pt+=Je.r=re[ke],Yt+=Je.g=re[ke+1],Ai+=Je.b=re[ke+2],Ri+=Je.a=re[ke+3],d+=Pt,b+=Yt,S+=Ai,k+=Ri,Je=Je.next;var qe=We,lt=qe.r,pt=qe.g,Ft=qe.b,zt=qe.a;Ei+=lt,Li+=pt,Yi+=Ft,vi+=zt,Pt-=lt,Yt-=pt,Ai-=Ft,Ri-=zt,We=We.next,et+=4}ut+=P}for(var Nt=0;Nt<P;Nt++){et=Nt<<2;var Mt=re[et],$t=re[et+1],ri=re[et+2],ci=re[et+3],wt=ue*Mt,di=ue*$t,ii=ue*ri,Hi=ue*ci,Vi=ge*Mt,Ot=ge*$t,_i=ge*ri,Ti=ge*ci;De=Be;for(var Wi=0;Wi<ue;Wi++)De.r=Mt,De.g=$t,De.b=ri,De.a=ci,De=De.next;for(var Zt=P,mi=0,bi=0,$i=0,tr=0,Ar=1;Ar<=Y;Ar++){et=Zt+Nt<<2;var Tr=ue-Ar;Vi+=(De.r=Mt=re[et])*Tr,Ot+=(De.g=$t=re[et+1])*Tr,_i+=(De.b=ri=re[et+2])*Tr,Ti+=(De.a=ci=re[et+3])*Tr,tr+=Mt,mi+=$t,bi+=ri,$i+=ci,De=De.next,Ar<ae&&(Zt+=P)}et=Nt,Je=Be,We=ze;for(var ji=0;ji<K;ji++){var Ii=et<<2;re[Ii+3]=ci=Ti*At>>nt,ci>0?(ci=255/ci,re[Ii]=(Vi*At>>nt)*ci,re[Ii+1]=(Ot*At>>nt)*ci,re[Ii+2]=(_i*At>>nt)*ci):re[Ii]=re[Ii+1]=re[Ii+2]=0,Vi-=wt,Ot-=di,_i-=ii,Ti-=Hi,wt-=Je.r,di-=Je.g,ii-=Je.b,Hi-=Je.a,Ii=Nt+((Ii=ji+ue)<ae?Ii:ae)*P<<2,Vi+=tr+=Je.r=re[Ii],Ot+=mi+=Je.g=re[Ii+1],_i+=bi+=Je.b=re[Ii+2],Ti+=$i+=Je.a=re[Ii+3],Je=Je.next,wt+=Mt=We.r,di+=$t=We.g,ii+=ri=We.b,Hi+=ci=We.a,tr-=Mt,mi-=$t,bi-=ri,$i-=ci,We=We.next,et+=P}}return g}var BlurStack=function g(){_classCallCheck(this,g),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null};function compressSpaces(g){return g.replace(/(?!\u3000)\s+/gm," ")}function trimLeft(g){return g.replace(/^[\n \t]+/,"")}function trimRight(g){return g.replace(/[\n \t]+$/,"")}function toNumbers(g){const B=g.match(/-?(\d+(?:\.\d*(?:[eE][+-]?\d+)?)?|\.\d+)(?=\D|$)/gm);return B?B.map(parseFloat):[]}function toMatrixValue(g){const B=toNumbers(g);return[B[0]||0,B[1]||0,B[2]||0,B[3]||0,B[4]||0,B[5]||0]}const allUppercase=/^[A-Z-]+$/;function normalizeAttributeName(g){return allUppercase.test(g)?g.toLowerCase():g}function parseExternalUrl(g){const B=/url\(('([^']+)'|"([^"]+)"|([^'")]+))\)/.exec(g);return B&&(B[2]||B[3]||B[4])||""}function normalizeColor(g){if(!g.startsWith("rgb"))return g;let B=3;return g.replace(/\d+(\.\d+)?/g,(P,K)=>B--&&K?String(Math.round(parseFloat(P))):P)}const attributeRegex=/(\[[^\]]+\])/g,idRegex=/(#[^\s+>~.[:]+)/g,classRegex=/(\.[^\s+>~.[:]+)/g,pseudoElementRegex=/(::[^\s+>~.[:]+|:first-line|:first-letter|:before|:after)/gi,pseudoClassWithBracketsRegex=/(:[\w-]+\([^)]*\))/gi,pseudoClassRegex=/(:[^\s+>~.[:]+)/g,elementRegex=/([^\s+>~.[:]+)/g;function findSelectorMatch(g,B){const M=B.exec(g);return M?[g.replace(B," "),M.length]:[g,0]}function getSelectorSpecificity(g){const B=[0,0,0];let M=g.replace(/:not\(([^)]*)\)/g,"     $1 ").replace(/{[\s\S]*/gm," "),P=0;return[M,P]=findSelectorMatch(M,attributeRegex),B[1]+=P,[M,P]=findSelectorMatch(M,idRegex),B[0]+=P,[M,P]=findSelectorMatch(M,classRegex),B[1]+=P,[M,P]=findSelectorMatch(M,pseudoElementRegex),B[2]+=P,[M,P]=findSelectorMatch(M,pseudoClassWithBracketsRegex),B[1]+=P,[M,P]=findSelectorMatch(M,pseudoClassRegex),B[1]+=P,M=M.replace(/[*\s+>~]/g," ").replace(/[#.]/g," "),[M,P]=findSelectorMatch(M,elementRegex),B[2]+=P,B.join("")}const PSEUDO_ZERO=1e-8;function vectorMagnitude(g){return Math.sqrt(Math.pow(g[0],2)+Math.pow(g[1],2))}function vectorsRatio(g,B){return(g[0]*B[0]+g[1]*B[1])/(vectorMagnitude(g)*vectorMagnitude(B))}function vectorsAngle(g,B){return(g[0]*B[1]<g[1]*B[0]?-1:1)*Math.acos(vectorsRatio(g,B))}function CB1(g){return g*g*g}function CB2(g){return 3*g*g*(1-g)}function CB3(g){return 3*g*(1-g)*(1-g)}function CB4(g){return(1-g)*(1-g)*(1-g)}function QB1(g){return g*g}function QB2(g){return 2*g*(1-g)}function QB3(g){return(1-g)*(1-g)}class Property{static empty(B){return new Property(B,"EMPTY","")}split(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:" ";const{document:M,name:P}=this;return compressSpaces(this.getString()).trim().split(B).map(K=>new Property(M,P,K))}hasValue(B){const M=this.value;return M!==null&&M!==""&&(B||M!==0)&&typeof M<"u"}isString(B){const{value:M}=this,P=typeof M=="string";return!P||!B?P:B.test(M)}isUrlDefinition(){return this.isString(/^url\(/)}isPixels(){if(!this.hasValue())return!1;const B=this.getString();switch(!0){case B.endsWith("px"):case/^[0-9]+$/.test(B):return!0;default:return!1}}setValue(B){return this.value=B,this}getValue(B){return typeof B>"u"||this.hasValue()?this.value:B}getNumber(B){if(!this.hasValue())return typeof B>"u"?0:parseFloat(B);const{value:M}=this;let P=parseFloat(M);return this.isString(/%$/)&&(P/=100),P}getString(B){return typeof B>"u"||this.hasValue()?typeof this.value>"u"?"":String(this.value):String(B)}getColor(B){let M=this.getString(B);return this.isNormalizedColor||(this.isNormalizedColor=!0,M=normalizeColor(M),this.value=M),M}getDpi(){return 96}getRem(){return this.document.rootEmSize}getEm(){return this.document.emSize}getUnits(){return this.getString().replace(/[0-9.-]/g,"")}getPixels(B){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!this.hasValue())return 0;const[P,K]=typeof B=="boolean"?[void 0,B]:[B],{viewPort:Y}=this.document.screen;switch(!0){case this.isString(/vmin$/):return this.getNumber()/100*Math.min(Y.computeSize("x"),Y.computeSize("y"));case this.isString(/vmax$/):return this.getNumber()/100*Math.max(Y.computeSize("x"),Y.computeSize("y"));case this.isString(/vw$/):return this.getNumber()/100*Y.computeSize("x");case this.isString(/vh$/):return this.getNumber()/100*Y.computeSize("y");case this.isString(/rem$/):return this.getNumber()*this.getRem();case this.isString(/em$/):return this.getNumber()*this.getEm();case this.isString(/ex$/):return this.getNumber()*this.getEm()/2;case this.isString(/px$/):return this.getNumber();case this.isString(/pt$/):return this.getNumber()*this.getDpi()*(1/72);case this.isString(/pc$/):return this.getNumber()*15;case this.isString(/cm$/):return this.getNumber()*this.getDpi()/2.54;case this.isString(/mm$/):return this.getNumber()*this.getDpi()/25.4;case this.isString(/in$/):return this.getNumber()*this.getDpi();case(this.isString(/%$/)&&K):return this.getNumber()*this.getEm();case this.isString(/%$/):return this.getNumber()*Y.computeSize(P);default:{const re=this.getNumber();return M&&re<1?re*Y.computeSize(P):re}}}getMilliseconds(){return this.hasValue()?this.isString(/ms$/)?this.getNumber():this.getNumber()*1e3:0}getRadians(){if(!this.hasValue())return 0;switch(!0){case this.isString(/deg$/):return this.getNumber()*(Math.PI/180);case this.isString(/grad$/):return this.getNumber()*(Math.PI/200);case this.isString(/rad$/):return this.getNumber();default:return this.getNumber()*(Math.PI/180)}}getDefinition(){const B=this.getString(),M=/#([^)'"]+)/.exec(B),P=(M==null?void 0:M[1])||B;return this.document.definitions[P]}getFillStyleDefinition(B,M){let P=this.getDefinition();if(!P)return null;if(typeof P.createGradient=="function"&&"getBoundingBox"in B)return P.createGradient(this.document.ctx,B,M);if(typeof P.createPattern=="function"){if(P.getHrefAttribute().hasValue()){const K=P.getAttribute("patternTransform");P=P.getHrefAttribute().getDefinition(),P&&K.hasValue()&&P.getAttribute("patternTransform",!0).setValue(K.value)}if(P)return P.createPattern(this.document.ctx,B,M)}return null}getTextBaseline(){if(!this.hasValue())return null;const B=this.getString();return Property.textBaselineMapping[B]||null}addOpacity(B){let M=this.getColor();const P=M.length;let K=0;for(let Y=0;Y<P&&(M[Y]===","&&K++,K!==3);Y++);if(B.hasValue()&&this.isString()&&K!==3){const Y=new RGBColor$1(M);Y.ok&&(Y.alpha=B.getNumber(),M=Y.toRGBA())}return new Property(this.document,this.name,M)}constructor(B,M,P){this.document=B,this.name=M,this.value=P,this.isNormalizedColor=!1}}Property.textBaselineMapping={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};class ViewPort{clear(){this.viewPorts=[]}setCurrent(B,M){this.viewPorts.push({width:B,height:M})}removeCurrent(){this.viewPorts.pop()}getRoot(){const[B]=this.viewPorts;return B||getDefault()}getCurrent(){const{viewPorts:B}=this,M=B[B.length-1];return M||getDefault()}get width(){return this.getCurrent().width}get height(){return this.getCurrent().height}computeSize(B){return typeof B=="number"?B:B==="x"?this.width:B==="y"?this.height:Math.sqrt(Math.pow(this.width,2)+Math.pow(this.height,2))/Math.sqrt(2)}constructor(){this.viewPorts=[]}}ViewPort.DEFAULT_VIEWPORT_WIDTH=800;ViewPort.DEFAULT_VIEWPORT_HEIGHT=600;function getDefault(){return{width:ViewPort.DEFAULT_VIEWPORT_WIDTH,height:ViewPort.DEFAULT_VIEWPORT_HEIGHT}}class Point{static parse(B){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const[P=M,K=M]=toNumbers(B);return new Point(P,K)}static parseScale(B){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const[P=M,K=P]=toNumbers(B);return new Point(P,K)}static parsePath(B){const M=toNumbers(B),P=M.length,K=[];for(let Y=0;Y<P;Y+=2)K.push(new Point(M[Y],M[Y+1]));return K}angleTo(B){return Math.atan2(B.y-this.y,B.x-this.x)}applyTransform(B){const{x:M,y:P}=this,K=M*B[0]+P*B[2]+B[4],Y=M*B[1]+P*B[3]+B[5];this.x=K,this.y=Y}constructor(B,M){this.x=B,this.y=M}}class Mouse{isWorking(){return this.working}start(){if(this.working)return;const{screen:B,onClick:M,onMouseMove:P}=this,K=B.ctx.canvas;K.onclick=M,K.onmousemove=P,this.working=!0}stop(){if(!this.working)return;const B=this.screen.ctx.canvas;this.working=!1,B.onclick=null,B.onmousemove=null}hasEvents(){return this.working&&this.events.length>0}runEvents(){if(!this.working)return;const{screen:B,events:M,eventElements:P}=this,{style:K}=B.ctx.canvas;let Y;K&&(K.cursor=""),M.forEach((re,D)=>{let{run:ne}=re;for(Y=P[D];Y;)ne(Y),Y=Y.parent}),this.events=[],this.eventElements=[]}checkPath(B,M){if(!this.working||!M)return;const{events:P,eventElements:K}=this;P.forEach((Y,re)=>{let{x:D,y:ne}=Y;!K[re]&&M.isPointInPath&&M.isPointInPath(D,ne)&&(K[re]=B)})}checkBoundingBox(B,M){if(!this.working||!M)return;const{events:P,eventElements:K}=this;P.forEach((Y,re)=>{let{x:D,y:ne}=Y;!K[re]&&M.isPointInBox(D,ne)&&(K[re]=B)})}mapXY(B,M){const{window:P,ctx:K}=this.screen,Y=new Point(B,M);let re=K.canvas;for(;re;)Y.x-=re.offsetLeft,Y.y-=re.offsetTop,re=re.offsetParent;return P!=null&&P.scrollX&&(Y.x+=P.scrollX),P!=null&&P.scrollY&&(Y.y+=P.scrollY),Y}onClick(B){const{x:M,y:P}=this.mapXY(B.clientX,B.clientY);this.events.push({type:"onclick",x:M,y:P,run(K){K.onClick&&K.onClick()}})}onMouseMove(B){const{x:M,y:P}=this.mapXY(B.clientX,B.clientY);this.events.push({type:"onmousemove",x:M,y:P,run(K){K.onMouseMove&&K.onMouseMove()}})}constructor(B){this.screen=B,this.working=!1,this.events=[],this.eventElements=[],this.onClick=this.onClick.bind(this),this.onMouseMove=this.onMouseMove.bind(this)}}const defaultWindow=typeof window<"u"?window:null,defaultFetch$1=typeof fetch<"u"?fetch.bind(void 0):void 0;class Screen{wait(B){this.waits.push(B)}ready(){return this.readyPromise?this.readyPromise:Promise.resolve()}isReady(){if(this.isReadyLock)return!0;const B=this.waits.every(M=>M());return B&&(this.waits=[],this.resolveReady&&this.resolveReady()),this.isReadyLock=B,B}setDefaults(B){B.strokeStyle="rgba(0,0,0,0)",B.lineCap="butt",B.lineJoin="miter",B.miterLimit=4}setViewBox(B){let{document:M,ctx:P,aspectRatio:K,width:Y,desiredWidth:re,height:D,desiredHeight:ne,minX:ae=0,minY:ue=0,refX:ge,refY:Be,clip:De=!1,clipX:ze=0,clipY:Oe=0}=B;const Je=compressSpaces(K).replace(/^defer\s/,""),[We,ut]=Je.split(" "),et=We||"xMidYMid",At=ut||"meet",nt=Y/re,ft=D/ne,Tt=Math.min(nt,ft),qt=Math.max(nt,ft);let Vt=re,vt=ne;At==="meet"&&(Vt*=Tt,vt*=Tt),At==="slice"&&(Vt*=qt,vt*=qt);const Ut=new Property(M,"refX",ge),Pt=new Property(M,"refY",Be),Yt=Ut.hasValue()&&Pt.hasValue();if(Yt&&P.translate(-Tt*Ut.getPixels("x"),-Tt*Pt.getPixels("y")),De){const Ai=Tt*ze,Ri=Tt*Oe;P.beginPath(),P.moveTo(Ai,Ri),P.lineTo(Y,Ri),P.lineTo(Y,D),P.lineTo(Ai,D),P.closePath(),P.clip()}if(!Yt){const Ai=At==="meet"&&Tt===ft,Ri=At==="slice"&&qt===ft,Ei=At==="meet"&&Tt===nt,Li=At==="slice"&&qt===nt;et.startsWith("xMid")&&(Ai||Ri)&&P.translate(Y/2-Vt/2,0),et.endsWith("YMid")&&(Ei||Li)&&P.translate(0,D/2-vt/2),et.startsWith("xMax")&&(Ai||Ri)&&P.translate(Y-Vt,0),et.endsWith("YMax")&&(Ei||Li)&&P.translate(0,D-vt)}switch(!0){case et==="none":P.scale(nt,ft);break;case At==="meet":P.scale(Tt,Tt);break;case At==="slice":P.scale(qt,qt);break}P.translate(-ae,-ue)}start(B){let{enableRedraw:M=!1,ignoreMouse:P=!1,ignoreAnimation:K=!1,ignoreDimensions:Y=!1,ignoreClear:re=!1,forceRedraw:D,scaleWidth:ne,scaleHeight:ae,offsetX:ue,offsetY:ge}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{mouse:Be}=this,De=1e3/Screen.FRAMERATE;if(this.isReadyLock=!1,this.frameDuration=De,this.readyPromise=new Promise(ut=>{this.resolveReady=ut}),this.isReady()&&this.render(B,Y,re,ne,ae,ue,ge),!M)return;let ze=Date.now(),Oe=ze,Je=0;const We=()=>{ze=Date.now(),Je=ze-Oe,Je>=De&&(Oe=ze-Je%De,this.shouldUpdate(K,D)&&(this.render(B,Y,re,ne,ae,ue,ge),Be.runEvents())),this.intervalId=requestAnimationFrame$1(We)};P||Be.start(),this.intervalId=requestAnimationFrame$1(We)}stop(){this.intervalId&&(requestAnimationFrame$1.cancel(this.intervalId),this.intervalId=null),this.mouse.stop()}shouldUpdate(B,M){if(!B){const{frameDuration:P}=this;if(this.animations.reduce((Y,re)=>re.update(P)||Y,!1))return!0}return!!(typeof M=="function"&&M()||!this.isReadyLock&&this.isReady()||this.mouse.hasEvents())}render(B,M,P,K,Y,re,D){const{viewPort:ne,ctx:ae,isFirstRender:ue}=this,ge=ae.canvas;ne.clear(),ge.width&&ge.height&&ne.setCurrent(ge.width,ge.height);const Be=B.getStyle("width"),De=B.getStyle("height");!M&&(ue||typeof K!="number"&&typeof Y!="number")&&(Be.hasValue()&&(ge.width=Be.getPixels("x"),ge.style&&(ge.style.width="".concat(ge.width,"px"))),De.hasValue()&&(ge.height=De.getPixels("y"),ge.style&&(ge.style.height="".concat(ge.height,"px"))));let ze=ge.clientWidth||ge.width,Oe=ge.clientHeight||ge.height;if(M&&Be.hasValue()&&De.hasValue()&&(ze=Be.getPixels("x"),Oe=De.getPixels("y")),ne.setCurrent(ze,Oe),typeof re=="number"&&B.getAttribute("x",!0).setValue(re),typeof D=="number"&&B.getAttribute("y",!0).setValue(D),typeof K=="number"||typeof Y=="number"){const Je=toNumbers(B.getAttribute("viewBox").getString());let We=0,ut=0;if(typeof K=="number"){const At=B.getStyle("width");At.hasValue()?We=At.getPixels("x")/K:Je[2]&&!isNaN(Je[2])&&(We=Je[2]/K)}if(typeof Y=="number"){const At=B.getStyle("height");At.hasValue()?ut=At.getPixels("y")/Y:Je[3]&&!isNaN(Je[3])&&(ut=Je[3]/Y)}We||(We=ut),ut||(ut=We),B.getAttribute("width",!0).setValue(K),B.getAttribute("height",!0).setValue(Y);const et=B.getStyle("transform",!0,!0);et.setValue("".concat(et.getString()," scale(").concat(1/We,", ").concat(1/ut,")"))}P||ae.clearRect(0,0,ze,Oe),B.render(ae),ue&&(this.isFirstRender=!1)}constructor(B,{fetch:M=defaultFetch$1,window:P=defaultWindow}={}){if(this.ctx=B,this.viewPort=new ViewPort,this.mouse=new Mouse(this),this.animations=[],this.waits=[],this.frameDuration=0,this.isReadyLock=!1,this.isFirstRender=!0,this.intervalId=null,this.window=P,!M)throw new Error("Can't find 'fetch' in 'globalThis', please provide it via options");this.fetch=M}}Screen.defaultWindow=defaultWindow;Screen.defaultFetch=defaultFetch$1;Screen.FRAMERATE=30;Screen.MAX_VIRTUAL_PIXELS=3e4;const{defaultFetch}=Screen,DefaultDOMParser=typeof DOMParser<"u"?DOMParser:void 0;class Parser{async parse(B){return B.startsWith("<")?this.parseFromString(B):this.load(B)}parseFromString(B){const M=new this.DOMParser;try{return this.checkDocument(M.parseFromString(B,"image/svg+xml"))}catch{return this.checkDocument(M.parseFromString(B,"text/xml"))}}checkDocument(B){const M=B.getElementsByTagName("parsererror")[0];if(M)throw new Error(M.textContent||"Unknown parse error");return B}async load(B){const P=await(await this.fetch(B)).text();return this.parseFromString(P)}constructor({fetch:B=defaultFetch,DOMParser:M=DefaultDOMParser}={}){if(!B)throw new Error("Can't find 'fetch' in 'globalThis', please provide it via options");if(!M)throw new Error("Can't find 'DOMParser' in 'globalThis', please provide it via options");this.fetch=B,this.DOMParser=M}}class Translate{apply(B){const{x:M,y:P}=this.point;B.translate(M||0,P||0)}unapply(B){const{x:M,y:P}=this.point;B.translate(-1*M||0,-1*P||0)}applyToPoint(B){const{x:M,y:P}=this.point;B.applyTransform([1,0,0,1,M||0,P||0])}constructor(B,M){this.type="translate",this.point=Point.parse(M)}}class Rotate{apply(B){const{cx:M,cy:P,originX:K,originY:Y,angle:re}=this,D=M+K.getPixels("x"),ne=P+Y.getPixels("y");B.translate(D,ne),B.rotate(re.getRadians()),B.translate(-D,-ne)}unapply(B){const{cx:M,cy:P,originX:K,originY:Y,angle:re}=this,D=M+K.getPixels("x"),ne=P+Y.getPixels("y");B.translate(D,ne),B.rotate(-1*re.getRadians()),B.translate(-D,-ne)}applyToPoint(B){const{cx:M,cy:P,angle:K}=this,Y=K.getRadians();B.applyTransform([1,0,0,1,M||0,P||0]),B.applyTransform([Math.cos(Y),Math.sin(Y),-Math.sin(Y),Math.cos(Y),0,0]),B.applyTransform([1,0,0,1,-M||0,-P||0])}constructor(B,M,P){this.type="rotate";const K=toNumbers(M);this.angle=new Property(B,"angle",K[0]),this.originX=P[0],this.originY=P[1],this.cx=K[1]||0,this.cy=K[2]||0}}class Scale{apply(B){const{scale:{x:M,y:P},originX:K,originY:Y}=this,re=K.getPixels("x"),D=Y.getPixels("y");B.translate(re,D),B.scale(M,P||M),B.translate(-re,-D)}unapply(B){const{scale:{x:M,y:P},originX:K,originY:Y}=this,re=K.getPixels("x"),D=Y.getPixels("y");B.translate(re,D),B.scale(1/M,1/P||M),B.translate(-re,-D)}applyToPoint(B){const{x:M,y:P}=this.scale;B.applyTransform([M||0,0,0,P||0,0,0])}constructor(B,M,P){this.type="scale";const K=Point.parseScale(M);(K.x===0||K.y===0)&&(K.x=PSEUDO_ZERO,K.y=PSEUDO_ZERO),this.scale=K,this.originX=P[0],this.originY=P[1]}}class Matrix{apply(B){const{originX:M,originY:P,matrix:K}=this,Y=M.getPixels("x"),re=P.getPixels("y");B.translate(Y,re),B.transform(K[0],K[1],K[2],K[3],K[4],K[5]),B.translate(-Y,-re)}unapply(B){const{originX:M,originY:P,matrix:K}=this,Y=K[0],re=K[2],D=K[4],ne=K[1],ae=K[3],ue=K[5],ge=0,Be=0,De=1,ze=1/(Y*(ae*De-ue*Be)-re*(ne*De-ue*ge)+D*(ne*Be-ae*ge)),Oe=M.getPixels("x"),Je=P.getPixels("y");B.translate(Oe,Je),B.transform(ze*(ae*De-ue*Be),ze*(ue*ge-ne*De),ze*(D*Be-re*De),ze*(Y*De-D*ge),ze*(re*ue-D*ae),ze*(D*ne-Y*ue)),B.translate(-Oe,-Je)}applyToPoint(B){B.applyTransform(this.matrix)}constructor(B,M,P){this.type="matrix",this.matrix=toMatrixValue(M),this.originX=P[0],this.originY=P[1]}}class Skew extends Matrix{constructor(B,M,P){super(B,M,P),this.type="skew",this.angle=new Property(B,"angle",M)}}class SkewX extends Skew{constructor(B,M,P){super(B,M,P),this.type="skewX",this.matrix=[1,0,Math.tan(this.angle.getRadians()),1,0,0]}}class SkewY extends Skew{constructor(B,M,P){super(B,M,P),this.type="skewY",this.matrix=[1,Math.tan(this.angle.getRadians()),0,1,0,0]}}function parseTransforms(g){return compressSpaces(g).trim().replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/)}function parseTransform(g){const[B="",M=""]=g.split("(");return[B.trim(),M.trim().replace(")","")]}class Transform{static fromElement(B,M){const P=M.getStyle("transform",!1,!0);if(P.hasValue()){const[K,Y=K]=M.getStyle("transform-origin",!1,!0).split();if(K&&Y){const re=[K,Y];return new Transform(B,P.getString(),re)}}return null}apply(B){this.transforms.forEach(M=>M.apply(B))}unapply(B){this.transforms.forEach(M=>M.unapply(B))}applyToPoint(B){this.transforms.forEach(M=>M.applyToPoint(B))}constructor(B,M,P){this.document=B,this.transforms=[],parseTransforms(M).forEach(Y=>{if(Y==="none")return;const[re,D]=parseTransform(Y),ne=Transform.transformTypes[re];ne&&this.transforms.push(new ne(this.document,D,P))})}}Transform.transformTypes={translate:Translate,rotate:Rotate,scale:Scale,matrix:Matrix,skewX:SkewX,skewY:SkewY};class Element{getAttribute(B){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const P=this.attributes[B];if(!P&&M){const K=new Property(this.document,B,"");return this.attributes[B]=K,K}return P||Property.empty(this.document)}getHrefAttribute(){let B;for(const M in this.attributes)if(M==="href"||M.endsWith(":href")){B=this.attributes[M];break}return B||Property.empty(this.document)}getStyle(B){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const K=this.styles[B];if(K)return K;const Y=this.getAttribute(B);if(Y.hasValue())return this.styles[B]=Y,Y;if(!P){const{parent:re}=this;if(re){const D=re.getStyle(B);if(D.hasValue())return D}}if(M){const re=new Property(this.document,B,"");return this.styles[B]=re,re}return Property.empty(this.document)}render(B){if(!(this.getStyle("display").getString()==="none"||this.getStyle("visibility").getString()==="hidden")){if(B.save(),this.getStyle("mask").hasValue()){const M=this.getStyle("mask").getDefinition();M&&(this.applyEffects(B),M.apply(B,this))}else if(this.getStyle("filter").getValue("none")!=="none"){const M=this.getStyle("filter").getDefinition();M&&(this.applyEffects(B),M.apply(B,this))}else this.setContext(B),this.renderChildren(B),this.clearContext(B);B.restore()}}setContext(B){}applyEffects(B){const M=Transform.fromElement(this.document,this);M&&M.apply(B);const P=this.getStyle("clip-path",!1,!0);if(P.hasValue()){const K=P.getDefinition();K&&K.apply(B)}}clearContext(B){}renderChildren(B){this.children.forEach(M=>{M.render(B)})}addChild(B){const M=B instanceof Element?B:this.document.createElement(B);M.parent=this,Element.ignoreChildTypes.includes(M.type)||this.children.push(M)}matchesSelector(B){var M;const{node:P}=this;if(typeof P.matches=="function")return P.matches(B);const K=(M=P.getAttribute)===null||M===void 0?void 0:M.call(P,"class");return!K||K===""?!1:K.split(" ").some(Y=>".".concat(Y)===B)}addStylesFromStyleDefinition(){const{styles:B,stylesSpecificity:M}=this.document;let P;for(const K in B)if(!K.startsWith("@")&&this.matchesSelector(K)){const Y=B[K],re=M[K];if(Y)for(const D in Y){let ne=this.stylesSpecificity[D];typeof ne>"u"&&(ne="000"),re&&re>=ne&&(P=Y[D],P&&(this.styles[D]=P),this.stylesSpecificity[D]=re)}}}removeStyles(B,M){return M.reduce((K,Y)=>{const re=B.getStyle(Y);if(!re.hasValue())return K;const D=re.getString();return re.setValue(""),[...K,[Y,D]]},[])}restoreStyles(B,M){M.forEach(P=>{let[K,Y]=P;B.getStyle(K,!0).setValue(Y)})}isFirstChild(){var B;return((B=this.parent)===null||B===void 0?void 0:B.children.indexOf(this))===0}constructor(B,M,P=!1){if(this.document=B,this.node=M,this.captureTextNodes=P,this.type="",this.attributes={},this.styles={},this.stylesSpecificity={},this.animationFrozen=!1,this.animationFrozenValue="",this.parent=null,this.children=[],!M||M.nodeType!==1)return;Array.from(M.attributes).forEach(re=>{const D=normalizeAttributeName(re.nodeName);this.attributes[D]=new Property(B,D,re.value)}),this.addStylesFromStyleDefinition(),this.getAttribute("style").hasValue()&&this.getAttribute("style").getString().split(";").map(D=>D.trim()).forEach(D=>{if(!D)return;const[ne,ae]=D.split(":").map(ue=>ue.trim());ne&&(this.styles[ne]=new Property(B,ne,ae))});const{definitions:K}=B,Y=this.getAttribute("id");Y.hasValue()&&(K[Y.getString()]||(K[Y.getString()]=this)),Array.from(M.childNodes).forEach(re=>{if(re.nodeType===1)this.addChild(re);else if(P&&(re.nodeType===3||re.nodeType===4)){const D=B.createTextNode(re);D.getText().length>0&&this.addChild(D)}})}}Element.ignoreChildTypes=["title"];class UnknownElement extends Element{constructor(B,M,P){super(B,M,P)}}function wrapFontFamily(g){const B=g.trim();return/^('|")/.test(B)?B:'"'.concat(B,'"')}function prepareFontFamily(g){return typeof process>"u"?g:g.trim().split(",").map(wrapFontFamily).join(",")}function prepareFontStyle(g){if(!g)return"";const B=g.trim().toLowerCase();switch(B){case"normal":case"italic":case"oblique":case"inherit":case"initial":case"unset":return B;default:return/^oblique\s+(-|)\d+deg$/.test(B)?B:""}}function prepareFontWeight(g){if(!g)return"";const B=g.trim().toLowerCase();switch(B){case"normal":case"bold":case"lighter":case"bolder":case"inherit":case"initial":case"unset":return B;default:return/^[\d.]+$/.test(B)?B:""}}class Font{static parse(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",M=arguments.length>1?arguments[1]:void 0,P="",K="",Y="",re="",D="";const ne=compressSpaces(B).trim().split(" "),ae={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1};return ne.forEach(ue=>{switch(!0){case(!ae.fontStyle&&Font.styles.includes(ue)):ue!=="inherit"&&(P=ue),ae.fontStyle=!0;break;case(!ae.fontVariant&&Font.variants.includes(ue)):ue!=="inherit"&&(K=ue),ae.fontStyle=!0,ae.fontVariant=!0;break;case(!ae.fontWeight&&Font.weights.includes(ue)):ue!=="inherit"&&(Y=ue),ae.fontStyle=!0,ae.fontVariant=!0,ae.fontWeight=!0;break;case!ae.fontSize:ue!=="inherit"&&(re=ue.split("/")[0]||""),ae.fontStyle=!0,ae.fontVariant=!0,ae.fontWeight=!0,ae.fontSize=!0;break;default:ue!=="inherit"&&(D+=ue)}}),new Font(P,K,Y,re,D,M)}toString(){return[prepareFontStyle(this.fontStyle),this.fontVariant,prepareFontWeight(this.fontWeight),this.fontSize,prepareFontFamily(this.fontFamily)].join(" ").trim()}constructor(B,M,P,K,Y,re){const D=re?typeof re=="string"?Font.parse(re):re:{};this.fontFamily=Y||D.fontFamily,this.fontSize=K||D.fontSize,this.fontStyle=B||D.fontStyle,this.fontWeight=P||D.fontWeight,this.fontVariant=M||D.fontVariant}}Font.styles="normal|italic|oblique|inherit";Font.variants="normal|small-caps|inherit";Font.weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit";class BoundingBox{get x(){return this.x1}get y(){return this.y1}get width(){return this.x2-this.x1}get height(){return this.y2-this.y1}addPoint(B,M){typeof B<"u"&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=B,this.x2=B),B<this.x1&&(this.x1=B),B>this.x2&&(this.x2=B)),typeof M<"u"&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=M,this.y2=M),M<this.y1&&(this.y1=M),M>this.y2&&(this.y2=M))}addX(B){this.addPoint(B,0)}addY(B){this.addPoint(0,B)}addBoundingBox(B){if(!B)return;const{x1:M,y1:P,x2:K,y2:Y}=B;this.addPoint(M,P),this.addPoint(K,Y)}sumCubic(B,M,P,K,Y){return Math.pow(1-B,3)*M+3*Math.pow(1-B,2)*B*P+3*(1-B)*Math.pow(B,2)*K+Math.pow(B,3)*Y}bezierCurveAdd(B,M,P,K,Y){const re=6*M-12*P+6*K,D=-3*M+9*P-9*K+3*Y,ne=3*P-3*M;if(D===0){if(re===0)return;const Be=-ne/re;0<Be&&Be<1&&(B?this.addX(this.sumCubic(Be,M,P,K,Y)):this.addY(this.sumCubic(Be,M,P,K,Y)));return}const ae=Math.pow(re,2)-4*ne*D;if(ae<0)return;const ue=(-re+Math.sqrt(ae))/(2*D);0<ue&&ue<1&&(B?this.addX(this.sumCubic(ue,M,P,K,Y)):this.addY(this.sumCubic(ue,M,P,K,Y)));const ge=(-re-Math.sqrt(ae))/(2*D);0<ge&&ge<1&&(B?this.addX(this.sumCubic(ge,M,P,K,Y)):this.addY(this.sumCubic(ge,M,P,K,Y)))}addBezierCurve(B,M,P,K,Y,re,D,ne){this.addPoint(B,M),this.addPoint(D,ne),this.bezierCurveAdd(!0,B,P,Y,D),this.bezierCurveAdd(!1,M,K,re,ne)}addQuadraticCurve(B,M,P,K,Y,re){const D=B+.6666666666666666*(P-B),ne=M+2/3*(K-M),ae=D+1/3*(Y-B),ue=ne+1/3*(re-M);this.addBezierCurve(B,M,D,ae,ne,ue,Y,re)}isPointInBox(B,M){const{x1:P,y1:K,x2:Y,y2:re}=this;return P<=B&&B<=Y&&K<=M&&M<=re}constructor(B=Number.NaN,M=Number.NaN,P=Number.NaN,K=Number.NaN){this.x1=B,this.y1=M,this.x2=P,this.y2=K,this.addPoint(B,M),this.addPoint(P,K)}}class RenderedElement extends Element{calculateOpacity(){let B=1,M=this;for(;M;){const P=M.getStyle("opacity",!1,!0);P.hasValue(!0)&&(B*=P.getNumber()),M=M.parent}return B}setContext(B){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!M){const P=this.getStyle("fill"),K=this.getStyle("fill-opacity"),Y=this.getStyle("stroke"),re=this.getStyle("stroke-opacity");if(P.isUrlDefinition()){const De=P.getFillStyleDefinition(this,K);De&&(B.fillStyle=De)}else if(P.hasValue()){P.getString()==="currentColor"&&P.setValue(this.getStyle("color").getColor());const De=P.getColor();De!=="inherit"&&(B.fillStyle=De==="none"?"rgba(0,0,0,0)":De)}if(K.hasValue()){const De=new Property(this.document,"fill",B.fillStyle).addOpacity(K).getColor();B.fillStyle=De}if(Y.isUrlDefinition()){const De=Y.getFillStyleDefinition(this,re);De&&(B.strokeStyle=De)}else if(Y.hasValue()){Y.getString()==="currentColor"&&Y.setValue(this.getStyle("color").getColor());const De=Y.getString();De!=="inherit"&&(B.strokeStyle=De==="none"?"rgba(0,0,0,0)":De)}if(re.hasValue()){const De=new Property(this.document,"stroke",B.strokeStyle).addOpacity(re).getString();B.strokeStyle=De}const D=this.getStyle("stroke-width");if(D.hasValue()){const De=D.getPixels();B.lineWidth=De||PSEUDO_ZERO}const ne=this.getStyle("stroke-linecap"),ae=this.getStyle("stroke-linejoin"),ue=this.getStyle("stroke-miterlimit"),ge=this.getStyle("stroke-dasharray"),Be=this.getStyle("stroke-dashoffset");if(ne.hasValue()&&(B.lineCap=ne.getString()),ae.hasValue()&&(B.lineJoin=ae.getString()),ue.hasValue()&&(B.miterLimit=ue.getNumber()),ge.hasValue()&&ge.getString()!=="none"){const De=toNumbers(ge.getString());typeof B.setLineDash<"u"?B.setLineDash(De):typeof B.webkitLineDash<"u"?B.webkitLineDash=De:typeof B.mozDash<"u"&&!(De.length===1&&De[0]===0)&&(B.mozDash=De);const ze=Be.getPixels();typeof B.lineDashOffset<"u"?B.lineDashOffset=ze:typeof B.webkitLineDashOffset<"u"?B.webkitLineDashOffset=ze:typeof B.mozDashOffset<"u"&&(B.mozDashOffset=ze)}}if(this.modifiedEmSizeStack=!1,typeof B.font<"u"){const P=this.getStyle("font"),K=this.getStyle("font-style"),Y=this.getStyle("font-variant"),re=this.getStyle("font-weight"),D=this.getStyle("font-size"),ne=this.getStyle("font-family"),ae=new Font(K.getString(),Y.getString(),re.getString(),D.hasValue()?"".concat(D.getPixels(!0),"px"):"",ne.getString(),Font.parse(P.getString(),B.font));K.setValue(ae.fontStyle),Y.setValue(ae.fontVariant),re.setValue(ae.fontWeight),D.setValue(ae.fontSize),ne.setValue(ae.fontFamily),B.font=ae.toString(),D.isPixels()&&(this.document.emSize=D.getPixels(),this.modifiedEmSizeStack=!0)}M||(this.applyEffects(B),B.globalAlpha=this.calculateOpacity())}clearContext(B){super.clearContext(B),this.modifiedEmSizeStack&&this.document.popEmSize()}constructor(...B){super(...B),this.modifiedEmSizeStack=!1}}class TextElement extends RenderedElement{setContext(B){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.setContext(B,M);const P=this.getStyle("dominant-baseline").getTextBaseline()||this.getStyle("alignment-baseline").getTextBaseline();P&&(B.textBaseline=P)}initializeCoordinates(){this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY}getBoundingBox(B){if(this.type!=="text")return this.getTElementBoundingBox(B);this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(B);let M=null;return this.children.forEach((P,K)=>{const Y=this.getChildBoundingBox(B,this,this,K);M?M.addBoundingBox(Y):M=Y}),M}getFontSize(){const{document:B,parent:M}=this,P=Font.parse(B.ctx.font).fontSize;return M.getStyle("font-size").getNumber(P)}getTElementBoundingBox(B){const M=this.getFontSize();return new BoundingBox(this.x,this.y-M,this.x+this.measureText(B),this.y)}getGlyph(B,M,P){const K=M[P];let Y;if(B.isArabic){var re;const D=M.length,ne=M[P-1],ae=M[P+1];let ue="isolated";(P===0||ne===" ")&&P<D-1&&ae!==" "&&(ue="terminal"),P>0&&ne!==" "&&P<D-1&&ae!==" "&&(ue="medial"),P>0&&ne!==" "&&(P===D-1||ae===" ")&&(ue="initial"),Y=((re=B.arabicGlyphs[K])===null||re===void 0?void 0:re[ue])||B.glyphs[K]}else Y=B.glyphs[K];return Y||(Y=B.missingGlyph),Y}getText(){return""}getTextFromNode(B){const M=B||this.node,P=Array.from(M.parentNode.childNodes),K=P.indexOf(M),Y=P.length-1;let re=compressSpaces(M.textContent||"");return K===0&&(re=trimLeft(re)),K===Y&&(re=trimRight(re)),re}renderChildren(B){if(this.type!=="text"){this.renderTElementChildren(B);return}this.initializeCoordinates(),this.adjustChildCoordinatesRecursive(B),this.children.forEach((P,K)=>{this.renderChild(B,this,this,K)});const{mouse:M}=this.document.screen;M.isWorking()&&M.checkBoundingBox(this,this.getBoundingBox(B))}renderTElementChildren(B){const{document:M,parent:P}=this,K=this.getText(),Y=P.getStyle("font-family").getDefinition();if(Y){const{unitsPerEm:ne}=Y.fontFace,ae=Font.parse(M.ctx.font),ue=P.getStyle("font-size").getNumber(ae.fontSize),ge=P.getStyle("font-style").getString(ae.fontStyle),Be=ue/ne,De=Y.isRTL?K.split("").reverse().join(""):K,ze=toNumbers(P.getAttribute("dx").getString()),Oe=De.length;for(let Je=0;Je<Oe;Je++){const We=this.getGlyph(Y,De,Je);B.translate(this.x,this.y),B.scale(Be,-Be);const ut=B.lineWidth;B.lineWidth=B.lineWidth*ne/ue,ge==="italic"&&B.transform(1,0,.4,1,0,0),We.render(B),ge==="italic"&&B.transform(1,0,-.4,1,0,0),B.lineWidth=ut,B.scale(1/Be,-1/Be),B.translate(-this.x,-this.y),this.x+=ue*(We.horizAdvX||Y.horizAdvX)/ne,typeof ze[Je]<"u"&&!isNaN(ze[Je])&&(this.x+=ze[Je])}return}const{x:re,y:D}=this;B.fillStyle&&B.fillText(K,re,D),B.strokeStyle&&B.strokeText(K,re,D)}applyAnchoring(){if(this.textChunkStart>=this.leafTexts.length)return;const B=this.leafTexts[this.textChunkStart],M=B.getStyle("text-anchor").getString("start"),P=!1;let K=0;M==="start"&&!P||M==="end"&&P?K=B.x-this.minX:M==="end"&&!P||M==="start"&&P?K=B.x-this.maxX:K=B.x-(this.minX+this.maxX)/2;for(let Y=this.textChunkStart;Y<this.leafTexts.length;Y++)this.leafTexts[Y].x+=K;this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.textChunkStart=this.leafTexts.length}adjustChildCoordinatesRecursive(B){this.children.forEach((M,P)=>{this.adjustChildCoordinatesRecursiveCore(B,this,this,P)}),this.applyAnchoring()}adjustChildCoordinatesRecursiveCore(B,M,P,K){const Y=P.children[K];Y.children.length>0?Y.children.forEach((re,D)=>{M.adjustChildCoordinatesRecursiveCore(B,M,Y,D)}):this.adjustChildCoordinates(B,M,P,K)}adjustChildCoordinates(B,M,P,K){const Y=P.children[K];if(typeof Y.measureText!="function")return Y;B.save(),Y.setContext(B,!0);const re=Y.getAttribute("x"),D=Y.getAttribute("y"),ne=Y.getAttribute("dx"),ae=Y.getAttribute("dy"),ue=Y.getStyle("font-family").getDefinition(),ge=!!(ue!=null&&ue.isRTL);K===0&&(re.hasValue()||re.setValue(Y.getInheritedAttribute("x")),D.hasValue()||D.setValue(Y.getInheritedAttribute("y")),ne.hasValue()||ne.setValue(Y.getInheritedAttribute("dx")),ae.hasValue()||ae.setValue(Y.getInheritedAttribute("dy")));const Be=Y.measureText(B);return ge&&(M.x-=Be),re.hasValue()?(M.applyAnchoring(),Y.x=re.getPixels("x"),ne.hasValue()&&(Y.x+=ne.getPixels("x"))):(ne.hasValue()&&(M.x+=ne.getPixels("x")),Y.x=M.x),M.x=Y.x,ge||(M.x+=Be),D.hasValue()?(Y.y=D.getPixels("y"),ae.hasValue()&&(Y.y+=ae.getPixels("y"))):(ae.hasValue()&&(M.y+=ae.getPixels("y")),Y.y=M.y),M.y=Y.y,M.leafTexts.push(Y),M.minX=Math.min(M.minX,Y.x,Y.x+Be),M.maxX=Math.max(M.maxX,Y.x,Y.x+Be),Y.clearContext(B),B.restore(),Y}getChildBoundingBox(B,M,P,K){const Y=P.children[K];if(typeof Y.getBoundingBox!="function")return null;const re=Y.getBoundingBox(B);return re&&Y.children.forEach((D,ne)=>{const ae=M.getChildBoundingBox(B,M,Y,ne);re.addBoundingBox(ae)}),re}renderChild(B,M,P,K){const Y=P.children[K];Y.render(B),Y.children.forEach((re,D)=>{M.renderChild(B,M,Y,D)})}measureText(B){const{measureCache:M}=this;if(~M)return M;const P=this.getText(),K=this.measureTargetText(B,P);return this.measureCache=K,K}measureTargetText(B,M){if(!M.length)return 0;const{parent:P}=this,K=P.getStyle("font-family").getDefinition();if(K){const re=this.getFontSize(),D=K.isRTL?M.split("").reverse().join(""):M,ne=toNumbers(P.getAttribute("dx").getString()),ae=D.length;let ue=0;for(let ge=0;ge<ae;ge++){const Be=this.getGlyph(K,D,ge);ue+=(Be.horizAdvX||K.horizAdvX)*re/K.fontFace.unitsPerEm,typeof ne[ge]<"u"&&!isNaN(ne[ge])&&(ue+=ne[ge])}return ue}if(!B.measureText)return M.length*10;B.save(),this.setContext(B,!0);const{width:Y}=B.measureText(M);return this.clearContext(B),B.restore(),Y}getInheritedAttribute(B){let M=this;for(;M instanceof TextElement&&M.isFirstChild()&&M.parent;){const P=M.parent.getAttribute(B);if(P.hasValue(!0))return P.getString("0");M=M.parent}return null}constructor(B,M,P){super(B,M,new.target===TextElement?!0:P),this.type="text",this.x=0,this.y=0,this.leafTexts=[],this.textChunkStart=0,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.measureCache=-1}}class TSpanElement extends TextElement{getText(){return this.text}constructor(B,M,P){super(B,M,new.target===TSpanElement?!0:P),this.type="tspan",this.text=this.children.length>0?"":this.getTextFromNode()}}class TextNode extends TSpanElement{constructor(...B){super(...B),this.type="textNode"}}class PathParser extends _{reset(){this.i=-1,this.command=null,this.previousCommand=null,this.start=new Point(0,0),this.control=new Point(0,0),this.current=new Point(0,0),this.points=[],this.angles=[]}isEnd(){const{i:B,commands:M}=this;return B>=M.length-1}next(){const B=this.commands[++this.i];return this.previousCommand=this.command,this.command=B,B}getPoint(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"x",M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"y";const P=new Point(this.command[B],this.command[M]);return this.makeAbsolute(P)}getAsControlPoint(B,M){const P=this.getPoint(B,M);return this.control=P,P}getAsCurrentPoint(B,M){const P=this.getPoint(B,M);return this.current=P,P}getReflectedControlPoint(){const B=this.previousCommand.type;if(B!==_.CURVE_TO&&B!==_.SMOOTH_CURVE_TO&&B!==_.QUAD_TO&&B!==_.SMOOTH_QUAD_TO)return this.current;const{current:{x:M,y:P},control:{x:K,y:Y}}=this;return new Point(2*M-K,2*P-Y)}makeAbsolute(B){if(this.command.relative){const{x:M,y:P}=this.current;B.x+=M,B.y+=P}return B}addMarker(B,M,P){const{points:K,angles:Y}=this;P&&Y.length>0&&!Y[Y.length-1]&&(Y[Y.length-1]=K[K.length-1].angleTo(P)),this.addMarkerAngle(B,M?M.angleTo(B):null)}addMarkerAngle(B,M){this.points.push(B),this.angles.push(M)}getMarkerPoints(){return this.points}getMarkerAngles(){const{angles:B}=this,M=B.length;for(let P=0;P<M;P++)if(!B[P]){for(let K=P+1;K<M;K++)if(B[K]){B[P]=B[K];break}}return B}constructor(B){super(B.replace(/([+\-.])\s+/gm,"$1").replace(/[^MmZzLlHhVvCcSsQqTtAae\d\s.,+-].*/g,"")),this.control=new Point(0,0),this.start=new Point(0,0),this.current=new Point(0,0),this.command=null,this.commands=this.commands,this.i=-1,this.previousCommand=null,this.points=[],this.angles=[]}}class PathElement extends RenderedElement{path(B){const{pathParser:M}=this,P=new BoundingBox;for(M.reset(),B&&B.beginPath();!M.isEnd();)switch(M.next().type){case PathParser.MOVE_TO:this.pathM(B,P);break;case PathParser.LINE_TO:this.pathL(B,P);break;case PathParser.HORIZ_LINE_TO:this.pathH(B,P);break;case PathParser.VERT_LINE_TO:this.pathV(B,P);break;case PathParser.CURVE_TO:this.pathC(B,P);break;case PathParser.SMOOTH_CURVE_TO:this.pathS(B,P);break;case PathParser.QUAD_TO:this.pathQ(B,P);break;case PathParser.SMOOTH_QUAD_TO:this.pathT(B,P);break;case PathParser.ARC:this.pathA(B,P);break;case PathParser.CLOSE_PATH:this.pathZ(B,P);break}return P}getBoundingBox(B){return this.path()}getMarkers(){const{pathParser:B}=this,M=B.getMarkerPoints(),P=B.getMarkerAngles();return M.map((Y,re)=>[Y,P[re]])}renderChildren(B){this.path(B),this.document.screen.mouse.checkPath(this,B);const M=this.getStyle("fill-rule");B.fillStyle!==""&&(M.getString("inherit")!=="inherit"?B.fill(M.getString()):B.fill()),B.strokeStyle!==""&&(this.getAttribute("vector-effect").getString()==="non-scaling-stroke"?(B.save(),B.setTransform(1,0,0,1,0,0),B.stroke(),B.restore()):B.stroke());const P=this.getMarkers();if(P){const K=P.length-1,Y=this.getStyle("marker-start"),re=this.getStyle("marker-mid"),D=this.getStyle("marker-end");if(Y.isUrlDefinition()){const ne=Y.getDefinition(),[ae,ue]=P[0];ne.render(B,ae,ue)}if(re.isUrlDefinition()){const ne=re.getDefinition();for(let ae=1;ae<K;ae++){const[ue,ge]=P[ae];ne.render(B,ue,ge)}}if(D.isUrlDefinition()){const ne=D.getDefinition(),[ae,ue]=P[K];ne.render(B,ae,ue)}}}static pathM(B){const M=B.getAsCurrentPoint();return B.start=B.current,{point:M}}pathM(B,M){const{pathParser:P}=this,{point:K}=PathElement.pathM(P),{x:Y,y:re}=K;P.addMarker(K),M.addPoint(Y,re),B&&B.moveTo(Y,re)}static pathL(B){const{current:M}=B,P=B.getAsCurrentPoint();return{current:M,point:P}}pathL(B,M){const{pathParser:P}=this,{current:K,point:Y}=PathElement.pathL(P),{x:re,y:D}=Y;P.addMarker(Y,K),M.addPoint(re,D),B&&B.lineTo(re,D)}static pathH(B){const{current:M,command:P}=B,K=new Point((P.relative?M.x:0)+P.x,M.y);return B.current=K,{current:M,point:K}}pathH(B,M){const{pathParser:P}=this,{current:K,point:Y}=PathElement.pathH(P),{x:re,y:D}=Y;P.addMarker(Y,K),M.addPoint(re,D),B&&B.lineTo(re,D)}static pathV(B){const{current:M,command:P}=B,K=new Point(M.x,(P.relative?M.y:0)+P.y);return B.current=K,{current:M,point:K}}pathV(B,M){const{pathParser:P}=this,{current:K,point:Y}=PathElement.pathV(P),{x:re,y:D}=Y;P.addMarker(Y,K),M.addPoint(re,D),B&&B.lineTo(re,D)}static pathC(B){const{current:M}=B,P=B.getPoint("x1","y1"),K=B.getAsControlPoint("x2","y2"),Y=B.getAsCurrentPoint();return{current:M,point:P,controlPoint:K,currentPoint:Y}}pathC(B,M){const{pathParser:P}=this,{current:K,point:Y,controlPoint:re,currentPoint:D}=PathElement.pathC(P);P.addMarker(D,re,Y),M.addBezierCurve(K.x,K.y,Y.x,Y.y,re.x,re.y,D.x,D.y),B&&B.bezierCurveTo(Y.x,Y.y,re.x,re.y,D.x,D.y)}static pathS(B){const{current:M}=B,P=B.getReflectedControlPoint(),K=B.getAsControlPoint("x2","y2"),Y=B.getAsCurrentPoint();return{current:M,point:P,controlPoint:K,currentPoint:Y}}pathS(B,M){const{pathParser:P}=this,{current:K,point:Y,controlPoint:re,currentPoint:D}=PathElement.pathS(P);P.addMarker(D,re,Y),M.addBezierCurve(K.x,K.y,Y.x,Y.y,re.x,re.y,D.x,D.y),B&&B.bezierCurveTo(Y.x,Y.y,re.x,re.y,D.x,D.y)}static pathQ(B){const{current:M}=B,P=B.getAsControlPoint("x1","y1"),K=B.getAsCurrentPoint();return{current:M,controlPoint:P,currentPoint:K}}pathQ(B,M){const{pathParser:P}=this,{current:K,controlPoint:Y,currentPoint:re}=PathElement.pathQ(P);P.addMarker(re,Y,Y),M.addQuadraticCurve(K.x,K.y,Y.x,Y.y,re.x,re.y),B&&B.quadraticCurveTo(Y.x,Y.y,re.x,re.y)}static pathT(B){const{current:M}=B,P=B.getReflectedControlPoint();B.control=P;const K=B.getAsCurrentPoint();return{current:M,controlPoint:P,currentPoint:K}}pathT(B,M){const{pathParser:P}=this,{current:K,controlPoint:Y,currentPoint:re}=PathElement.pathT(P);P.addMarker(re,Y,Y),M.addQuadraticCurve(K.x,K.y,Y.x,Y.y,re.x,re.y),B&&B.quadraticCurveTo(Y.x,Y.y,re.x,re.y)}static pathA(B){const{current:M,command:P}=B;let{rX:K,rY:Y,xRot:re,lArcFlag:D,sweepFlag:ne}=P;const ae=re*(Math.PI/180),ue=B.getAsCurrentPoint(),ge=new Point(Math.cos(ae)*(M.x-ue.x)/2+Math.sin(ae)*(M.y-ue.y)/2,-Math.sin(ae)*(M.x-ue.x)/2+Math.cos(ae)*(M.y-ue.y)/2),Be=Math.pow(ge.x,2)/Math.pow(K,2)+Math.pow(ge.y,2)/Math.pow(Y,2);Be>1&&(K*=Math.sqrt(Be),Y*=Math.sqrt(Be));let De=(D===ne?-1:1)*Math.sqrt((Math.pow(K,2)*Math.pow(Y,2)-Math.pow(K,2)*Math.pow(ge.y,2)-Math.pow(Y,2)*Math.pow(ge.x,2))/(Math.pow(K,2)*Math.pow(ge.y,2)+Math.pow(Y,2)*Math.pow(ge.x,2)));isNaN(De)&&(De=0);const ze=new Point(De*K*ge.y/Y,De*-Y*ge.x/K),Oe=new Point((M.x+ue.x)/2+Math.cos(ae)*ze.x-Math.sin(ae)*ze.y,(M.y+ue.y)/2+Math.sin(ae)*ze.x+Math.cos(ae)*ze.y),Je=vectorsAngle([1,0],[(ge.x-ze.x)/K,(ge.y-ze.y)/Y]),We=[(ge.x-ze.x)/K,(ge.y-ze.y)/Y],ut=[(-ge.x-ze.x)/K,(-ge.y-ze.y)/Y];let et=vectorsAngle(We,ut);return vectorsRatio(We,ut)<=-1&&(et=Math.PI),vectorsRatio(We,ut)>=1&&(et=0),{currentPoint:ue,rX:K,rY:Y,sweepFlag:ne,xAxisRotation:ae,centp:Oe,a1:Je,ad:et}}pathA(B,M){const{pathParser:P}=this,{currentPoint:K,rX:Y,rY:re,sweepFlag:D,xAxisRotation:ne,centp:ae,a1:ue,ad:ge}=PathElement.pathA(P),Be=1-D?1:-1,De=ue+Be*(ge/2),ze=new Point(ae.x+Y*Math.cos(De),ae.y+re*Math.sin(De));if(P.addMarkerAngle(ze,De-Be*Math.PI/2),P.addMarkerAngle(K,De-Be*Math.PI),M.addPoint(K.x,K.y),B&&!isNaN(ue)&&!isNaN(ge)){const Oe=Y>re?Y:re,Je=Y>re?1:Y/re,We=Y>re?re/Y:1;B.translate(ae.x,ae.y),B.rotate(ne),B.scale(Je,We),B.arc(0,0,Oe,ue,ue+ge,!!(1-D)),B.scale(1/Je,1/We),B.rotate(-ne),B.translate(-ae.x,-ae.y)}}static pathZ(B){B.current=B.start}pathZ(B,M){PathElement.pathZ(this.pathParser),B&&M.x1!==M.x2&&M.y1!==M.y2&&B.closePath()}constructor(B,M,P){super(B,M,P),this.type="path",this.pathParser=new PathParser(this.getAttribute("d").getString())}}class SVGElement extends RenderedElement{setContext(B){var M;const{document:P}=this,{screen:K,window:Y}=P,re=B.canvas;if(K.setDefaults(B),"style"in re&&typeof B.font<"u"&&Y&&typeof Y.getComputedStyle<"u"){B.font=Y.getComputedStyle(re).getPropertyValue("font");const ut=new Property(P,"fontSize",Font.parse(B.font).fontSize);ut.hasValue()&&(P.rootEmSize=ut.getPixels("y"),P.emSize=P.rootEmSize)}this.getAttribute("x").hasValue()||this.getAttribute("x",!0).setValue(0),this.getAttribute("y").hasValue()||this.getAttribute("y",!0).setValue(0);let{width:D,height:ne}=K.viewPort;this.getStyle("width").hasValue()||this.getStyle("width",!0).setValue("100%"),this.getStyle("height").hasValue()||this.getStyle("height",!0).setValue("100%"),this.getStyle("color").hasValue()||this.getStyle("color",!0).setValue("black");const ae=this.getAttribute("refX"),ue=this.getAttribute("refY"),ge=this.getAttribute("viewBox"),Be=ge.hasValue()?toNumbers(ge.getString()):null,De=!this.root&&this.getStyle("overflow").getValue("hidden")!=="visible";let ze=0,Oe=0,Je=0,We=0;Be&&(ze=Be[0],Oe=Be[1]),this.root||(D=this.getStyle("width").getPixels("x"),ne=this.getStyle("height").getPixels("y"),this.type==="marker"&&(Je=ze,We=Oe,ze=0,Oe=0)),K.viewPort.setCurrent(D,ne),this.node&&(!this.parent||((M=this.node.parentNode)===null||M===void 0?void 0:M.nodeName)==="foreignObject")&&this.getStyle("transform",!1,!0).hasValue()&&!this.getStyle("transform-origin",!1,!0).hasValue()&&this.getStyle("transform-origin",!0,!0).setValue("50% 50%"),super.setContext(B),B.translate(this.getAttribute("x").getPixels("x"),this.getAttribute("y").getPixels("y")),Be&&(D=Be[2],ne=Be[3]),P.setViewBox({ctx:B,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:K.viewPort.width,desiredWidth:D,height:K.viewPort.height,desiredHeight:ne,minX:ze,minY:Oe,refX:ae.getValue(),refY:ue.getValue(),clip:De,clipX:Je,clipY:We}),Be&&(K.viewPort.removeCurrent(),K.viewPort.setCurrent(D,ne))}clearContext(B){super.clearContext(B),this.document.screen.viewPort.removeCurrent()}resize(B){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:B,P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const K=this.getAttribute("width",!0),Y=this.getAttribute("height",!0),re=this.getAttribute("viewBox"),D=this.getAttribute("style"),ne=K.getNumber(0),ae=Y.getNumber(0);if(P)if(typeof P=="string")this.getAttribute("preserveAspectRatio",!0).setValue(P);else{const ue=this.getAttribute("preserveAspectRatio");ue.hasValue()&&ue.setValue(ue.getString().replace(/^\s*(\S.*\S)\s*$/,"$1"))}if(K.setValue(B),Y.setValue(M),re.hasValue()||re.setValue("0 0 ".concat(ne||B," ").concat(ae||M)),D.hasValue()){const ue=this.getStyle("width"),ge=this.getStyle("height");ue.hasValue()&&ue.setValue("".concat(B,"px")),ge.hasValue()&&ge.setValue("".concat(M,"px"))}}constructor(...B){super(...B),this.type="svg",this.root=!1}}class RectElement extends PathElement{path(B){const M=this.getAttribute("x").getPixels("x"),P=this.getAttribute("y").getPixels("y"),K=this.getStyle("width",!1,!0).getPixels("x"),Y=this.getStyle("height",!1,!0).getPixels("y"),re=this.getAttribute("rx"),D=this.getAttribute("ry");let ne=re.getPixels("x"),ae=D.getPixels("y");if(re.hasValue()&&!D.hasValue()&&(ae=ne),D.hasValue()&&!re.hasValue()&&(ne=ae),ne=Math.min(ne,K/2),ae=Math.min(ae,Y/2),B){const ue=4*((Math.sqrt(2)-1)/3);B.beginPath(),Y>0&&K>0&&(B.moveTo(M+ne,P),B.lineTo(M+K-ne,P),B.bezierCurveTo(M+K-ne+ue*ne,P,M+K,P+ae-ue*ae,M+K,P+ae),B.lineTo(M+K,P+Y-ae),B.bezierCurveTo(M+K,P+Y-ae+ue*ae,M+K-ne+ue*ne,P+Y,M+K-ne,P+Y),B.lineTo(M+ne,P+Y),B.bezierCurveTo(M+ne-ue*ne,P+Y,M,P+Y-ae+ue*ae,M,P+Y-ae),B.lineTo(M,P+ae),B.bezierCurveTo(M,P+ae-ue*ae,M+ne-ue*ne,P,M+ne,P),B.closePath())}return new BoundingBox(M,P,M+K,P+Y)}getMarkers(){return null}constructor(...B){super(...B),this.type="rect"}}class CircleElement extends PathElement{path(B){const M=this.getAttribute("cx").getPixels("x"),P=this.getAttribute("cy").getPixels("y"),K=this.getAttribute("r").getPixels();return B&&K>0&&(B.beginPath(),B.arc(M,P,K,0,Math.PI*2,!1),B.closePath()),new BoundingBox(M-K,P-K,M+K,P+K)}getMarkers(){return null}constructor(...B){super(...B),this.type="circle"}}class EllipseElement extends PathElement{path(B){const M=4*((Math.sqrt(2)-1)/3),P=this.getAttribute("rx").getPixels("x"),K=this.getAttribute("ry").getPixels("y"),Y=this.getAttribute("cx").getPixels("x"),re=this.getAttribute("cy").getPixels("y");return B&&P>0&&K>0&&(B.beginPath(),B.moveTo(Y+P,re),B.bezierCurveTo(Y+P,re+M*K,Y+M*P,re+K,Y,re+K),B.bezierCurveTo(Y-M*P,re+K,Y-P,re+M*K,Y-P,re),B.bezierCurveTo(Y-P,re-M*K,Y-M*P,re-K,Y,re-K),B.bezierCurveTo(Y+M*P,re-K,Y+P,re-M*K,Y+P,re),B.closePath()),new BoundingBox(Y-P,re-K,Y+P,re+K)}getMarkers(){return null}constructor(...B){super(...B),this.type="ellipse"}}class LineElement extends PathElement{getPoints(){return[new Point(this.getAttribute("x1").getPixels("x"),this.getAttribute("y1").getPixels("y")),new Point(this.getAttribute("x2").getPixels("x"),this.getAttribute("y2").getPixels("y"))]}path(B){const[{x:M,y:P},{x:K,y:Y}]=this.getPoints();return B&&(B.beginPath(),B.moveTo(M,P),B.lineTo(K,Y)),new BoundingBox(M,P,K,Y)}getMarkers(){const[B,M]=this.getPoints(),P=B.angleTo(M);return[[B,P],[M,P]]}constructor(...B){super(...B),this.type="line"}}class PolylineElement extends PathElement{path(B){const{points:M}=this,[{x:P,y:K}]=M,Y=new BoundingBox(P,K);return B&&(B.beginPath(),B.moveTo(P,K)),M.forEach(re=>{let{x:D,y:ne}=re;Y.addPoint(D,ne),B&&B.lineTo(D,ne)}),Y}getMarkers(){const{points:B}=this,M=B.length-1,P=[];return B.forEach((K,Y)=>{Y!==M&&P.push([K,K.angleTo(B[Y+1])])}),P.length>0&&P.push([B[B.length-1],P[P.length-1][1]]),P}constructor(B,M,P){super(B,M,P),this.type="polyline",this.points=[],this.points=Point.parsePath(this.getAttribute("points").getString())}}class PolygonElement extends PolylineElement{path(B){const M=super.path(B),[{x:P,y:K}]=this.points;return B&&(B.lineTo(P,K),B.closePath()),M}constructor(...B){super(...B),this.type="polygon"}}class PatternElement extends Element{createPattern(B,M,P){const K=this.getStyle("width").getPixels("x",!0),Y=this.getStyle("height").getPixels("y",!0),re=new SVGElement(this.document,null);re.attributes.viewBox=new Property(this.document,"viewBox",this.getAttribute("viewBox").getValue()),re.attributes.width=new Property(this.document,"width","".concat(K,"px")),re.attributes.height=new Property(this.document,"height","".concat(Y,"px")),re.attributes.transform=new Property(this.document,"transform",this.getAttribute("patternTransform").getValue()),re.children=this.children;const D=this.document.createCanvas(K,Y),ne=D.getContext("2d"),ae=this.getAttribute("x"),ue=this.getAttribute("y");ae.hasValue()&&ue.hasValue()&&ne.translate(ae.getPixels("x",!0),ue.getPixels("y",!0)),P.hasValue()?this.styles["fill-opacity"]=P:Reflect.deleteProperty(this.styles,"fill-opacity");for(let Be=-1;Be<=1;Be++)for(let De=-1;De<=1;De++)ne.save(),re.attributes.x=new Property(this.document,"x",Be*D.width),re.attributes.y=new Property(this.document,"y",De*D.height),re.render(ne),ne.restore();return B.createPattern(D,"repeat")}constructor(...B){super(...B),this.type="pattern"}}class MarkerElement extends Element{render(B,M,P){if(!M)return;const{x:K,y:Y}=M,re=this.getAttribute("orient").getString("auto"),D=this.getAttribute("markerUnits").getString("strokeWidth");B.translate(K,Y),re==="auto"&&B.rotate(P),D==="strokeWidth"&&B.scale(B.lineWidth,B.lineWidth),B.save();const ne=new SVGElement(this.document);ne.type=this.type,ne.attributes.viewBox=new Property(this.document,"viewBox",this.getAttribute("viewBox").getValue()),ne.attributes.refX=new Property(this.document,"refX",this.getAttribute("refX").getValue()),ne.attributes.refY=new Property(this.document,"refY",this.getAttribute("refY").getValue()),ne.attributes.width=new Property(this.document,"width",this.getAttribute("markerWidth").getValue()),ne.attributes.height=new Property(this.document,"height",this.getAttribute("markerHeight").getValue()),ne.attributes.overflow=new Property(this.document,"overflow",this.getAttribute("overflow").getValue()),ne.attributes.fill=new Property(this.document,"fill",this.getAttribute("fill").getColor("black")),ne.attributes.stroke=new Property(this.document,"stroke",this.getAttribute("stroke").getValue("none")),ne.children=this.children,ne.render(B),B.restore(),D==="strokeWidth"&&B.scale(1/B.lineWidth,1/B.lineWidth),re==="auto"&&B.rotate(-P),B.translate(-K,-Y)}constructor(...B){super(...B),this.type="marker"}}class DefsElement extends Element{render(){}constructor(...B){super(...B),this.type="defs"}}class GElement extends RenderedElement{getBoundingBox(B){const M=new BoundingBox;return this.children.forEach(P=>{M.addBoundingBox(P.getBoundingBox(B))}),M}constructor(...B){super(...B),this.type="g"}}class GradientElement extends Element{getGradientUnits(){return this.getAttribute("gradientUnits").getString("objectBoundingBox")}createGradient(B,M,P){let K=this;this.getHrefAttribute().hasValue()&&(K=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(K));const{stops:Y}=K,re=this.getGradient(B,M);if(!re)return this.addParentOpacity(P,Y[Y.length-1].color);if(Y.forEach(D=>{re.addColorStop(D.offset,this.addParentOpacity(P,D.color))}),this.getAttribute("gradientTransform").hasValue()){const{document:D}=this,{MAX_VIRTUAL_PIXELS:ne}=Screen,{viewPort:ae}=D.screen,ue=ae.getRoot(),ge=new RectElement(D);ge.attributes.x=new Property(D,"x",-ne/3),ge.attributes.y=new Property(D,"y",-ne/3),ge.attributes.width=new Property(D,"width",ne),ge.attributes.height=new Property(D,"height",ne);const Be=new GElement(D);Be.attributes.transform=new Property(D,"transform",this.getAttribute("gradientTransform").getValue()),Be.children=[ge];const De=new SVGElement(D);De.attributes.x=new Property(D,"x",0),De.attributes.y=new Property(D,"y",0),De.attributes.width=new Property(D,"width",ue.width),De.attributes.height=new Property(D,"height",ue.height),De.children=[Be];const ze=D.createCanvas(ue.width,ue.height),Oe=ze.getContext("2d");return Oe.fillStyle=re,De.render(Oe),Oe.createPattern(ze,"no-repeat")}return re}inheritStopContainer(B){this.attributesToInherit.forEach(M=>{!this.getAttribute(M).hasValue()&&B.getAttribute(M).hasValue()&&this.getAttribute(M,!0).setValue(B.getAttribute(M).getValue())})}addParentOpacity(B,M){return B.hasValue()?new Property(this.document,"color",M).addOpacity(B).getColor():M}constructor(B,M,P){super(B,M,P),this.attributesToInherit=["gradientUnits"],this.stops=[];const{stops:K,children:Y}=this;Y.forEach(re=>{re.type==="stop"&&K.push(re)})}}class LinearGradientElement extends GradientElement{getGradient(B,M){const P=this.getGradientUnits()==="objectBoundingBox",K=P?M.getBoundingBox(B):null;if(P&&!K)return null;!this.getAttribute("x1").hasValue()&&!this.getAttribute("y1").hasValue()&&!this.getAttribute("x2").hasValue()&&!this.getAttribute("y2").hasValue()&&(this.getAttribute("x1",!0).setValue(0),this.getAttribute("y1",!0).setValue(0),this.getAttribute("x2",!0).setValue(1),this.getAttribute("y2",!0).setValue(0));const Y=P?K.x+K.width*this.getAttribute("x1").getNumber():this.getAttribute("x1").getPixels("x"),re=P?K.y+K.height*this.getAttribute("y1").getNumber():this.getAttribute("y1").getPixels("y"),D=P?K.x+K.width*this.getAttribute("x2").getNumber():this.getAttribute("x2").getPixels("x"),ne=P?K.y+K.height*this.getAttribute("y2").getNumber():this.getAttribute("y2").getPixels("y");return Y===D&&re===ne?null:B.createLinearGradient(Y,re,D,ne)}constructor(B,M,P){super(B,M,P),this.type="linearGradient",this.attributesToInherit.push("x1","y1","x2","y2")}}class RadialGradientElement extends GradientElement{getGradient(B,M){const P=this.getGradientUnits()==="objectBoundingBox",K=M.getBoundingBox(B);if(P&&!K)return null;this.getAttribute("cx").hasValue()||this.getAttribute("cx",!0).setValue("50%"),this.getAttribute("cy").hasValue()||this.getAttribute("cy",!0).setValue("50%"),this.getAttribute("r").hasValue()||this.getAttribute("r",!0).setValue("50%");const Y=P?K.x+K.width*this.getAttribute("cx").getNumber():this.getAttribute("cx").getPixels("x"),re=P?K.y+K.height*this.getAttribute("cy").getNumber():this.getAttribute("cy").getPixels("y");let D=Y,ne=re;this.getAttribute("fx").hasValue()&&(D=P?K.x+K.width*this.getAttribute("fx").getNumber():this.getAttribute("fx").getPixels("x")),this.getAttribute("fy").hasValue()&&(ne=P?K.y+K.height*this.getAttribute("fy").getNumber():this.getAttribute("fy").getPixels("y"));const ae=P?(K.width+K.height)/2*this.getAttribute("r").getNumber():this.getAttribute("r").getPixels(),ue=this.getAttribute("fr").getPixels();return B.createRadialGradient(D,ne,ue,Y,re,ae)}constructor(B,M,P){super(B,M,P),this.type="radialGradient",this.attributesToInherit.push("cx","cy","r","fx","fy","fr")}}class StopElement extends Element{constructor(B,M,P){super(B,M,P),this.type="stop";const K=Math.max(0,Math.min(1,this.getAttribute("offset").getNumber())),Y=this.getStyle("stop-opacity");let re=this.getStyle("stop-color",!0);re.getString()===""&&re.setValue("#000"),Y.hasValue()&&(re=re.addOpacity(Y)),this.offset=K,this.color=re.getColor()}}class AnimateElement extends Element{getProperty(){const B=this.getAttribute("attributeType").getString(),M=this.getAttribute("attributeName").getString();return B==="CSS"?this.parent.getStyle(M,!0):this.parent.getAttribute(M,!0)}calcValue(){const{initialUnits:B}=this,{progress:M,from:P,to:K}=this.getProgress();let Y=P.getNumber()+(K.getNumber()-P.getNumber())*M;return B==="%"&&(Y*=100),"".concat(Y).concat(B)}update(B){const{parent:M}=this,P=this.getProperty();if(this.initialValue||(this.initialValue=P.getString(),this.initialUnits=P.getUnits()),this.duration>this.maxDuration){const Y=this.getAttribute("fill").getString("remove");if(this.getAttribute("repeatCount").getString()==="indefinite"||this.getAttribute("repeatDur").getString()==="indefinite")this.duration=0;else if(Y==="freeze"&&!this.frozen)this.frozen=!0,M&&P&&(M.animationFrozen=!0,M.animationFrozenValue=P.getString());else if(Y==="remove"&&!this.removed)return this.removed=!0,M&&P&&P.setValue(M.animationFrozen?M.animationFrozenValue:this.initialValue),!0;return!1}this.duration+=B;let K=!1;if(this.begin<this.duration){let Y=this.calcValue();const re=this.getAttribute("type");if(re.hasValue()){const D=re.getString();Y="".concat(D,"(").concat(Y,")")}P.setValue(Y),K=!0}return K}getProgress(){const{document:B,values:M}=this;let P=(this.duration-this.begin)/(this.maxDuration-this.begin),K,Y;if(M.hasValue()){const re=P*(M.getValue().length-1),D=Math.floor(re),ne=Math.ceil(re);let ae;ae=M.getValue()[D],K=new Property(B,"from",ae?parseFloat(ae):0),ae=M.getValue()[ne],Y=new Property(B,"to",ae?parseFloat(ae):0),P=(re-D)/(ne-D)}else K=this.from,Y=this.to;return{progress:P,from:K,to:Y}}constructor(B,M,P){super(B,M,P),this.type="animate",this.duration=0,this.initialUnits="",this.removed=!1,this.frozen=!1,B.screen.animations.push(this),this.begin=this.getAttribute("begin").getMilliseconds(),this.maxDuration=this.begin+this.getAttribute("dur").getMilliseconds(),this.from=this.getAttribute("from"),this.to=this.getAttribute("to"),this.values=new Property(B,"values",null);const K=this.getAttribute("values");K.hasValue()&&this.values.setValue(K.getString().split(";"))}}class AnimateColorElement extends AnimateElement{calcValue(){const{progress:B,from:M,to:P}=this.getProgress(),K=new RGBColor$1(M.getColor()),Y=new RGBColor$1(P.getColor());if(K.ok&&Y.ok){const re=K.r+(Y.r-K.r)*B,D=K.g+(Y.g-K.g)*B,ne=K.b+(Y.b-K.b)*B;return"rgb(".concat(Math.floor(re),", ").concat(Math.floor(D),", ").concat(Math.floor(ne),")")}return this.getAttribute("from").getColor()}constructor(...B){super(...B),this.type="animateColor"}}class AnimateTransformElement extends AnimateElement{calcValue(){const{progress:B,from:M,to:P}=this.getProgress(),K=toNumbers(M.getString()),Y=toNumbers(P.getString());return K.map((D,ne)=>{const ae=Y[ne];return D+(ae-D)*B}).join(" ")}constructor(...B){super(...B),this.type="animateTransform"}}class FontFaceElement extends Element{constructor(B,M,P){super(B,M,P),this.type="font-face",this.ascent=this.getAttribute("ascent").getNumber(),this.descent=this.getAttribute("descent").getNumber(),this.unitsPerEm=this.getAttribute("units-per-em").getNumber()}}class GlyphElement extends PathElement{constructor(B,M,P){super(B,M,P),this.type="glyph",this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber(),this.unicode=this.getAttribute("unicode").getString(),this.arabicForm=this.getAttribute("arabic-form").getString()}}class MissingGlyphElement extends GlyphElement{constructor(...B){super(...B),this.type="missing-glyph",this.horizAdvX=0}}class FontElement extends Element{render(){}constructor(B,M,P){super(B,M,P),this.type="font",this.isArabic=!1,this.glyphs={},this.arabicGlyphs={},this.isRTL=!1,this.horizAdvX=this.getAttribute("horiz-adv-x").getNumber();const{definitions:K}=B,{children:Y}=this;for(const re of Y)if(re instanceof FontFaceElement){this.fontFace=re;const D=re.getStyle("font-family");D.hasValue()&&(K[D.getString()]=this)}else if(re instanceof MissingGlyphElement)this.missingGlyph=re;else if(re instanceof GlyphElement)if(re.arabicForm){this.isRTL=!0,this.isArabic=!0;const D=this.arabicGlyphs[re.unicode];typeof D>"u"?this.arabicGlyphs[re.unicode]={[re.arabicForm]:re}:D[re.arabicForm]=re}else this.glyphs[re.unicode]=re}}class TRefElement extends TextElement{getText(){const B=this.getHrefAttribute().getDefinition();if(B){const M=B.children[0];if(M)return M.getText()}return""}constructor(...B){super(...B),this.type="tref"}}class AElement extends TextElement{getText(){return this.text}renderChildren(B){if(this.hasText){super.renderChildren(B);const{document:M,x:P,y:K}=this,{mouse:Y}=M.screen,re=new Property(M,"fontSize",Font.parse(M.ctx.font).fontSize);Y.isWorking()&&Y.checkBoundingBox(this,new BoundingBox(P,K-re.getPixels("y"),P+this.measureText(B),K))}else if(this.children.length>0){const M=new GElement(this.document);M.children=this.children,M.parent=this,M.render(B)}}onClick(){const{window:B}=this.document;B&&B.open(this.getHrefAttribute().getString())}onMouseMove(){const B=this.document.ctx;B.canvas.style.cursor="pointer"}constructor(B,M,P){super(B,M,P),this.type="a";const{childNodes:K}=M,Y=K[0],re=K.length>0&&Array.from(K).every(D=>D.nodeType===3);this.hasText=re,this.text=re?this.getTextFromNode(Y):""}}class TextPathElement extends TextElement{getText(){return this.text}path(B){const{dataArray:M}=this;B&&B.beginPath(),M.forEach(P=>{let{type:K,points:Y}=P;switch(K){case PathParser.LINE_TO:B&&B.lineTo(Y[0],Y[1]);break;case PathParser.MOVE_TO:B&&B.moveTo(Y[0],Y[1]);break;case PathParser.CURVE_TO:B&&B.bezierCurveTo(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5]);break;case PathParser.QUAD_TO:B&&B.quadraticCurveTo(Y[0],Y[1],Y[2],Y[3]);break;case PathParser.ARC:{const[re,D,ne,ae,ue,ge,Be,De]=Y,ze=ne>ae?ne:ae,Oe=ne>ae?1:ne/ae,Je=ne>ae?ae/ne:1;B&&(B.translate(re,D),B.rotate(Be),B.scale(Oe,Je),B.arc(0,0,ze,ue,ue+ge,!!(1-De)),B.scale(1/Oe,1/Je),B.rotate(-Be),B.translate(-re,-D));break}case PathParser.CLOSE_PATH:B&&B.closePath();break}})}renderChildren(B){this.setTextData(B),B.save();const M=this.parent.getStyle("text-decoration").getString(),P=this.getFontSize(),{glyphInfo:K}=this,Y=B.fillStyle;M==="underline"&&B.beginPath(),K.forEach((re,D)=>{const{p0:ne,p1:ae,rotation:ue,text:ge}=re;B.save(),B.translate(ne.x,ne.y),B.rotate(ue),B.fillStyle&&B.fillText(ge,0,0),B.strokeStyle&&B.strokeText(ge,0,0),B.restore(),M==="underline"&&(D===0&&B.moveTo(ne.x,ne.y+P/8),B.lineTo(ae.x,ae.y+P/5))}),M==="underline"&&(B.lineWidth=P/20,B.strokeStyle=Y,B.stroke(),B.closePath()),B.restore()}getLetterSpacingAt(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.letterSpacingCache[B]||0}findSegmentToFitChar(B,M,P,K,Y,re,D,ne,ae){let ue=re,ge=this.measureText(B,ne);ne===" "&&M==="justify"&&P<K&&(ge+=(K-P)/Y),ae>-1&&(ue+=this.getLetterSpacingAt(ae));const Be=this.textHeight/20,De=this.getEquidistantPointOnPath(ue,Be,0),ze=this.getEquidistantPointOnPath(ue+ge,Be,0),Oe={p0:De,p1:ze},Je=De&&ze?Math.atan2(ze.y-De.y,ze.x-De.x):0;if(D){const We=Math.cos(Math.PI/2+Je)*D,ut=Math.cos(-Je)*D;Oe.p0={...De,x:De.x+We,y:De.y+ut},Oe.p1={...ze,x:ze.x+We,y:ze.y+ut}}return ue+=ge,{offset:ue,segment:Oe,rotation:Je}}measureText(B,M){const{measuresCache:P}=this,K=M||this.getText();if(P.has(K))return P.get(K);const Y=this.measureTargetText(B,K);return P.set(K,Y),Y}setTextData(B){if(this.glyphInfo)return;const M=this.getText(),P=M.split(""),K=M.split(" ").length-1,Y=this.parent.getAttribute("dx").split().map(et=>et.getPixels("x")),re=this.parent.getAttribute("dy").getPixels("y"),D=this.parent.getStyle("text-anchor").getString("start"),ne=this.getStyle("letter-spacing"),ae=this.parent.getStyle("letter-spacing");let ue=0;!ne.hasValue()||ne.getValue()==="inherit"?ue=ae.getPixels():ne.hasValue()&&ne.getValue()!=="initial"&&ne.getValue()!=="unset"&&(ue=ne.getPixels());const ge=[],Be=M.length;this.letterSpacingCache=ge;for(let et=0;et<Be;et++)ge.push(typeof Y[et]<"u"?Y[et]:ue);const De=ge.reduce((et,At,nt)=>nt===0?0:et+At||0,0),ze=this.measureText(B),Oe=Math.max(ze+De,0);this.textWidth=ze,this.textHeight=this.getFontSize(),this.glyphInfo=[];const Je=this.getPathLength(),We=this.getStyle("startOffset").getNumber(0)*Je;let ut=0;(D==="middle"||D==="center")&&(ut=-Oe/2),(D==="end"||D==="right")&&(ut=-Oe),ut+=We,P.forEach((et,At)=>{const{offset:nt,segment:ft,rotation:Tt}=this.findSegmentToFitChar(B,D,Oe,Je,K,ut,re,et,At);ut=nt,!(!ft.p0||!ft.p1)&&this.glyphInfo.push({text:P[At],p0:ft.p0,p1:ft.p1,rotation:Tt})})}parsePathData(B){if(this.pathLength=-1,!B)return[];const M=[],{pathParser:P}=B;for(P.reset();!P.isEnd();){const{current:K}=P,Y=K?K.x:0,re=K?K.y:0,D=P.next();let ne=D.type,ae=[];switch(D.type){case PathParser.MOVE_TO:this.pathM(P,ae);break;case PathParser.LINE_TO:ne=this.pathL(P,ae);break;case PathParser.HORIZ_LINE_TO:ne=this.pathH(P,ae);break;case PathParser.VERT_LINE_TO:ne=this.pathV(P,ae);break;case PathParser.CURVE_TO:this.pathC(P,ae);break;case PathParser.SMOOTH_CURVE_TO:ne=this.pathS(P,ae);break;case PathParser.QUAD_TO:this.pathQ(P,ae);break;case PathParser.SMOOTH_QUAD_TO:ne=this.pathT(P,ae);break;case PathParser.ARC:ae=this.pathA(P);break;case PathParser.CLOSE_PATH:PathElement.pathZ(P);break}D.type!==PathParser.CLOSE_PATH?M.push({type:ne,points:ae,start:{x:Y,y:re},pathLength:this.calcLength(Y,re,ne,ae)}):M.push({type:PathParser.CLOSE_PATH,points:[],pathLength:0})}return M}pathM(B,M){const{x:P,y:K}=PathElement.pathM(B).point;M.push(P,K)}pathL(B,M){const{x:P,y:K}=PathElement.pathL(B).point;return M.push(P,K),PathParser.LINE_TO}pathH(B,M){const{x:P,y:K}=PathElement.pathH(B).point;return M.push(P,K),PathParser.LINE_TO}pathV(B,M){const{x:P,y:K}=PathElement.pathV(B).point;return M.push(P,K),PathParser.LINE_TO}pathC(B,M){const{point:P,controlPoint:K,currentPoint:Y}=PathElement.pathC(B);M.push(P.x,P.y,K.x,K.y,Y.x,Y.y)}pathS(B,M){const{point:P,controlPoint:K,currentPoint:Y}=PathElement.pathS(B);return M.push(P.x,P.y,K.x,K.y,Y.x,Y.y),PathParser.CURVE_TO}pathQ(B,M){const{controlPoint:P,currentPoint:K}=PathElement.pathQ(B);M.push(P.x,P.y,K.x,K.y)}pathT(B,M){const{controlPoint:P,currentPoint:K}=PathElement.pathT(B);return M.push(P.x,P.y,K.x,K.y),PathParser.QUAD_TO}pathA(B){let{rX:M,rY:P,sweepFlag:K,xAxisRotation:Y,centp:re,a1:D,ad:ne}=PathElement.pathA(B);return K===0&&ne>0&&(ne-=2*Math.PI),K===1&&ne<0&&(ne+=2*Math.PI),[re.x,re.y,M,P,D,ne,Y,K]}calcLength(B,M,P,K){let Y=0,re=null,D=null,ne=0;switch(P){case PathParser.LINE_TO:return this.getLineLength(B,M,K[0],K[1]);case PathParser.CURVE_TO:for(Y=0,re=this.getPointOnCubicBezier(0,B,M,K[0],K[1],K[2],K[3],K[4],K[5]),ne=.01;ne<=1;ne+=.01)D=this.getPointOnCubicBezier(ne,B,M,K[0],K[1],K[2],K[3],K[4],K[5]),Y+=this.getLineLength(re.x,re.y,D.x,D.y),re=D;return Y;case PathParser.QUAD_TO:for(Y=0,re=this.getPointOnQuadraticBezier(0,B,M,K[0],K[1],K[2],K[3]),ne=.01;ne<=1;ne+=.01)D=this.getPointOnQuadraticBezier(ne,B,M,K[0],K[1],K[2],K[3]),Y+=this.getLineLength(re.x,re.y,D.x,D.y),re=D;return Y;case PathParser.ARC:{Y=0;const ae=K[4],ue=K[5],ge=K[4]+ue;let Be=Math.PI/180;if(Math.abs(ae-ge)<Be&&(Be=Math.abs(ae-ge)),re=this.getPointOnEllipticalArc(K[0],K[1],K[2],K[3],ae,0),ue<0)for(ne=ae-Be;ne>ge;ne-=Be)D=this.getPointOnEllipticalArc(K[0],K[1],K[2],K[3],ne,0),Y+=this.getLineLength(re.x,re.y,D.x,D.y),re=D;else for(ne=ae+Be;ne<ge;ne+=Be)D=this.getPointOnEllipticalArc(K[0],K[1],K[2],K[3],ne,0),Y+=this.getLineLength(re.x,re.y,D.x,D.y),re=D;return D=this.getPointOnEllipticalArc(K[0],K[1],K[2],K[3],ge,0),Y+=this.getLineLength(re.x,re.y,D.x,D.y),Y}}return 0}getPointOnLine(B,M,P,K,Y){let re=arguments.length>5&&arguments[5]!==void 0?arguments[5]:M,D=arguments.length>6&&arguments[6]!==void 0?arguments[6]:P;const ne=(Y-P)/(K-M+PSEUDO_ZERO);let ae=Math.sqrt(B*B/(1+ne*ne));K<M&&(ae*=-1);let ue=ne*ae,ge=null;if(K===M)ge={x:re,y:D+ue};else if((D-P)/(re-M+PSEUDO_ZERO)===ne)ge={x:re+ae,y:D+ue};else{let Be=0,De=0;const ze=this.getLineLength(M,P,K,Y);if(ze<PSEUDO_ZERO)return null;let Oe=(re-M)*(K-M)+(D-P)*(Y-P);Oe/=ze*ze,Be=M+Oe*(K-M),De=P+Oe*(Y-P);const Je=this.getLineLength(re,D,Be,De),We=Math.sqrt(B*B-Je*Je);ae=Math.sqrt(We*We/(1+ne*ne)),K<M&&(ae*=-1),ue=ne*ae,ge={x:Be+ae,y:De+ue}}return ge}getPointOnPath(B){const M=this.getPathLength();let P=0,K=null;if(B<-5e-5||B-5e-5>M)return null;const{dataArray:Y}=this;for(const re of Y){if(re&&(re.pathLength<5e-5||P+re.pathLength+5e-5<B)){P+=re.pathLength;continue}const D=B-P;let ne=0;switch(re.type){case PathParser.LINE_TO:K=this.getPointOnLine(D,re.start.x,re.start.y,re.points[0],re.points[1],re.start.x,re.start.y);break;case PathParser.ARC:{const ae=re.points[4],ue=re.points[5],ge=re.points[4]+ue;if(ne=ae+D/re.pathLength*ue,ue<0&&ne<ge||ue>=0&&ne>ge)break;K=this.getPointOnEllipticalArc(re.points[0],re.points[1],re.points[2],re.points[3],ne,re.points[6]);break}case PathParser.CURVE_TO:ne=D/re.pathLength,ne>1&&(ne=1),K=this.getPointOnCubicBezier(ne,re.start.x,re.start.y,re.points[0],re.points[1],re.points[2],re.points[3],re.points[4],re.points[5]);break;case PathParser.QUAD_TO:ne=D/re.pathLength,ne>1&&(ne=1),K=this.getPointOnQuadraticBezier(ne,re.start.x,re.start.y,re.points[0],re.points[1],re.points[2],re.points[3]);break}if(K)return K;break}return null}getLineLength(B,M,P,K){return Math.sqrt((P-B)*(P-B)+(K-M)*(K-M))}getPathLength(){return this.pathLength===-1&&(this.pathLength=this.dataArray.reduce((B,M)=>M.pathLength>0?B+M.pathLength:B,0)),this.pathLength}getPointOnCubicBezier(B,M,P,K,Y,re,D,ne,ae){const ue=ne*CB1(B)+re*CB2(B)+K*CB3(B)+M*CB4(B),ge=ae*CB1(B)+D*CB2(B)+Y*CB3(B)+P*CB4(B);return{x:ue,y:ge}}getPointOnQuadraticBezier(B,M,P,K,Y,re,D){const ne=re*QB1(B)+K*QB2(B)+M*QB3(B),ae=D*QB1(B)+Y*QB2(B)+P*QB3(B);return{x:ne,y:ae}}getPointOnEllipticalArc(B,M,P,K,Y,re){const D=Math.cos(re),ne=Math.sin(re),ae={x:P*Math.cos(Y),y:K*Math.sin(Y)};return{x:B+(ae.x*D-ae.y*ne),y:M+(ae.x*ne+ae.y*D)}}buildEquidistantCache(B,M){const P=this.getPathLength(),K=M||.25,Y=B||P/100;if(!this.equidistantCache||this.equidistantCache.step!==Y||this.equidistantCache.precision!==K){this.equidistantCache={step:Y,precision:K,points:[]};let re=0;for(let D=0;D<=P;D+=K){const ne=this.getPointOnPath(D),ae=this.getPointOnPath(D+K);!ne||!ae||(re+=this.getLineLength(ne.x,ne.y,ae.x,ae.y),re>=Y&&(this.equidistantCache.points.push({x:ne.x,y:ne.y,distance:D}),re-=Y))}}}getEquidistantPointOnPath(B,M,P){if(this.buildEquidistantCache(M,P),B<0||B-this.getPathLength()>5e-5)return null;const K=Math.round(B/this.getPathLength()*(this.equidistantCache.points.length-1));return this.equidistantCache.points[K]||null}constructor(B,M,P){super(B,M,P),this.type="textPath",this.textWidth=0,this.textHeight=0,this.pathLength=-1,this.glyphInfo=null,this.letterSpacingCache=[],this.measuresCache=new Map([["",0]]);const K=this.getHrefAttribute().getDefinition();this.text=this.getTextFromNode(),this.dataArray=this.parsePathData(K)}}const dataUriRegex=/^\s*data:(([^/,;]+\/[^/,;]+)(?:;([^,;=]+=[^,;=]+))?)?(?:;(base64))?,(.*)$/i;class ImageElement extends RenderedElement{async loadImage(B){try{const M=await this.document.createImage(B);this.image=M}catch(M){console.error('Error while loading image "'.concat(B,'":'),M)}this.loaded=!0}async loadSvg(B){const M=dataUriRegex.exec(B);if(M){const P=M[5];P&&(M[4]==="base64"?this.image=atob(P):this.image=decodeURIComponent(P))}else try{const K=await(await this.document.fetch(B)).text();this.image=K}catch(P){console.error('Error while loading image "'.concat(B,'":'),P)}this.loaded=!0}renderChildren(B){const{document:M,image:P,loaded:K}=this,Y=this.getAttribute("x").getPixels("x"),re=this.getAttribute("y").getPixels("y"),D=this.getStyle("width").getPixels("x"),ne=this.getStyle("height").getPixels("y");if(!(!K||!P||!D||!ne)){if(B.save(),B.translate(Y,re),typeof P=="string"){const ae=M.canvg.forkString(B,P,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:0,offsetY:0,scaleWidth:D,scaleHeight:ne}),{documentElement:ue}=ae.document;ue&&(ue.parent=this),ae.render()}else M.setViewBox({ctx:B,aspectRatio:this.getAttribute("preserveAspectRatio").getString(),width:D,desiredWidth:P.width,height:ne,desiredHeight:P.height}),this.loaded&&(!("complete"in P)||P.complete)&&B.drawImage(P,0,0);B.restore()}}getBoundingBox(){const B=this.getAttribute("x").getPixels("x"),M=this.getAttribute("y").getPixels("y"),P=this.getStyle("width").getPixels("x"),K=this.getStyle("height").getPixels("y");return new BoundingBox(B,M,B+P,M+K)}constructor(B,M,P){super(B,M,P),this.type="image",this.loaded=!1;const K=this.getHrefAttribute().getString();if(!K)return;const Y=K.endsWith(".svg")||/^\s*data:image\/svg\+xml/i.test(K);B.images.push(this),Y?this.loadSvg(K):this.loadImage(K)}}class SymbolElement extends RenderedElement{render(B){}constructor(...B){super(...B),this.type="symbol"}}class SVGFontLoader{async load(B,M){try{const{document:P}=this,Y=(await P.canvg.parser.load(M)).getElementsByTagName("font");Array.from(Y).forEach(re=>{const D=P.createElement(re);P.definitions[B]=D})}catch(P){console.error('Error while loading font "'.concat(M,'":'),P)}this.loaded=!0}constructor(B){this.document=B,this.loaded=!1,B.fonts.push(this)}}class StyleElement extends Element{constructor(B,M,P){super(B,M,P),this.type="style",compressSpaces(Array.from(M.childNodes).map(re=>re.textContent).join("").replace(/(\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,"").replace(/@import.*;/g,"")).split("}").forEach(re=>{const D=re.trim();if(!D)return;const ne=D.split("{"),ae=ne[0].split(","),ue=ne[1].split(";");ae.forEach(ge=>{const Be=ge.trim();if(!Be)return;const De=B.styles[Be]||{};if(ue.forEach(ze=>{const Oe=ze.indexOf(":"),Je=ze.substr(0,Oe).trim(),We=ze.substr(Oe+1,ze.length-Oe).trim();Je&&We&&(De[Je]=new Property(B,Je,We))}),B.styles[Be]=De,B.stylesSpecificity[Be]=getSelectorSpecificity(Be),Be==="@font-face"){const ze=De["font-family"].getString().replace(/"|'/g,"");De.src.getString().split(",").forEach(Je=>{if(Je.indexOf('format("svg")')>0){const We=parseExternalUrl(Je);We&&new SVGFontLoader(B).load(ze,We)}})}})})}}StyleElement.parseExternalUrl=parseExternalUrl;class UseElement extends RenderedElement{setContext(B){super.setContext(B);const M=this.getAttribute("x"),P=this.getAttribute("y");M.hasValue()&&B.translate(M.getPixels("x"),0),P.hasValue()&&B.translate(0,P.getPixels("y"))}path(B){const{element:M}=this;M&&M.path(B)}renderChildren(B){const{document:M,element:P}=this;if(P){let K=P;if(P.type==="symbol"&&(K=new SVGElement(M),K.attributes.viewBox=new Property(M,"viewBox",P.getAttribute("viewBox").getString()),K.attributes.preserveAspectRatio=new Property(M,"preserveAspectRatio",P.getAttribute("preserveAspectRatio").getString()),K.attributes.overflow=new Property(M,"overflow",P.getAttribute("overflow").getString()),K.children=P.children,P.styles.opacity=new Property(M,"opacity",this.calculateOpacity())),K.type==="svg"){const re=this.getStyle("width",!1,!0),D=this.getStyle("height",!1,!0);re.hasValue()&&(K.attributes.width=new Property(M,"width",re.getString())),D.hasValue()&&(K.attributes.height=new Property(M,"height",D.getString()))}const Y=K.parent;K.parent=this,K.render(B),K.parent=Y}}getBoundingBox(B){const{element:M}=this;return M?M.getBoundingBox(B):null}elementTransform(){const{document:B,element:M}=this;return M?Transform.fromElement(B,M):null}get element(){return this.cachedElement||(this.cachedElement=this.getHrefAttribute().getDefinition()),this.cachedElement}constructor(...B){super(...B),this.type="use"}}function imGet(g,B,M,P,K,Y){return g[M*P*4+B*4+Y]}function imSet(g,B,M,P,K,Y,re){g[M*P*4+B*4+Y]=re}function m(g,B,M){return g[B]*M}function c(g,B,M,P){return B+Math.cos(g)*M+Math.sin(g)*P}class FeColorMatrixElement extends Element{apply(B,M,P,K,Y){const{includeOpacity:re,matrix:D}=this,ne=B.getImageData(0,0,K,Y);for(let ae=0;ae<Y;ae++)for(let ue=0;ue<K;ue++){const ge=imGet(ne.data,ue,ae,K,Y,0),Be=imGet(ne.data,ue,ae,K,Y,1),De=imGet(ne.data,ue,ae,K,Y,2),ze=imGet(ne.data,ue,ae,K,Y,3);let Oe=m(D,0,ge)+m(D,1,Be)+m(D,2,De)+m(D,3,ze)+m(D,4,1),Je=m(D,5,ge)+m(D,6,Be)+m(D,7,De)+m(D,8,ze)+m(D,9,1),We=m(D,10,ge)+m(D,11,Be)+m(D,12,De)+m(D,13,ze)+m(D,14,1),ut=m(D,15,ge)+m(D,16,Be)+m(D,17,De)+m(D,18,ze)+m(D,19,1);re&&(Oe=0,Je=0,We=0,ut*=ze/255),imSet(ne.data,ue,ae,K,Y,0,Oe),imSet(ne.data,ue,ae,K,Y,1,Je),imSet(ne.data,ue,ae,K,Y,2,We),imSet(ne.data,ue,ae,K,Y,3,ut)}B.clearRect(0,0,K,Y),B.putImageData(ne,0,0)}constructor(B,M,P){super(B,M,P),this.type="feColorMatrix";let K=toNumbers(this.getAttribute("values").getString());switch(this.getAttribute("type").getString("matrix")){case"saturate":{const Y=K[0];K=[.213+.787*Y,.715-.715*Y,.072-.072*Y,0,0,.213-.213*Y,.715+.285*Y,.072-.072*Y,0,0,.213-.213*Y,.715-.715*Y,.072+.928*Y,0,0,0,0,0,1,0,0,0,0,0,1];break}case"hueRotate":{const Y=K[0]*Math.PI/180;K=[c(Y,.213,.787,-.213),c(Y,.715,-.715,-.715),c(Y,.072,-.072,.928),0,0,c(Y,.213,-.213,.143),c(Y,.715,.285,.14),c(Y,.072,-.072,-.283),0,0,c(Y,.213,-.213,-.787),c(Y,.715,-.715,.715),c(Y,.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break}case"luminanceToAlpha":K=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1];break}this.matrix=K,this.includeOpacity=this.getAttribute("includeOpacity").hasValue()}}class MaskElement extends Element{apply(B,M){const{document:P}=this;let K=this.getAttribute("x").getPixels("x"),Y=this.getAttribute("y").getPixels("y"),re=this.getStyle("width").getPixels("x"),D=this.getStyle("height").getPixels("y");if(!re&&!D){const De=new BoundingBox;this.children.forEach(ze=>{De.addBoundingBox(ze.getBoundingBox(B))}),K=Math.floor(De.x1),Y=Math.floor(De.y1),re=Math.floor(De.width),D=Math.floor(De.height)}const ne=this.removeStyles(M,MaskElement.ignoreStyles),ae=P.createCanvas(K+re,Y+D),ue=ae.getContext("2d");P.screen.setDefaults(ue),this.renderChildren(ue),new FeColorMatrixElement(P,{nodeType:1,childNodes:[],attributes:[{nodeName:"type",value:"luminanceToAlpha"},{nodeName:"includeOpacity",value:"true"}]}).apply(ue,0,0,K+re,Y+D);const ge=P.createCanvas(K+re,Y+D),Be=ge.getContext("2d");P.screen.setDefaults(Be),M.render(Be),Be.globalCompositeOperation="destination-in",Be.fillStyle=ue.createPattern(ae,"no-repeat"),Be.fillRect(0,0,K+re,Y+D),B.fillStyle=Be.createPattern(ge,"no-repeat"),B.fillRect(0,0,K+re,Y+D),this.restoreStyles(M,ne)}render(B){}constructor(...B){super(...B),this.type="mask"}}MaskElement.ignoreStyles=["mask","transform","clip-path"];const noop=()=>{};class ClipPathElement extends Element{apply(B){const{document:M}=this,P=Reflect.getPrototypeOf(B),{beginPath:K,closePath:Y}=B;P&&(P.beginPath=noop,P.closePath=noop),Reflect.apply(K,B,[]),this.children.forEach(re=>{if(!("path"in re))return;let D="elementTransform"in re?re.elementTransform():null;D||(D=Transform.fromElement(M,re)),D&&D.apply(B),re.path(B),P&&(P.closePath=Y),D&&D.unapply(B)}),Reflect.apply(Y,B,[]),B.clip(),P&&(P.beginPath=K,P.closePath=Y)}render(B){}constructor(...B){super(...B),this.type="clipPath"}}class FilterElement extends Element{apply(B,M){const{document:P,children:K}=this,Y="getBoundingBox"in M?M.getBoundingBox(B):null;if(!Y)return;let re=0,D=0;K.forEach(We=>{const ut=We.extraFilterDistance||0;re=Math.max(re,ut),D=Math.max(D,ut)});const ne=Math.floor(Y.width),ae=Math.floor(Y.height),ue=ne+2*re,ge=ae+2*D;if(ue<1||ge<1)return;const Be=Math.floor(Y.x),De=Math.floor(Y.y),ze=this.removeStyles(M,FilterElement.ignoreStyles),Oe=P.createCanvas(ue,ge),Je=Oe.getContext("2d");P.screen.setDefaults(Je),Je.translate(-Be+re,-De+D),M.render(Je),K.forEach(We=>{typeof We.apply=="function"&&We.apply(Je,0,0,ue,ge)}),B.drawImage(Oe,0,0,ue,ge,Be-re,De-D,ue,ge),this.restoreStyles(M,ze)}render(B){}constructor(...B){super(...B),this.type="filter"}}FilterElement.ignoreStyles=["filter","transform","clip-path"];class FeDropShadowElement extends Element{apply(B,M,P,K,Y){}constructor(B,M,P){super(B,M,P),this.type="feDropShadow",this.addStylesFromStyleDefinition()}}class FeMorphologyElement extends Element{apply(B,M,P,K,Y){}constructor(...B){super(...B),this.type="feMorphology"}}class FeCompositeElement extends Element{apply(B,M,P,K,Y){}constructor(...B){super(...B),this.type="feComposite"}}class FeGaussianBlurElement extends Element{apply(B,M,P,K,Y){const{document:re,blurRadius:D}=this,ne=re.window?re.window.document.body:null,ae=B.canvas;ae.id=re.getUniqueId(),ne&&(ae.style.display="none",ne.appendChild(ae)),processCanvasRGBA(ae,M,P,K,Y,D),ne&&ne.removeChild(ae)}constructor(B,M,P){super(B,M,P),this.type="feGaussianBlur",this.blurRadius=Math.floor(this.getAttribute("stdDeviation").getNumber()),this.extraFilterDistance=this.blurRadius}}class TitleElement extends Element{constructor(...B){super(...B),this.type="title"}}class DescElement extends Element{constructor(...B){super(...B),this.type="desc"}}const elements={svg:SVGElement,rect:RectElement,circle:CircleElement,ellipse:EllipseElement,line:LineElement,polyline:PolylineElement,polygon:PolygonElement,path:PathElement,pattern:PatternElement,marker:MarkerElement,defs:DefsElement,linearGradient:LinearGradientElement,radialGradient:RadialGradientElement,stop:StopElement,animate:AnimateElement,animateColor:AnimateColorElement,animateTransform:AnimateTransformElement,font:FontElement,"font-face":FontFaceElement,"missing-glyph":MissingGlyphElement,glyph:GlyphElement,text:TextElement,tspan:TSpanElement,tref:TRefElement,a:AElement,textPath:TextPathElement,image:ImageElement,g:GElement,symbol:SymbolElement,style:StyleElement,use:UseElement,mask:MaskElement,clipPath:ClipPathElement,filter:FilterElement,feDropShadow:FeDropShadowElement,feMorphology:FeMorphologyElement,feComposite:FeCompositeElement,feColorMatrix:FeColorMatrixElement,feGaussianBlur:FeGaussianBlurElement,title:TitleElement,desc:DescElement};function createCanvas(g,B){const M=document.createElement("canvas");return M.width=g,M.height=B,M}async function createImage(g){let B=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const M=document.createElement("img");return B&&(M.crossOrigin="Anonymous"),new Promise((P,K)=>{M.onload=()=>{P(M)},M.onerror=(Y,re,D,ne,ae)=>{K(ae)},M.src=g})}const DEFAULT_EM_SIZE=12;class Document{bindCreateImage(B,M){return typeof M=="boolean"?(P,K)=>B(P,typeof K=="boolean"?K:M):B}get window(){return this.screen.window}get fetch(){return this.screen.fetch}get ctx(){return this.screen.ctx}get emSize(){const{emSizeStack:B}=this;return B[B.length-1]||DEFAULT_EM_SIZE}set emSize(B){const{emSizeStack:M}=this;M.push(B)}popEmSize(){const{emSizeStack:B}=this;B.pop()}getUniqueId(){return"canvg".concat(++this.uniqueId)}isImagesLoaded(){return this.images.every(B=>B.loaded)}isFontsLoaded(){return this.fonts.every(B=>B.loaded)}createDocumentElement(B){const M=this.createElement(B.documentElement);return M.root=!0,M.addStylesFromStyleDefinition(),this.documentElement=M,M}createElement(B){const M=B.nodeName.replace(/^[^:]+:/,""),P=Document.elementTypes[M];return P?new P(this,B):new UnknownElement(this,B)}createTextNode(B){return new TextNode(this,B)}setViewBox(B){this.screen.setViewBox({document:this,...B})}constructor(B,{rootEmSize:M=DEFAULT_EM_SIZE,emSize:P=DEFAULT_EM_SIZE,createCanvas:K=Document.createCanvas,createImage:Y=Document.createImage,anonymousCrossOrigin:re}={}){this.canvg=B,this.definitions={},this.styles={},this.stylesSpecificity={},this.images=[],this.fonts=[],this.emSizeStack=[],this.uniqueId=0,this.screen=B.screen,this.rootEmSize=M,this.emSize=P,this.createCanvas=K,this.createImage=this.bindCreateImage(Y,re),this.screen.wait(()=>this.isImagesLoaded()),this.screen.wait(()=>this.isFontsLoaded())}}Document.createCanvas=createCanvas;Document.createImage=createImage;Document.elementTypes=elements;class Canvg{static async from(B,M){let P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const Y=await new Parser(P).parse(M);return new Canvg(B,Y,P)}static fromString(B,M){let P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const Y=new Parser(P).parseFromString(M);return new Canvg(B,Y,P)}fork(B,M){let P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Canvg.from(B,M,{...this.options,...P})}forkString(B,M){let P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Canvg.fromString(B,M,{...this.options,...P})}ready(){return this.screen.ready()}isReady(){return this.screen.isReady()}async render(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.start({enableRedraw:!0,ignoreAnimation:!0,ignoreMouse:!0,...B}),await this.ready(),this.stop()}start(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{documentElement:M,screen:P,options:K}=this;P.start(M,{enableRedraw:!0,...K,...B})}stop(){this.screen.stop()}resize(B){let M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:B,P=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.documentElement.resize(B,M,P)}constructor(B,M,P={}){this.parser=new Parser(P),this.screen=new Screen(B,P),this.options=P;const K=new Document(this,P),Y=K.createDocumentElement(M);this.document=K,this.documentElement=Y}}var colorScale$1={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]};function lerp$1(g,B,M){return g*(1-M)+B*M}var lerp_1=lerp$1,colorScale=colorScale$1,lerp=lerp_1,colormap=createColormap;function createColormap(g){var B,M,P,K,Y,re,D,ne,Be,ae,ue;if(g||(g={}),ne=(g.nshades||72)-1,D=g.format||"hex",re=g.colormap,re||(re="jet"),typeof re=="string"){if(re=re.toLowerCase(),!colorScale[re])throw Error(re+" not a supported colorscale");Y=colorScale[re]}else if(Array.isArray(re))Y=re.slice();else throw Error("unsupported colormap option",re);if(Y.length>ne+1)throw new Error(re+" map requires nshades to be at least size "+Y.length);Array.isArray(g.alpha)?g.alpha.length!==2?ae=[1,1]:ae=g.alpha.slice():typeof g.alpha=="number"?ae=[g.alpha,g.alpha]:ae=[1,1],B=Y.map(function(Oe){return Math.round(Oe.index*ne)}),ae[0]=Math.min(Math.max(ae[0],0),1),ae[1]=Math.min(Math.max(ae[1],0),1);var ge=Y.map(function(Oe,Je){var We=Y[Je].index,ut=Y[Je].rgb.slice();return ut.length===4&&ut[3]>=0&&ut[3]<=1||(ut[3]=ae[0]+(ae[1]-ae[0])*We),ut}),Be=[];for(ue=0;ue<B.length-1;++ue){K=B[ue+1]-B[ue],M=ge[ue],P=ge[ue+1];for(var De=0;De<K;De++){var ze=De/K;Be.push([Math.round(lerp(M[0],P[0],ze)),Math.round(lerp(M[1],P[1],ze)),Math.round(lerp(M[2],P[2],ze)),lerp(M[3],P[3],ze)])}}return Be.push(Y[Y.length-1].rgb.concat(ae[1])),D==="hex"?Be=Be.map(rgb2hex):D==="rgbaString"?Be=Be.map(rgbaStr):D==="float"&&(Be=Be.map(rgb2float)),Be}function rgb2float(g){return[g[0]/255,g[1]/255,g[2]/255,g[3]]}function rgb2hex(g){for(var B,M="#",P=0;P<3;++P)B=g[P],B=B.toString(16),M+=("00"+B).substr(B.length);return M}function rgbaStr(g){return"rgba("+g.join(",")+")"}const colormap$1=getDefaultExportFromCjs(colormap);var strxml$1={};strxml$1.attr=attr;strxml$1.tagClose=tagClose;strxml$1.tag=tag$1;strxml$1.encode=encode$1;function attr(g){return g&&g.length?" "+g.map(function(B){return B[0]+'="'+B[1]+'"'}).join(" "):""}function tagClose(g,B){return"<"+g+attr(B)+"/>"}function tag$1(g,B,M){return"<"+g+attr(M)+">"+B+"</"+g+">"}function encode$1(g){return(g===null?"":g.toString()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}var strxml=strxml$1,tag=strxml.tag,encode=strxml.encode,tokml=function(B,M){return M=M||{documentName:void 0,documentDescription:void 0,name:"name",description:"description",simplestyle:!1,timestamp:"timestamp"},'<?xml version="1.0" encoding="UTF-8"?>'+tag("kml",tag("Document",documentName(M)+documentDescription(M)+root(B,M)),[["xmlns","http://www.opengis.net/kml/2.2"]])};function feature(g,B){return function(M){if(!M.properties||!geometry.valid(M.geometry))return"";var P=geometry.any(M.geometry);if(!P)return"";var K="",Y="";if(g.simplestyle){var re=hashStyle(M.properties);re&&(geometry.isPoint(M.geometry)&&hasMarkerStyle(M.properties)?(B.indexOf(re)===-1&&(K=markerStyle(M.properties,re),B.push(re)),Y=tag("styleUrl","#"+re)):(geometry.isPolygon(M.geometry)||geometry.isLine(M.geometry))&&hasPolygonAndLineStyle(M.properties)&&(B.indexOf(re)===-1&&(K=polygonAndLineStyle(M.properties,re),B.push(re)),Y=tag("styleUrl","#"+re)))}return K+tag("Placemark",name(M.properties,g)+description(M.properties,g)+extendeddata(M.properties)+timestamp(M.properties,g)+P+Y)}}function root(g,B){if(!g.type)return"";var M=[];switch(g.type){case"FeatureCollection":return g.features?g.features.map(feature(B,M)).join(""):"";case"Feature":return feature(B,M)(g);default:return feature(B,M)({type:"Feature",geometry:g,properties:{}})}}function documentName(g){return g.documentName!==void 0?tag("name",g.documentName):""}function documentDescription(g){return g.documentDescription!==void 0?tag("description",g.documentDescription):""}function name(g,B){return g[B.name]?tag("name",encode(g[B.name])):""}function description(g,B){return g[B.description]?tag("description",encode(g[B.description])):""}function timestamp(g,B){return g[B.timestamp]?tag("TimeStamp",tag("when",encode(g[B.timestamp]))):""}var geometry={Point:function(g){return tag("Point",tag("coordinates",g.coordinates.join(",")))},LineString:function(g){return tag("LineString",tag("coordinates",linearring(g.coordinates)))},Polygon:function(g){if(!g.coordinates.length)return"";var B=g.coordinates[0],M=g.coordinates.slice(1),P=tag("outerBoundaryIs",tag("LinearRing",tag("coordinates",linearring(B)))),K=M.map(function(Y){return tag("innerBoundaryIs",tag("LinearRing",tag("coordinates",linearring(Y))))}).join("");return tag("Polygon",P+K)},MultiPoint:function(g){return g.coordinates.length?tag("MultiGeometry",g.coordinates.map(function(B){return geometry.Point({coordinates:B})}).join("")):""},MultiPolygon:function(g){return g.coordinates.length?tag("MultiGeometry",g.coordinates.map(function(B){return geometry.Polygon({coordinates:B})}).join("")):""},MultiLineString:function(g){return g.coordinates.length?tag("MultiGeometry",g.coordinates.map(function(B){return geometry.LineString({coordinates:B})}).join("")):""},GeometryCollection:function(g){return tag("MultiGeometry",g.geometries.map(geometry.any).join(""))},valid:function(g){return g&&g.type&&(g.coordinates||g.type==="GeometryCollection"&&g.geometries&&g.geometries.every(geometry.valid))},any:function(g){return geometry[g.type]?geometry[g.type](g):""},isPoint:function(g){return g.type==="Point"||g.type==="MultiPoint"},isPolygon:function(g){return g.type==="Polygon"||g.type==="MultiPolygon"},isLine:function(g){return g.type==="LineString"||g.type==="MultiLineString"}};function linearring(g){return g.map(function(B){return B.join(",")}).join(" ")}function extendeddata(g){return tag("ExtendedData",pairs(g).map(data).join(""))}function data(g){return tag("Data",tag("value",encode(g[1])),[["name",encode(g[0])]])}function hasMarkerStyle(g){return!!(g["marker-size"]||g["marker-symbol"]||g["marker-color"])}function markerStyle(g,B){return tag("Style",tag("IconStyle",tag("Icon",tag("href",iconUrl(g))))+iconSize(),[["id",B]])}function iconUrl(g){var B=g["marker-size"]||"medium",M=g["marker-symbol"]?"-"+g["marker-symbol"]:"",P=(g["marker-color"]||"7e7e7e").replace("#","");return"https://api.tiles.mapbox.com/v3/marker/pin-"+B.charAt(0)+M+"+"+P+".png"}function iconSize(g){return tag("hotSpot","",[["xunits","fraction"],["yunits","fraction"],["x",.5],["y",.5]])}function hasPolygonAndLineStyle(g){for(var B in g)if({stroke:!0,"stroke-opacity":!0,"stroke-width":!0,fill:!0,"fill-opacity":!0}[B])return!0}function polygonAndLineStyle(g,B){var M=tag("LineStyle",[tag("color",hexToKmlColor(g.stroke,g["stroke-opacity"])||"ff555555")+tag("width",g["stroke-width"]===void 0?2:g["stroke-width"])]),P="";return(g.fill||g["fill-opacity"])&&(P=tag("PolyStyle",[tag("color",hexToKmlColor(g.fill,g["fill-opacity"])||"88555555")])),tag("Style",M+P,[["id",B]])}function hashStyle(g){var B="";return g["marker-symbol"]&&(B=B+"ms"+g["marker-symbol"]),g["marker-color"]&&(B=B+"mc"+g["marker-color"].replace("#","")),g["marker-size"]&&(B=B+"ms"+g["marker-size"]),g.stroke&&(B=B+"s"+g.stroke.replace("#","")),g["stroke-width"]&&(B=B+"sw"+g["stroke-width"].toString().replace(".","")),g["stroke-opacity"]&&(B=B+"mo"+g["stroke-opacity"].toString().replace(".","")),g.fill&&(B=B+"f"+g.fill.replace("#","")),g["fill-opacity"]&&(B=B+"fo"+g["fill-opacity"].toString().replace(".","")),B}function hexToKmlColor(g,B){if(typeof g!="string")return"";if(g=g.replace("#","").toLowerCase(),g.length===3)g=g[0]+g[0]+g[1]+g[1]+g[2]+g[2];else if(g.length!==6)return"";var M=g[0]+g[1],P=g[2]+g[3],K=g[4]+g[5],Y="ff";return typeof B=="number"&&B>=0&&B<=1&&(Y=(B*255).toString(16),Y.indexOf(".")>-1&&(Y=Y.substr(0,Y.indexOf("."))),Y.length<2&&(Y="0"+Y)),Y+K+P+M}function pairs(g){var B=[];for(var M in g)B.push([M,g[M]]);return B}const tokml$1=getDefaultExportFromCjs(tokml);var jxon={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(__viteBrowserExternal$1);(function(g,B){(function(M,P){typeof window=="object"&&window.DOMImplementation&&window.XMLSerializer&&window.DOMParser?g.exports=P(window):g.exports=P(require$$0,!0)})(commonjsGlobal,function(M,P){var K={valueKey:"_",attrKey:"$",attrPrefix:"$",lowerCaseTags:!1,trueIsEmpty:!1,autoDate:!1,ignorePrefixedNodes:!1,parseValues:!1},Y=[],re=/^\s*$/,D=/^(?:true|false)$/i,ne;return new function(){this.config=function(ze){for(var Oe in ze)K[Oe]=ze[Oe];K.parserErrorHandler&&(ne=new M.DOMParser({errorHandler:K.parserErrorHandler,locator:{}}))};function ae(ze){return K.parseValues?re.test(ze)?null:D.test(ze)?ze.toLowerCase()==="true":isFinite(ze)?parseFloat(ze):K.autoDate&&isFinite(Date.parse(ze))?new Date(ze):ze:ze}function ue(){}ue.prototype.toString=function(){return"null"},ue.prototype.valueOf=function(){return null};function ge(ze){return ze===null?new ue:ze instanceof Object?ze:new ze.constructor(ze)}function Be(ze,Oe,Je,We){var ut=4,et=3,At=1,nt=Y.length,ft=ze.hasChildNodes(),Tt=ze.nodeType===ze.ELEMENT_NODE&&ze.hasAttributes(),qt=!!(Oe&2),Vt=0,vt="",Ut=qt?{}:K.trueIsEmpty?!0:"",Pt,Yt;if(ft)for(var Ai,Ri=0;Ri<ze.childNodes.length;Ri++)Ai=ze.childNodes.item(Ri),Ai.nodeType===ut?vt+=Ai.nodeValue:Ai.nodeType===et?vt+=Ai.nodeValue.trim():Ai.nodeType===At&&!(K.ignorePrefixedNodes&&Ai.prefix)&&Y.push(Ai);var Ei=Y.length,Li=ae(vt);!qt&&(ft||Tt)&&(Ut=Oe===0?ge(Li):{});for(var Yi=nt;Yi<Ei;Yi++)Pt=Y[Yi].nodeName,K.lowerCaseTags&&(Pt=Pt.toLowerCase()),Yt=Be(Y[Yi],Oe,Je,We),Ut.hasOwnProperty(Pt)?(Ut[Pt].constructor!==Array&&(Ut[Pt]=[Ut[Pt]]),Ut[Pt].push(Yt)):(Ut[Pt]=Yt,Vt++);if(Tt){for(var vi=ze.attributes.length,d=We?"":K.attrPrefix,b=We?{}:Ut,S,k,R=0;R<vi;Vt++,R++)S=ze.attributes.item(R),k=S.name,K.lowerCaseTags&&(k=k.toLowerCase()),b[d+k]=ae(S.value.trim());We&&(Je&&Object.freeze(b),Ut[K.attrKey]=b,Vt-=vi-1)}return Oe===3||(Oe===2||Oe===1&&Vt>0)&&vt?Ut[K.valueKey]=Li:!qt&&Vt===0&&vt&&(Ut=Li),Je&&(qt||Vt>0)&&Object.freeze(Ut),Y.length=nt,Ut}function De(ze,Oe,Je){var We,ut,et;if(Je.constructor===String||Je.constructor===Number||Je.constructor===Boolean){if(Oe.appendChild(ze.createTextNode(Je.toString())),Je===Je.valueOf())return}else Je.constructor===Date&&Oe.appendChild(ze.createTextNode(Je.toISOString()));for(var At in Je)if(We=Je[At],We!==void 0&&(We===null&&(We={}),!(isFinite(At)||We instanceof Function)))if(At===K.valueKey)We!==null&&We!==!0&&Oe.appendChild(ze.createTextNode(We.constructor===Date?We.toISOString():String(We)));else if(At===K.attrKey)for(var nt in We)Oe.setAttribute(nt,We[nt]);else if(At===K.attrPrefix+"xmlns")P&&Oe.setAttribute(At.slice(1),We);else if(At.charAt(0)===K.attrPrefix)Oe.setAttribute(At.slice(1),We);else if(We.constructor===Array)for(var ft in We)We.hasOwnProperty(ft)&&(et=We[ft]&&We[ft][K.attrPrefix+"xmlns"]||Oe.namespaceURI,et?ut=ze.createElementNS(et,At):ut=ze.createElement(At),De(ze,ut,We[ft]||{}),Oe.appendChild(ut));else et=(We||{})[K.attrPrefix+"xmlns"]||Oe.namespaceURI,et?ut=ze.createElementNS(et,At):ut=ze.createElement(At),We instanceof Object?De(ze,ut,We):We!==null&&(We!==!0||!K.trueIsEmpty)&&ut.appendChild(ze.createTextNode(We.toString())),Oe.appendChild(ut)}this.xmlToJs=this.build=function(ze,Oe,Je,We){var ut=arguments.length>1&&typeof Oe=="number"?Oe&3:1;return Be(ze,ut,Je||!1,arguments.length>3?We:ut===3)},this.jsToXml=this.unbuild=function(ze,Oe,Je,We){var ut=M.document&&M.document.implementation||new M.DOMImplementation,et=ut.createDocument(Oe||null,Je||"",We||null);return De(et,et.documentElement||et,ze),et},this.stringToXml=function(ze){return ne||(ne=new M.DOMParser),ne.parseFromString(ze,"application/xml")},this.xmlToString=function(ze){return typeof ze.xml<"u"?ze.xml:new M.XMLSerializer().serializeToString(ze)},this.stringToJs=function(ze){var Oe=this.stringToXml(ze);return this.xmlToJs(Oe)},this.jsToString=this.stringify=function(ze,Oe,Je,We){return this.xmlToString(this.jsToXml(ze,Oe,Je,We))},this.each=function(ze,Oe,Je){ze instanceof Array?ze.forEach(Oe,Je):[ze].forEach(Oe,Je)}}})})(jxon);var jxonExports=jxon.exports;const JXON=jxonExports;JXON.config({attrPrefix:"@"});function togpx(g,B){if(B=function(ne,ae){for(const ue in ne)ae.hasOwnProperty(ue)&&(ne[ue]=ae[ue]);return ne}({creator:"togpx",metadata:void 0,featureTitle:M,featureDescription:P,featureLink:void 0,featureCoordTimes:K},B||{}),typeof B.featureCoordTimes=="string"){const ne=B.featureCoordTimes;B.featureCoordTimes=function(ae){return ae.properties[ne]}}function M(ne){if(!ne)return"";if(typeof ne.tags=="object"){const ae=M(ne.tags);if(ae!=="")return ae}return ne.name?ne.name:ne.ref?ne.ref:ne.id?ne.id:""}function P(ne){if(!ne)return"";if(typeof ne.tags=="object")return P(ne.tags);let ae="";for(const ue in ne)typeof ne[ue]!="object"&&(ae+=ue+"="+ne[ue]+`
`);return ae.substring(0,ae.length-1)}function K(ne){return ne.properties&&(ne.properties.times||ne.properties.coordTimes)||null}function Y(ne,ae){B.featureLink&&(ne.link={"@href":B.featureLink(ae.properties)})}const re={gpx:{"@xmlns":"http://www.topografix.com/GPX/1/1","@xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","@xsi:schemaLocation":"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd","@version":"1.1",metadata:null,wpt:[],trk:[]}};B.creator&&(re.gpx["@creator"]=B.creator),B.metadata?re.gpx.metadata=B.metadata:delete B.metadata;let D;return g.type==="FeatureCollection"?D=g.features:g.type==="Feature"?D=[g]:D=[{type:"Feature",properties:{},geometry:g}],D.forEach(function ne(ae){let ue,ge,Be;switch(ae.geometry.type){case"Point":case"MultiPoint":ue=ae.geometry.coordinates,ae.geometry.type=="Point"&&(ue=[ue]),ue.forEach(function(De){let ze={"@lat":De[1],"@lon":De[0],name:B.featureTitle(ae.properties),desc:B.featureDescription(ae.properties)};De[2]!==void 0&&(ze.ele=De[2]),Y(ze,ae),re.gpx.wpt.push(ze)});break;case"LineString":case"MultiLineString":ue=ae.geometry.coordinates,ge=B.featureCoordTimes(ae),ae.geometry.type=="LineString"&&(ue=[ue]),Be={name:B.featureTitle(ae.properties),desc:B.featureDescription(ae.properties)},Y(Be,ae),Be.trkseg=[],ue.forEach(function(De){const ze={trkpt:[]};De.forEach(function(Oe,Je){const We={"@lat":Oe[1],"@lon":Oe[0]};Oe[2]!==void 0&&(We.ele=Oe[2]),ge&&ge[Je]&&(We.time=ge[Je]),ze.trkpt.push(We)}),Be.trkseg.push(ze)}),re.gpx.trk.push(Be);break;case"Polygon":case"MultiPolygon":Be={name:B.featureTitle(ae.properties),desc:B.featureDescription(ae.properties)},Y(Be,ae),Be.trkseg=[],ue=ae.geometry.coordinates,ge=B.featureCoordTimes(ae),ae.geometry.type=="Polygon"&&(ue=[ue]),ue.forEach(function(De){De.forEach(function(ze){const Oe={trkpt:[]};let Je=0;ze.forEach(function(We){const ut={"@lat":We[1],"@lon":We[0]};We[2]!==void 0&&(ut.ele=We[2]),ge&&ge[Je]&&(ut.time=ge[Je]),Je++,Oe.trkpt.push(ut)}),Be.trkseg.push(Oe)})}),re.gpx.trk.push(Be);break;case"GeometryCollection":ae.geometry.geometries.forEach(function(De){const ze={properties:ae.properties,geometry:De};ne(ze)});break;default:console.log("warning: unsupported geometry type: "+ae.geometry.type)}}),JXON.stringify(re)}var togpx_1=togpx;const togpx$1=getDefaultExportFromCjs(togpx_1);var index={schemeGroups:{sequential:["BuGn","BuPu","GnBu","OrRd","PuBu","PuBuGn","PuRd","RdPu","YlGn","YlGnBu","YlOrBr","YlOrRd"],singlehue:["Blues","Greens","Greys","Oranges","Purples","Reds"],diverging:["BrBG","PiYG","PRGn","PuOr","RdBu","RdGy","RdYlBu","RdYlGn","Spectral"],qualitative:["Accent","Dark2","Paired","Pastel1","Pastel2","Set1","Set2","Set3"]},YlGn:{3:["#f7fcb9","#addd8e","#31a354"],4:["#ffffcc","#c2e699","#78c679","#238443"],5:["#ffffcc","#c2e699","#78c679","#31a354","#006837"],6:["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],7:["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],8:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],9:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]},YlGnBu:{3:["#edf8b1","#7fcdbb","#2c7fb8"],4:["#ffffcc","#a1dab4","#41b6c4","#225ea8"],5:["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],6:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],7:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],8:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],9:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]},GnBu:{3:["#e0f3db","#a8ddb5","#43a2ca"],4:["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],5:["#f0f9e8","#bae4bc","#7bccc4","#43a2ca","#0868ac"],6:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],7:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],8:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],9:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"]},BuGn:{3:["#e5f5f9","#99d8c9","#2ca25f"],4:["#edf8fb","#b2e2e2","#66c2a4","#238b45"],5:["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],6:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#2ca25f","#006d2c"],7:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],8:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],9:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"]},PuBuGn:{3:["#ece2f0","#a6bddb","#1c9099"],4:["#f6eff7","#bdc9e1","#67a9cf","#02818a"],5:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],6:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#1c9099","#016c59"],7:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],8:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],9:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"]},PuBu:{3:["#ece7f2","#a6bddb","#2b8cbe"],4:["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],5:["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],6:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],7:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],8:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],9:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"]},BuPu:{3:["#e0ecf4","#9ebcda","#8856a7"],4:["#edf8fb","#b3cde3","#8c96c6","#88419d"],5:["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],6:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8856a7","#810f7c"],7:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],8:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],9:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"]},RdPu:{3:["#fde0dd","#fa9fb5","#c51b8a"],4:["#feebe2","#fbb4b9","#f768a1","#ae017e"],5:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],6:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],7:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],8:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],9:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"]},PuRd:{3:["#e7e1ef","#c994c7","#dd1c77"],4:["#f1eef6","#d7b5d8","#df65b0","#ce1256"],5:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],6:["#f1eef6","#d4b9da","#c994c7","#df65b0","#dd1c77","#980043"],7:["#f1eef6","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],8:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],9:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"]},OrRd:{3:["#fee8c8","#fdbb84","#e34a33"],4:["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],5:["#fef0d9","#fdcc8a","#fc8d59","#e34a33","#b30000"],6:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000"],7:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],8:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],9:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"]},YlOrRd:{3:["#ffeda0","#feb24c","#f03b20"],4:["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],5:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],6:["#ffffb2","#fed976","#feb24c","#fd8d3c","#f03b20","#bd0026"],7:["#ffffb2","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],8:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],9:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"]},YlOrBr:{3:["#fff7bc","#fec44f","#d95f0e"],4:["#ffffd4","#fed98e","#fe9929","#cc4c02"],5:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],6:["#ffffd4","#fee391","#fec44f","#fe9929","#d95f0e","#993404"],7:["#ffffd4","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],8:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],9:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"]},Purples:{3:["#efedf5","#bcbddc","#756bb1"],4:["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],5:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],6:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#756bb1","#54278f"],7:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],8:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],9:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"]},Blues:{3:["#deebf7","#9ecae1","#3182bd"],4:["#eff3ff","#bdd7e7","#6baed6","#2171b5"],5:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],6:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#3182bd","#08519c"],7:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],8:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],9:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"]},Greens:{3:["#e5f5e0","#a1d99b","#31a354"],4:["#edf8e9","#bae4b3","#74c476","#238b45"],5:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],6:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],7:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],8:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],9:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"]},Oranges:{3:["#fee6ce","#fdae6b","#e6550d"],4:["#feedde","#fdbe85","#fd8d3c","#d94701"],5:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],6:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#e6550d","#a63603"],7:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],8:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],9:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"]},Reds:{3:["#fee0d2","#fc9272","#de2d26"],4:["#fee5d9","#fcae91","#fb6a4a","#cb181d"],5:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],6:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#de2d26","#a50f15"],7:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],8:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],9:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"]},Greys:{3:["#f0f0f0","#bdbdbd","#636363"],4:["#f7f7f7","#cccccc","#969696","#525252"],5:["#f7f7f7","#cccccc","#969696","#636363","#252525"],6:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#636363","#252525"],7:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],8:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],9:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"]},PuOr:{3:["#f1a340","#f7f7f7","#998ec3"],4:["#e66101","#fdb863","#b2abd2","#5e3c99"],5:["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],6:["#b35806","#f1a340","#fee0b6","#d8daeb","#998ec3","#542788"],7:["#b35806","#f1a340","#fee0b6","#f7f7f7","#d8daeb","#998ec3","#542788"],8:["#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788"],9:["#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788"],10:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],11:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"]},BrBG:{3:["#d8b365","#f5f5f5","#5ab4ac"],4:["#a6611a","#dfc27d","#80cdc1","#018571"],5:["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],6:["#8c510a","#d8b365","#f6e8c3","#c7eae5","#5ab4ac","#01665e"],7:["#8c510a","#d8b365","#f6e8c3","#f5f5f5","#c7eae5","#5ab4ac","#01665e"],8:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e"],9:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e"],10:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],11:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"]},PRGn:{3:["#af8dc3","#f7f7f7","#7fbf7b"],4:["#7b3294","#c2a5cf","#a6dba0","#008837"],5:["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],6:["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"],7:["#762a83","#af8dc3","#e7d4e8","#f7f7f7","#d9f0d3","#7fbf7b","#1b7837"],8:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837"],9:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837"],10:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],11:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"]},PiYG:{3:["#e9a3c9","#f7f7f7","#a1d76a"],4:["#d01c8b","#f1b6da","#b8e186","#4dac26"],5:["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],6:["#c51b7d","#e9a3c9","#fde0ef","#e6f5d0","#a1d76a","#4d9221"],7:["#c51b7d","#e9a3c9","#fde0ef","#f7f7f7","#e6f5d0","#a1d76a","#4d9221"],8:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221"],9:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221"],10:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],11:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"]},RdBu:{3:["#ef8a62","#f7f7f7","#67a9cf"],4:["#ca0020","#f4a582","#92c5de","#0571b0"],5:["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],6:["#b2182b","#ef8a62","#fddbc7","#d1e5f0","#67a9cf","#2166ac"],7:["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"]},RdGy:{3:["#ef8a62","#ffffff","#999999"],4:["#ca0020","#f4a582","#bababa","#404040"],5:["#ca0020","#f4a582","#ffffff","#bababa","#404040"],6:["#b2182b","#ef8a62","#fddbc7","#e0e0e0","#999999","#4d4d4d"],7:["#b2182b","#ef8a62","#fddbc7","#ffffff","#e0e0e0","#999999","#4d4d4d"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"]},RdYlBu:{3:["#fc8d59","#ffffbf","#91bfdb"],4:["#d7191c","#fdae61","#abd9e9","#2c7bb6"],5:["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],6:["#d73027","#fc8d59","#fee090","#e0f3f8","#91bfdb","#4575b4"],7:["#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"],8:["#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4"],9:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"]},Spectral:{3:["#fc8d59","#ffffbf","#99d594"],4:["#d7191c","#fdae61","#abdda4","#2b83ba"],5:["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],6:["#d53e4f","#fc8d59","#fee08b","#e6f598","#99d594","#3288bd"],7:["#d53e4f","#fc8d59","#fee08b","#ffffbf","#e6f598","#99d594","#3288bd"],8:["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd"],9:["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"],10:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],11:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"]},RdYlGn:{3:["#fc8d59","#ffffbf","#91cf60"],4:["#d7191c","#fdae61","#a6d96a","#1a9641"],5:["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],6:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91cf60","#1a9850"],7:["#d73027","#fc8d59","#fee08b","#ffffbf","#d9ef8b","#91cf60","#1a9850"],8:["#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850"],9:["#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"]},Accent:{3:["#7fc97f","#beaed4","#fdc086"],4:["#7fc97f","#beaed4","#fdc086","#ffff99"],5:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],6:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"],7:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17"],8:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"]},Dark2:{3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]},Paired:{3:["#a6cee3","#1f78b4","#b2df8a"],4:["#a6cee3","#1f78b4","#b2df8a","#33a02c"],5:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],6:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c"],7:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f"],8:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},Pastel1:{3:["#fbb4ae","#b3cde3","#ccebc5"],4:["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],5:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],6:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc"],7:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd"],8:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"],9:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Pastel2:{3:["#b3e2cd","#fdcdac","#cbd5e8"],4:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4"],5:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],6:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae"],7:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc"],8:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"]},Set1:{3:["#e41a1c","#377eb8","#4daf4a"],4:["#e41a1c","#377eb8","#4daf4a","#984ea3"],5:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],6:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33"],7:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628"],8:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],9:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]},Set2:{3:["#66c2a5","#fc8d62","#8da0cb"],4:["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],5:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],6:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f"],7:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],8:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"]},Set3:{3:["#8dd3c7","#ffffb3","#bebada"],4:["#8dd3c7","#ffffb3","#bebada","#fb8072"],5:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],6:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462"],7:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69"],8:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5"],9:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9"],10:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd"],11:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5"],12:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"]}};function autorepair(g,B){const M={},P={};return function(){let Y,re;if(B=="xml"){Y=g.match(/<!--[\s\S]*?-->/g)||[];for(const D of Y)re=`<!--${Base64.encode(Math.random().toString())}-->`,g=g.replace(D,re),P[re]=D}else{Y=g.match(/\/\*[\s\S]*?\*\//g)||[];for(const D of Y)re=`/*${Base64.encode(Math.random().toString())}*/`,g=g.replace(D,re),P[re]=D;Y=g.match(/\/\/[^\n]*/g)||[];for(const D of Y)re=`/*${Base64.encode(Math.random().toString())}*/`,g=g.replace(D,re),P[re]=D}}(),M.getQuery=()=>{for(const K in P)g=g.replace(K,P[K]);return g},M.recurse=()=>{if(B=="xml"){const K=g.match(/(\n?[^\S\n]*<print[\s\S]*?(\/>|<\/print>))/g)||[];for(let Y=0;Y<K.length;Y++){const re=K[Y].match(/^\n?(\s*)/)[1],D=$("print",$.parseXML(K[Y])).attr("from");let ne,ae,ue;D?(ne=` into="${D}"`,ae=` set="${D}"`,ue=` from="${D}"`):(ne="",ae="",ue=""),g=g.replace(K[Y],`
${re}<!-- added by auto repair -->
${re}<union${ne}>
${re}  <item${ae}/>
${re}  <recurse${ue} type="down"/>
${re}</union>
${re}<!-- end of auto repair --><autorepair>${Y}</autorepair>`)}for(let Y=0;Y<K.length;Y++)g=g.replace(`<autorepair>${Y}</autorepair>`,K[Y])}else{const K=g.match(/(\n?[^\S\n]*(\.[^.;]+)?out[^:;"\]]*;)/g)||[];for(let Y=0;Y<K.length;Y++){const re=K[Y].match(/^\n?(\s*)/)[0],D=K[Y].match(/\.([^;.]+?)\s+out/);let ne;D?ne=`(.${D[1]};.${D[1]} >;)->.${D[1]};`:ne="(._;>;);",g=g.replace(K[Y],`${re}/*added by auto repair*/${re}${ne}${re}/*end of auto repair*/<autorepair>${Y}</autorepair>`)}for(let Y=0;Y<K.length;Y++)g=g.replace(`<autorepair>${Y}</autorepair>`,K[Y])}return!0},M.editors=()=>{if(B=="xml"){const K=g.match(/<osm-script([^>]*)>/);if(K){const re=$("osm-script",$.parseXML(`${K[0]}</osm-script>`)).attr("output");if(re&&re!="xml"){const D=K[0].replace(re,"xml");g=g.replace(K[0],`${D}<!-- fixed by auto repair -->`)}}const Y=g.match(/(<print[\s\S]*?(\/>|<\/print>))/g)||[];for(const re of Y){const D=$("print",$.parseXML(re)),ne=D.attr("mode"),ae=D.attr("geometry");let ue="",ge,Be=!1;if(ne!=="meta"&&(D.attr("mode","meta"),Be=!0),ae&&ae!=="skeleton"){D.attr("geometry",null);const De=D.attr("from");De?ue=`<union into="${De}"><item set="${De}"/><recurse from="${De}" type="down"/></union>`:ue='<union><item/><recurse type="down"/></union>',Be=!0}Be&&(ge=ue+new XMLSerializer().serializeToString(D[0]),ge+="<!-- fixed by auto repair -->",g=g.replace(re,ge))}}else{const K=g.match(/\[\s*out\s*:\s*([^\]\s]+)\s*\]\s*;?/);K&&K[1]!="xml"&&(g=g.replace(/(\[\s*out\s*:\s*)([^\]\s]+)(\s*\]\s*;?)/,"$1xml$3/*fixed by auto repair*/"));const Y=g.match(/(\.([^;.]+?)\s+)?(\bout\b[^:;"\]]*;)/g)||[];for(const re of Y){let[D,,ne,ae]=re.match(/(\.([^;.]+?)\s+)?(\bout[^:;"\]]*;)/),ue=D,ge;(ae.match(/\s(body|skel|ids|tags|count)/)||!ae.match(/\s(meta)/))&&(ge=ae.replace(/\s(body|skel|ids|tags|count|meta)/g,"").replace(/^out/,"out meta"),ue=ue.replace(ae,ge),ae=ge),ae.match(/\s(center|bb|geom)/)&&(ge=ae.replace(/\s(center|bb|geom)/g,""),ue=ue.replace(ae,ge),ae=ge,ne?ue=`(.${ne};.${ne} >;)->.${ne}; ${ue}`:ue=`(._;>;); ${ue}`),ue!=D&&(g=g.replace(D,`${ue}/*fixed by auto repair*/`))}}return!0},M}autorepair.detect={};autorepair.detect.editors=(g,B)=>{g=g.replace(/{{.*?}}/g,"");const M={};if(B=="xml")try{const P=$.parseXML(`<x>${g}</x>`),K=$("osm-script",P).attr("output");K!==void 0&&K!=="xml"&&(M.output=!0),$("print",P).each((Y,re)=>{$(re).attr("mode")!=="meta"&&(M.meta=!0)}),$("print",P).each((Y,re)=>{$(re).attr("geometry").match(/(center|bounds|full)/)&&(M.geometry=!0)})}catch{}else{g=g.replace(/\/\*[\s\S]*?\*\//g,""),g=g.replace(/\/\/[^\n]*/g,"");const P=g.match(/\[\s*out\s*:\s*([^\]\s]+)\s*\]/);P&&P[1]!="xml"&&(M.output=!0);const K=g.match(/out([^:;]*);/g);$(K).each((Y,re)=>{(re.match(/\s(body|skel|ids|tags)/)||!re.match(/meta/))&&(M.meta=!0)}),$(K).each((Y,re)=>{re.match(/\s(center|bb|geom)/)&&(M.geometry=!0)})}return $.isEmptyObject(M)};var assign=make_assign(),create$1=make_create(),trim$1=make_trim(),Global$5=typeof window<"u"?window:commonjsGlobal,util$6={assign,create:create$1,trim:trim$1,bind:bind$1,slice:slice$1,each:each$7,map,pluck:pluck$1,isList:isList$1,isFunction:isFunction$1,isObject:isObject$1,Global:Global$5};function make_assign(){return Object.assign?Object.assign:function(B,M,P,K){for(var Y=1;Y<arguments.length;Y++)each$7(Object(arguments[Y]),function(re,D){B[D]=re});return B}}function make_create(){if(Object.create)return function(B,M,P,K){var Y=slice$1(arguments,1);return assign.apply(this,[Object.create(B)].concat(Y))};{let g=function(){};return function(M,P,K,Y){var re=slice$1(arguments,1);return g.prototype=M,assign.apply(this,[new g].concat(re))}}}function make_trim(){return String.prototype.trim?function(B){return String.prototype.trim.call(B)}:function(B){return B.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}function bind$1(g,B){return function(){return B.apply(g,Array.prototype.slice.call(arguments,0))}}function slice$1(g,B){return Array.prototype.slice.call(g,B||0)}function each$7(g,B){pluck$1(g,function(M,P){return B(M,P),!1})}function map(g,B){var M=isList$1(g)?[]:{};return pluck$1(g,function(P,K){return M[K]=B(P,K),!1}),M}function pluck$1(g,B){if(isList$1(g)){for(var M=0;M<g.length;M++)if(B(g[M],M))return g[M]}else for(var P in g)if(g.hasOwnProperty(P)&&B(g[P],P))return g[P]}function isList$1(g){return g!=null&&typeof g!="function"&&typeof g.length=="number"}function isFunction$1(g){return g&&{}.toString.call(g)==="[object Function]"}function isObject$1(g){return g&&{}.toString.call(g)==="[object Object]"}var util$5=util$6,slice=util$5.slice,pluck=util$5.pluck,each$6=util$5.each,bind=util$5.bind,create=util$5.create,isList=util$5.isList,isFunction=util$5.isFunction,isObject=util$5.isObject,storeEngine={createStore},storeAPI={version:"2.0.12",enabled:!1,get:function(g,B){var M=this.storage.read(this._namespacePrefix+g);return this._deserialize(M,B)},set:function(g,B){return B===void 0?this.remove(g):(this.storage.write(this._namespacePrefix+g,this._serialize(B)),B)},remove:function(g){this.storage.remove(this._namespacePrefix+g)},each:function(g){var B=this;this.storage.each(function(M,P){g.call(B,B._deserialize(M),(P||"").replace(B._namespaceRegexp,""))})},clearAll:function(){this.storage.clearAll()},hasNamespace:function(g){return this._namespacePrefix=="__storejs_"+g+"_"},createStore:function(){return createStore.apply(this,arguments)},addPlugin:function(g){this._addPlugin(g)},namespace:function(g){return createStore(this.storage,this.plugins,g)}};function _warn(){var g=typeof console>"u"?null:console;if(g){var B=g.warn?g.warn:g.log;B.apply(g,arguments)}}function createStore(g,B,M){M||(M=""),g&&!isList(g)&&(g=[g]),B&&!isList(B)&&(B=[B]);var P=M?"__storejs_"+M+"_":"",K=M?new RegExp("^"+P):null,Y=/^[a-zA-Z0-9_\-]*$/;if(!Y.test(M))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var re={_namespacePrefix:P,_namespaceRegexp:K,_testStorage:function(ne){try{var ae="__storejs__test__";ne.write(ae,ae);var ue=ne.read(ae)===ae;return ne.remove(ae),ue}catch{return!1}},_assignPluginFnProp:function(ne,ae){var ue=this[ae];this[ae]=function(){var Be=slice(arguments,0),De=this;function ze(){if(ue)return each$6(arguments,function(Je,We){Be[We]=Je}),ue.apply(De,Be)}var Oe=[ze].concat(Be);return ne.apply(De,Oe)}},_serialize:function(ne){return JSON.stringify(ne)},_deserialize:function(ne,ae){if(!ne)return ae;var ue="";try{ue=JSON.parse(ne)}catch{ue=ne}return ue!==void 0?ue:ae},_addStorage:function(ne){this.enabled||this._testStorage(ne)&&(this.storage=ne,this.enabled=!0)},_addPlugin:function(ne){var ae=this;if(isList(ne)){each$6(ne,function(Be){ae._addPlugin(Be)});return}var ue=pluck(this.plugins,function(Be){return ne===Be});if(!ue){if(this.plugins.push(ne),!isFunction(ne))throw new Error("Plugins must be function values that return objects");var ge=ne.call(this);if(!isObject(ge))throw new Error("Plugins must return an object of function properties");each$6(ge,function(Be,De){if(!isFunction(Be))throw new Error("Bad plugin property: "+De+" from plugin "+ne.name+". Plugins should only return functions.");ae._assignPluginFnProp(Be,De)})}},addStorage:function(ne){_warn("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(ne)}},D=create(re,storeAPI,{plugins:[]});return D.raw={},each$6(D,function(ne,ae){isFunction(ne)&&(D.raw[ae]=bind(D,ne))}),each$6(g,function(ne){D._addStorage(ne)}),each$6(B,function(ne){D._addPlugin(ne)}),D}var util$4=util$6,Global$4=util$4.Global,localStorage_1={name:"localStorage",read:read$5,write:write$5,each:each$5,remove:remove$5,clearAll:clearAll$5};function localStorage$1(){return Global$4.localStorage}function read$5(g){return localStorage$1().getItem(g)}function write$5(g,B){return localStorage$1().setItem(g,B)}function each$5(g){for(var B=localStorage$1().length-1;B>=0;B--){var M=localStorage$1().key(B);g(read$5(M),M)}}function remove$5(g){return localStorage$1().removeItem(g)}function clearAll$5(){return localStorage$1().clear()}var util$3=util$6,Global$3=util$3.Global,oldFFGlobalStorage={name:"oldFF-globalStorage",read:read$4,write:write$4,each:each$4,remove:remove$4,clearAll:clearAll$4},globalStorage=Global$3.globalStorage;function read$4(g){return globalStorage[g]}function write$4(g,B){globalStorage[g]=B}function each$4(g){for(var B=globalStorage.length-1;B>=0;B--){var M=globalStorage.key(B);g(globalStorage[M],M)}}function remove$4(g){return globalStorage.removeItem(g)}function clearAll$4(){each$4(function(g,B){delete globalStorage[g]})}var util$2=util$6,Global$2=util$2.Global,oldIEUserDataStorage={name:"oldIE-userDataStorage",write:write$3,read:read$3,each:each$3,remove:remove$3,clearAll:clearAll$3},storageName="storejs",doc$1=Global$2.document,_withStorageEl=_makeIEStorageElFunction(),disable=(Global$2.navigator?Global$2.navigator.userAgent:"").match(/ (MSIE 8|MSIE 9|MSIE 10)\./);function write$3(g,B){if(!disable){var M=fixKey(g);_withStorageEl(function(P){P.setAttribute(M,B),P.save(storageName)})}}function read$3(g){if(!disable){var B=fixKey(g),M=null;return _withStorageEl(function(P){M=P.getAttribute(B)}),M}}function each$3(g){_withStorageEl(function(B){for(var M=B.XMLDocument.documentElement.attributes,P=M.length-1;P>=0;P--){var K=M[P];g(B.getAttribute(K.name),K.name)}})}function remove$3(g){var B=fixKey(g);_withStorageEl(function(M){M.removeAttribute(B),M.save(storageName)})}function clearAll$3(){_withStorageEl(function(g){var B=g.XMLDocument.documentElement.attributes;g.load(storageName);for(var M=B.length-1;M>=0;M--)g.removeAttribute(B[M].name);g.save(storageName)})}var forbiddenCharsRegex=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");function fixKey(g){return g.replace(/^\d/,"___$&").replace(forbiddenCharsRegex,"___")}function _makeIEStorageElFunction(){if(!doc$1||!doc$1.documentElement||!doc$1.documentElement.addBehavior)return null;var g="script",B,M,P;try{M=new ActiveXObject("htmlfile"),M.open(),M.write("<"+g+">document.w=window</"+g+'><iframe src="/favicon.ico"></iframe>'),M.close(),B=M.w.frames[0].document,P=B.createElement("div")}catch{P=doc$1.createElement("div"),B=doc$1.body}return function(K){var Y=[].slice.call(arguments,0);Y.unshift(P),B.appendChild(P),P.addBehavior("#default#userData"),P.load(storageName),K.apply(this,Y),B.removeChild(P)}}var util$1=util$6,Global$1=util$1.Global,trim=util$1.trim,cookieStorage={name:"cookieStorage",read:read$2,write:write$2,each:each$2,remove:remove$2,clearAll:clearAll$2},doc=Global$1.document;function read$2(g){if(!g||!_has(g))return null;var B="(?:^|.*;\\s*)"+escape(g).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(doc.cookie.replace(new RegExp(B),"$1"))}function each$2(g){for(var B=doc.cookie.split(/; ?/g),M=B.length-1;M>=0;M--)if(trim(B[M])){var P=B[M].split("="),K=unescape(P[0]),Y=unescape(P[1]);g(Y,K)}}function write$2(g,B){g&&(doc.cookie=escape(g)+"="+escape(B)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")}function remove$2(g){!g||!_has(g)||(doc.cookie=escape(g)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function clearAll$2(){each$2(function(g,B){remove$2(B)})}function _has(g){return new RegExp("(?:^|;\\s*)"+escape(g).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(doc.cookie)}var util=util$6,Global=util.Global,sessionStorage_1={name:"sessionStorage",read:read$1,write:write$1,each:each$1,remove:remove$1,clearAll:clearAll$1};function sessionStorage(){return Global.sessionStorage}function read$1(g){return sessionStorage().getItem(g)}function write$1(g,B){return sessionStorage().setItem(g,B)}function each$1(g){for(var B=sessionStorage().length-1;B>=0;B--){var M=sessionStorage().key(B);g(read$1(M),M)}}function remove$1(g){return sessionStorage().removeItem(g)}function clearAll$1(){return sessionStorage().clear()}var memoryStorage_1={name:"memoryStorage",read,write,each,remove,clearAll},memoryStorage={};function read(g){return memoryStorage[g]}function write(g,B){memoryStorage[g]=B}function each(g){for(var B in memoryStorage)memoryStorage.hasOwnProperty(B)&&g(memoryStorage[B],B)}function remove(g){delete memoryStorage[g]}function clearAll(g){memoryStorage={}}var all=[localStorage_1,oldFFGlobalStorage,oldIEUserDataStorage,cookieStorage,sessionStorage_1,memoryStorage_1],json2$1={},hasRequiredJson2;function requireJson2(){return hasRequiredJson2||(hasRequiredJson2=1,typeof JSON!="object"&&(JSON={}),function(){var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;function f(g){return g<10?"0"+g:g}function this_value(){return this.valueOf()}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value);var gap,indent,meta,rep;function quote(g){return rx_escapable.lastIndex=0,rx_escapable.test(g)?'"'+g.replace(rx_escapable,function(B){var M=meta[B];return typeof M=="string"?M:"\\u"+("0000"+B.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+g+'"'}function str(g,B){var M,P,K,Y,re=gap,D,ne=B[g];switch(ne&&typeof ne=="object"&&typeof ne.toJSON=="function"&&(ne=ne.toJSON(g)),typeof rep=="function"&&(ne=rep.call(B,g,ne)),typeof ne){case"string":return quote(ne);case"number":return isFinite(ne)?String(ne):"null";case"boolean":case"null":return String(ne);case"object":if(!ne)return"null";if(gap+=indent,D=[],Object.prototype.toString.apply(ne)==="[object Array]"){for(Y=ne.length,M=0;M<Y;M+=1)D[M]=str(M,ne)||"null";return K=D.length===0?"[]":gap?`[
`+gap+D.join(`,
`+gap)+`
`+re+"]":"["+D.join(",")+"]",gap=re,K}if(rep&&typeof rep=="object")for(Y=rep.length,M=0;M<Y;M+=1)typeof rep[M]=="string"&&(P=rep[M],K=str(P,ne),K&&D.push(quote(P)+(gap?": ":":")+K));else for(P in ne)Object.prototype.hasOwnProperty.call(ne,P)&&(K=str(P,ne),K&&D.push(quote(P)+(gap?": ":":")+K));return K=D.length===0?"{}":gap?`{
`+gap+D.join(`,
`+gap)+`
`+re+"}":"{"+D.join(",")+"}",gap=re,K}}typeof JSON.stringify!="function"&&(meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(g,B,M){var P;if(gap="",indent="",typeof M=="number")for(P=0;P<M;P+=1)indent+=" ";else typeof M=="string"&&(indent=M);if(rep=B,B&&typeof B!="function"&&(typeof B!="object"||typeof B.length!="number"))throw new Error("JSON.stringify");return str("",{"":g})}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){var j;function walk(g,B){var M,P,K=g[B];if(K&&typeof K=="object")for(M in K)Object.prototype.hasOwnProperty.call(K,M)&&(P=walk(K,M),P!==void 0?K[M]=P:delete K[M]);return reviver.call(g,B,K)}if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(g){return"\\u"+("0000"+g.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()),json2$1}var json2=json2Plugin;function json2Plugin(){return requireJson2(),{}}var engine=storeEngine,storages=all,plugins=[json2],store_legacy=engine.createStore(storages,plugins);const store=getDefaultExportFromCjs(store_legacy);function osmAuth(g){var B={};B.authenticated=function(){return!!K("oauth2_access_token")},B.logout=function(){return K("oauth2_access_token",""),K("oauth_token",""),K("oauth_token_secret",""),K("oauth_request_token_secret",""),B},B.authenticate=function(re){if(B.authenticated()){re(null,B);return}B.logout(),_generatePkceChallenge(function(D){M(D,re)})},B.authenticateAsync=function(){return B.authenticated()?Promise.resolve(B):(B.logout(),new Promise((re,D)=>{var ne=(ae,ue)=>{ae?D(new Error(ae)):re(ue)};_generatePkceChallenge(ae=>M(ae,ne))}))};function M(re,D){var ne=generateState(),ae=g.url+"/oauth2/authorize?"+utilQsString({client_id:g.client_id,redirect_uri:g.redirect_uri,response_type:"code",scope:g.scope,state:ne,code_challenge:re.code_challenge,code_challenge_method:re.code_challenge_method});if(g.singlepage){if(!store.enabled){var ue=new Error("local storage unavailable, but require in singlepage mode");ue.status="pkce-localstorage-unavailable",D(ue);return}var ge=utilStringQs(window.location.search.slice(1));ge.code?B.bootstrapToken(ge.code,D):(K("oauth2_state",ne),K("oauth2_pkce_code_verifier",re.code_verifier),window.location=ae)}else{var Be=600,De=550,ze=[["width",Be],["height",De],["left",window.screen.width/2-Be/2],["top",window.screen.height/2-De/2]].map(function(We){return We.join("=")}).join(","),Oe=window.open("about:blank","oauth_window",ze);B.popupWindow=Oe,Oe.location=ae,Oe||(ue=new Error("Popup was blocked"),ue.status="popup-blocked",D(ue))}window.authComplete=function(We){var ut=utilStringQs(We.split("?")[1]);if(ut.state!==ne){ue=new Error("Invalid state"),ue.status="invalid-state",D(ue);return}P(ut.code,re.code_verifier,Je),delete window.authComplete};function Je(We,ut){if(g.done(),We){D(We);return}var et=JSON.parse(ut.response);K("oauth2_access_token",et.access_token),D(null,B)}}function P(re,D,ne){var ae=g.url+"/oauth2/token?"+utilQsString({client_id:g.client_id,redirect_uri:g.redirect_uri,grant_type:"authorization_code",code:re,code_verifier:D});B.rawxhr("POST",ae,null,null,null,ne),g.loading()}B.bringPopupWindowToFront=function(){var re=!1;try{B.popupWindow&&!B.popupWindow.closed&&(B.popupWindow.focus(),re=!0)}catch{}return re},B.bootstrapToken=function(re,D){var ne=K("oauth2_state");K("oauth2_state","");var ae=utilStringQs(window.location.search.slice(1));if(ae.state!==ne){var ue=new Error("Invalid state");ue.status="invalid-state",D(ue);return}var ge=K("oauth2_pkce_code_verifier");K("oauth2_pkce_code_verifier",""),P(re,ge,Be);function Be(De,ze){if(g.done(),De){D(De);return}var Oe=JSON.parse(ze.response);K("oauth2_access_token",Oe.access_token),D(null,B)}},B.fetch=function(re,D){if(B.authenticated())return ne();return g.auto?B.authenticateAsync().then(ne):Promise.reject(new Error("not authenticated"));function ne(){return D=D||{},D.headers||(D.headers={"Content-Type":"application/x-www-form-urlencoded"}),D.headers.Authorization="Bearer "+K("oauth2_access_token"),fetch(re,D)}},B.xhr=function(re,D){if(B.authenticated())return ne();if(g.auto){B.authenticate(ne);return}else{D("not authenticated",null);return}function ne(){var ue=re.prefix!==!1?g.url+re.path:re.path;return B.rawxhr(re.method,ue,K("oauth2_access_token"),re.content,re.headers,ae)}function ae(ue,ge){ue?D(ue):ge.responseXML?D(ue,ge.responseXML):D(ue,ge.response)}},B.rawxhr=function(re,D,ne,ae,ue,ge){ue=ue||{"Content-Type":"application/x-www-form-urlencoded"},ne&&(ue.Authorization="Bearer "+ne);var Be=new XMLHttpRequest;Be.onreadystatechange=function(){Be.readyState===4&&Be.status!==0&&(/^20\d$/.test(Be.status)?ge(null,Be):ge(Be,null))},Be.onerror=function(ze){ge(ze,null)},Be.open(re,D,!0);for(var De in ue)Be.setRequestHeader(De,ue[De]);return Be.send(ae),Be},B.preauth=function(re){return re&&re.access_token&&K("oauth2_access_token",re.access_token),B},B.options=function(re){return arguments.length?(g=re,g.url=g.url||"https://www.openstreetmap.org",g.auto=g.auto||!1,g.singlepage=g.singlepage||!1,g.loading=g.loading||function(){},g.done=g.done||function(){},B.preauth(g)):g};var K;if(store.enabled)K=function(re,D){if(arguments.length===1)return store.get(g.url+re);if(arguments.length===2)return store.set(g.url+re,D)};else{var Y={};K=function(re,D){if(arguments.length===1)return Y[g.url+re];if(arguments.length===2)return Y[g.url+re]=D}}return B.options(g),B}function utilQsString(g){return Object.keys(g).filter(function(B){return g[B]!==void 0}).sort().map(function(B){return encodeURIComponent(B)+"="+encodeURIComponent(g[B])}).join("&")}function utilStringQs(g){for(var B=0;B<g.length&&(g[B]==="?"||g[B]==="#");)B++;return g=g.slice(B),g.split("&").reduce(function(M,P){var K=P.split("=");return K.length===2&&(M[K[0]]=decodeURIComponent(K[1])),M},{})}function supportsWebCryptoAPI(){return window&&window.crypto&&window.crypto.getRandomValues&&window.crypto.subtle&&window.crypto.subtle.digest}function _generatePkceChallenge(g){var B;if(supportsWebCryptoAPI()){var M=window.crypto.getRandomValues(new Uint8Array(32));B=base64(M.buffer);var P=Uint8Array.from(Array.from(B).map(function(re){return re.charCodeAt(0)}));window.crypto.subtle.digest("SHA-256",P).then(function(re){var D=base64(re);g({code_challenge:D,code_verifier:B,code_challenge_method:"S256"})})}else{var K="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";B="";for(var Y=0;Y<64;Y++)B+=K[Math.floor(Math.random()*K.length)];g({code_verifier:B,code_challenge:B,code_challenge_method:"plain"})}}function generateState(){var g;if(supportsWebCryptoAPI()){var B=window.crypto.getRandomValues(new Uint8Array(32));g=base64(B.buffer)}else{var M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";g="";for(var P=0;P<64;P++)g+=M[Math.floor(Math.random()*M.length)]}return g}function base64(g){return btoa(String.fromCharCode.apply(null,new Uint8Array(g))).replace(/\//g,"_").replace(/\+/g,"-").replace(/[=]/g,"")}const enabled=configs.osmAuth&&configs.osmAuth.client_id;configs.osmAuth.redirect_uri||(configs.osmAuth.redirect_uri=`${window.location.origin}${window.location.pathname}land.html`);configs.osmAuth.scope="read_prefs write_prefs";let auth;enabled&&(auth=osmAuth(configs.osmAuth));const sync={enabled,load(g){auth.authenticated()?loadQueries(g):auth.authenticate(B=>{if(B)return g(B);loadQueries(g)})},save(g,B){auth.authenticated()?saveQuery(g,B):auth.authenticate(M=>{if(M)return B(M);saveQuery(g,B)})},delete(g,B){if(!auth.authenticated())return B(new Error("must be logged in to delete a synced query"));g={name:g,deleteMe:!0},saveQuery(g,B)},logout(){auth.authenticated()&&auth.logout()},authenticated(){return enabled&&auth.authenticated()}};function loadQueries(g){auth.xhr({method:"GET",path:"/api/0.6/user/preferences"},(B,M)=>{if(B)return g(B);let P=0,K;(K=M.querySelector(`preference[k="${configs.settingNamespace}_query-count"]`))&&(P=+K.getAttribute("v"));const Y=[];for(let re=0;re<P;re++){const D=M.querySelector(`preference[k="${configs.settingNamespace}_query_${re}_0"]`);if(!D)continue;const ne=D.getAttribute("v").split("&"),ae=+ne[0].slice(2),ue=ne[1].slice(2);let ge=ne[2].slice(2);for(let Be=1;Be<ae;Be++)ge+=M.querySelector(`preference[k="${configs.settingNamespace}_query_${re}_${Be}"]`).getAttribute("v");Y.push({name:ue,query:ge})}g(null,Y,M)})}function saveQuery(g,B){loadQueries((M,P,K)=>{if(M)return B(M);const Y=K.querySelector("preferences"),re=Y.querySelectorAll(`preference[k^="${configs.settingNamespace}_query"]`);for(const ae of re)ae.remove();let D=!0;P.forEach((ae,ue)=>{ae.name==g.name&&(ae.query=g.query,D=ue)}),D===!0?P.push(g):g.deleteMe&&P.splice(D,1);const ne=K.createElement("preference");ne.setAttribute("k",`${configs.settingNamespace}_query-count`),ne.setAttribute("v",P.length),Y.appendChild(ne);for(let ae=0;ae<P.length;ae++){const ue=P[ae];if(ue.name.length>200)return B(new Error("query name too long to be saved on osm.org"));const ge=Math.ceil((ue.query.length+ue.name.length+8)/255);if(ge>9)return B(new Error("query too long to be saved on osm.org"));let Be=`p=${ge}`;Be+=`&n=${ue.name}`,Be+=`&q=${ue.query}`,Be=Be.match(/.{1,255}/g);for(let De=0;De<ge;De++){const ze=K.createElement("preference");ze.setAttribute("k",`${configs.settingNamespace}_query_${ae}_${De}`),ze.setAttribute("v",Be[De]),Y.appendChild(ze)}}auth.xhr({method:"PUT",path:"/api/0.6/user/preferences",headers:{"Content-Type":"text/xml"},content:K.firstChild.outerHTML},ae=>{if(ae)return B(ae);B(null,P)})})}const cache={};class nominatim{static request(B,M){$.ajax(`https://nominatim-api.openhistoricalmap.org/search?X-Requested-With=${configs.appname}`,{data:{format:"json",q:B},success(P){if(typeof P=="string")try{P=JSON.parse(P)}catch{}cache[B]=P,M(void 0,P)},error(){const P="An error occurred while contacting the osm search server nominatim.openhistoricalmap.org :(";console.log(P),M(P,null)}})}static get(B,M){return cache[B]===void 0?this.request(B,M):M(void 0,cache[B]),this}static getBest(B,M,P){return P||(P=M,M=null),this.get(B,(K,Y)=>{if(K){P(K,null);return}M&&(Y=Y.filter(M)),Y.length===0?P("No result found",null):P(K,Y[0])}),this}}function map2bbox(g){let B;ide.map.bboxfilter&&ide.map.bboxfilter.isEnabled()?B=ide.map.bboxfilter.getBounds():B=ide.map.getBounds();const M=Math.min(Math.max(B.getSouthWest().lat,-90),90),P=Math.min(Math.max(B.getNorthEast().lat,-90),90),K=Math.min(Math.max(B.getSouthWest().lng,-180),180),Y=Math.min(Math.max(B.getNorthEast().lng,-180),180);if(g=="OverpassQL")return`${M},${K},${P},${Y}`;if(g=="xml")return`s="${M}" w="${K}" n="${P}" e="${Y}"`}function map2coord(g){const B=ide.map.getCenter();if(g=="OverpassQL")return`${B.lat},${B.lng}`;if(g=="xml")return`lat="${B.lat}" lon="${B.lng}"`}function relativeTime(g,B){const M=Date.now();if(g==""&&(g="0 seconds"),g=g.toLowerCase().match(/(-?[0-9]+) ?(seconds?|minutes?|hours?|days?|weeks?|months?|years?)?/),g===null){B("");return}const P=parseInt(g[1]);let K;switch(g[2]){case"second":case"seconds":K=1;break;case"minute":case"minutes":K=60;break;case"hour":case"hours":K=3600;break;case"day":case"days":default:K=86400;break;case"week":case"weeks":K=604800;break;case"month":case"months":K=2628e3;break;case"year":case"years":K=31536e3;break}const Y=M-P*K*1e3;B(new Date(Y).toISOString())}function geocodeId(g,B){const M=ide.getQueryLang();function P(K){return K.osm_type&&K.osm_id}nominatim.getBest(g,P,(K,Y)=>{if(K)return ide.onNominatimError(g,"Id");M=="OverpassQL"?Y=`${Y.osm_type}(${Y.osm_id})`:M=="xml"&&(Y=`type="${Y.osm_type}" ref="${Y.osm_id}"`),B(Y)})}function geocodeArea(g,B){const M=ide.getQueryLang();function P(K){return K.osm_type&&K.osm_id&&K.osm_type!=="node"}nominatim.getBest(g,P,(K,Y)=>{if(K)return ide.onNominatimError(g,"Area");let re=1*Y.osm_id;if(Y.osm_type=="way"&&(re+=24e8),Y.osm_type=="relation"&&(re+=36e8),M=="OverpassQL")return Y.osm_type==="way"&&(re+=`,${Y.osm_id}`),B(`area(id:${re})`);if(M=="xml")return Y.osm_type==="way"&&(re+=`" ref_1="${Y.osm_id}`),B(`type="area" ref="${re}"`)})}function geocodeBbox(g,B){const M=ide.getQueryLang();nominatim.getBest(g,(P,K)=>{if(P)return ide.onNominatimError(g,"Bbox");const Y=Math.min(Math.max(K.boundingbox[0],-90),90),re=Math.min(Math.max(K.boundingbox[1],-90),90),D=Math.min(Math.max(K.boundingbox[2],-180),180),ne=Math.min(Math.max(K.boundingbox[3],-180),180);M=="OverpassQL"?K=`${Y},${D},${re},${ne}`:M=="xml"&&(K=`s="${Y}" w="${D}" n="${re}" e="${ne}"`),B(K)})}function geocodeCoords(g,B){const M=ide.getQueryLang();nominatim.getBest(g,(P,K)=>{if(P)return ide.onNominatimError(g,"Coords");M=="OverpassQL"?K=`${K.lat},${K.lon}`:M=="xml"&&(K=`lat="${K.lat}" lon="${K.lon}"`),B(K)})}function shortcuts(){const g=ide.getQueryLang();return{bbox:map2bbox(g),center:map2coord(g),__bbox__global_bbox_xml__ezs4K8__:map2bbox("OverpassQL"),date:relativeTime,geocodeId,geocodeArea,geocodeBbox,geocodeCoords,nominatimId:g=="xml"?geocodeId:(B,M)=>geocodeId(B,P=>M(`${P};`)),nominatimArea:g=="xml"?geocodeArea:(B,M)=>geocodeArea(B,P=>M(`${P};`)),nominatimBbox:geocodeBbox,nominatimCoords:geocodeCoords}}var maplibreGl={exports:{}};(function(g,B){(function(M,P){g.exports=P()})(commonjsGlobal,function(){var M,P,K;function Y(D,ne){if(!M)M=ne;else if(!P)P=ne;else{var ae="var sharedChunk = {}; ("+M+")(sharedChunk); ("+P+")(sharedChunk);",ue={};M(ue),K=ne(ue),typeof window<"u"&&(K.workerUrl=window.URL.createObjectURL(new Blob([ae],{type:"text/javascript"})))}}Y(["exports"],function(D){function ne(C){return C&&C.__esModule&&Object.prototype.hasOwnProperty.call(C,"default")?C.default:C}var ae=ue;function ue(C,w){this.x=C,this.y=w}ue.prototype={clone:function(){return new ue(this.x,this.y)},add:function(C){return this.clone()._add(C)},sub:function(C){return this.clone()._sub(C)},multByPoint:function(C){return this.clone()._multByPoint(C)},divByPoint:function(C){return this.clone()._divByPoint(C)},mult:function(C){return this.clone()._mult(C)},div:function(C){return this.clone()._div(C)},rotate:function(C){return this.clone()._rotate(C)},rotateAround:function(C,w){return this.clone()._rotateAround(C,w)},matMult:function(C){return this.clone()._matMult(C)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(C){return this.x===C.x&&this.y===C.y},dist:function(C){return Math.sqrt(this.distSqr(C))},distSqr:function(C){var w=C.x-this.x,I=C.y-this.y;return w*w+I*I},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(C){return Math.atan2(this.y-C.y,this.x-C.x)},angleWith:function(C){return this.angleWithSep(C.x,C.y)},angleWithSep:function(C,w){return Math.atan2(this.x*w-this.y*C,this.x*C+this.y*w)},_matMult:function(C){var w=C[2]*this.x+C[3]*this.y;return this.x=C[0]*this.x+C[1]*this.y,this.y=w,this},_add:function(C){return this.x+=C.x,this.y+=C.y,this},_sub:function(C){return this.x-=C.x,this.y-=C.y,this},_mult:function(C){return this.x*=C,this.y*=C,this},_div:function(C){return this.x/=C,this.y/=C,this},_multByPoint:function(C){return this.x*=C.x,this.y*=C.y,this},_divByPoint:function(C){return this.x/=C.x,this.y/=C.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var C=this.y;return this.y=this.x,this.x=-C,this},_rotate:function(C){var w=Math.cos(C),I=Math.sin(C),H=I*this.x+w*this.y;return this.x=w*this.x-I*this.y,this.y=H,this},_rotateAround:function(C,w){var I=Math.cos(C),H=Math.sin(C),q=w.y+H*(this.x-w.x)+I*(this.y-w.y);return this.x=w.x+I*(this.x-w.x)-H*(this.y-w.y),this.y=q,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ue.convert=function(C){return C instanceof ue?C:Array.isArray(C)?new ue(C[0],C[1]):C};var ge=ne(ae),Be=De;function De(C,w,I,H){this.cx=3*C,this.bx=3*(I-C)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*w,this.by=3*(H-w)-this.cy,this.ay=1-this.cy-this.by,this.p1x=C,this.p1y=w,this.p2x=I,this.p2y=H}De.prototype={sampleCurveX:function(C){return((this.ax*C+this.bx)*C+this.cx)*C},sampleCurveY:function(C){return((this.ay*C+this.by)*C+this.cy)*C},sampleCurveDerivativeX:function(C){return(3*this.ax*C+2*this.bx)*C+this.cx},solveCurveX:function(C,w){if(w===void 0&&(w=1e-6),C<0)return 0;if(C>1)return 1;for(var I=C,H=0;H<8;H++){var q=this.sampleCurveX(I)-C;if(Math.abs(q)<w)return I;var ee=this.sampleCurveDerivativeX(I);if(Math.abs(ee)<1e-6)break;I-=q/ee}var ie=0,oe=1;for(I=C,H=0;H<20&&(q=this.sampleCurveX(I),!(Math.abs(q-C)<w));H++)C>q?ie=I:oe=I,I=.5*(oe-ie)+ie;return I},solve:function(C,w){return this.sampleCurveY(this.solveCurveX(C,w))}};var ze=ne(Be);function Oe(C,w,I,H){const q=new ze(C,w,I,H);return function(ee){return q.solve(ee)}}const Je=Oe(.25,.1,.25,1);function We(C,w,I){return Math.min(I,Math.max(w,C))}function ut(C,w,I){const H=I-w,q=((C-w)%H+H)%H+w;return q===w?I:q}function et(C,...w){for(const I of w)for(const H in I)C[H]=I[H];return C}let At=1;function nt(C,w,I){const H={};for(const q in C)H[q]=w.call(I||this,C[q],q,C);return H}function ft(C,w,I){const H={};for(const q in C)w.call(I||this,C[q],q,C)&&(H[q]=C[q]);return H}function Tt(C){return Array.isArray(C)?C.map(Tt):typeof C=="object"&&C?nt(C,Tt):C}const qt={};function Vt(C){qt[C]||(typeof console<"u"&&console.warn(C),qt[C]=!0)}function vt(C,w,I){return(I.y-C.y)*(w.x-C.x)>(w.y-C.y)*(I.x-C.x)}function Ut(C){let w=0;for(let I,H,q=0,ee=C.length,ie=ee-1;q<ee;ie=q++)I=C[q],H=C[ie],w+=(H.x-I.x)*(I.y+H.y);return w}function Pt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Yt=null;function Ai(C){if(Yt==null){const w=C.navigator?C.navigator.userAgent:null;Yt=!!C.safari||!(!w||!(/\b(iPad|iPhone|iPod)\b/.test(w)||w.match("Safari")&&!w.match("Chrome")))}return Yt}function Ri(C){return typeof ImageBitmap<"u"&&C instanceof ImageBitmap}const Ei="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Li,Yi;const vi={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(C){const w=requestAnimationFrame(C);return{cancel:()=>cancelAnimationFrame(w)}},getImageData(C,w=0){return this.getImageCanvasContext(C).getImageData(-w,-w,C.width+2*w,C.height+2*w)},getImageCanvasContext(C){const w=window.document.createElement("canvas"),I=w.getContext("2d",{willReadFrequently:!0});if(!I)throw new Error("failed to create canvas 2d context");return w.width=C.width,w.height=C.height,I.drawImage(C,0,0,C.width,C.height),I},resolveURL:C=>(Li||(Li=document.createElement("a")),Li.href=C,Li.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Yi==null&&(Yi=matchMedia("(prefers-reduced-motion: reduce)")),Yi.matches)}},d={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class b extends Error{constructor(w,I,H,q){super(`AJAXError: ${I} (${w}): ${H}`),this.status=w,this.statusText=I,this.url=H,this.body=q}}const S=Pt()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,k=C=>d.REGISTERED_PROTOCOLS[C.substring(0,C.indexOf("://"))];function R(C,w){const I=new AbortController,H=new Request(C.url,{method:C.method||"GET",body:C.body,credentials:C.credentials,headers:C.headers,cache:C.cache,referrer:S(),signal:I.signal});let q=!1,ee=!1;return C.type==="json"&&H.headers.set("Accept","application/json"),ee||fetch(H).then(ie=>ie.ok?(oe=>{(C.type==="arrayBuffer"||C.type==="image"?oe.arrayBuffer():C.type==="json"?oe.json():oe.text()).then(de=>{ee||(q=!0,w(null,de,oe.headers.get("Cache-Control"),oe.headers.get("Expires")))}).catch(de=>{ee||w(new Error(de.message))})})(ie):ie.blob().then(oe=>w(new b(ie.status,ie.statusText,C.url,oe)))).catch(ie=>{ie.code!==20&&w(new Error(ie.message))}),{cancel:()=>{ee=!0,q||I.abort()}}}const W=function(C,w){if(/:\/\//.test(C.url)&&!/^https?:|^file:/.test(C.url)){if(Pt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",C,w);if(!Pt())return(k(C.url)||R)(C,w)}if(!(/^file:/.test(I=C.url)||/^file:/.test(S())&&!/^\w+:/.test(I))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return R(C,w);if(Pt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",C,w,void 0,!0)}var I;return function(H,q){const ee=new XMLHttpRequest;ee.open(H.method||"GET",H.url,!0),H.type!=="arrayBuffer"&&H.type!=="image"||(ee.responseType="arraybuffer");for(const ie in H.headers)ee.setRequestHeader(ie,H.headers[ie]);return H.type==="json"&&(ee.responseType="text",ee.setRequestHeader("Accept","application/json")),ee.withCredentials=H.credentials==="include",ee.onerror=()=>{q(new Error(ee.statusText))},ee.onload=()=>{if((ee.status>=200&&ee.status<300||ee.status===0)&&ee.response!==null){let ie=ee.response;if(H.type==="json")try{ie=JSON.parse(ee.response)}catch(oe){return q(oe)}q(null,ie,ee.getResponseHeader("Cache-Control"),ee.getResponseHeader("Expires"))}else{const ie=new Blob([ee.response],{type:ee.getResponseHeader("Content-Type")});q(new b(ee.status,ee.statusText,H.url,ie))}},ee.send(H.body),{cancel:()=>ee.abort()}}(C,w)},se=function(C,w){return W(et(C,{type:"arrayBuffer"}),w)};function le(C){if(!C||C.indexOf("://")<=0||C.indexOf("data:image/")===0||C.indexOf("blob:")===0)return!0;const w=new URL(C),I=window.location;return w.protocol===I.protocol&&w.host===I.host}function fe(C,w,I){I[C]&&I[C].indexOf(w)!==-1||(I[C]=I[C]||[],I[C].push(w))}function be(C,w,I){if(I&&I[C]){const H=I[C].indexOf(w);H!==-1&&I[C].splice(H,1)}}class Te{constructor(w,I={}){et(this,I),this.type=w}}class Ve extends Te{constructor(w,I={}){super("error",et({error:w},I))}}class Ue{on(w,I){return this._listeners=this._listeners||{},fe(w,I,this._listeners),this}off(w,I){return be(w,I,this._listeners),be(w,I,this._oneTimeListeners),this}once(w,I){return I?(this._oneTimeListeners=this._oneTimeListeners||{},fe(w,I,this._oneTimeListeners),this):new Promise(H=>this.once(w,H))}fire(w,I){typeof w=="string"&&(w=new Te(w,I||{}));const H=w.type;if(this.listens(H)){w.target=this;const q=this._listeners&&this._listeners[H]?this._listeners[H].slice():[];for(const oe of q)oe.call(this,w);const ee=this._oneTimeListeners&&this._oneTimeListeners[H]?this._oneTimeListeners[H].slice():[];for(const oe of ee)be(H,oe,this._oneTimeListeners),oe.call(this,w);const ie=this._eventedParent;ie&&(et(w,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),ie.fire(w))}else w instanceof Ve&&console.error(w.error);return this}listens(w){return this._listeners&&this._listeners[w]&&this._listeners[w].length>0||this._oneTimeListeners&&this._oneTimeListeners[w]&&this._oneTimeListeners[w].length>0||this._eventedParent&&this._eventedParent.listens(w)}setEventedParent(w,I){return this._eventedParent=w,this._eventedParentData=I,this}}var me={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const ke=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function qe(C,w){const I={};for(const H in C)H!=="ref"&&(I[H]=C[H]);return ke.forEach(H=>{H in w&&(I[H]=w[H])}),I}function lt(C,w){if(Array.isArray(C)){if(!Array.isArray(w)||C.length!==w.length)return!1;for(let I=0;I<C.length;I++)if(!lt(C[I],w[I]))return!1;return!0}if(typeof C=="object"&&C!==null&&w!==null){if(typeof w!="object"||Object.keys(C).length!==Object.keys(w).length)return!1;for(const I in C)if(!lt(C[I],w[I]))return!1;return!0}return C===w}const pt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ft(C,w,I){I.push({command:pt.addSource,args:[C,w[C]]})}function zt(C,w,I){w.push({command:pt.removeSource,args:[C]}),I[C]=!0}function Nt(C,w,I,H){zt(C,I,H),Ft(C,w,I)}function Mt(C,w,I){let H;for(H in C[I])if(Object.prototype.hasOwnProperty.call(C[I],H)&&H!=="data"&&!lt(C[I][H],w[I][H]))return!1;for(H in w[I])if(Object.prototype.hasOwnProperty.call(w[I],H)&&H!=="data"&&!lt(C[I][H],w[I][H]))return!1;return!0}function $t(C,w,I,H,q,ee){let ie;for(ie in w=w||{},C=C||{})Object.prototype.hasOwnProperty.call(C,ie)&&(lt(C[ie],w[ie])||I.push({command:ee,args:[H,ie,w[ie],q]}));for(ie in w)Object.prototype.hasOwnProperty.call(w,ie)&&!Object.prototype.hasOwnProperty.call(C,ie)&&(lt(C[ie],w[ie])||I.push({command:ee,args:[H,ie,w[ie],q]}))}function ri(C){return C.id}function ci(C,w){return C[w.id]=w,C}class wt{constructor(w,I,H,q){this.message=(w?`${w}: `:"")+H,q&&(this.identifier=q),I!=null&&I.__line__&&(this.line=I.__line__)}}function di(C,...w){for(const I of w)for(const H in I)C[H]=I[H];return C}class ii extends Error{constructor(w,I){super(I),this.message=I,this.key=w}}class Hi{constructor(w,I=[]){this.parent=w,this.bindings={};for(const[H,q]of I)this.bindings[H]=q}concat(w){return new Hi(this,w)}get(w){if(this.bindings[w])return this.bindings[w];if(this.parent)return this.parent.get(w);throw new Error(`${w} not found in scope.`)}has(w){return!!this.bindings[w]||!!this.parent&&this.parent.has(w)}}const Vi={kind:"null"},Ot={kind:"number"},_i={kind:"string"},Ti={kind:"boolean"},Wi={kind:"color"},Zt={kind:"object"},mi={kind:"value"},bi={kind:"collator"},$i={kind:"formatted"},tr={kind:"padding"},Ar={kind:"resolvedImage"},Tr={kind:"variableAnchorOffsetCollection"};function ji(C,w){return{kind:"array",itemType:C,N:w}}function Ii(C){if(C.kind==="array"){const w=Ii(C.itemType);return typeof C.N=="number"?`array<${w}, ${C.N}>`:C.itemType.kind==="value"?"array":`array<${w}>`}return C.kind}const Qs=[Vi,Ot,_i,Ti,Wi,$i,Zt,ji(mi),tr,Ar,Tr];function $r(C,w){if(w.kind==="error")return null;if(C.kind==="array"){if(w.kind==="array"&&(w.N===0&&w.itemType.kind==="value"||!$r(C.itemType,w.itemType))&&(typeof C.N!="number"||C.N===w.N))return null}else{if(C.kind===w.kind)return null;if(C.kind==="value"){for(const I of Qs)if(!$r(I,w))return null}}return`Expected ${Ii(C)} but found ${Ii(w)} instead.`}function it(C,w){return w.some(I=>I.kind===C.kind)}function Ie(C,w){return w.some(I=>I==="null"?C===null:I==="array"?Array.isArray(C):I==="object"?C&&!Array.isArray(C)&&typeof C=="object":I===typeof C)}function ce(C,w){return C.kind==="array"&&w.kind==="array"?C.itemType.kind===w.itemType.kind&&typeof C.N=="number":C.kind===w.kind}const ye=.96422,xe=.82521,Me=4/29,Ge=6/29,Le=3*Ge*Ge,Ke=Ge*Ge*Ge,st=Math.PI/180,_t=180/Math.PI;function xt(C){return(C%=360)<0&&(C+=360),C}function kt([C,w,I,H]){let q,ee;const ie=Di((.2225045*(C=ai(C))+.7168786*(w=ai(w))+.0606169*(I=ai(I)))/1);C===w&&w===I?q=ee=ie:(q=Di((.4360747*C+.3850649*w+.1430804*I)/ye),ee=Di((.0139322*C+.0971045*w+.7141733*I)/xe));const oe=116*ie-16;return[oe<0?0:oe,500*(q-ie),200*(ie-ee),H]}function ai(C){return C<=.04045?C/12.92:Math.pow((C+.055)/1.055,2.4)}function Di(C){return C>Ke?Math.pow(C,1/3):C/Le+Me}function ni([C,w,I,H]){let q=(C+16)/116,ee=isNaN(w)?q:q+w/500,ie=isNaN(I)?q:q-I/200;return q=1*Ui(q),ee=ye*Ui(ee),ie=xe*Ui(ie),[ei(3.1338561*ee-1.6168667*q-.4906146*ie),ei(-.9787684*ee+1.9161415*q+.033454*ie),ei(.0719453*ee-.2289914*q+1.4052427*ie),H]}function ei(C){return(C=C<=.00304?12.92*C:1.055*Math.pow(C,1/2.4)-.055)<0?0:C>1?1:C}function Ui(C){return C>Ge?C*C*C:Le*(C-Me)}function Qi(C){return parseInt(C.padEnd(2,C),16)/255}function hr(C,w){return Ki(w?C/100:C,0,1)}function Ki(C,w,I){return Math.min(Math.max(w,C),I)}function Xt(C){return!C.some(Number.isNaN)}const br={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class wi{constructor(w,I,H,q=1,ee=!0){this.r=w,this.g=I,this.b=H,this.a=q,ee||(this.r*=q,this.g*=q,this.b*=q,q||this.overwriteGetter("rgb",[w,I,H,q]))}static parse(w){if(w instanceof wi)return w;if(typeof w!="string")return;const I=function(H){if((H=H.toLowerCase().trim())==="transparent")return[0,0,0,0];const q=br[H];if(q){const[ie,oe,de]=q;return[ie/255,oe/255,de/255,1]}if(H.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(H)){const ie=H.length<6?1:2;let oe=1;return[Qi(H.slice(oe,oe+=ie)),Qi(H.slice(oe,oe+=ie)),Qi(H.slice(oe,oe+=ie)),Qi(H.slice(oe,oe+ie)||"ff")]}if(H.startsWith("rgb")){const ie=H.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(ie){const[oe,de,_e,Ee,Fe,Pe,He,Ne,tt,at,ct,mt]=ie,ht=[Ee||" ",He||" ",at].join("");if(ht==="  "||ht==="  /"||ht===",,"||ht===",,,"){const bt=[_e,Pe,tt].join(""),Ct=bt==="%%%"?100:bt===""?255:0;if(Ct){const Qt=[Ki(+de/Ct,0,1),Ki(+Fe/Ct,0,1),Ki(+Ne/Ct,0,1),ct?hr(+ct,mt):1];if(Xt(Qt))return Qt}}return}}const ee=H.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(ee){const[ie,oe,de,_e,Ee,Fe,Pe,He,Ne]=ee,tt=[de||" ",Ee||" ",Pe].join("");if(tt==="  "||tt==="  /"||tt===",,"||tt===",,,"){const at=[+oe,Ki(+_e,0,100),Ki(+Fe,0,100),He?hr(+He,Ne):1];if(Xt(at))return function([ct,mt,ht,bt]){function Ct(Qt){const fi=(Qt+ct/30)%12,Ci=mt*Math.min(ht,1-ht);return ht-Ci*Math.max(-1,Math.min(fi-3,9-fi,1))}return ct=xt(ct),mt/=100,ht/=100,[Ct(0),Ct(8),Ct(4),bt]}(at)}}}(w);return I?new wi(...I,!1):void 0}get rgb(){const{r:w,g:I,b:H,a:q}=this,ee=q||1/0;return this.overwriteGetter("rgb",[w/ee,I/ee,H/ee,q])}get hcl(){return this.overwriteGetter("hcl",function(w){const[I,H,q,ee]=kt(w),ie=Math.sqrt(H*H+q*q);return[Math.round(1e4*ie)?xt(Math.atan2(q,H)*_t):NaN,ie,I,ee]}(this.rgb))}get lab(){return this.overwriteGetter("lab",kt(this.rgb))}overwriteGetter(w,I){return Object.defineProperty(this,w,{value:I}),I}toString(){const[w,I,H,q]=this.rgb;return`rgba(${[w,I,H].map(ee=>Math.round(255*ee)).join(",")},${q})`}}wi.black=new wi(0,0,0,1),wi.white=new wi(1,1,1,1),wi.transparent=new wi(0,0,0,0),wi.red=new wi(1,0,0,1);class Ir{constructor(w,I,H){this.sensitivity=w?I?"variant":"case":I?"accent":"base",this.locale=H,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(w,I){return this.collator.compare(w,I)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Pr{constructor(w,I,H,q,ee){this.text=w,this.image=I,this.scale=H,this.fontStack=q,this.textColor=ee}}class Zi{constructor(w){this.sections=w}static fromString(w){return new Zi([new Pr(w,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(w=>w.text.length!==0||w.image&&w.image.name.length!==0)}static factory(w){return w instanceof Zi?w:Zi.fromString(w)}toString(){return this.sections.length===0?"":this.sections.map(w=>w.text).join("")}}class pi{constructor(w){this.values=w.slice()}static parse(w){if(w instanceof pi)return w;if(typeof w=="number")return new pi([w,w,w,w]);if(Array.isArray(w)&&!(w.length<1||w.length>4)){for(const I of w)if(typeof I!="number")return;switch(w.length){case 1:w=[w[0],w[0],w[0],w[0]];break;case 2:w=[w[0],w[1],w[0],w[1]];break;case 3:w=[w[0],w[1],w[2],w[1]]}return new pi(w)}}toString(){return JSON.stringify(this.values)}}const _s=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class dr{constructor(w){this.values=w.slice()}static parse(w){if(w instanceof dr)return w;if(Array.isArray(w)&&!(w.length<1)&&w.length%2==0){for(let I=0;I<w.length;I+=2){const H=w[I],q=w[I+1];if(typeof H!="string"||!_s.has(H)||!Array.isArray(q)||q.length!==2||typeof q[0]!="number"||typeof q[1]!="number")return}return new dr(w)}}toString(){return JSON.stringify(this.values)}}class Dt{constructor(w){this.name=w.name,this.available=w.available}toString(){return this.name}static fromString(w){return w?new Dt({name:w,available:!1}):null}}function Yr(C,w,I,H){return typeof C=="number"&&C>=0&&C<=255&&typeof w=="number"&&w>=0&&w<=255&&typeof I=="number"&&I>=0&&I<=255?H===void 0||typeof H=="number"&&H>=0&&H<=1?null:`Invalid rgba value [${[C,w,I,H].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof H=="number"?[C,w,I,H]:[C,w,I]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ys(C){if(C===null||typeof C=="string"||typeof C=="boolean"||typeof C=="number"||C instanceof wi||C instanceof Ir||C instanceof Zi||C instanceof pi||C instanceof dr||C instanceof Dt)return!0;if(Array.isArray(C)){for(const w of C)if(!Ys(w))return!1;return!0}if(typeof C=="object"){for(const w in C)if(!Ys(C[w]))return!1;return!0}return!1}function _r(C){if(C===null)return Vi;if(typeof C=="string")return _i;if(typeof C=="boolean")return Ti;if(typeof C=="number")return Ot;if(C instanceof wi)return Wi;if(C instanceof Ir)return bi;if(C instanceof Zi)return $i;if(C instanceof pi)return tr;if(C instanceof dr)return Tr;if(C instanceof Dt)return Ar;if(Array.isArray(C)){const w=C.length;let I;for(const H of C){const q=_r(H);if(I){if(I===q)continue;I=mi;break}I=q}return ji(I||mi,w)}return Zt}function Br(C){const w=typeof C;return C===null?"":w==="string"||w==="number"||w==="boolean"?String(C):C instanceof wi||C instanceof Zi||C instanceof pi||C instanceof dr||C instanceof Dt?C.toString():JSON.stringify(C)}class Cr{constructor(w,I){this.type=w,this.value=I}static parse(w,I){if(w.length!==2)return I.error(`'literal' expression requires exactly one argument, but found ${w.length-1} instead.`);if(!Ys(w[1]))return I.error("invalid value");const H=w[1];let q=_r(H);const ee=I.expectedType;return q.kind!=="array"||q.N!==0||!ee||ee.kind!=="array"||typeof ee.N=="number"&&ee.N!==0||(q=ee),new Cr(q,H)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class rr{constructor(w){this.name="ExpressionEvaluationError",this.message=w}toJSON(){return this.message}}const Lr={string:_i,number:Ot,boolean:Ti,object:Zt};class sr{constructor(w,I){this.type=w,this.args=I}static parse(w,I){if(w.length<2)return I.error("Expected at least one argument.");let H,q=1;const ee=w[0];if(ee==="array"){let oe,de;if(w.length>2){const _e=w[1];if(typeof _e!="string"||!(_e in Lr)||_e==="object")return I.error('The item type argument of "array" must be one of string, number, boolean',1);oe=Lr[_e],q++}else oe=mi;if(w.length>3){if(w[2]!==null&&(typeof w[2]!="number"||w[2]<0||w[2]!==Math.floor(w[2])))return I.error('The length argument to "array" must be a positive integer literal',2);de=w[2],q++}H=ji(oe,de)}else{if(!Lr[ee])throw new Error(`Types doesn't contain name = ${ee}`);H=Lr[ee]}const ie=[];for(;q<w.length;q++){const oe=I.parse(w[q],q,mi);if(!oe)return null;ie.push(oe)}return new sr(H,ie)}evaluate(w){for(let I=0;I<this.args.length;I++){const H=this.args[I].evaluate(w);if(!$r(this.type,_r(H)))return H;if(I===this.args.length-1)throw new rr(`Expected value to be of type ${Ii(this.type)}, but found ${Ii(_r(H))} instead.`)}throw new Error}eachChild(w){this.args.forEach(w)}outputDefined(){return this.args.every(w=>w.outputDefined())}}const jr={"to-boolean":Ti,"to-color":Wi,"to-number":Ot,"to-string":_i};class ss{constructor(w,I){this.type=w,this.args=I}static parse(w,I){if(w.length<2)return I.error("Expected at least one argument.");const H=w[0];if(!jr[H])throw new Error(`Can't parse ${H} as it is not part of the known types`);if((H==="to-boolean"||H==="to-string")&&w.length!==2)return I.error("Expected one argument.");const q=jr[H],ee=[];for(let ie=1;ie<w.length;ie++){const oe=I.parse(w[ie],ie,mi);if(!oe)return null;ee.push(oe)}return new ss(q,ee)}evaluate(w){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(w);case"color":{let I,H;for(const q of this.args){if(I=q.evaluate(w),H=null,I instanceof wi)return I;if(typeof I=="string"){const ee=w.parseColor(I);if(ee)return ee}else if(Array.isArray(I)&&(H=I.length<3||I.length>4?`Invalid rbga value ${JSON.stringify(I)}: expected an array containing either three or four numeric values.`:Yr(I[0],I[1],I[2],I[3]),!H))return new wi(I[0]/255,I[1]/255,I[2]/255,I[3])}throw new rr(H||`Could not parse color from value '${typeof I=="string"?I:JSON.stringify(I)}'`)}case"padding":{let I;for(const H of this.args){I=H.evaluate(w);const q=pi.parse(I);if(q)return q}throw new rr(`Could not parse padding from value '${typeof I=="string"?I:JSON.stringify(I)}'`)}case"variableAnchorOffsetCollection":{let I;for(const H of this.args){I=H.evaluate(w);const q=dr.parse(I);if(q)return q}throw new rr(`Could not parse variableAnchorOffsetCollection from value '${typeof I=="string"?I:JSON.stringify(I)}'`)}case"number":{let I=null;for(const H of this.args){if(I=H.evaluate(w),I===null)return 0;const q=Number(I);if(!isNaN(q))return q}throw new rr(`Could not convert ${JSON.stringify(I)} to number.`)}case"formatted":return Zi.fromString(Br(this.args[0].evaluate(w)));case"resolvedImage":return Dt.fromString(Br(this.args[0].evaluate(w)));default:return Br(this.args[0].evaluate(w))}}eachChild(w){this.args.forEach(w)}outputDefined(){return this.args.every(w=>w.outputDefined())}}const ps=["Unknown","Point","LineString","Polygon"];class cr{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ps[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(w){let I=this._parseColorCache[w];return I||(I=this._parseColorCache[w]=wi.parse(w)),I}}class js{constructor(w,I,H=[],q,ee=new Hi,ie=[]){this.registry=w,this.path=H,this.key=H.map(oe=>`[${oe}]`).join(""),this.scope=ee,this.errors=ie,this.expectedType=q,this._isConstant=I}parse(w,I,H,q,ee={}){return I?this.concat(I,H,q)._parse(w,ee):this._parse(w,ee)}_parse(w,I){function H(q,ee,ie){return ie==="assert"?new sr(ee,[q]):ie==="coerce"?new ss(ee,[q]):q}if(w!==null&&typeof w!="string"&&typeof w!="boolean"&&typeof w!="number"||(w=["literal",w]),Array.isArray(w)){if(w.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const q=w[0];if(typeof q!="string")return this.error(`Expression name must be a string, but found ${typeof q} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const ee=this.registry[q];if(ee){let ie=ee.parse(w,this);if(!ie)return null;if(this.expectedType){const oe=this.expectedType,de=ie.type;if(oe.kind!=="string"&&oe.kind!=="number"&&oe.kind!=="boolean"&&oe.kind!=="object"&&oe.kind!=="array"||de.kind!=="value")if(oe.kind!=="color"&&oe.kind!=="formatted"&&oe.kind!=="resolvedImage"||de.kind!=="value"&&de.kind!=="string")if(oe.kind!=="padding"||de.kind!=="value"&&de.kind!=="number"&&de.kind!=="array")if(oe.kind!=="variableAnchorOffsetCollection"||de.kind!=="value"&&de.kind!=="array"){if(this.checkSubtype(oe,de))return null}else ie=H(ie,oe,I.typeAnnotation||"coerce");else ie=H(ie,oe,I.typeAnnotation||"coerce");else ie=H(ie,oe,I.typeAnnotation||"coerce");else ie=H(ie,oe,I.typeAnnotation||"assert")}if(!(ie instanceof Cr)&&ie.type.kind!=="resolvedImage"&&this._isConstant(ie)){const oe=new cr;try{ie=new Cr(ie.type,ie.evaluate(oe))}catch(de){return this.error(de.message),null}}return ie}return this.error(`Unknown expression "${q}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(w===void 0?"'undefined' value invalid. Use null instead.":typeof w=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof w} instead.`)}concat(w,I,H){const q=typeof w=="number"?this.path.concat(w):this.path,ee=H?this.scope.concat(H):this.scope;return new js(this.registry,this._isConstant,q,I||null,ee,this.errors)}error(w,...I){const H=`${this.key}${I.map(q=>`[${q}]`).join("")}`;this.errors.push(new ii(H,w))}checkSubtype(w,I){const H=$r(w,I);return H&&this.error(H),H}}class ys{constructor(w,I,H){this.type=bi,this.locale=H,this.caseSensitive=w,this.diacriticSensitive=I}static parse(w,I){if(w.length!==2)return I.error("Expected one argument.");const H=w[1];if(typeof H!="object"||Array.isArray(H))return I.error("Collator options argument must be an object.");const q=I.parse(H["case-sensitive"]!==void 0&&H["case-sensitive"],1,Ti);if(!q)return null;const ee=I.parse(H["diacritic-sensitive"]!==void 0&&H["diacritic-sensitive"],1,Ti);if(!ee)return null;let ie=null;return H.locale&&(ie=I.parse(H.locale,1,_i),!ie)?null:new ys(q,ee,ie)}evaluate(w){return new Ir(this.caseSensitive.evaluate(w),this.diacriticSensitive.evaluate(w),this.locale?this.locale.evaluate(w):null)}eachChild(w){w(this.caseSensitive),w(this.diacriticSensitive),this.locale&&w(this.locale)}outputDefined(){return!1}}const Os=8192;function pn(C,w){C[0]=Math.min(C[0],w[0]),C[1]=Math.min(C[1],w[1]),C[2]=Math.max(C[2],w[0]),C[3]=Math.max(C[3],w[1])}function Qr(C,w){return!(C[0]<=w[0]||C[2]>=w[2]||C[1]<=w[1]||C[3]>=w[3])}function es(C,w){const I=(180+C[0])/360,H=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+C[1]*Math.PI/360)))/360,q=Math.pow(2,w.z);return[Math.round(I*q*Os),Math.round(H*q*Os)]}function xo(C,w,I){const H=C[0]-w[0],q=C[1]-w[1],ee=C[0]-I[0],ie=C[1]-I[1];return H*ie-ee*q==0&&H*ee<=0&&q*ie<=0}function Zs(C,w){let I=!1;for(let ie=0,oe=w.length;ie<oe;ie++){const de=w[ie];for(let _e=0,Ee=de.length;_e<Ee-1;_e++){if(xo(C,de[_e],de[_e+1]))return!1;(q=de[_e])[1]>(H=C)[1]!=(ee=de[_e+1])[1]>H[1]&&H[0]<(ee[0]-q[0])*(H[1]-q[1])/(ee[1]-q[1])+q[0]&&(I=!I)}}var H,q,ee;return I}function An(C,w){for(let I=0;I<w.length;I++)if(Zs(C,w[I]))return!0;return!1}function ta(C,w,I,H){const q=H[0]-I[0],ee=H[1]-I[1],ie=(C[0]-I[0])*ee-q*(C[1]-I[1]),oe=(w[0]-I[0])*ee-q*(w[1]-I[1]);return ie>0&&oe<0||ie<0&&oe>0}function ja(C,w,I){for(const _e of I)for(let Ee=0;Ee<_e.length-1;++Ee)if((oe=[(ie=_e[Ee+1])[0]-(ee=_e[Ee])[0],ie[1]-ee[1]])[0]*(de=[(q=w)[0]-(H=C)[0],q[1]-H[1]])[1]-oe[1]*de[0]!=0&&ta(H,q,ee,ie)&&ta(ee,ie,H,q))return!0;var H,q,ee,ie,oe,de;return!1}function Qn(C,w){for(let I=0;I<C.length;++I)if(!Zs(C[I],w))return!1;for(let I=0;I<C.length-1;++I)if(ja(C[I],C[I+1],w))return!1;return!0}function wa(C,w){for(let I=0;I<w.length;I++)if(Qn(C,w[I]))return!0;return!1}function Nr(C,w,I){const H=[];for(let q=0;q<C.length;q++){const ee=[];for(let ie=0;ie<C[q].length;ie++){const oe=es(C[q][ie],I);pn(w,oe),ee.push(oe)}H.push(ee)}return H}function Vo(C,w,I){const H=[];for(let q=0;q<C.length;q++){const ee=Nr(C[q],w,I);H.push(ee)}return H}function Bo(C,w,I,H){if(C[0]<I[0]||C[0]>I[2]){const q=.5*H;let ee=C[0]-I[0]>q?-H:I[0]-C[0]>q?H:0;ee===0&&(ee=C[0]-I[2]>q?-H:I[2]-C[0]>q?H:0),C[0]+=ee}pn(w,C)}function xa(C,w,I,H){const q=Math.pow(2,H.z)*Os,ee=[H.x*Os,H.y*Os],ie=[];for(const oe of C)for(const de of oe){const _e=[de.x+ee[0],de.y+ee[1]];Bo(_e,w,I,q),ie.push(_e)}return ie}function Tn(C,w,I,H){const q=Math.pow(2,H.z)*Os,ee=[H.x*Os,H.y*Os],ie=[];for(const de of C){const _e=[];for(const Ee of de){const Fe=[Ee.x+ee[0],Ee.y+ee[1]];pn(w,Fe),_e.push(Fe)}ie.push(_e)}if(w[2]-w[0]<=q/2){(oe=w)[0]=oe[1]=1/0,oe[2]=oe[3]=-1/0;for(const de of ie)for(const _e of de)Bo(_e,w,I,q)}var oe;return ie}class wr{constructor(w,I){this.type=Ti,this.geojson=w,this.geometries=I}static parse(w,I){if(w.length!==2)return I.error(`'within' expression requires exactly one argument, but found ${w.length-1} instead.`);if(Ys(w[1])){const H=w[1];if(H.type==="FeatureCollection")for(let q=0;q<H.features.length;++q){const ee=H.features[q].geometry.type;if(ee==="Polygon"||ee==="MultiPolygon")return new wr(H,H.features[q].geometry)}else if(H.type==="Feature"){const q=H.geometry.type;if(q==="Polygon"||q==="MultiPolygon")return new wr(H,H.geometry)}else if(H.type==="Polygon"||H.type==="MultiPolygon")return new wr(H,H)}return I.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(w){if(w.geometry()!=null&&w.canonicalID()!=null){if(w.geometryType()==="Point")return function(I,H){const q=[1/0,1/0,-1/0,-1/0],ee=[1/0,1/0,-1/0,-1/0],ie=I.canonicalID();if(H.type==="Polygon"){const oe=Nr(H.coordinates,ee,ie),de=xa(I.geometry(),q,ee,ie);if(!Qr(q,ee))return!1;for(const _e of de)if(!Zs(_e,oe))return!1}if(H.type==="MultiPolygon"){const oe=Vo(H.coordinates,ee,ie),de=xa(I.geometry(),q,ee,ie);if(!Qr(q,ee))return!1;for(const _e of de)if(!An(_e,oe))return!1}return!0}(w,this.geometries);if(w.geometryType()==="LineString")return function(I,H){const q=[1/0,1/0,-1/0,-1/0],ee=[1/0,1/0,-1/0,-1/0],ie=I.canonicalID();if(H.type==="Polygon"){const oe=Nr(H.coordinates,ee,ie),de=Tn(I.geometry(),q,ee,ie);if(!Qr(q,ee))return!1;for(const _e of de)if(!Qn(_e,oe))return!1}if(H.type==="MultiPolygon"){const oe=Vo(H.coordinates,ee,ie),de=Tn(I.geometry(),q,ee,ie);if(!Qr(q,ee))return!1;for(const _e of de)if(!wa(_e,oe))return!1}return!0}(w,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class er{constructor(w,I){this.type=I.type,this.name=w,this.boundExpression=I}static parse(w,I){if(w.length!==2||typeof w[1]!="string")return I.error("'var' expression requires exactly one string literal argument.");const H=w[1];return I.scope.has(H)?new er(H,I.scope.get(H)):I.error(`Unknown variable "${H}". Make sure "${H}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(w){return this.boundExpression.evaluate(w)}eachChild(){}outputDefined(){return!1}}class As{constructor(w,I,H,q){this.name=w,this.type=I,this._evaluate=H,this.args=q}evaluate(w){return this._evaluate(w,this.args)}eachChild(w){this.args.forEach(w)}outputDefined(){return!1}static parse(w,I){const H=w[0],q=As.definitions[H];if(!q)return I.error(`Unknown expression "${H}". If you wanted a literal array, use ["literal", [...]].`,0);const ee=Array.isArray(q)?q[0]:q.type,ie=Array.isArray(q)?[[q[1],q[2]]]:q.overloads,oe=ie.filter(([_e])=>!Array.isArray(_e)||_e.length===w.length-1);let de=null;for(const[_e,Ee]of oe){de=new js(I.registry,ia,I.path,null,I.scope);const Fe=[];let Pe=!1;for(let He=1;He<w.length;He++){const Ne=w[He],tt=Array.isArray(_e)?_e[He-1]:_e.type,at=de.parse(Ne,1+Fe.length,tt);if(!at){Pe=!0;break}Fe.push(at)}if(!Pe)if(Array.isArray(_e)&&_e.length!==Fe.length)de.error(`Expected ${_e.length} arguments, but found ${Fe.length} instead.`);else{for(let He=0;He<Fe.length;He++){const Ne=Array.isArray(_e)?_e[He]:_e.type,tt=Fe[He];de.concat(He+1).checkSubtype(Ne,tt.type)}if(de.errors.length===0)return new As(H,ee,Ee,Fe)}}if(oe.length===1)I.errors.push(...de.errors);else{const _e=(oe.length?oe:ie).map(([Fe])=>{return Pe=Fe,Array.isArray(Pe)?`(${Pe.map(Ii).join(", ")})`:`(${Ii(Pe.type)}...)`;var Pe}).join(" | "),Ee=[];for(let Fe=1;Fe<w.length;Fe++){const Pe=I.parse(w[Fe],1+Ee.length);if(!Pe)return null;Ee.push(Ii(Pe.type))}I.error(`Expected arguments of type ${_e}, but found (${Ee.join(", ")}) instead.`)}return null}static register(w,I){As.definitions=I;for(const H in I)w[H]=As}}function ia(C){if(C instanceof er)return ia(C.boundExpression);if(C instanceof As&&C.name==="error"||C instanceof ys||C instanceof wr)return!1;const w=C instanceof ss||C instanceof sr;let I=!0;return C.eachChild(H=>{I=w?I&&ia(H):I&&H instanceof Cr}),!!I&&Ba(C)&&Ea(C,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ba(C){if(C instanceof As&&(C.name==="get"&&C.args.length===1||C.name==="feature-state"||C.name==="has"&&C.args.length===1||C.name==="properties"||C.name==="geometry-type"||C.name==="id"||/^filter-/.test(C.name))||C instanceof wr)return!1;let w=!0;return C.eachChild(I=>{w&&!Ba(I)&&(w=!1)}),w}function Ca(C){if(C instanceof As&&C.name==="feature-state")return!1;let w=!0;return C.eachChild(I=>{w&&!Ca(I)&&(w=!1)}),w}function Ea(C,w){if(C instanceof As&&w.indexOf(C.name)>=0)return!1;let I=!0;return C.eachChild(H=>{I&&!Ea(H,w)&&(I=!1)}),I}function Ta(C,w){const I=C.length-1;let H,q,ee=0,ie=I,oe=0;for(;ee<=ie;)if(oe=Math.floor((ee+ie)/2),H=C[oe],q=C[oe+1],H<=w){if(oe===I||w<q)return oe;ee=oe+1}else{if(!(H>w))throw new rr("Input is not a number.");ie=oe-1}return 0}class Sa{constructor(w,I,H){this.type=w,this.input=I,this.labels=[],this.outputs=[];for(const[q,ee]of H)this.labels.push(q),this.outputs.push(ee)}static parse(w,I){if(w.length-1<4)return I.error(`Expected at least 4 arguments, but found only ${w.length-1}.`);if((w.length-1)%2!=0)return I.error("Expected an even number of arguments.");const H=I.parse(w[1],1,Ot);if(!H)return null;const q=[];let ee=null;I.expectedType&&I.expectedType.kind!=="value"&&(ee=I.expectedType);for(let ie=1;ie<w.length;ie+=2){const oe=ie===1?-1/0:w[ie],de=w[ie+1],_e=ie,Ee=ie+1;if(typeof oe!="number")return I.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',_e);if(q.length&&q[q.length-1][0]>=oe)return I.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',_e);const Fe=I.parse(de,Ee,ee);if(!Fe)return null;ee=ee||Fe.type,q.push([oe,Fe])}return new Sa(ee,H,q)}evaluate(w){const I=this.labels,H=this.outputs;if(I.length===1)return H[0].evaluate(w);const q=this.input.evaluate(w);if(q<=I[0])return H[0].evaluate(w);const ee=I.length;return q>=I[ee-1]?H[ee-1].evaluate(w):H[Ta(I,q)].evaluate(w)}eachChild(w){w(this.input);for(const I of this.outputs)w(I)}outputDefined(){return this.outputs.every(w=>w.outputDefined())}}function On(C,w,I){return C+I*(w-C)}function Za(C,w,I){return C.map((H,q)=>On(H,w[q],I))}const ks={number:On,color:function(C,w,I,H="rgb"){switch(H){case"rgb":{const[q,ee,ie,oe]=Za(C.rgb,w.rgb,I);return new wi(q,ee,ie,oe,!1)}case"hcl":{const[q,ee,ie,oe]=C.hcl,[de,_e,Ee,Fe]=w.hcl;let Pe,He;if(isNaN(q)||isNaN(de))isNaN(q)?isNaN(de)?Pe=NaN:(Pe=de,ie!==1&&ie!==0||(He=_e)):(Pe=q,Ee!==1&&Ee!==0||(He=ee));else{let mt=de-q;de>q&&mt>180?mt-=360:de<q&&q-de>180&&(mt+=360),Pe=q+I*mt}const[Ne,tt,at,ct]=function([mt,ht,bt,Ct]){return mt=isNaN(mt)?0:mt*st,ni([bt,Math.cos(mt)*ht,Math.sin(mt)*ht,Ct])}([Pe,He??On(ee,_e,I),On(ie,Ee,I),On(oe,Fe,I)]);return new wi(Ne,tt,at,ct,!1)}case"lab":{const[q,ee,ie,oe]=ni(Za(C.lab,w.lab,I));return new wi(q,ee,ie,oe,!1)}}},array:Za,padding:function(C,w,I){return new pi(Za(C.values,w.values,I))},variableAnchorOffsetCollection:function(C,w,I){const H=C.values,q=w.values;if(H.length!==q.length)throw new rr(`Cannot interpolate values of different length. from: ${C.toString()}, to: ${w.toString()}`);const ee=[];for(let ie=0;ie<H.length;ie+=2){if(H[ie]!==q[ie])throw new rr(`Cannot interpolate values containing mismatched anchors. from[${ie}]: ${H[ie]}, to[${ie}]: ${q[ie]}`);ee.push(H[ie]);const[oe,de]=H[ie+1],[_e,Ee]=q[ie+1];ee.push([On(oe,_e,I),On(de,Ee,I)])}return new dr(ee)}};class gs{constructor(w,I,H,q,ee){this.type=w,this.operator=I,this.interpolation=H,this.input=q,this.labels=[],this.outputs=[];for(const[ie,oe]of ee)this.labels.push(ie),this.outputs.push(oe)}static interpolationFactor(w,I,H,q){let ee=0;if(w.name==="exponential")ee=Ja(I,w.base,H,q);else if(w.name==="linear")ee=Ja(I,1,H,q);else if(w.name==="cubic-bezier"){const ie=w.controlPoints;ee=new ze(ie[0],ie[1],ie[2],ie[3]).solve(Ja(I,1,H,q))}return ee}static parse(w,I){let[H,q,ee,...ie]=w;if(!Array.isArray(q)||q.length===0)return I.error("Expected an interpolation type expression.",1);if(q[0]==="linear")q={name:"linear"};else if(q[0]==="exponential"){const _e=q[1];if(typeof _e!="number")return I.error("Exponential interpolation requires a numeric base.",1,1);q={name:"exponential",base:_e}}else{if(q[0]!=="cubic-bezier")return I.error(`Unknown interpolation type ${String(q[0])}`,1,0);{const _e=q.slice(1);if(_e.length!==4||_e.some(Ee=>typeof Ee!="number"||Ee<0||Ee>1))return I.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);q={name:"cubic-bezier",controlPoints:_e}}}if(w.length-1<4)return I.error(`Expected at least 4 arguments, but found only ${w.length-1}.`);if((w.length-1)%2!=0)return I.error("Expected an even number of arguments.");if(ee=I.parse(ee,2,Ot),!ee)return null;const oe=[];let de=null;H==="interpolate-hcl"||H==="interpolate-lab"?de=Wi:I.expectedType&&I.expectedType.kind!=="value"&&(de=I.expectedType);for(let _e=0;_e<ie.length;_e+=2){const Ee=ie[_e],Fe=ie[_e+1],Pe=_e+3,He=_e+4;if(typeof Ee!="number")return I.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Pe);if(oe.length&&oe[oe.length-1][0]>=Ee)return I.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Pe);const Ne=I.parse(Fe,He,de);if(!Ne)return null;de=de||Ne.type,oe.push([Ee,Ne])}return ce(de,Ot)||ce(de,Wi)||ce(de,tr)||ce(de,Tr)||ce(de,ji(Ot))?new gs(de,H,q,ee,oe):I.error(`Type ${Ii(de)} is not interpolatable.`)}evaluate(w){const I=this.labels,H=this.outputs;if(I.length===1)return H[0].evaluate(w);const q=this.input.evaluate(w);if(q<=I[0])return H[0].evaluate(w);const ee=I.length;if(q>=I[ee-1])return H[ee-1].evaluate(w);const ie=Ta(I,q),oe=gs.interpolationFactor(this.interpolation,q,I[ie],I[ie+1]),de=H[ie].evaluate(w),_e=H[ie+1].evaluate(w);switch(this.operator){case"interpolate":return ks[this.type.kind](de,_e,oe);case"interpolate-hcl":return ks.color(de,_e,oe,"hcl");case"interpolate-lab":return ks.color(de,_e,oe,"lab")}}eachChild(w){w(this.input);for(const I of this.outputs)w(I)}outputDefined(){return this.outputs.every(w=>w.outputDefined())}}function Ja(C,w,I,H){const q=H-I,ee=C-I;return q===0?0:w===1?ee/q:(Math.pow(w,ee)-1)/(Math.pow(w,q)-1)}class Ia{constructor(w,I){this.type=w,this.args=I}static parse(w,I){if(w.length<2)return I.error("Expectected at least one argument.");let H=null;const q=I.expectedType;q&&q.kind!=="value"&&(H=q);const ee=[];for(const oe of w.slice(1)){const de=I.parse(oe,1+ee.length,H,void 0,{typeAnnotation:"omit"});if(!de)return null;H=H||de.type,ee.push(de)}if(!H)throw new Error("No output type");const ie=q&&ee.some(oe=>$r(q,oe.type));return new Ia(ie?mi:H,ee)}evaluate(w){let I,H=null,q=0;for(const ee of this.args)if(q++,H=ee.evaluate(w),H&&H instanceof Dt&&!H.available&&(I||(I=H.name),H=null,q===this.args.length&&(H=I)),H!==null)break;return H}eachChild(w){this.args.forEach(w)}outputDefined(){return this.args.every(w=>w.outputDefined())}}class ra{constructor(w,I){this.type=I.type,this.bindings=[].concat(w),this.result=I}evaluate(w){return this.result.evaluate(w)}eachChild(w){for(const I of this.bindings)w(I[1]);w(this.result)}static parse(w,I){if(w.length<4)return I.error(`Expected at least 3 arguments, but found ${w.length-1} instead.`);const H=[];for(let ee=1;ee<w.length-1;ee+=2){const ie=w[ee];if(typeof ie!="string")return I.error(`Expected string, but found ${typeof ie} instead.`,ee);if(/[^a-zA-Z0-9_]/.test(ie))return I.error("Variable names must contain only alphanumeric characters or '_'.",ee);const oe=I.parse(w[ee+1],ee+1);if(!oe)return null;H.push([ie,oe])}const q=I.parse(w[w.length-1],w.length-1,I.expectedType,H);return q?new ra(H,q):null}outputDefined(){return this.result.outputDefined()}}class Sn{constructor(w,I,H){this.type=w,this.index=I,this.input=H}static parse(w,I){if(w.length!==3)return I.error(`Expected 2 arguments, but found ${w.length-1} instead.`);const H=I.parse(w[1],1,Ot),q=I.parse(w[2],2,ji(I.expectedType||mi));return H&&q?new Sn(q.type.itemType,H,q):null}evaluate(w){const I=this.index.evaluate(w),H=this.input.evaluate(w);if(I<0)throw new rr(`Array index out of bounds: ${I} < 0.`);if(I>=H.length)throw new rr(`Array index out of bounds: ${I} > ${H.length-1}.`);if(I!==Math.floor(I))throw new rr(`Array index must be an integer, but found ${I} instead.`);return H[I]}eachChild(w){w(this.index),w(this.input)}outputDefined(){return!1}}class pr{constructor(w,I){this.type=Ti,this.needle=w,this.haystack=I}static parse(w,I){if(w.length!==3)return I.error(`Expected 2 arguments, but found ${w.length-1} instead.`);const H=I.parse(w[1],1,mi),q=I.parse(w[2],2,mi);return H&&q?it(H.type,[Ti,_i,Ot,Vi,mi])?new pr(H,q):I.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(H.type)} instead`):null}evaluate(w){const I=this.needle.evaluate(w),H=this.haystack.evaluate(w);if(!H)return!1;if(!Ie(I,["boolean","string","number","null"]))throw new rr(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(_r(I))} instead.`);if(!Ie(H,["string","array"]))throw new rr(`Expected second argument to be of type array or string, but found ${Ii(_r(H))} instead.`);return H.indexOf(I)>=0}eachChild(w){w(this.needle),w(this.haystack)}outputDefined(){return!0}}class $a{constructor(w,I,H){this.type=Ot,this.needle=w,this.haystack=I,this.fromIndex=H}static parse(w,I){if(w.length<=2||w.length>=5)return I.error(`Expected 3 or 4 arguments, but found ${w.length-1} instead.`);const H=I.parse(w[1],1,mi),q=I.parse(w[2],2,mi);if(!H||!q)return null;if(!it(H.type,[Ti,_i,Ot,Vi,mi]))return I.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(H.type)} instead`);if(w.length===4){const ee=I.parse(w[3],3,Ot);return ee?new $a(H,q,ee):null}return new $a(H,q)}evaluate(w){const I=this.needle.evaluate(w),H=this.haystack.evaluate(w);if(!Ie(I,["boolean","string","number","null"]))throw new rr(`Expected first argument to be of type boolean, string, number or null, but found ${Ii(_r(I))} instead.`);if(!Ie(H,["string","array"]))throw new rr(`Expected second argument to be of type array or string, but found ${Ii(_r(H))} instead.`);if(this.fromIndex){const q=this.fromIndex.evaluate(w);return H.indexOf(I,q)}return H.indexOf(I)}eachChild(w){w(this.needle),w(this.haystack),this.fromIndex&&w(this.fromIndex)}outputDefined(){return!1}}class Co{constructor(w,I,H,q,ee,ie){this.inputType=w,this.type=I,this.input=H,this.cases=q,this.outputs=ee,this.otherwise=ie}static parse(w,I){if(w.length<5)return I.error(`Expected at least 4 arguments, but found only ${w.length-1}.`);if(w.length%2!=1)return I.error("Expected an even number of arguments.");let H,q;I.expectedType&&I.expectedType.kind!=="value"&&(q=I.expectedType);const ee={},ie=[];for(let _e=2;_e<w.length-1;_e+=2){let Ee=w[_e];const Fe=w[_e+1];Array.isArray(Ee)||(Ee=[Ee]);const Pe=I.concat(_e);if(Ee.length===0)return Pe.error("Expected at least one branch label.");for(const Ne of Ee){if(typeof Ne!="number"&&typeof Ne!="string")return Pe.error("Branch labels must be numbers or strings.");if(typeof Ne=="number"&&Math.abs(Ne)>Number.MAX_SAFE_INTEGER)return Pe.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Ne=="number"&&Math.floor(Ne)!==Ne)return Pe.error("Numeric branch labels must be integer values.");if(H){if(Pe.checkSubtype(H,_r(Ne)))return null}else H=_r(Ne);if(ee[String(Ne)]!==void 0)return Pe.error("Branch labels must be unique.");ee[String(Ne)]=ie.length}const He=I.parse(Fe,_e,q);if(!He)return null;q=q||He.type,ie.push(He)}const oe=I.parse(w[1],1,mi);if(!oe)return null;const de=I.parse(w[w.length-1],w.length-1,q);return de?oe.type.kind!=="value"&&I.concat(1).checkSubtype(H,oe.type)?null:new Co(H,q,oe,ee,ie,de):null}evaluate(w){const I=this.input.evaluate(w);return(_r(I)===this.inputType&&this.outputs[this.cases[I]]||this.otherwise).evaluate(w)}eachChild(w){w(this.input),this.outputs.forEach(w),w(this.otherwise)}outputDefined(){return this.outputs.every(w=>w.outputDefined())&&this.otherwise.outputDefined()}}class In{constructor(w,I,H){this.type=w,this.branches=I,this.otherwise=H}static parse(w,I){if(w.length<4)return I.error(`Expected at least 3 arguments, but found only ${w.length-1}.`);if(w.length%2!=0)return I.error("Expected an odd number of arguments.");let H;I.expectedType&&I.expectedType.kind!=="value"&&(H=I.expectedType);const q=[];for(let ie=1;ie<w.length-1;ie+=2){const oe=I.parse(w[ie],ie,Ti);if(!oe)return null;const de=I.parse(w[ie+1],ie+1,H);if(!de)return null;q.push([oe,de]),H=H||de.type}const ee=I.parse(w[w.length-1],w.length-1,H);if(!ee)return null;if(!H)throw new Error("Can't infer output type");return new In(H,q,ee)}evaluate(w){for(const[I,H]of this.branches)if(I.evaluate(w))return H.evaluate(w);return this.otherwise.evaluate(w)}eachChild(w){for(const[I,H]of this.branches)w(I),w(H);w(this.otherwise)}outputDefined(){return this.branches.every(([w,I])=>I.outputDefined())&&this.otherwise.outputDefined()}}class sa{constructor(w,I,H,q){this.type=w,this.input=I,this.beginIndex=H,this.endIndex=q}static parse(w,I){if(w.length<=2||w.length>=5)return I.error(`Expected 3 or 4 arguments, but found ${w.length-1} instead.`);const H=I.parse(w[1],1,mi),q=I.parse(w[2],2,Ot);if(!H||!q)return null;if(!it(H.type,[ji(mi),_i,mi]))return I.error(`Expected first argument to be of type array or string, but found ${Ii(H.type)} instead`);if(w.length===4){const ee=I.parse(w[3],3,Ot);return ee?new sa(H.type,H,q,ee):null}return new sa(H.type,H,q)}evaluate(w){const I=this.input.evaluate(w),H=this.beginIndex.evaluate(w);if(!Ie(I,["string","array"]))throw new rr(`Expected first argument to be of type array or string, but found ${Ii(_r(I))} instead.`);if(this.endIndex){const q=this.endIndex.evaluate(w);return I.slice(H,q)}return I.slice(H)}eachChild(w){w(this.input),w(this.beginIndex),this.endIndex&&w(this.endIndex)}outputDefined(){return!1}}function Eo(C,w){return C==="=="||C==="!="?w.kind==="boolean"||w.kind==="string"||w.kind==="number"||w.kind==="null"||w.kind==="value":w.kind==="string"||w.kind==="number"||w.kind==="value"}function To(C,w,I,H){return H.compare(w,I)===0}function na(C,w,I){const H=C!=="=="&&C!=="!=";return class Ph{constructor(ee,ie,oe){this.type=Ti,this.lhs=ee,this.rhs=ie,this.collator=oe,this.hasUntypedArgument=ee.type.kind==="value"||ie.type.kind==="value"}static parse(ee,ie){if(ee.length!==3&&ee.length!==4)return ie.error("Expected two or three arguments.");const oe=ee[0];let de=ie.parse(ee[1],1,mi);if(!de)return null;if(!Eo(oe,de.type))return ie.concat(1).error(`"${oe}" comparisons are not supported for type '${Ii(de.type)}'.`);let _e=ie.parse(ee[2],2,mi);if(!_e)return null;if(!Eo(oe,_e.type))return ie.concat(2).error(`"${oe}" comparisons are not supported for type '${Ii(_e.type)}'.`);if(de.type.kind!==_e.type.kind&&de.type.kind!=="value"&&_e.type.kind!=="value")return ie.error(`Cannot compare types '${Ii(de.type)}' and '${Ii(_e.type)}'.`);H&&(de.type.kind==="value"&&_e.type.kind!=="value"?de=new sr(_e.type,[de]):de.type.kind!=="value"&&_e.type.kind==="value"&&(_e=new sr(de.type,[_e])));let Ee=null;if(ee.length===4){if(de.type.kind!=="string"&&_e.type.kind!=="string"&&de.type.kind!=="value"&&_e.type.kind!=="value")return ie.error("Cannot use collator to compare non-string types.");if(Ee=ie.parse(ee[3],3,bi),!Ee)return null}return new Ph(de,_e,Ee)}evaluate(ee){const ie=this.lhs.evaluate(ee),oe=this.rhs.evaluate(ee);if(H&&this.hasUntypedArgument){const de=_r(ie),_e=_r(oe);if(de.kind!==_e.kind||de.kind!=="string"&&de.kind!=="number")throw new rr(`Expected arguments for "${C}" to be (string, string) or (number, number), but found (${de.kind}, ${_e.kind}) instead.`)}if(this.collator&&!H&&this.hasUntypedArgument){const de=_r(ie),_e=_r(oe);if(de.kind!=="string"||_e.kind!=="string")return w(ee,ie,oe)}return this.collator?I(ee,ie,oe,this.collator.evaluate(ee)):w(ee,ie,oe)}eachChild(ee){ee(this.lhs),ee(this.rhs),this.collator&&ee(this.collator)}outputDefined(){return!0}}}const pl=na("==",function(C,w,I){return w===I},To),Ko=na("!=",function(C,w,I){return w!==I},function(C,w,I,H){return!To(0,w,I,H)}),Go=na("<",function(C,w,I){return w<I},function(C,w,I,H){return H.compare(w,I)<0}),So=na(">",function(C,w,I){return w>I},function(C,w,I,H){return H.compare(w,I)>0}),Wo=na("<=",function(C,w,I){return w<=I},function(C,w,I,H){return H.compare(w,I)<=0}),cn=na(">=",function(C,w,I){return w>=I},function(C,w,I,H){return H.compare(w,I)>=0});class Rn{constructor(w,I,H,q,ee){this.type=_i,this.number=w,this.locale=I,this.currency=H,this.minFractionDigits=q,this.maxFractionDigits=ee}static parse(w,I){if(w.length!==3)return I.error("Expected two arguments.");const H=I.parse(w[1],1,Ot);if(!H)return null;const q=w[2];if(typeof q!="object"||Array.isArray(q))return I.error("NumberFormat options argument must be an object.");let ee=null;if(q.locale&&(ee=I.parse(q.locale,1,_i),!ee))return null;let ie=null;if(q.currency&&(ie=I.parse(q.currency,1,_i),!ie))return null;let oe=null;if(q["min-fraction-digits"]&&(oe=I.parse(q["min-fraction-digits"],1,Ot),!oe))return null;let de=null;return q["max-fraction-digits"]&&(de=I.parse(q["max-fraction-digits"],1,Ot),!de)?null:new Rn(H,ee,ie,oe,de)}evaluate(w){return new Intl.NumberFormat(this.locale?this.locale.evaluate(w):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(w):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(w):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(w):void 0}).format(this.number.evaluate(w))}eachChild(w){w(this.number),this.locale&&w(this.locale),this.currency&&w(this.currency),this.minFractionDigits&&w(this.minFractionDigits),this.maxFractionDigits&&w(this.maxFractionDigits)}outputDefined(){return!1}}class Fa{constructor(w){this.type=$i,this.sections=w}static parse(w,I){if(w.length<2)return I.error("Expected at least one argument.");const H=w[1];if(!Array.isArray(H)&&typeof H=="object")return I.error("First argument must be an image or text section.");const q=[];let ee=!1;for(let ie=1;ie<=w.length-1;++ie){const oe=w[ie];if(ee&&typeof oe=="object"&&!Array.isArray(oe)){ee=!1;let de=null;if(oe["font-scale"]&&(de=I.parse(oe["font-scale"],1,Ot),!de))return null;let _e=null;if(oe["text-font"]&&(_e=I.parse(oe["text-font"],1,ji(_i)),!_e))return null;let Ee=null;if(oe["text-color"]&&(Ee=I.parse(oe["text-color"],1,Wi),!Ee))return null;const Fe=q[q.length-1];Fe.scale=de,Fe.font=_e,Fe.textColor=Ee}else{const de=I.parse(w[ie],1,mi);if(!de)return null;const _e=de.type.kind;if(_e!=="string"&&_e!=="value"&&_e!=="null"&&_e!=="resolvedImage")return I.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");ee=!0,q.push({content:de,scale:null,font:null,textColor:null})}}return new Fa(q)}evaluate(w){return new Zi(this.sections.map(I=>{const H=I.content.evaluate(w);return _r(H)===Ar?new Pr("",H,null,null,null):new Pr(Br(H),null,I.scale?I.scale.evaluate(w):null,I.font?I.font.evaluate(w).join(","):null,I.textColor?I.textColor.evaluate(w):null)}))}eachChild(w){for(const I of this.sections)w(I.content),I.scale&&w(I.scale),I.font&&w(I.font),I.textColor&&w(I.textColor)}outputDefined(){return!1}}class eo{constructor(w){this.type=Ar,this.input=w}static parse(w,I){if(w.length!==2)return I.error("Expected two arguments.");const H=I.parse(w[1],1,_i);return H?new eo(H):I.error("No image name provided.")}evaluate(w){const I=this.input.evaluate(w),H=Dt.fromString(I);return H&&w.availableImages&&(H.available=w.availableImages.indexOf(I)>-1),H}eachChild(w){w(this.input)}outputDefined(){return!1}}class ka{constructor(w){this.type=Ot,this.input=w}static parse(w,I){if(w.length!==2)return I.error(`Expected 1 argument, but found ${w.length-1} instead.`);const H=I.parse(w[1],1);return H?H.type.kind!=="array"&&H.type.kind!=="string"&&H.type.kind!=="value"?I.error(`Expected argument of type string or array, but found ${Ii(H.type)} instead.`):new ka(H):null}evaluate(w){const I=this.input.evaluate(w);if(typeof I=="string"||Array.isArray(I))return I.length;throw new rr(`Expected value to be of type string or array, but found ${Ii(_r(I))} instead.`)}eachChild(w){w(this.input)}outputDefined(){return!1}}const gn={"==":pl,"!=":Ko,">":So,"<":Go,">=":cn,"<=":Wo,array:sr,at:Sn,boolean:sr,case:In,coalesce:Ia,collator:ys,format:Fa,image:eo,in:pr,"index-of":$a,interpolate:gs,"interpolate-hcl":gs,"interpolate-lab":gs,length:ka,let:ra,literal:Cr,match:Co,number:sr,"number-format":Rn,object:sr,slice:sa,step:Sa,string:sr,"to-boolean":ss,"to-color":ss,"to-number":ss,"to-string":ss,var:er,within:wr};function aa(C,[w,I,H,q]){w=w.evaluate(C),I=I.evaluate(C),H=H.evaluate(C);const ee=q?q.evaluate(C):1,ie=Yr(w,I,H,ee);if(ie)throw new rr(ie);return new wi(w/255,I/255,H/255,ee,!1)}function Ds(C,w){return C in w}function oa(C,w){const I=w[C];return I===void 0?null:I}function hn(C){return{type:C}}function Rs(C){return{result:"success",value:C}}function la(C){return{result:"error",value:C}}function Hn(C){return C["property-type"]==="data-driven"||C["property-type"]==="cross-faded-data-driven"}function to(C){return!!C.expression&&C.expression.parameters.indexOf("zoom")>-1}function io(C){return!!C.expression&&C.expression.interpolated}function gr(C){return C instanceof Number?"number":C instanceof String?"string":C instanceof Boolean?"boolean":Array.isArray(C)?"array":C===null?"null":typeof C}function Js(C){return typeof C=="object"&&C!==null&&!Array.isArray(C)}function gl(C){return C}function qo(C,w){const I=w.type==="color",H=C.stops&&typeof C.stops[0][0]=="object",q=H||!(H||C.property!==void 0),ee=C.type||(io(w)?"exponential":"interval");if(I||w.type==="padding"){const Ee=I?wi.parse:pi.parse;(C=di({},C)).stops&&(C.stops=C.stops.map(Fe=>[Fe[0],Ee(Fe[1])])),C.default=Ee(C.default?C.default:w.default)}if(C.colorSpace&&(ie=C.colorSpace)!=="rgb"&&ie!=="hcl"&&ie!=="lab")throw new Error(`Unknown color space: "${C.colorSpace}"`);var ie;let oe,de,_e;if(ee==="exponential")oe=Hs;else if(ee==="interval")oe=Xo;else if(ee==="categorical"){oe=Io,de=Object.create(null);for(const Ee of C.stops)de[Ee[0]]=Ee[1];_e=typeof C.stops[0][0]}else{if(ee!=="identity")throw new Error(`Unknown function type "${ee}"`);oe=Da}if(H){const Ee={},Fe=[];for(let Ne=0;Ne<C.stops.length;Ne++){const tt=C.stops[Ne],at=tt[0].zoom;Ee[at]===void 0&&(Ee[at]={zoom:at,type:C.type,property:C.property,default:C.default,stops:[]},Fe.push(at)),Ee[at].stops.push([tt[0].value,tt[1]])}const Pe=[];for(const Ne of Fe)Pe.push([Ee[Ne].zoom,qo(Ee[Ne],w)]);const He={name:"linear"};return{kind:"composite",interpolationType:He,interpolationFactor:gs.interpolationFactor.bind(void 0,He),zoomStops:Pe.map(Ne=>Ne[0]),evaluate:({zoom:Ne},tt)=>Hs({stops:Pe,base:C.base},w,Ne).evaluate(Ne,tt)}}if(q){const Ee=ee==="exponential"?{name:"exponential",base:C.base!==void 0?C.base:1}:null;return{kind:"camera",interpolationType:Ee,interpolationFactor:gs.interpolationFactor.bind(void 0,Ee),zoomStops:C.stops.map(Fe=>Fe[0]),evaluate:({zoom:Fe})=>oe(C,w,Fe,de,_e)}}return{kind:"source",evaluate(Ee,Fe){const Pe=Fe&&Fe.properties?Fe.properties[C.property]:void 0;return Pe===void 0?mn(C.default,w.default):oe(C,w,Pe,de,_e)}}}function mn(C,w,I){return C!==void 0?C:w!==void 0?w:I!==void 0?I:void 0}function Io(C,w,I,H,q){return mn(typeof I===q?H[I]:void 0,C.default,w.default)}function Xo(C,w,I){if(gr(I)!=="number")return mn(C.default,w.default);const H=C.stops.length;if(H===1||I<=C.stops[0][0])return C.stops[0][1];if(I>=C.stops[H-1][0])return C.stops[H-1][1];const q=Ta(C.stops.map(ee=>ee[0]),I);return C.stops[q][1]}function Hs(C,w,I){const H=C.base!==void 0?C.base:1;if(gr(I)!=="number")return mn(C.default,w.default);const q=C.stops.length;if(q===1||I<=C.stops[0][0])return C.stops[0][1];if(I>=C.stops[q-1][0])return C.stops[q-1][1];const ee=Ta(C.stops.map(Ee=>Ee[0]),I),ie=function(Ee,Fe,Pe,He){const Ne=He-Pe,tt=Ee-Pe;return Ne===0?0:Fe===1?tt/Ne:(Math.pow(Fe,tt)-1)/(Math.pow(Fe,Ne)-1)}(I,H,C.stops[ee][0],C.stops[ee+1][0]),oe=C.stops[ee][1],de=C.stops[ee+1][1],_e=ks[w.type]||gl;return typeof oe.evaluate=="function"?{evaluate(...Ee){const Fe=oe.evaluate.apply(void 0,Ee),Pe=de.evaluate.apply(void 0,Ee);if(Fe!==void 0&&Pe!==void 0)return _e(Fe,Pe,ie,C.colorSpace)}}:_e(oe,de,ie,C.colorSpace)}function Da(C,w,I){switch(w.type){case"color":I=wi.parse(I);break;case"formatted":I=Zi.fromString(I.toString());break;case"resolvedImage":I=Dt.fromString(I.toString());break;case"padding":I=pi.parse(I);break;default:gr(I)===w.type||w.type==="enum"&&w.values[I]||(I=void 0)}return mn(I,C.default,w.default)}As.register(gn,{error:[{kind:"error"},[_i],(C,[w])=>{throw new rr(w.evaluate(C))}],typeof:[_i,[mi],(C,[w])=>Ii(_r(w.evaluate(C)))],"to-rgba":[ji(Ot,4),[Wi],(C,[w])=>{const[I,H,q,ee]=w.evaluate(C).rgb;return[255*I,255*H,255*q,ee]}],rgb:[Wi,[Ot,Ot,Ot],aa],rgba:[Wi,[Ot,Ot,Ot,Ot],aa],has:{type:Ti,overloads:[[[_i],(C,[w])=>Ds(w.evaluate(C),C.properties())],[[_i,Zt],(C,[w,I])=>Ds(w.evaluate(C),I.evaluate(C))]]},get:{type:mi,overloads:[[[_i],(C,[w])=>oa(w.evaluate(C),C.properties())],[[_i,Zt],(C,[w,I])=>oa(w.evaluate(C),I.evaluate(C))]]},"feature-state":[mi,[_i],(C,[w])=>oa(w.evaluate(C),C.featureState||{})],properties:[Zt,[],C=>C.properties()],"geometry-type":[_i,[],C=>C.geometryType()],id:[mi,[],C=>C.id()],zoom:[Ot,[],C=>C.globals.zoom],"heatmap-density":[Ot,[],C=>C.globals.heatmapDensity||0],"line-progress":[Ot,[],C=>C.globals.lineProgress||0],accumulated:[mi,[],C=>C.globals.accumulated===void 0?null:C.globals.accumulated],"+":[Ot,hn(Ot),(C,w)=>{let I=0;for(const H of w)I+=H.evaluate(C);return I}],"*":[Ot,hn(Ot),(C,w)=>{let I=1;for(const H of w)I*=H.evaluate(C);return I}],"-":{type:Ot,overloads:[[[Ot,Ot],(C,[w,I])=>w.evaluate(C)-I.evaluate(C)],[[Ot],(C,[w])=>-w.evaluate(C)]]},"/":[Ot,[Ot,Ot],(C,[w,I])=>w.evaluate(C)/I.evaluate(C)],"%":[Ot,[Ot,Ot],(C,[w,I])=>w.evaluate(C)%I.evaluate(C)],ln2:[Ot,[],()=>Math.LN2],pi:[Ot,[],()=>Math.PI],e:[Ot,[],()=>Math.E],"^":[Ot,[Ot,Ot],(C,[w,I])=>Math.pow(w.evaluate(C),I.evaluate(C))],sqrt:[Ot,[Ot],(C,[w])=>Math.sqrt(w.evaluate(C))],log10:[Ot,[Ot],(C,[w])=>Math.log(w.evaluate(C))/Math.LN10],ln:[Ot,[Ot],(C,[w])=>Math.log(w.evaluate(C))],log2:[Ot,[Ot],(C,[w])=>Math.log(w.evaluate(C))/Math.LN2],sin:[Ot,[Ot],(C,[w])=>Math.sin(w.evaluate(C))],cos:[Ot,[Ot],(C,[w])=>Math.cos(w.evaluate(C))],tan:[Ot,[Ot],(C,[w])=>Math.tan(w.evaluate(C))],asin:[Ot,[Ot],(C,[w])=>Math.asin(w.evaluate(C))],acos:[Ot,[Ot],(C,[w])=>Math.acos(w.evaluate(C))],atan:[Ot,[Ot],(C,[w])=>Math.atan(w.evaluate(C))],min:[Ot,hn(Ot),(C,w)=>Math.min(...w.map(I=>I.evaluate(C)))],max:[Ot,hn(Ot),(C,w)=>Math.max(...w.map(I=>I.evaluate(C)))],abs:[Ot,[Ot],(C,[w])=>Math.abs(w.evaluate(C))],round:[Ot,[Ot],(C,[w])=>{const I=w.evaluate(C);return I<0?-Math.round(-I):Math.round(I)}],floor:[Ot,[Ot],(C,[w])=>Math.floor(w.evaluate(C))],ceil:[Ot,[Ot],(C,[w])=>Math.ceil(w.evaluate(C))],"filter-==":[Ti,[_i,mi],(C,[w,I])=>C.properties()[w.value]===I.value],"filter-id-==":[Ti,[mi],(C,[w])=>C.id()===w.value],"filter-type-==":[Ti,[_i],(C,[w])=>C.geometryType()===w.value],"filter-<":[Ti,[_i,mi],(C,[w,I])=>{const H=C.properties()[w.value],q=I.value;return typeof H==typeof q&&H<q}],"filter-id-<":[Ti,[mi],(C,[w])=>{const I=C.id(),H=w.value;return typeof I==typeof H&&I<H}],"filter->":[Ti,[_i,mi],(C,[w,I])=>{const H=C.properties()[w.value],q=I.value;return typeof H==typeof q&&H>q}],"filter-id->":[Ti,[mi],(C,[w])=>{const I=C.id(),H=w.value;return typeof I==typeof H&&I>H}],"filter-<=":[Ti,[_i,mi],(C,[w,I])=>{const H=C.properties()[w.value],q=I.value;return typeof H==typeof q&&H<=q}],"filter-id-<=":[Ti,[mi],(C,[w])=>{const I=C.id(),H=w.value;return typeof I==typeof H&&I<=H}],"filter->=":[Ti,[_i,mi],(C,[w,I])=>{const H=C.properties()[w.value],q=I.value;return typeof H==typeof q&&H>=q}],"filter-id->=":[Ti,[mi],(C,[w])=>{const I=C.id(),H=w.value;return typeof I==typeof H&&I>=H}],"filter-has":[Ti,[mi],(C,[w])=>w.value in C.properties()],"filter-has-id":[Ti,[],C=>C.id()!==null&&C.id()!==void 0],"filter-type-in":[Ti,[ji(_i)],(C,[w])=>w.value.indexOf(C.geometryType())>=0],"filter-id-in":[Ti,[ji(mi)],(C,[w])=>w.value.indexOf(C.id())>=0],"filter-in-small":[Ti,[_i,ji(mi)],(C,[w,I])=>I.value.indexOf(C.properties()[w.value])>=0],"filter-in-large":[Ti,[_i,ji(mi)],(C,[w,I])=>function(H,q,ee,ie){for(;ee<=ie;){const oe=ee+ie>>1;if(q[oe]===H)return!0;q[oe]>H?ie=oe-1:ee=oe+1}return!1}(C.properties()[w.value],I.value,0,I.value.length-1)],all:{type:Ti,overloads:[[[Ti,Ti],(C,[w,I])=>w.evaluate(C)&&I.evaluate(C)],[hn(Ti),(C,w)=>{for(const I of w)if(!I.evaluate(C))return!1;return!0}]]},any:{type:Ti,overloads:[[[Ti,Ti],(C,[w,I])=>w.evaluate(C)||I.evaluate(C)],[hn(Ti),(C,w)=>{for(const I of w)if(I.evaluate(C))return!0;return!1}]]},"!":[Ti,[Ti],(C,[w])=>!w.evaluate(C)],"is-supported-script":[Ti,[_i],(C,[w])=>{const I=C.globals&&C.globals.isSupportedScript;return!I||I(w.evaluate(C))}],upcase:[_i,[_i],(C,[w])=>w.evaluate(C).toUpperCase()],downcase:[_i,[_i],(C,[w])=>w.evaluate(C).toLowerCase()],concat:[_i,hn(mi),(C,w)=>w.map(I=>Br(I.evaluate(C))).join("")],"resolved-locale":[_i,[bi],(C,[w])=>w.evaluate(C).resolvedLocale()]});class Ur{constructor(w,I){var H;this.expression=w,this._warningHistory={},this._evaluator=new cr,this._defaultValue=I?(H=I).type==="color"&&Js(H.default)?new wi(0,0,0,0):H.type==="color"?wi.parse(H.default)||null:H.type==="padding"?pi.parse(H.default)||null:H.type==="variableAnchorOffsetCollection"?dr.parse(H.default)||null:H.default===void 0?null:H.default:null,this._enumValues=I&&I.type==="enum"?I.values:null}evaluateWithoutErrorHandling(w,I,H,q,ee,ie){return this._evaluator.globals=w,this._evaluator.feature=I,this._evaluator.featureState=H,this._evaluator.canonical=q,this._evaluator.availableImages=ee||null,this._evaluator.formattedSection=ie,this.expression.evaluate(this._evaluator)}evaluate(w,I,H,q,ee,ie){this._evaluator.globals=w,this._evaluator.feature=I||null,this._evaluator.featureState=H||null,this._evaluator.canonical=q,this._evaluator.availableImages=ee||null,this._evaluator.formattedSection=ie||null;try{const oe=this.expression.evaluate(this._evaluator);if(oe==null||typeof oe=="number"&&oe!=oe)return this._defaultValue;if(this._enumValues&&!(oe in this._enumValues))throw new rr(`Expected value to be one of ${Object.keys(this._enumValues).map(de=>JSON.stringify(de)).join(", ")}, but found ${JSON.stringify(oe)} instead.`);return oe}catch(oe){return this._warningHistory[oe.message]||(this._warningHistory[oe.message]=!0,typeof console<"u"&&console.warn(oe.message)),this._defaultValue}}}function $s(C){return Array.isArray(C)&&C.length>0&&typeof C[0]=="string"&&C[0]in gn}function Ji(C,w){const I=new js(gn,ia,[],w?function(q){const ee={color:Wi,string:_i,number:Ot,enum:_i,boolean:Ti,formatted:$i,padding:tr,resolvedImage:Ar,variableAnchorOffsetCollection:Tr};return q.type==="array"?ji(ee[q.value]||mi,q.length):ee[q.type]}(w):void 0),H=I.parse(C,void 0,void 0,void 0,w&&w.type==="string"?{typeAnnotation:"coerce"}:void 0);return H?Rs(new Ur(H,w)):la(I.errors)}class yr{constructor(w,I){this.kind=w,this._styleExpression=I,this.isStateDependent=w!=="constant"&&!Ca(I.expression)}evaluateWithoutErrorHandling(w,I,H,q,ee,ie){return this._styleExpression.evaluateWithoutErrorHandling(w,I,H,q,ee,ie)}evaluate(w,I,H,q,ee,ie){return this._styleExpression.evaluate(w,I,H,q,ee,ie)}}class Fr{constructor(w,I,H,q){this.kind=w,this.zoomStops=H,this._styleExpression=I,this.isStateDependent=w!=="camera"&&!Ca(I.expression),this.interpolationType=q}evaluateWithoutErrorHandling(w,I,H,q,ee,ie){return this._styleExpression.evaluateWithoutErrorHandling(w,I,H,q,ee,ie)}evaluate(w,I,H,q,ee,ie){return this._styleExpression.evaluate(w,I,H,q,ee,ie)}interpolationFactor(w,I,H){return this.interpolationType?gs.interpolationFactor(this.interpolationType,w,I,H):0}}function Mr(C,w){const I=Ji(C,w);if(I.result==="error")return I;const H=I.value.expression,q=Ba(H);if(!q&&!Hn(w))return la([new ii("","data expressions not supported")]);const ee=Ea(H,["zoom"]);if(!ee&&!to(w))return la([new ii("","zoom expressions not supported")]);const ie=Ua(H);return ie||ee?ie instanceof ii?la([ie]):ie instanceof gs&&!io(w)?la([new ii("",'"interpolate" expressions cannot be used with this property')]):Rs(ie?new Fr(q?"camera":"composite",I.value,ie.labels,ie instanceof gs?ie.interpolation:void 0):new yr(q?"constant":"source",I.value)):la([new ii("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class zn{constructor(w,I){this._parameters=w,this._specification=I,di(this,qo(this._parameters,this._specification))}static deserialize(w){return new zn(w._parameters,w._specification)}static serialize(w){return{_parameters:w._parameters,_specification:w._specification}}}function Ua(C){let w=null;if(C instanceof ra)w=Ua(C.result);else if(C instanceof Ia){for(const I of C.args)if(w=Ua(I),w)break}else(C instanceof Sa||C instanceof gs)&&C.input instanceof As&&C.input.name==="zoom"&&(w=C);return w instanceof ii||C.eachChild(I=>{const H=Ua(I);H instanceof ii?w=H:!w&&H?w=new ii("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):w&&H&&w!==H&&(w=new ii("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),w}function ro(C){if(C===!0||C===!1)return!0;if(!Array.isArray(C)||C.length===0)return!1;switch(C[0]){case"has":return C.length>=2&&C[1]!=="$id"&&C[1]!=="$type";case"in":return C.length>=3&&(typeof C[1]!="string"||Array.isArray(C[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return C.length!==3||Array.isArray(C[1])||Array.isArray(C[2]);case"any":case"all":for(const w of C.slice(1))if(!ro(w)&&typeof w!="boolean")return!1;return!0;default:return!0}}const ml={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Fo(C){if(C==null)return{filter:()=>!0,needGeometry:!1};ro(C)||(C=Ma(C));const w=Ji(C,ml);if(w.result==="error")throw new Error(w.value.map(I=>`${I.key}: ${I.message}`).join(", "));return{filter:(I,H,q)=>w.value.evaluate(I,H,{},q),needGeometry:no(C)}}function so(C,w){return C<w?-1:C>w?1:0}function no(C){if(!Array.isArray(C))return!1;if(C[0]==="within")return!0;for(let w=1;w<C.length;w++)if(no(C[w]))return!0;return!1}function Ma(C){if(!C)return!0;const w=C[0];return C.length<=1?w!=="any":w==="=="?ao(C[1],C[2],"=="):w==="!="?Nn(ao(C[1],C[2],"==")):w==="<"||w===">"||w==="<="||w===">="?ao(C[1],C[2],w):w==="any"?(I=C.slice(1),["any"].concat(I.map(Ma))):w==="all"?["all"].concat(C.slice(1).map(Ma)):w==="none"?["all"].concat(C.slice(1).map(Ma).map(Nn)):w==="in"?oo(C[1],C.slice(2)):w==="!in"?Nn(oo(C[1],C.slice(2))):w==="has"?Pa(C[1]):w==="!has"?Nn(Pa(C[1])):w!=="within"||C;var I}function ao(C,w,I){switch(C){case"$type":return[`filter-type-${I}`,w];case"$id":return[`filter-id-${I}`,w];default:return[`filter-${I}`,C,w]}}function oo(C,w){if(w.length===0)return!1;switch(C){case"$type":return["filter-type-in",["literal",w]];case"$id":return["filter-id-in",["literal",w]];default:return w.length>200&&!w.some(I=>typeof I!=typeof w[0])?["filter-in-large",C,["literal",w.sort(so)]]:["filter-in-small",C,["literal",w]]}}function Pa(C){switch(C){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",C]}}function Nn(C){return["!",C]}function La(C){const w=typeof C;if(w==="number"||w==="boolean"||w==="string"||C==null)return JSON.stringify(C);if(Array.isArray(C)){let q="[";for(const ee of C)q+=`${La(ee)},`;return`${q}]`}const I=Object.keys(C).sort();let H="{";for(let q=0;q<I.length;q++)H+=`${JSON.stringify(I[q])}:${La(C[I[q]])},`;return`${H}}`}function _l(C){let w="";for(const I of ke)w+=`/${La(C[I])}`;return w}function Yo(C){const w=C.value;return w?[new wt(C.key,w,"constants have been deprecated as of v8")]:[]}function Wr(C){return C instanceof Number||C instanceof String||C instanceof Boolean?C.valueOf():C}function Vn(C){if(Array.isArray(C))return C.map(Vn);if(C instanceof Object&&!(C instanceof Number||C instanceof String||C instanceof Boolean)){const w={};for(const I in C)w[I]=Vn(C[I]);return w}return Wr(C)}function Us(C){const w=C.key,I=C.value,H=C.valueSpec||{},q=C.objectElementValidators||{},ee=C.style,ie=C.styleSpec,oe=C.validateSpec;let de=[];const _e=gr(I);if(_e!=="object")return[new wt(w,I,`object expected, ${_e} found`)];for(const Ee in I){const Fe=Ee.split(".")[0],Pe=H[Fe]||H["*"];let He;if(q[Fe])He=q[Fe];else if(H[Fe])He=oe;else if(q["*"])He=q["*"];else{if(!H["*"]){de.push(new wt(w,I[Ee],`unknown property "${Ee}"`));continue}He=oe}de=de.concat(He({key:(w&&`${w}.`)+Ee,value:I[Ee],valueSpec:Pe,style:ee,styleSpec:ie,object:I,objectKey:Ee,validateSpec:oe},I))}for(const Ee in H)q[Ee]||H[Ee].required&&H[Ee].default===void 0&&I[Ee]===void 0&&de.push(new wt(w,I,`missing required property "${Ee}"`));return de}function ko(C){const w=C.value,I=C.valueSpec,H=C.style,q=C.styleSpec,ee=C.key,ie=C.arrayElementValidator||C.validateSpec;if(gr(w)!=="array")return[new wt(ee,w,`array expected, ${gr(w)} found`)];if(I.length&&w.length!==I.length)return[new wt(ee,w,`array length ${I.length} expected, length ${w.length} found`)];if(I["min-length"]&&w.length<I["min-length"])return[new wt(ee,w,`array length at least ${I["min-length"]} expected, length ${w.length} found`)];let oe={type:I.value,values:I.values};q.$version<7&&(oe.function=I.function),gr(I.value)==="object"&&(oe=I.value);let de=[];for(let _e=0;_e<w.length;_e++)de=de.concat(ie({array:w,arrayIndex:_e,value:w[_e],valueSpec:oe,validateSpec:C.validateSpec,style:H,styleSpec:q,key:`${ee}[${_e}]`}));return de}function Aa(C){const w=C.key,I=C.value,H=C.valueSpec;let q=gr(I);return q==="number"&&I!=I&&(q="NaN"),q!=="number"?[new wt(w,I,`number expected, ${q} found`)]:"minimum"in H&&I<H.minimum?[new wt(w,I,`${I} is less than the minimum value ${H.minimum}`)]:"maximum"in H&&I>H.maximum?[new wt(w,I,`${I} is greater than the maximum value ${H.maximum}`)]:[]}function Do(C){const w=C.valueSpec,I=Wr(C.value.type);let H,q,ee,ie={};const oe=I!=="categorical"&&C.value.property===void 0,de=!oe,_e=gr(C.value.stops)==="array"&&gr(C.value.stops[0])==="array"&&gr(C.value.stops[0][0])==="object",Ee=Us({key:C.key,value:C.value,valueSpec:C.styleSpec.function,validateSpec:C.validateSpec,style:C.style,styleSpec:C.styleSpec,objectElementValidators:{stops:function(He){if(I==="identity")return[new wt(He.key,He.value,'identity function may not have a "stops" property')];let Ne=[];const tt=He.value;return Ne=Ne.concat(ko({key:He.key,value:tt,valueSpec:He.valueSpec,validateSpec:He.validateSpec,style:He.style,styleSpec:He.styleSpec,arrayElementValidator:Fe})),gr(tt)==="array"&&tt.length===0&&Ne.push(new wt(He.key,tt,"array must have at least one stop")),Ne},default:function(He){return He.validateSpec({key:He.key,value:He.value,valueSpec:w,validateSpec:He.validateSpec,style:He.style,styleSpec:He.styleSpec})}}});return I==="identity"&&oe&&Ee.push(new wt(C.key,C.value,'missing required property "property"')),I==="identity"||C.value.stops||Ee.push(new wt(C.key,C.value,'missing required property "stops"')),I==="exponential"&&C.valueSpec.expression&&!io(C.valueSpec)&&Ee.push(new wt(C.key,C.value,"exponential functions not supported")),C.styleSpec.$version>=8&&(de&&!Hn(C.valueSpec)?Ee.push(new wt(C.key,C.value,"property functions not supported")):oe&&!to(C.valueSpec)&&Ee.push(new wt(C.key,C.value,"zoom functions not supported"))),I!=="categorical"&&!_e||C.value.property!==void 0||Ee.push(new wt(C.key,C.value,'"property" property is required')),Ee;function Fe(He){let Ne=[];const tt=He.value,at=He.key;if(gr(tt)!=="array")return[new wt(at,tt,`array expected, ${gr(tt)} found`)];if(tt.length!==2)return[new wt(at,tt,`array length 2 expected, length ${tt.length} found`)];if(_e){if(gr(tt[0])!=="object")return[new wt(at,tt,`object expected, ${gr(tt[0])} found`)];if(tt[0].zoom===void 0)return[new wt(at,tt,"object stop key must have zoom")];if(tt[0].value===void 0)return[new wt(at,tt,"object stop key must have value")];if(ee&&ee>Wr(tt[0].zoom))return[new wt(at,tt[0].zoom,"stop zoom values must appear in ascending order")];Wr(tt[0].zoom)!==ee&&(ee=Wr(tt[0].zoom),q=void 0,ie={}),Ne=Ne.concat(Us({key:`${at}[0]`,value:tt[0],valueSpec:{zoom:{}},validateSpec:He.validateSpec,style:He.style,styleSpec:He.styleSpec,objectElementValidators:{zoom:Aa,value:Pe}}))}else Ne=Ne.concat(Pe({key:`${at}[0]`,value:tt[0],valueSpec:{},validateSpec:He.validateSpec,style:He.style,styleSpec:He.styleSpec},tt));return $s(Vn(tt[1]))?Ne.concat([new wt(`${at}[1]`,tt[1],"expressions are not allowed in function stops.")]):Ne.concat(He.validateSpec({key:`${at}[1]`,value:tt[1],valueSpec:w,validateSpec:He.validateSpec,style:He.style,styleSpec:He.styleSpec}))}function Pe(He,Ne){const tt=gr(He.value),at=Wr(He.value),ct=He.value!==null?He.value:Ne;if(H){if(tt!==H)return[new wt(He.key,ct,`${tt} stop domain type must match previous stop domain type ${H}`)]}else H=tt;if(tt!=="number"&&tt!=="string"&&tt!=="boolean")return[new wt(He.key,ct,"stop domain value must be a number, string, or boolean")];if(tt!=="number"&&I!=="categorical"){let mt=`number expected, ${tt} found`;return Hn(w)&&I===void 0&&(mt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new wt(He.key,ct,mt)]}return I!=="categorical"||tt!=="number"||isFinite(at)&&Math.floor(at)===at?I!=="categorical"&&tt==="number"&&q!==void 0&&at<q?[new wt(He.key,ct,"stop domain values must appear in ascending order")]:(q=at,I==="categorical"&&at in ie?[new wt(He.key,ct,"stop domain values must be unique")]:(ie[at]=!0,[])):[new wt(He.key,ct,`integer expected, found ${at}`)]}}function en(C){const w=(C.expressionContext==="property"?Mr:Ji)(Vn(C.value),C.valueSpec);if(w.result==="error")return w.value.map(H=>new wt(`${C.key}${H.key}`,C.value,H.message));const I=w.value.expression||w.value._styleExpression.expression;if(C.expressionContext==="property"&&C.propertyKey==="text-font"&&!I.outputDefined())return[new wt(C.key,C.value,`Invalid data expression for "${C.propertyKey}". Output values must be contained as literals within the expression.`)];if(C.expressionContext==="property"&&C.propertyType==="layout"&&!Ca(I))return[new wt(C.key,C.value,'"feature-state" data expressions are not supported with layout properties.')];if(C.expressionContext==="filter"&&!Ca(I))return[new wt(C.key,C.value,'"feature-state" data expressions are not supported with filters.')];if(C.expressionContext&&C.expressionContext.indexOf("cluster")===0){if(!Ea(I,["zoom","feature-state"]))return[new wt(C.key,C.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(C.expressionContext==="cluster-initial"&&!Ba(I))return[new wt(C.key,C.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function xs(C){const w=C.key,I=C.value,H=C.valueSpec,q=[];return Array.isArray(H.values)?H.values.indexOf(Wr(I))===-1&&q.push(new wt(w,I,`expected one of [${H.values.join(", ")}], ${JSON.stringify(I)} found`)):Object.keys(H.values).indexOf(Wr(I))===-1&&q.push(new wt(w,I,`expected one of [${Object.keys(H.values).join(", ")}], ${JSON.stringify(I)} found`)),q}function Kn(C){return ro(Vn(C.value))?en(di({},C,{expressionContext:"filter",valueSpec:{value:"boolean"}})):jo(C)}function jo(C){const w=C.value,I=C.key;if(gr(w)!=="array")return[new wt(I,w,`array expected, ${gr(w)} found`)];const H=C.styleSpec;let q,ee=[];if(w.length<1)return[new wt(I,w,"filter array must have at least 1 element")];switch(ee=ee.concat(xs({key:`${I}[0]`,value:w[0],valueSpec:H.filter_operator,style:C.style,styleSpec:C.styleSpec})),Wr(w[0])){case"<":case"<=":case">":case">=":w.length>=2&&Wr(w[1])==="$type"&&ee.push(new wt(I,w,`"$type" cannot be use with operator "${w[0]}"`));case"==":case"!=":w.length!==3&&ee.push(new wt(I,w,`filter array for operator "${w[0]}" must have 3 elements`));case"in":case"!in":w.length>=2&&(q=gr(w[1]),q!=="string"&&ee.push(new wt(`${I}[1]`,w[1],`string expected, ${q} found`)));for(let ie=2;ie<w.length;ie++)q=gr(w[ie]),Wr(w[1])==="$type"?ee=ee.concat(xs({key:`${I}[${ie}]`,value:w[ie],valueSpec:H.geometry_type,style:C.style,styleSpec:C.styleSpec})):q!=="string"&&q!=="number"&&q!=="boolean"&&ee.push(new wt(`${I}[${ie}]`,w[ie],`string, number, or boolean expected, ${q} found`));break;case"any":case"all":case"none":for(let ie=1;ie<w.length;ie++)ee=ee.concat(jo({key:`${I}[${ie}]`,value:w[ie],style:C.style,styleSpec:C.styleSpec}));break;case"has":case"!has":q=gr(w[1]),w.length!==2?ee.push(new wt(I,w,`filter array for "${w[0]}" operator must have 2 elements`)):q!=="string"&&ee.push(new wt(`${I}[1]`,w[1],`string expected, ${q} found`));break;case"within":q=gr(w[1]),w.length!==2?ee.push(new wt(I,w,`filter array for "${w[0]}" operator must have 2 elements`)):q!=="object"&&ee.push(new wt(`${I}[1]`,w[1],`object expected, ${q} found`))}return ee}function ca(C,w){const I=C.key,H=C.validateSpec,q=C.style,ee=C.styleSpec,ie=C.value,oe=C.objectKey,de=ee[`${w}_${C.layerType}`];if(!de)return[];const _e=oe.match(/^(.*)-transition$/);if(w==="paint"&&_e&&de[_e[1]]&&de[_e[1]].transition)return H({key:I,value:ie,valueSpec:ee.transition,style:q,styleSpec:ee});const Ee=C.valueSpec||de[oe];if(!Ee)return[new wt(I,ie,`unknown property "${oe}"`)];let Fe;if(gr(ie)==="string"&&Hn(Ee)&&!Ee.tokens&&(Fe=/^{([^}]+)}$/.exec(ie)))return[new wt(I,ie,`"${oe}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(Fe[1])} }\`.`)];const Pe=[];return C.layerType==="symbol"&&(oe==="text-field"&&q&&!q.glyphs&&Pe.push(new wt(I,ie,'use of "text-field" requires a style "glyphs" property')),oe==="text-font"&&Js(Vn(ie))&&Wr(ie.type)==="identity"&&Pe.push(new wt(I,ie,'"text-font" does not support identity functions'))),Pe.concat(H({key:C.key,value:ie,valueSpec:Ee,style:q,styleSpec:ee,expressionContext:"property",propertyType:w,propertyKey:oe}))}function ha(C){return ca(C,"paint")}function _n(C){return ca(C,"layout")}function Bs(C){let w=[];const I=C.value,H=C.key,q=C.style,ee=C.styleSpec;I.type||I.ref||w.push(new wt(H,I,'either "type" or "ref" is required'));let ie=Wr(I.type);const oe=Wr(I.ref);if(I.id){const de=Wr(I.id);for(let _e=0;_e<C.arrayIndex;_e++){const Ee=q.layers[_e];Wr(Ee.id)===de&&w.push(new wt(H,I.id,`duplicate layer id "${I.id}", previously used at line ${Ee.id.__line__}`))}}if("ref"in I){let de;["type","source","source-layer","filter","layout"].forEach(_e=>{_e in I&&w.push(new wt(H,I[_e],`"${_e}" is prohibited for ref layers`))}),q.layers.forEach(_e=>{Wr(_e.id)===oe&&(de=_e)}),de?de.ref?w.push(new wt(H,I.ref,"ref cannot reference another ref layer")):ie=Wr(de.type):w.push(new wt(H,I.ref,`ref layer "${oe}" not found`))}else if(ie!=="background")if(I.source){const de=q.sources&&q.sources[I.source],_e=de&&Wr(de.type);de?_e==="vector"&&ie==="raster"?w.push(new wt(H,I.source,`layer "${I.id}" requires a raster source`)):_e==="raster"&&ie!=="raster"?w.push(new wt(H,I.source,`layer "${I.id}" requires a vector source`)):_e!=="vector"||I["source-layer"]?_e==="raster-dem"&&ie!=="hillshade"?w.push(new wt(H,I.source,"raster-dem source can only be used with layer type 'hillshade'.")):ie!=="line"||!I.paint||!I.paint["line-gradient"]||_e==="geojson"&&de.lineMetrics||w.push(new wt(H,I,`layer "${I.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):w.push(new wt(H,I,`layer "${I.id}" must specify a "source-layer"`)):w.push(new wt(H,I.source,`source "${I.source}" not found`))}else w.push(new wt(H,I,'missing required property "source"'));return w=w.concat(Us({key:H,value:I,valueSpec:ee.layer,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,objectElementValidators:{"*":()=>[],type:()=>C.validateSpec({key:`${H}.type`,value:I.type,valueSpec:ee.layer.type,style:C.style,styleSpec:C.styleSpec,validateSpec:C.validateSpec,object:I,objectKey:"type"}),filter:Kn,layout:de=>Us({layer:I,key:de.key,value:de.value,style:de.style,styleSpec:de.styleSpec,validateSpec:de.validateSpec,objectElementValidators:{"*":_e=>_n(di({layerType:ie},_e))}}),paint:de=>Us({layer:I,key:de.key,value:de.value,style:de.style,styleSpec:de.styleSpec,validateSpec:de.validateSpec,objectElementValidators:{"*":_e=>ha(di({layerType:ie},_e))}})}})),w}function yn(C){const w=C.value,I=C.key,H=gr(w);return H!=="string"?[new wt(I,w,`string expected, ${H} found`)]:[]}const Uo={promoteId:function({key:C,value:w}){if(gr(w)==="string")return yn({key:C,value:w});{const I=[];for(const H in w)I.push(...yn({key:`${C}.${H}`,value:w[H]}));return I}}};function Gn(C){const w=C.value,I=C.key,H=C.styleSpec,q=C.style,ee=C.validateSpec;if(!w.type)return[new wt(I,w,'"type" is required')];const ie=Wr(w.type);let oe;switch(ie){case"vector":case"raster":case"raster-dem":return oe=Us({key:I,value:w,valueSpec:H[`source_${ie.replace("-","_")}`],style:C.style,styleSpec:H,objectElementValidators:Uo,validateSpec:ee}),oe;case"geojson":if(oe=Us({key:I,value:w,valueSpec:H.source_geojson,style:q,styleSpec:H,validateSpec:ee,objectElementValidators:Uo}),w.cluster)for(const de in w.clusterProperties){const[_e,Ee]=w.clusterProperties[de],Fe=typeof _e=="string"?[_e,["accumulated"],["get",de]]:_e;oe.push(...en({key:`${I}.${de}.map`,value:Ee,validateSpec:ee,expressionContext:"cluster-map"})),oe.push(...en({key:`${I}.${de}.reduce`,value:Fe,validateSpec:ee,expressionContext:"cluster-reduce"}))}return oe;case"video":return Us({key:I,value:w,valueSpec:H.source_video,style:q,validateSpec:ee,styleSpec:H});case"image":return Us({key:I,value:w,valueSpec:H.source_image,style:q,validateSpec:ee,styleSpec:H});case"canvas":return[new wt(I,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return xs({key:`${I}.type`,value:w.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:q,validateSpec:ee,styleSpec:H})}}function Qa(C){const w=C.value,I=C.styleSpec,H=I.light,q=C.style;let ee=[];const ie=gr(w);if(w===void 0)return ee;if(ie!=="object")return ee=ee.concat([new wt("light",w,`object expected, ${ie} found`)]),ee;for(const oe in w){const de=oe.match(/^(.*)-transition$/);ee=ee.concat(de&&H[de[1]]&&H[de[1]].transition?C.validateSpec({key:oe,value:w[oe],valueSpec:I.transition,validateSpec:C.validateSpec,style:q,styleSpec:I}):H[oe]?C.validateSpec({key:oe,value:w[oe],valueSpec:H[oe],validateSpec:C.validateSpec,style:q,styleSpec:I}):[new wt(oe,w[oe],`unknown property "${oe}"`)])}return ee}function lo(C){const w=C.value,I=C.styleSpec,H=I.terrain,q=C.style;let ee=[];const ie=gr(w);if(w===void 0)return ee;if(ie!=="object")return ee=ee.concat([new wt("terrain",w,`object expected, ${ie} found`)]),ee;for(const oe in w)ee=ee.concat(H[oe]?C.validateSpec({key:oe,value:w[oe],valueSpec:H[oe],validateSpec:C.validateSpec,style:q,styleSpec:I}):[new wt(oe,w[oe],`unknown property "${oe}"`)]);return ee}function ua(C){let w=[];const I=C.value,H=C.key;if(Array.isArray(I)){const q=[],ee=[];for(const ie in I)I[ie].id&&q.includes(I[ie].id)&&w.push(new wt(H,I,`all the sprites' ids must be unique, but ${I[ie].id} is duplicated`)),q.push(I[ie].id),I[ie].url&&ee.includes(I[ie].url)&&w.push(new wt(H,I,`all the sprites' URLs must be unique, but ${I[ie].url} is duplicated`)),ee.push(I[ie].url),w=w.concat(Us({key:`${H}[${ie}]`,value:I[ie],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:C.validateSpec}));return w}return yn({key:H,value:I})}const Ao={"*":()=>[],array:ko,boolean:function(C){const w=C.value,I=C.key,H=gr(w);return H!=="boolean"?[new wt(I,w,`boolean expected, ${H} found`)]:[]},number:Aa,color:function(C){const w=C.key,I=C.value,H=gr(I);return H!=="string"?[new wt(w,I,`color expected, ${H} found`)]:wi.parse(String(I))?[]:[new wt(w,I,`color expected, "${I}" found`)]},constants:Yo,enum:xs,filter:Kn,function:Do,layer:Bs,object:Us,source:Gn,light:Qa,terrain:lo,string:yn,formatted:function(C){return yn(C).length===0?[]:en(C)},resolvedImage:function(C){return yn(C).length===0?[]:en(C)},padding:function(C){const w=C.key,I=C.value;if(gr(I)==="array"){if(I.length<1||I.length>4)return[new wt(w,I,`padding requires 1 to 4 values; ${I.length} values found`)];const H={type:"number"};let q=[];for(let ee=0;ee<I.length;ee++)q=q.concat(C.validateSpec({key:`${w}[${ee}]`,value:I[ee],validateSpec:C.validateSpec,valueSpec:H}));return q}return Aa({key:w,value:I,valueSpec:{}})},variableAnchorOffsetCollection:function(C){const w=C.key,I=C.value,H=gr(I),q=C.styleSpec;if(H!=="array"||I.length<1||I.length%2!=0)return[new wt(w,I,"variableAnchorOffsetCollection requires a non-empty array of even length")];let ee=[];for(let ie=0;ie<I.length;ie+=2)ee=ee.concat(xs({key:`${w}[${ie}]`,value:I[ie],valueSpec:q.layout_symbol["text-anchor"]})),ee=ee.concat(ko({key:`${w}[${ie+1}]`,value:I[ie+1],valueSpec:{length:2,value:"number"},validateSpec:C.validateSpec,style:C.style,styleSpec:q}));return ee},sprite:ua};function fa(C){const w=C.value,I=C.valueSpec,H=C.styleSpec;return C.validateSpec=fa,I.expression&&Js(Wr(w))?Do(C):I.expression&&$s(Vn(w))?en(C):I.type&&Ao[I.type]?Ao[I.type](C):Us(di({},C,{valueSpec:I.type?H[I.type]:I}))}function Fn(C){const w=C.value,I=C.key,H=yn(C);return H.length||(w.indexOf("{fontstack}")===-1&&H.push(new wt(I,w,'"glyphs" url must include a "{fontstack}" token')),w.indexOf("{range}")===-1&&H.push(new wt(I,w,'"glyphs" url must include a "{range}" token'))),H}function vs(C,w=me){let I=[];return I=I.concat(fa({key:"",value:C,valueSpec:w.$root,styleSpec:w,style:C,validateSpec:fa,objectElementValidators:{glyphs:Fn,"*":()=>[]}})),C.constants&&(I=I.concat(Yo({key:"constants",value:C.constants,style:C,styleSpec:w,validateSpec:fa}))),Oa(I)}function qr(C){return function(w){return C({...w,validateSpec:fa})}}function Oa(C){return[].concat(C).sort((w,I)=>w.line-I.line)}function Ms(C){return function(...w){return Oa(C.apply(this,w))}}vs.source=Ms(qr(Gn)),vs.sprite=Ms(qr(ua)),vs.glyphs=Ms(qr(Fn)),vs.light=Ms(qr(Qa)),vs.terrain=Ms(qr(lo)),vs.layer=Ms(qr(Bs)),vs.filter=Ms(qr(Kn)),vs.paintProperty=Ms(qr(ha)),vs.layoutProperty=Ms(qr(_n));const Ra=vs,co=Ra.light,da=Ra.paintProperty,Zo=Ra.layoutProperty;function Wn(C,w){let I=!1;if(w&&w.length)for(const H of w)C.fire(new Ve(new Error(H.message))),I=!0;return I}class qi{constructor(w,I,H){const q=this.cells=[];if(w instanceof ArrayBuffer){this.arrayBuffer=w;const ie=new Int32Array(this.arrayBuffer);w=ie[0],this.d=(I=ie[1])+2*(H=ie[2]);for(let de=0;de<this.d*this.d;de++){const _e=ie[3+de],Ee=ie[3+de+1];q.push(_e===Ee?null:ie.subarray(_e,Ee))}const oe=ie[3+q.length+1];this.keys=ie.subarray(ie[3+q.length],oe),this.bboxes=ie.subarray(oe),this.insert=this._insertReadonly}else{this.d=I+2*H;for(let ie=0;ie<this.d*this.d;ie++)q.push([]);this.keys=[],this.bboxes=[]}this.n=I,this.extent=w,this.padding=H,this.scale=I/w,this.uid=0;const ee=H/I*w;this.min=-ee,this.max=w+ee}insert(w,I,H,q,ee){this._forEachCell(I,H,q,ee,this._insertCell,this.uid++,void 0,void 0),this.keys.push(w),this.bboxes.push(I),this.bboxes.push(H),this.bboxes.push(q),this.bboxes.push(ee)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(w,I,H,q,ee,ie){this.cells[ee].push(ie)}query(w,I,H,q,ee){const ie=this.min,oe=this.max;if(w<=ie&&I<=ie&&oe<=H&&oe<=q&&!ee)return Array.prototype.slice.call(this.keys);{const de=[];return this._forEachCell(w,I,H,q,this._queryCell,de,{},ee),de}}_queryCell(w,I,H,q,ee,ie,oe,de){const _e=this.cells[ee];if(_e!==null){const Ee=this.keys,Fe=this.bboxes;for(let Pe=0;Pe<_e.length;Pe++){const He=_e[Pe];if(oe[He]===void 0){const Ne=4*He;(de?de(Fe[Ne+0],Fe[Ne+1],Fe[Ne+2],Fe[Ne+3]):w<=Fe[Ne+2]&&I<=Fe[Ne+3]&&H>=Fe[Ne+0]&&q>=Fe[Ne+1])?(oe[He]=!0,ie.push(Ee[He])):oe[He]=!1}}}}_forEachCell(w,I,H,q,ee,ie,oe,de){const _e=this._convertToCellCoord(w),Ee=this._convertToCellCoord(I),Fe=this._convertToCellCoord(H),Pe=this._convertToCellCoord(q);for(let He=_e;He<=Fe;He++)for(let Ne=Ee;Ne<=Pe;Ne++){const tt=this.d*Ne+He;if((!de||de(this._convertFromCellCoord(He),this._convertFromCellCoord(Ne),this._convertFromCellCoord(He+1),this._convertFromCellCoord(Ne+1)))&&ee.call(this,w,I,H,q,tt,ie,oe,de))return}}_convertFromCellCoord(w){return(w-this.padding)/this.scale}_convertToCellCoord(w){return Math.max(0,Math.min(this.d-1,Math.floor(w*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const w=this.cells,I=3+this.cells.length+1+1;let H=0;for(let ie=0;ie<this.cells.length;ie++)H+=this.cells[ie].length;const q=new Int32Array(I+H+this.keys.length+this.bboxes.length);q[0]=this.extent,q[1]=this.n,q[2]=this.padding;let ee=I;for(let ie=0;ie<w.length;ie++){const oe=w[ie];q[3+ie]=ee,q.set(oe,ee),ee+=oe.length}return q[3+w.length]=ee,q.set(this.keys,ee),ee+=this.keys.length,q[3+w.length+1]=ee,q.set(this.bboxes,ee),ee+=this.bboxes.length,q.buffer}static serialize(w,I){const H=w.toArrayBuffer();return I&&I.push(H),{buffer:H}}static deserialize(w){return new qi(w.buffer)}}const tn={};function gi(C,w,I={}){if(tn[C])throw new Error(`${C} is already registered.`);Object.defineProperty(w,"_classRegistryKey",{value:C,writeable:!1}),tn[C]={klass:w,omit:I.omit||[],shallow:I.shallow||[]}}gi("Object",Object),gi("TransferableGridIndex",qi),gi("Color",wi),gi("Error",Error),gi("AJAXError",b),gi("ResolvedImage",Dt),gi("StylePropertyFunction",zn),gi("StyleExpression",Ur,{omit:["_evaluator"]}),gi("ZoomDependentExpression",Fr),gi("ZoomConstantExpression",yr),gi("CompoundExpression",As,{omit:["_evaluate"]});for(const C in gn)gn[C]._classRegistryKey||gi(`Expression_${C}`,gn[C]);function kn(C){return C&&typeof ArrayBuffer<"u"&&(C instanceof ArrayBuffer||C.constructor&&C.constructor.name==="ArrayBuffer")}function we(C,w){if(C==null||typeof C=="boolean"||typeof C=="number"||typeof C=="string"||C instanceof Boolean||C instanceof Number||C instanceof String||C instanceof Date||C instanceof RegExp||C instanceof Blob)return C;if(kn(C)||Ri(C))return w&&w.push(C),C;if(ArrayBuffer.isView(C)){const I=C;return w&&w.push(I.buffer),I}if(C instanceof ImageData)return w&&w.push(C.data.buffer),C;if(Array.isArray(C)){const I=[];for(const H of C)I.push(we(H,w));return I}if(typeof C=="object"){const I=C.constructor,H=I._classRegistryKey;if(!H)throw new Error("can't serialize object of unregistered class");if(!tn[H])throw new Error(`${H} is not registered.`);const q=I.serialize?I.serialize(C,w):{};if(I.serialize){if(w&&q===w[w.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const ee in C){if(!C.hasOwnProperty(ee)||tn[H].omit.indexOf(ee)>=0)continue;const ie=C[ee];q[ee]=tn[H].shallow.indexOf(ee)>=0?ie:we(ie,w)}C instanceof Error&&(q.message=C.message)}if(q.$name)throw new Error("$name property is reserved for worker serialization logic.");return H!=="Object"&&(q.$name=H),q}throw new Error("can't serialize object of type "+typeof C)}function Re(C){if(C==null||typeof C=="boolean"||typeof C=="number"||typeof C=="string"||C instanceof Boolean||C instanceof Number||C instanceof String||C instanceof Date||C instanceof RegExp||C instanceof Blob||kn(C)||Ri(C)||ArrayBuffer.isView(C)||C instanceof ImageData)return C;if(Array.isArray(C))return C.map(Re);if(typeof C=="object"){const w=C.$name||"Object";if(!tn[w])throw new Error(`can't deserialize unregistered class ${w}`);const{klass:I}=tn[w];if(!I)throw new Error(`can't deserialize unregistered class ${w}`);if(I.deserialize)return I.deserialize(C);const H=Object.create(I.prototype);for(const q of Object.keys(C)){if(q==="$name")continue;const ee=C[q];H[q]=tn[w].shallow.indexOf(q)>=0?ee:Re(ee)}return H}throw new Error("can't deserialize object of type "+typeof C)}class Xe{constructor(){this.first=!0}update(w,I){const H=Math.floor(w);return this.first?(this.first=!1,this.lastIntegerZoom=H,this.lastIntegerZoomTime=0,this.lastZoom=w,this.lastFloorZoom=H,!0):(this.lastFloorZoom>H?(this.lastIntegerZoom=H+1,this.lastIntegerZoomTime=I):this.lastFloorZoom<H&&(this.lastIntegerZoom=H,this.lastIntegerZoomTime=I),w!==this.lastZoom&&(this.lastZoom=w,this.lastFloorZoom=H,!0))}}const je={"Latin-1 Supplement":C=>C>=128&&C<=255,Arabic:C=>C>=1536&&C<=1791,"Arabic Supplement":C=>C>=1872&&C<=1919,"Arabic Extended-A":C=>C>=2208&&C<=2303,"Hangul Jamo":C=>C>=4352&&C<=4607,"Unified Canadian Aboriginal Syllabics":C=>C>=5120&&C<=5759,Khmer:C=>C>=6016&&C<=6143,"Unified Canadian Aboriginal Syllabics Extended":C=>C>=6320&&C<=6399,"General Punctuation":C=>C>=8192&&C<=8303,"Letterlike Symbols":C=>C>=8448&&C<=8527,"Number Forms":C=>C>=8528&&C<=8591,"Miscellaneous Technical":C=>C>=8960&&C<=9215,"Control Pictures":C=>C>=9216&&C<=9279,"Optical Character Recognition":C=>C>=9280&&C<=9311,"Enclosed Alphanumerics":C=>C>=9312&&C<=9471,"Geometric Shapes":C=>C>=9632&&C<=9727,"Miscellaneous Symbols":C=>C>=9728&&C<=9983,"Miscellaneous Symbols and Arrows":C=>C>=11008&&C<=11263,"CJK Radicals Supplement":C=>C>=11904&&C<=12031,"Kangxi Radicals":C=>C>=12032&&C<=12255,"Ideographic Description Characters":C=>C>=12272&&C<=12287,"CJK Symbols and Punctuation":C=>C>=12288&&C<=12351,Hiragana:C=>C>=12352&&C<=12447,Katakana:C=>C>=12448&&C<=12543,Bopomofo:C=>C>=12544&&C<=12591,"Hangul Compatibility Jamo":C=>C>=12592&&C<=12687,Kanbun:C=>C>=12688&&C<=12703,"Bopomofo Extended":C=>C>=12704&&C<=12735,"CJK Strokes":C=>C>=12736&&C<=12783,"Katakana Phonetic Extensions":C=>C>=12784&&C<=12799,"Enclosed CJK Letters and Months":C=>C>=12800&&C<=13055,"CJK Compatibility":C=>C>=13056&&C<=13311,"CJK Unified Ideographs Extension A":C=>C>=13312&&C<=19903,"Yijing Hexagram Symbols":C=>C>=19904&&C<=19967,"CJK Unified Ideographs":C=>C>=19968&&C<=40959,"Yi Syllables":C=>C>=40960&&C<=42127,"Yi Radicals":C=>C>=42128&&C<=42191,"Hangul Jamo Extended-A":C=>C>=43360&&C<=43391,"Hangul Syllables":C=>C>=44032&&C<=55215,"Hangul Jamo Extended-B":C=>C>=55216&&C<=55295,"Private Use Area":C=>C>=57344&&C<=63743,"CJK Compatibility Ideographs":C=>C>=63744&&C<=64255,"Arabic Presentation Forms-A":C=>C>=64336&&C<=65023,"Vertical Forms":C=>C>=65040&&C<=65055,"CJK Compatibility Forms":C=>C>=65072&&C<=65103,"Small Form Variants":C=>C>=65104&&C<=65135,"Arabic Presentation Forms-B":C=>C>=65136&&C<=65279,"Halfwidth and Fullwidth Forms":C=>C>=65280&&C<=65519};function yt(C){for(const w of C)if(jt(w.charCodeAt(0)))return!0;return!1}function Et(C){for(const w of C)if(!Ht(w.charCodeAt(0)))return!1;return!0}function Ht(C){return!(je.Arabic(C)||je["Arabic Supplement"](C)||je["Arabic Extended-A"](C)||je["Arabic Presentation Forms-A"](C)||je["Arabic Presentation Forms-B"](C))}function jt(C){return!(C!==746&&C!==747&&(C<4352||!(je["Bopomofo Extended"](C)||je.Bopomofo(C)||je["CJK Compatibility Forms"](C)&&!(C>=65097&&C<=65103)||je["CJK Compatibility Ideographs"](C)||je["CJK Compatibility"](C)||je["CJK Radicals Supplement"](C)||je["CJK Strokes"](C)||!(!je["CJK Symbols and Punctuation"](C)||C>=12296&&C<=12305||C>=12308&&C<=12319||C===12336)||je["CJK Unified Ideographs Extension A"](C)||je["CJK Unified Ideographs"](C)||je["Enclosed CJK Letters and Months"](C)||je["Hangul Compatibility Jamo"](C)||je["Hangul Jamo Extended-A"](C)||je["Hangul Jamo Extended-B"](C)||je["Hangul Jamo"](C)||je["Hangul Syllables"](C)||je.Hiragana(C)||je["Ideographic Description Characters"](C)||je.Kanbun(C)||je["Kangxi Radicals"](C)||je["Katakana Phonetic Extensions"](C)||je.Katakana(C)&&C!==12540||!(!je["Halfwidth and Fullwidth Forms"](C)||C===65288||C===65289||C===65293||C>=65306&&C<=65310||C===65339||C===65341||C===65343||C>=65371&&C<=65503||C===65507||C>=65512&&C<=65519)||!(!je["Small Form Variants"](C)||C>=65112&&C<=65118||C>=65123&&C<=65126)||je["Unified Canadian Aboriginal Syllabics"](C)||je["Unified Canadian Aboriginal Syllabics Extended"](C)||je["Vertical Forms"](C)||je["Yijing Hexagram Symbols"](C)||je["Yi Syllables"](C)||je["Yi Radicals"](C))))}function hi(C){return!(jt(C)||function(w){return!!(je["Latin-1 Supplement"](w)&&(w===167||w===169||w===174||w===177||w===188||w===189||w===190||w===215||w===247)||je["General Punctuation"](w)&&(w===8214||w===8224||w===8225||w===8240||w===8241||w===8251||w===8252||w===8258||w===8263||w===8264||w===8265||w===8273)||je["Letterlike Symbols"](w)||je["Number Forms"](w)||je["Miscellaneous Technical"](w)&&(w>=8960&&w<=8967||w>=8972&&w<=8991||w>=8996&&w<=9e3||w===9003||w>=9085&&w<=9114||w>=9150&&w<=9165||w===9167||w>=9169&&w<=9179||w>=9186&&w<=9215)||je["Control Pictures"](w)&&w!==9251||je["Optical Character Recognition"](w)||je["Enclosed Alphanumerics"](w)||je["Geometric Shapes"](w)||je["Miscellaneous Symbols"](w)&&!(w>=9754&&w<=9759)||je["Miscellaneous Symbols and Arrows"](w)&&(w>=11026&&w<=11055||w>=11088&&w<=11097||w>=11192&&w<=11243)||je["CJK Symbols and Punctuation"](w)||je.Katakana(w)||je["Private Use Area"](w)||je["CJK Compatibility Forms"](w)||je["Small Form Variants"](w)||je["Halfwidth and Fullwidth Forms"](w)||w===8734||w===8756||w===8757||w>=9984&&w<=10087||w>=10102&&w<=10131||w===65532||w===65533)}(C))}function Wt(C){return C>=1424&&C<=2303||je["Arabic Presentation Forms-A"](C)||je["Arabic Presentation Forms-B"](C)}function Gi(C,w){return!(!w&&Wt(C)||C>=2304&&C<=3583||C>=3840&&C<=4255||je.Khmer(C))}function zi(C){for(const w of C)if(Wt(w.charCodeAt(0)))return!0;return!1}const Oi="deferred",mr="loading",ur="loaded";let vr=null,nr="unavailable",Xi=null;const Or=function(C){C&&typeof C=="string"&&C.indexOf("NetworkError")>-1&&(nr="error"),vr&&vr(C)};function Sr(){bs.fire(new Te("pluginStateChange",{pluginStatus:nr,pluginURL:Xi}))}const bs=new Ue,Ha=function(){return nr},pa=function(){if(nr!==Oi||!Xi)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");nr=mr,Sr(),Xi&&se({url:Xi},C=>{C?Or(C):(nr=ur,Sr())})},ns={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>nr===ur||ns.applyArabicShaping!=null,isLoading:()=>nr===mr,setState(C){if(!Pt())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");nr=C.pluginStatus,Xi=C.pluginURL},isParsed(){if(!Pt())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return ns.applyArabicShaping!=null&&ns.processBidirectionalText!=null&&ns.processStyledBidirectionalText!=null},getPluginURL(){if(!Pt())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Xi}};class Er{constructor(w,I){this.zoom=w,I?(this.now=I.now,this.fadeDuration=I.fadeDuration,this.zoomHistory=I.zoomHistory,this.transition=I.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Xe,this.transition={})}isSupportedScript(w){return function(I,H){for(const q of I)if(!Gi(q.charCodeAt(0),H))return!1;return!0}(w,ns.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const w=this.zoom,I=w-Math.floor(w),H=this.crossFadingFactor();return w>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:I+(1-I)*H}:{fromScale:.5,toScale:1,t:1-(1-H)*I}}}class ga{constructor(w,I){this.property=w,this.value=I,this.expression=function(H,q){if(Js(H))return new zn(H,q);if($s(H)){const ee=Mr(H,q);if(ee.result==="error")throw new Error(ee.value.map(ie=>`${ie.key}: ${ie.message}`).join(", "));return ee.value}{let ee=H;return q.type==="color"&&typeof H=="string"?ee=wi.parse(H):q.type!=="padding"||typeof H!="number"&&!Array.isArray(H)?q.type==="variableAnchorOffsetCollection"&&Array.isArray(H)&&(ee=dr.parse(H)):ee=pi.parse(H),{kind:"constant",evaluate:()=>ee}}}(I===void 0?w.specification.default:I,w.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(w,I,H){return this.property.possiblyEvaluate(this,w,I,H)}}class vn{constructor(w){this.property=w,this.value=new ga(w,void 0)}transitioned(w,I){return new qn(this.property,this.value,I,et({},w.transition,this.transition),w.now)}untransitioned(){return new qn(this.property,this.value,null,{},0)}}class Jo{constructor(w){this._properties=w,this._values=Object.create(w.defaultTransitionablePropertyValues)}getValue(w){return Tt(this._values[w].value.value)}setValue(w,I){Object.prototype.hasOwnProperty.call(this._values,w)||(this._values[w]=new vn(this._values[w].property)),this._values[w].value=new ga(this._values[w].property,I===null?void 0:Tt(I))}getTransition(w){return Tt(this._values[w].transition)}setTransition(w,I){Object.prototype.hasOwnProperty.call(this._values,w)||(this._values[w]=new vn(this._values[w].property)),this._values[w].transition=Tt(I)||void 0}serialize(){const w={};for(const I of Object.keys(this._values)){const H=this.getValue(I);H!==void 0&&(w[I]=H);const q=this.getTransition(I);q!==void 0&&(w[`${I}-transition`]=q)}return w}transitioned(w,I){const H=new ho(this._properties);for(const q of Object.keys(this._values))H._values[q]=this._values[q].transitioned(w,I._values[q]);return H}untransitioned(){const w=new ho(this._properties);for(const I of Object.keys(this._values))w._values[I]=this._values[I].untransitioned();return w}}class qn{constructor(w,I,H,q,ee){this.property=w,this.value=I,this.begin=ee+q.delay||0,this.end=this.begin+q.duration||0,w.specification.transition&&(q.delay||q.duration)&&(this.prior=H)}possiblyEvaluate(w,I,H){const q=w.now||0,ee=this.value.possiblyEvaluate(w,I,H),ie=this.prior;if(ie){if(q>this.end)return this.prior=null,ee;if(this.value.isDataDriven())return this.prior=null,ee;if(q<this.begin)return ie.possiblyEvaluate(w,I,H);{const oe=(q-this.begin)/(this.end-this.begin);return this.property.interpolate(ie.possiblyEvaluate(w,I,H),ee,function(de){if(de<=0)return 0;if(de>=1)return 1;const _e=de*de,Ee=_e*de;return 4*(de<.5?Ee:3*(de-_e)+Ee-.75)}(oe))}}return ee}}class ho{constructor(w){this._properties=w,this._values=Object.create(w.defaultTransitioningPropertyValues)}possiblyEvaluate(w,I,H){const q=new Mo(this._properties);for(const ee of Object.keys(this._values))q._values[ee]=this._values[ee].possiblyEvaluate(w,I,H);return q}hasTransition(){for(const w of Object.keys(this._values))if(this._values[w].prior)return!0;return!1}}class yl{constructor(w){this._properties=w,this._values=Object.create(w.defaultPropertyValues)}hasValue(w){return this._values[w].value!==void 0}getValue(w){return Tt(this._values[w].value)}setValue(w,I){this._values[w]=new ga(this._values[w].property,I===null?void 0:Tt(I))}serialize(){const w={};for(const I of Object.keys(this._values)){const H=this.getValue(I);H!==void 0&&(w[I]=H)}return w}possiblyEvaluate(w,I,H){const q=new Mo(this._properties);for(const ee of Object.keys(this._values))q._values[ee]=this._values[ee].possiblyEvaluate(w,I,H);return q}}class zs{constructor(w,I,H){this.property=w,this.value=I,this.parameters=H}isConstant(){return this.value.kind==="constant"}constantOr(w){return this.value.kind==="constant"?this.value.value:w}evaluate(w,I,H,q){return this.property.evaluate(this.value,this.parameters,w,I,H,q)}}class Mo{constructor(w){this._properties=w,this._values=Object.create(w.defaultPossiblyEvaluatedValues)}get(w){return this._values[w]}}class Fi{constructor(w){this.specification=w}possiblyEvaluate(w,I){if(w.isDataDriven())throw new Error("Value should not be data driven");return w.expression.evaluate(I)}interpolate(w,I,H){const q=ks[this.specification.type];return q?q(w,I,H):w}}class Ni{constructor(w,I){this.specification=w,this.overrides=I}possiblyEvaluate(w,I,H,q){return new zs(this,w.expression.kind==="constant"||w.expression.kind==="camera"?{kind:"constant",value:w.expression.evaluate(I,null,{},H,q)}:w.expression,I)}interpolate(w,I,H){if(w.value.kind!=="constant"||I.value.kind!=="constant")return w;if(w.value.value===void 0||I.value.value===void 0)return new zs(this,{kind:"constant",value:void 0},w.parameters);const q=ks[this.specification.type];if(q){const ee=q(w.value.value,I.value.value,H);return new zs(this,{kind:"constant",value:ee},w.parameters)}return w}evaluate(w,I,H,q,ee,ie){return w.kind==="constant"?w.value:w.evaluate(I,H,q,ee,ie)}}class $o extends Ni{possiblyEvaluate(w,I,H,q){if(w.value===void 0)return new zs(this,{kind:"constant",value:void 0},I);if(w.expression.kind==="constant"){const ee=w.expression.evaluate(I,null,{},H,q),ie=w.property.specification.type==="resolvedImage"&&typeof ee!="string"?ee.name:ee,oe=this._calculate(ie,ie,ie,I);return new zs(this,{kind:"constant",value:oe},I)}if(w.expression.kind==="camera"){const ee=this._calculate(w.expression.evaluate({zoom:I.zoom-1}),w.expression.evaluate({zoom:I.zoom}),w.expression.evaluate({zoom:I.zoom+1}),I);return new zs(this,{kind:"constant",value:ee},I)}return new zs(this,w.expression,I)}evaluate(w,I,H,q,ee,ie){if(w.kind==="source"){const oe=w.evaluate(I,H,q,ee,ie);return this._calculate(oe,oe,oe,I)}return w.kind==="composite"?this._calculate(w.evaluate({zoom:Math.floor(I.zoom)-1},H,q),w.evaluate({zoom:Math.floor(I.zoom)},H,q),w.evaluate({zoom:Math.floor(I.zoom)+1},H,q),I):w.value}_calculate(w,I,H,q){return q.zoom>q.zoomHistory.lastIntegerZoom?{from:w,to:I}:{from:H,to:I}}interpolate(w){return w}}class vl{constructor(w){this.specification=w}possiblyEvaluate(w,I,H,q){if(w.value!==void 0){if(w.expression.kind==="constant"){const ee=w.expression.evaluate(I,null,{},H,q);return this._calculate(ee,ee,ee,I)}return this._calculate(w.expression.evaluate(new Er(Math.floor(I.zoom-1),I)),w.expression.evaluate(new Er(Math.floor(I.zoom),I)),w.expression.evaluate(new Er(Math.floor(I.zoom+1),I)),I)}}_calculate(w,I,H,q){return q.zoom>q.zoomHistory.lastIntegerZoom?{from:w,to:I}:{from:H,to:I}}interpolate(w){return w}}class bl{constructor(w){this.specification=w}possiblyEvaluate(w,I,H,q){return!!w.expression.evaluate(I,null,{},H,q)}interpolate(){return!1}}class Ns{constructor(w){this.properties=w,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const I in w){const H=w[I];H.specification.overridable&&this.overridableProperties.push(I);const q=this.defaultPropertyValues[I]=new ga(H,void 0),ee=this.defaultTransitionablePropertyValues[I]=new vn(H);this.defaultTransitioningPropertyValues[I]=ee.untransitioned(),this.defaultPossiblyEvaluatedValues[I]=q.possiblyEvaluate({})}}}gi("DataDrivenProperty",Ni),gi("DataConstantProperty",Fi),gi("CrossFadedDataDrivenProperty",$o),gi("CrossFadedProperty",vl),gi("ColorRampProperty",bl);const za="-transition";class Dn extends Ue{constructor(w,I){if(super(),this.id=w.id,this.type=w.type,this._featureFilter={filter:()=>!0,needGeometry:!1},w.type!=="custom"&&(this.metadata=w.metadata,this.minzoom=w.minzoom,this.maxzoom=w.maxzoom,w.type!=="background"&&(this.source=w.source,this.sourceLayer=w["source-layer"],this.filter=w.filter),I.layout&&(this._unevaluatedLayout=new yl(I.layout)),I.paint)){this._transitionablePaint=new Jo(I.paint);for(const H in w.paint)this.setPaintProperty(H,w.paint[H],{validate:!1});for(const H in w.layout)this.setLayoutProperty(H,w.layout[H],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Mo(I.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(w){return w==="visibility"?this.visibility:this._unevaluatedLayout.getValue(w)}setLayoutProperty(w,I,H={}){I!=null&&this._validate(Zo,`layers.${this.id}.layout.${w}`,w,I,H)||(w!=="visibility"?this._unevaluatedLayout.setValue(w,I):this.visibility=I)}getPaintProperty(w){return w.endsWith(za)?this._transitionablePaint.getTransition(w.slice(0,-11)):this._transitionablePaint.getValue(w)}setPaintProperty(w,I,H={}){if(I!=null&&this._validate(da,`layers.${this.id}.paint.${w}`,w,I,H))return!1;if(w.endsWith(za))return this._transitionablePaint.setTransition(w.slice(0,-11),I||void 0),!1;{const q=this._transitionablePaint._values[w],ee=q.property.specification["property-type"]==="cross-faded-data-driven",ie=q.value.isDataDriven(),oe=q.value;this._transitionablePaint.setValue(w,I),this._handleSpecialPaintPropertyUpdate(w);const de=this._transitionablePaint._values[w].value;return de.isDataDriven()||ie||ee||this._handleOverridablePaintPropertyUpdate(w,oe,de)}}_handleSpecialPaintPropertyUpdate(w){}_handleOverridablePaintPropertyUpdate(w,I,H){return!1}isHidden(w){return!!(this.minzoom&&w<this.minzoom)||!!(this.maxzoom&&w>=this.maxzoom)||this.visibility==="none"}updateTransitions(w){this._transitioningPaint=this._transitionablePaint.transitioned(w,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(w,I){w.getCrossfadeParameters&&(this._crossfadeParameters=w.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(w,void 0,I)),this.paint=this._transitioningPaint.possiblyEvaluate(w,void 0,I)}serialize(){const w={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(w.layout=w.layout||{},w.layout.visibility=this.visibility),ft(w,(I,H)=>!(I===void 0||H==="layout"&&!Object.keys(I).length||H==="paint"&&!Object.keys(I).length))}_validate(w,I,H,q,ee={}){return(!ee||ee.validate!==!1)&&Wn(this,w.call(Ra,{key:I,layerType:this.type,objectKey:H,value:q,styleSpec:me,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const w in this.paint._values){const I=this.paint.get(w);if(I instanceof zs&&Hn(I.property.specification)&&(I.value.kind==="source"||I.value.kind==="composite")&&I.value.isStateDependent)return!0}return!1}}const uA={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Po{constructor(w,I){this._structArray=w,this._pos1=I*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Vr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(w,I){return w._trim(),I&&(w.isTransferred=!0,I.push(w.arrayBuffer)),{length:w.length,arrayBuffer:w.arrayBuffer}}static deserialize(w){const I=Object.create(this.prototype);return I.arrayBuffer=w.arrayBuffer,I.length=w.length,I.capacity=w.arrayBuffer.byteLength/I.bytesPerElement,I._refreshViews(),I}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(w){this.reserve(w),this.length=w}reserve(w){if(w>this.capacity){this.capacity=Math.max(w,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const I=this.uint8;this._refreshViews(),I&&this.uint8.set(I)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ts(C,w=1){let I=0,H=0;return{members:C.map(q=>{const ee=uA[q.type].BYTES_PER_ELEMENT,ie=I=Kl(I,Math.max(w,ee)),oe=q.components||1;return H=Math.max(H,ee),I+=ee*oe,{name:q.name,type:q.type,components:oe,offset:ie}}),size:Kl(I,Math.max(H,w)),alignment:w}}function Kl(C,w){return Math.ceil(C/w)*w}class un extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(w,I){const H=this.length;return this.resize(H+1),this.emplace(H,w,I)}emplace(w,I,H){const q=2*w;return this.int16[q+0]=I,this.int16[q+1]=H,w}}un.prototype.bytesPerElement=4,gi("StructArrayLayout2i4",un);class Lo extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(w,I,H){const q=this.length;return this.resize(q+1),this.emplace(q,w,I,H)}emplace(w,I,H,q){const ee=3*w;return this.int16[ee+0]=I,this.int16[ee+1]=H,this.int16[ee+2]=q,w}}Lo.prototype.bytesPerElement=6,gi("StructArrayLayout3i6",Lo);class Qo extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(w,I,H,q){const ee=this.length;return this.resize(ee+1),this.emplace(ee,w,I,H,q)}emplace(w,I,H,q,ee){const ie=4*w;return this.int16[ie+0]=I,this.int16[ie+1]=H,this.int16[ie+2]=q,this.int16[ie+3]=ee,w}}Qo.prototype.bytesPerElement=8,gi("StructArrayLayout4i8",Qo);class el extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(w,I,H,q,ee,ie){const oe=this.length;return this.resize(oe+1),this.emplace(oe,w,I,H,q,ee,ie)}emplace(w,I,H,q,ee,ie,oe){const de=6*w;return this.int16[de+0]=I,this.int16[de+1]=H,this.int16[de+2]=q,this.int16[de+3]=ee,this.int16[de+4]=ie,this.int16[de+5]=oe,w}}el.prototype.bytesPerElement=12,gi("StructArrayLayout2i4i12",el);class Oo extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(w,I,H,q,ee,ie){const oe=this.length;return this.resize(oe+1),this.emplace(oe,w,I,H,q,ee,ie)}emplace(w,I,H,q,ee,ie,oe){const de=4*w,_e=8*w;return this.int16[de+0]=I,this.int16[de+1]=H,this.uint8[_e+4]=q,this.uint8[_e+5]=ee,this.uint8[_e+6]=ie,this.uint8[_e+7]=oe,w}}Oo.prototype.bytesPerElement=8,gi("StructArrayLayout2i4ub8",Oo);class Ro extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(w,I){const H=this.length;return this.resize(H+1),this.emplace(H,w,I)}emplace(w,I,H){const q=2*w;return this.float32[q+0]=I,this.float32[q+1]=H,w}}Ro.prototype.bytesPerElement=8,gi("StructArrayLayout2f8",Ro);class uo extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(w,I,H,q,ee,ie,oe,de,_e,Ee){const Fe=this.length;return this.resize(Fe+1),this.emplace(Fe,w,I,H,q,ee,ie,oe,de,_e,Ee)}emplace(w,I,H,q,ee,ie,oe,de,_e,Ee,Fe){const Pe=10*w;return this.uint16[Pe+0]=I,this.uint16[Pe+1]=H,this.uint16[Pe+2]=q,this.uint16[Pe+3]=ee,this.uint16[Pe+4]=ie,this.uint16[Pe+5]=oe,this.uint16[Pe+6]=de,this.uint16[Pe+7]=_e,this.uint16[Pe+8]=Ee,this.uint16[Pe+9]=Fe,w}}uo.prototype.bytesPerElement=20,gi("StructArrayLayout10ui20",uo);class Na extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(w,I,H,q,ee,ie,oe,de,_e,Ee,Fe,Pe){const He=this.length;return this.resize(He+1),this.emplace(He,w,I,H,q,ee,ie,oe,de,_e,Ee,Fe,Pe)}emplace(w,I,H,q,ee,ie,oe,de,_e,Ee,Fe,Pe,He){const Ne=12*w;return this.int16[Ne+0]=I,this.int16[Ne+1]=H,this.int16[Ne+2]=q,this.int16[Ne+3]=ee,this.uint16[Ne+4]=ie,this.uint16[Ne+5]=oe,this.uint16[Ne+6]=de,this.uint16[Ne+7]=_e,this.int16[Ne+8]=Ee,this.int16[Ne+9]=Fe,this.int16[Ne+10]=Pe,this.int16[Ne+11]=He,w}}Na.prototype.bytesPerElement=24,gi("StructArrayLayout4i4ui4i24",Na);class wl extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(w,I,H){const q=this.length;return this.resize(q+1),this.emplace(q,w,I,H)}emplace(w,I,H,q){const ee=3*w;return this.float32[ee+0]=I,this.float32[ee+1]=H,this.float32[ee+2]=q,w}}wl.prototype.bytesPerElement=12,gi("StructArrayLayout3f12",wl);class tl extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(w){const I=this.length;return this.resize(I+1),this.emplace(I,w)}emplace(w,I){return this.uint32[1*w+0]=I,w}}tl.prototype.bytesPerElement=4,gi("StructArrayLayout1ul4",tl);class Va extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(w,I,H,q,ee,ie,oe,de,_e){const Ee=this.length;return this.resize(Ee+1),this.emplace(Ee,w,I,H,q,ee,ie,oe,de,_e)}emplace(w,I,H,q,ee,ie,oe,de,_e,Ee){const Fe=10*w,Pe=5*w;return this.int16[Fe+0]=I,this.int16[Fe+1]=H,this.int16[Fe+2]=q,this.int16[Fe+3]=ee,this.int16[Fe+4]=ie,this.int16[Fe+5]=oe,this.uint32[Pe+3]=de,this.uint16[Fe+8]=_e,this.uint16[Fe+9]=Ee,w}}Va.prototype.bytesPerElement=20,gi("StructArrayLayout6i1ul2ui20",Va);class xl extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(w,I,H,q,ee,ie){const oe=this.length;return this.resize(oe+1),this.emplace(oe,w,I,H,q,ee,ie)}emplace(w,I,H,q,ee,ie,oe){const de=6*w;return this.int16[de+0]=I,this.int16[de+1]=H,this.int16[de+2]=q,this.int16[de+3]=ee,this.int16[de+4]=ie,this.int16[de+5]=oe,w}}xl.prototype.bytesPerElement=12,gi("StructArrayLayout2i2i2i12",xl);class Bl extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(w,I,H,q,ee){const ie=this.length;return this.resize(ie+1),this.emplace(ie,w,I,H,q,ee)}emplace(w,I,H,q,ee,ie){const oe=4*w,de=8*w;return this.float32[oe+0]=I,this.float32[oe+1]=H,this.float32[oe+2]=q,this.int16[de+6]=ee,this.int16[de+7]=ie,w}}Bl.prototype.bytesPerElement=16,gi("StructArrayLayout2f1f2i16",Bl);class il extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(w,I,H,q){const ee=this.length;return this.resize(ee+1),this.emplace(ee,w,I,H,q)}emplace(w,I,H,q,ee){const ie=12*w,oe=3*w;return this.uint8[ie+0]=I,this.uint8[ie+1]=H,this.float32[oe+1]=q,this.float32[oe+2]=ee,w}}il.prototype.bytesPerElement=12,gi("StructArrayLayout2ub2f12",il);class rl extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(w,I,H){const q=this.length;return this.resize(q+1),this.emplace(q,w,I,H)}emplace(w,I,H,q){const ee=3*w;return this.uint16[ee+0]=I,this.uint16[ee+1]=H,this.uint16[ee+2]=q,w}}rl.prototype.bytesPerElement=6,gi("StructArrayLayout3ui6",rl);class Cl extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(w,I,H,q,ee,ie,oe,de,_e,Ee,Fe,Pe,He,Ne,tt,at,ct){const mt=this.length;return this.resize(mt+1),this.emplace(mt,w,I,H,q,ee,ie,oe,de,_e,Ee,Fe,Pe,He,Ne,tt,at,ct)}emplace(w,I,H,q,ee,ie,oe,de,_e,Ee,Fe,Pe,He,Ne,tt,at,ct,mt){const ht=24*w,bt=12*w,Ct=48*w;return this.int16[ht+0]=I,this.int16[ht+1]=H,this.uint16[ht+2]=q,this.uint16[ht+3]=ee,this.uint32[bt+2]=ie,this.uint32[bt+3]=oe,this.uint32[bt+4]=de,this.uint16[ht+10]=_e,this.uint16[ht+11]=Ee,this.uint16[ht+12]=Fe,this.float32[bt+7]=Pe,this.float32[bt+8]=He,this.uint8[Ct+36]=Ne,this.uint8[Ct+37]=tt,this.uint8[Ct+38]=at,this.uint32[bt+10]=ct,this.int16[ht+22]=mt,w}}Cl.prototype.bytesPerElement=48,gi("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Cl);class xr extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(w,I,H,q,ee,ie,oe,de,_e,Ee,Fe,Pe,He,Ne,tt,at,ct,mt,ht,bt,Ct,Qt,fi,Ci,ui,li,ti,yi){const si=this.length;return this.resize(si+1),this.emplace(si,w,I,H,q,ee,ie,oe,de,_e,Ee,Fe,Pe,He,Ne,tt,at,ct,mt,ht,bt,Ct,Qt,fi,Ci,ui,li,ti,yi)}emplace(w,I,H,q,ee,ie,oe,de,_e,Ee,Fe,Pe,He,Ne,tt,at,ct,mt,ht,bt,Ct,Qt,fi,Ci,ui,li,ti,yi,si){const Gt=32*w,Pi=16*w;return this.int16[Gt+0]=I,this.int16[Gt+1]=H,this.int16[Gt+2]=q,this.int16[Gt+3]=ee,this.int16[Gt+4]=ie,this.int16[Gt+5]=oe,this.int16[Gt+6]=de,this.int16[Gt+7]=_e,this.uint16[Gt+8]=Ee,this.uint16[Gt+9]=Fe,this.uint16[Gt+10]=Pe,this.uint16[Gt+11]=He,this.uint16[Gt+12]=Ne,this.uint16[Gt+13]=tt,this.uint16[Gt+14]=at,this.uint16[Gt+15]=ct,this.uint16[Gt+16]=mt,this.uint16[Gt+17]=ht,this.uint16[Gt+18]=bt,this.uint16[Gt+19]=Ct,this.uint16[Gt+20]=Qt,this.uint16[Gt+21]=fi,this.uint16[Gt+22]=Ci,this.uint32[Pi+12]=ui,this.float32[Pi+13]=li,this.float32[Pi+14]=ti,this.uint16[Gt+30]=yi,this.uint16[Gt+31]=si,w}}xr.prototype.bytesPerElement=64,gi("StructArrayLayout8i15ui1ul2f2ui64",xr);class J extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(w){const I=this.length;return this.resize(I+1),this.emplace(I,w)}emplace(w,I){return this.float32[1*w+0]=I,w}}J.prototype.bytesPerElement=4,gi("StructArrayLayout1f4",J);class x extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(w,I,H){const q=this.length;return this.resize(q+1),this.emplace(q,w,I,H)}emplace(w,I,H,q){const ee=3*w;return this.uint16[6*w+0]=I,this.float32[ee+1]=H,this.float32[ee+2]=q,w}}x.prototype.bytesPerElement=12,gi("StructArrayLayout1ui2f12",x);class Q extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(w,I,H){const q=this.length;return this.resize(q+1),this.emplace(q,w,I,H)}emplace(w,I,H,q){const ee=4*w;return this.uint32[2*w+0]=I,this.uint16[ee+2]=H,this.uint16[ee+3]=q,w}}Q.prototype.bytesPerElement=8,gi("StructArrayLayout1ul2ui8",Q);class G extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(w,I){const H=this.length;return this.resize(H+1),this.emplace(H,w,I)}emplace(w,I,H){const q=2*w;return this.uint16[q+0]=I,this.uint16[q+1]=H,w}}G.prototype.bytesPerElement=4,gi("StructArrayLayout2ui4",G);class X extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(w){const I=this.length;return this.resize(I+1),this.emplace(I,w)}emplace(w,I){return this.uint16[1*w+0]=I,w}}X.prototype.bytesPerElement=2,gi("StructArrayLayout1ui2",X);class te extends Vr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(w,I,H,q){const ee=this.length;return this.resize(ee+1),this.emplace(ee,w,I,H,q)}emplace(w,I,H,q,ee){const ie=4*w;return this.float32[ie+0]=I,this.float32[ie+1]=H,this.float32[ie+2]=q,this.float32[ie+3]=ee,w}}te.prototype.bytesPerElement=16,gi("StructArrayLayout4f16",te);class Ae extends Po{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ge(this.anchorPointX,this.anchorPointY)}}Ae.prototype.size=20;class he extends Va{get(w){return new Ae(this,w)}}gi("CollisionBoxArray",he);class pe extends Po{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(w){this._structArray.uint8[this._pos1+37]=w}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(w){this._structArray.uint8[this._pos1+38]=w}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(w){this._structArray.uint32[this._pos4+10]=w}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}pe.prototype.size=48;class ve extends Cl{get(w){return new pe(this,w)}}gi("PlacedSymbolArray",ve);class Ce extends Po{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(w){this._structArray.uint32[this._pos4+12]=w}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Ce.prototype.size=64;class Se extends xr{get(w){return new Ce(this,w)}}gi("SymbolInstanceArray",Se);class Qe extends J{getoffsetX(w){return this.float32[1*w+0]}}gi("GlyphOffsetArray",Qe);class $e extends Lo{getx(w){return this.int16[3*w+0]}gety(w){return this.int16[3*w+1]}gettileUnitDistanceFromAnchor(w){return this.int16[3*w+2]}}gi("SymbolLineVertexArray",$e);class Ze extends Po{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Ze.prototype.size=12;class rt extends x{get(w){return new Ze(this,w)}}gi("TextAnchorOffsetArray",rt);class Ye extends Po{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ye.prototype.size=8;class dt extends Q{get(w){return new Ye(this,w)}}gi("FeatureIndexArray",dt);class Bt extends un{}class ot extends un{}class gt extends un{}class St extends el{}class It extends Oo{}class Lt extends Ro{}class Kt extends uo{}class Rt extends Na{}class Jt extends wl{}class Bi extends tl{}class ar extends xl{}class oi extends il{}class ki extends rl{}class xi extends G{}const Hr=ts([{name:"a_pos",components:2,type:"Int16"}],4),{members:or}=Hr;class Mi{constructor(w=[]){this.segments=w}prepareSegment(w,I,H,q){let ee=this.segments[this.segments.length-1];return w>Mi.MAX_VERTEX_ARRAY_LENGTH&&Vt(`Max vertices per segment is ${Mi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${w}`),(!ee||ee.vertexLength+w>Mi.MAX_VERTEX_ARRAY_LENGTH||ee.sortKey!==q)&&(ee={vertexOffset:I.length,primitiveOffset:H.length,vertexLength:0,primitiveLength:0},q!==void 0&&(ee.sortKey=q),this.segments.push(ee)),ee}get(){return this.segments}destroy(){for(const w of this.segments)for(const I in w.vaos)w.vaos[I].destroy()}static simpleSegment(w,I,H,q){return new Mi([{vertexOffset:w,primitiveOffset:I,vertexLength:H,primitiveLength:q,vaos:{},sortKey:0}])}}function lr(C,w){return 256*(C=We(Math.floor(C),0,255))+We(Math.floor(w),0,255)}Mi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,gi("SegmentVector",Mi);const Kr=ts([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var kr={exports:{}},rn={exports:{}};rn.exports=function(C,w){var I,H,q,ee,ie,oe,de,_e;for(H=C.length-(I=3&C.length),q=w,ie=3432918353,oe=461845907,_e=0;_e<H;)de=255&C.charCodeAt(_e)|(255&C.charCodeAt(++_e))<<8|(255&C.charCodeAt(++_e))<<16|(255&C.charCodeAt(++_e))<<24,++_e,q=27492+(65535&(ee=5*(65535&(q=(q^=de=(65535&(de=(de=(65535&de)*ie+(((de>>>16)*ie&65535)<<16)&4294967295)<<15|de>>>17))*oe+(((de>>>16)*oe&65535)<<16)&4294967295)<<13|q>>>19))+((5*(q>>>16)&65535)<<16)&4294967295))+((58964+(ee>>>16)&65535)<<16);switch(de=0,I){case 3:de^=(255&C.charCodeAt(_e+2))<<16;case 2:de^=(255&C.charCodeAt(_e+1))<<8;case 1:q^=de=(65535&(de=(de=(65535&(de^=255&C.charCodeAt(_e)))*ie+(((de>>>16)*ie&65535)<<16)&4294967295)<<15|de>>>17))*oe+(((de>>>16)*oe&65535)<<16)&4294967295}return q^=C.length,q=2246822507*(65535&(q^=q>>>16))+((2246822507*(q>>>16)&65535)<<16)&4294967295,q=3266489909*(65535&(q^=q>>>13))+((3266489909*(q>>>16)&65535)<<16)&4294967295,(q^=q>>>16)>>>0};var ws=rn.exports,Zr={exports:{}};Zr.exports=function(C,w){for(var I,H=C.length,q=w^H,ee=0;H>=4;)I=1540483477*(65535&(I=255&C.charCodeAt(ee)|(255&C.charCodeAt(++ee))<<8|(255&C.charCodeAt(++ee))<<16|(255&C.charCodeAt(++ee))<<24))+((1540483477*(I>>>16)&65535)<<16),q=1540483477*(65535&q)+((1540483477*(q>>>16)&65535)<<16)^(I=1540483477*(65535&(I^=I>>>24))+((1540483477*(I>>>16)&65535)<<16)),H-=4,++ee;switch(H){case 3:q^=(255&C.charCodeAt(ee+2))<<16;case 2:q^=(255&C.charCodeAt(ee+1))<<8;case 1:q=1540483477*(65535&(q^=255&C.charCodeAt(ee)))+((1540483477*(q>>>16)&65535)<<16)}return q=1540483477*(65535&(q^=q>>>13))+((1540483477*(q>>>16)&65535)<<16),(q^=q>>>15)>>>0};var Vs=ws,Un=Zr.exports;kr.exports=Vs,kr.exports.murmur3=Vs,kr.exports.murmur2=Un;var bn=ne(kr.exports);class Mn{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(w,I,H,q){this.ids.push(fo(w)),this.positions.push(I,H,q)}getPositions(w){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const I=fo(w);let H=0,q=this.ids.length-1;for(;H<q;){const ie=H+q>>1;this.ids[ie]>=I?q=ie:H=ie+1}const ee=[];for(;this.ids[H]===I;)ee.push({index:this.positions[3*H],start:this.positions[3*H+1],end:this.positions[3*H+2]}),H++;return ee}static serialize(w,I){const H=new Float64Array(w.ids),q=new Uint32Array(w.positions);return ma(H,q,0,H.length-1),I&&I.push(H.buffer,q.buffer),{ids:H,positions:q}}static deserialize(w){const I=new Mn;return I.ids=w.ids,I.positions=w.positions,I.indexed=!0,I}}function fo(C){const w=+C;return!isNaN(w)&&w<=Number.MAX_SAFE_INTEGER?w:bn(String(C))}function ma(C,w,I,H){for(;I<H;){const q=C[I+H>>1];let ee=I-1,ie=H+1;for(;;){do ee++;while(C[ee]<q);do ie--;while(C[ie]>q);if(ee>=ie)break;Xn(C,ee,ie),Xn(w,3*ee,3*ie),Xn(w,3*ee+1,3*ie+1),Xn(w,3*ee+2,3*ie+2)}ie-I<H-ie?(ma(C,w,I,ie),I=ie+1):(ma(C,w,ie+1,H),H=ie)}}function Xn(C,w,I){const H=C[w];C[w]=C[I],C[I]=H}gi("FeaturePositionMap",Mn);class is{constructor(w,I){this.gl=w.gl,this.location=I}}class cs extends is{constructor(w,I){super(w,I),this.current=0}set(w){this.current!==w&&(this.current=w,this.gl.uniform1f(this.location,w))}}class Cs extends is{constructor(w,I){super(w,I),this.current=[0,0,0,0]}set(w){w[0]===this.current[0]&&w[1]===this.current[1]&&w[2]===this.current[2]&&w[3]===this.current[3]||(this.current=w,this.gl.uniform4f(this.location,w[0],w[1],w[2],w[3]))}}class po extends is{constructor(w,I){super(w,I),this.current=wi.transparent}set(w){w.r===this.current.r&&w.g===this.current.g&&w.b===this.current.b&&w.a===this.current.a||(this.current=w,this.gl.uniform4f(this.location,w.r,w.g,w.b,w.a))}}const hs=new Float32Array(16);function as(C){return[lr(255*C.r,255*C.g),lr(255*C.b,255*C.a)]}class Es{constructor(w,I,H){this.value=w,this.uniformNames=I.map(q=>`u_${q}`),this.type=H}setUniform(w,I,H){w.set(H.constantOr(this.value))}getBinding(w,I,H){return this.type==="color"?new po(w,I):new cs(w,I)}}class Gr{constructor(w,I){this.uniformNames=I.map(H=>`u_${H}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(w,I){this.pixelRatioFrom=I.pixelRatio,this.pixelRatioTo=w.pixelRatio,this.patternFrom=I.tlbr,this.patternTo=w.tlbr}setUniform(w,I,H,q){const ee=q==="u_pattern_to"?this.patternTo:q==="u_pattern_from"?this.patternFrom:q==="u_pixel_ratio_to"?this.pixelRatioTo:q==="u_pixel_ratio_from"?this.pixelRatioFrom:null;ee&&w.set(ee)}getBinding(w,I,H){return H.substr(0,9)==="u_pattern"?new Cs(w,I):new cs(w,I)}}class Yn{constructor(w,I,H,q){this.expression=w,this.type=H,this.maxValue=0,this.paintVertexAttributes=I.map(ee=>({name:`a_${ee}`,type:"Float32",components:H==="color"?2:1,offset:0})),this.paintVertexArray=new q}populatePaintArray(w,I,H,q,ee){const ie=this.paintVertexArray.length,oe=this.expression.evaluate(new Er(0),I,{},q,[],ee);this.paintVertexArray.resize(w),this._setPaintValue(ie,w,oe)}updatePaintArray(w,I,H,q){const ee=this.expression.evaluate({zoom:0},H,q);this._setPaintValue(w,I,ee)}_setPaintValue(w,I,H){if(this.type==="color"){const q=as(H);for(let ee=w;ee<I;ee++)this.paintVertexArray.emplace(ee,q[0],q[1])}else{for(let q=w;q<I;q++)this.paintVertexArray.emplace(q,H);this.maxValue=Math.max(this.maxValue,Math.abs(H))}}upload(w){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=w.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class wn{constructor(w,I,H,q,ee,ie){this.expression=w,this.uniformNames=I.map(oe=>`u_${oe}_t`),this.type=H,this.useIntegerZoom=q,this.zoom=ee,this.maxValue=0,this.paintVertexAttributes=I.map(oe=>({name:`a_${oe}`,type:"Float32",components:H==="color"?4:2,offset:0})),this.paintVertexArray=new ie}populatePaintArray(w,I,H,q,ee){const ie=this.expression.evaluate(new Er(this.zoom),I,{},q,[],ee),oe=this.expression.evaluate(new Er(this.zoom+1),I,{},q,[],ee),de=this.paintVertexArray.length;this.paintVertexArray.resize(w),this._setPaintValue(de,w,ie,oe)}updatePaintArray(w,I,H,q){const ee=this.expression.evaluate({zoom:this.zoom},H,q),ie=this.expression.evaluate({zoom:this.zoom+1},H,q);this._setPaintValue(w,I,ee,ie)}_setPaintValue(w,I,H,q){if(this.type==="color"){const ee=as(H),ie=as(q);for(let oe=w;oe<I;oe++)this.paintVertexArray.emplace(oe,ee[0],ee[1],ie[0],ie[1])}else{for(let ee=w;ee<I;ee++)this.paintVertexArray.emplace(ee,H,q);this.maxValue=Math.max(this.maxValue,Math.abs(H),Math.abs(q))}}upload(w){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=w.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(w,I){const H=this.useIntegerZoom?Math.floor(I.zoom):I.zoom,q=We(this.expression.interpolationFactor(H,this.zoom,this.zoom+1),0,1);w.set(q)}getBinding(w,I,H){return new cs(w,I)}}class _a{constructor(w,I,H,q,ee,ie){this.expression=w,this.type=I,this.useIntegerZoom=H,this.zoom=q,this.layerId=ie,this.zoomInPaintVertexArray=new ee,this.zoomOutPaintVertexArray=new ee}populatePaintArray(w,I,H){const q=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(w),this.zoomOutPaintVertexArray.resize(w),this._setPaintValues(q,w,I.patterns&&I.patterns[this.layerId],H)}updatePaintArray(w,I,H,q,ee){this._setPaintValues(w,I,H.patterns&&H.patterns[this.layerId],ee)}_setPaintValues(w,I,H,q){if(!q||!H)return;const{min:ee,mid:ie,max:oe}=H,de=q[ee],_e=q[ie],Ee=q[oe];if(de&&_e&&Ee)for(let Fe=w;Fe<I;Fe++)this.zoomInPaintVertexArray.emplace(Fe,_e.tl[0],_e.tl[1],_e.br[0],_e.br[1],de.tl[0],de.tl[1],de.br[0],de.br[1],_e.pixelRatio,de.pixelRatio),this.zoomOutPaintVertexArray.emplace(Fe,_e.tl[0],_e.tl[1],_e.br[0],_e.br[1],Ee.tl[0],Ee.tl[1],Ee.br[0],Ee.br[1],_e.pixelRatio,Ee.pixelRatio)}upload(w){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=w.createVertexBuffer(this.zoomInPaintVertexArray,Kr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=w.createVertexBuffer(this.zoomOutPaintVertexArray,Kr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Gl{constructor(w,I,H){this.binders={},this._buffers=[];const q=[];for(const ee in w.paint._values){if(!H(ee))continue;const ie=w.paint.get(ee);if(!(ie instanceof zs&&Hn(ie.property.specification)))continue;const oe=fA(ee,w.type),de=ie.value,_e=ie.property.specification.type,Ee=ie.property.useIntegerZoom,Fe=ie.property.specification["property-type"],Pe=Fe==="cross-faded"||Fe==="cross-faded-data-driven";if(de.kind==="constant")this.binders[ee]=Pe?new Gr(de.value,oe):new Es(de.value,oe,_e),q.push(`/u_${ee}`);else if(de.kind==="source"||Pe){const He=Ga(ee,_e,"source");this.binders[ee]=Pe?new _a(de,_e,Ee,I,He,w.id):new Yn(de,oe,_e,He),q.push(`/a_${ee}`)}else{const He=Ga(ee,_e,"composite");this.binders[ee]=new wn(de,oe,_e,Ee,I,He),q.push(`/z_${ee}`)}}this.cacheKey=q.sort().join("")}getMaxValue(w){const I=this.binders[w];return I instanceof Yn||I instanceof wn?I.maxValue:0}populatePaintArrays(w,I,H,q,ee){for(const ie in this.binders){const oe=this.binders[ie];(oe instanceof Yn||oe instanceof wn||oe instanceof _a)&&oe.populatePaintArray(w,I,H,q,ee)}}setConstantPatternPositions(w,I){for(const H in this.binders){const q=this.binders[H];q instanceof Gr&&q.setConstantPatternPositions(w,I)}}updatePaintArrays(w,I,H,q,ee){let ie=!1;for(const oe in w){const de=I.getPositions(oe);for(const _e of de){const Ee=H.feature(_e.index);for(const Fe in this.binders){const Pe=this.binders[Fe];if((Pe instanceof Yn||Pe instanceof wn||Pe instanceof _a)&&Pe.expression.isStateDependent===!0){const He=q.paint.get(Fe);Pe.expression=He.value,Pe.updatePaintArray(_e.start,_e.end,Ee,w[oe],ee),ie=!0}}}}return ie}defines(){const w=[];for(const I in this.binders){const H=this.binders[I];(H instanceof Es||H instanceof Gr)&&w.push(...H.uniformNames.map(q=>`#define HAS_UNIFORM_${q}`))}return w}getBinderAttributes(){const w=[];for(const I in this.binders){const H=this.binders[I];if(H instanceof Yn||H instanceof wn)for(let q=0;q<H.paintVertexAttributes.length;q++)w.push(H.paintVertexAttributes[q].name);else if(H instanceof _a)for(let q=0;q<Kr.members.length;q++)w.push(Kr.members[q].name)}return w}getBinderUniforms(){const w=[];for(const I in this.binders){const H=this.binders[I];if(H instanceof Es||H instanceof Gr||H instanceof wn)for(const q of H.uniformNames)w.push(q)}return w}getPaintVertexBuffers(){return this._buffers}getUniforms(w,I){const H=[];for(const q in this.binders){const ee=this.binders[q];if(ee instanceof Es||ee instanceof Gr||ee instanceof wn){for(const ie of ee.uniformNames)if(I[ie]){const oe=ee.getBinding(w,I[ie],ie);H.push({name:ie,property:q,binding:oe})}}}return H}setUniforms(w,I,H,q){for(const{name:ee,property:ie,binding:oe}of I)this.binders[ie].setUniform(oe,q,H.get(ie),ee)}updatePaintBuffers(w){this._buffers=[];for(const I in this.binders){const H=this.binders[I];if(w&&H instanceof _a){const q=w.fromScale===2?H.zoomInPaintVertexBuffer:H.zoomOutPaintVertexBuffer;q&&this._buffers.push(q)}else(H instanceof Yn||H instanceof wn)&&H.paintVertexBuffer&&this._buffers.push(H.paintVertexBuffer)}}upload(w){for(const I in this.binders){const H=this.binders[I];(H instanceof Yn||H instanceof wn||H instanceof _a)&&H.upload(w)}this.updatePaintBuffers()}destroy(){for(const w in this.binders){const I=this.binders[w];(I instanceof Yn||I instanceof wn||I instanceof _a)&&I.destroy()}}}class Ka{constructor(w,I,H=()=>!0){this.programConfigurations={};for(const q of w)this.programConfigurations[q.id]=new Gl(q,I,H);this.needsUpload=!1,this._featureMap=new Mn,this._bufferOffset=0}populatePaintArrays(w,I,H,q,ee,ie){for(const oe in this.programConfigurations)this.programConfigurations[oe].populatePaintArrays(w,I,q,ee,ie);I.id!==void 0&&this._featureMap.add(I.id,H,this._bufferOffset,w),this._bufferOffset=w,this.needsUpload=!0}updatePaintArrays(w,I,H,q){for(const ee of H)this.needsUpload=this.programConfigurations[ee.id].updatePaintArrays(w,this._featureMap,I,ee,q)||this.needsUpload}get(w){return this.programConfigurations[w]}upload(w){if(this.needsUpload){for(const I in this.programConfigurations)this.programConfigurations[I].upload(w);this.needsUpload=!1}}destroy(){for(const w in this.programConfigurations)this.programConfigurations[w].destroy()}}function fA(C,w){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[C]||[C.replace(`${w}-`,"").replace(/-/g,"_")]}function Ga(C,w,I){const H={color:{source:Ro,composite:te},number:{source:J,composite:Ro}},q=function(ee){return{"line-pattern":{source:Kt,composite:Kt},"fill-pattern":{source:Kt,composite:Kt},"fill-extrusion-pattern":{source:Kt,composite:Kt}}[ee]}(C);return q&&q[I]||H[w][I]}gi("ConstantBinder",Es),gi("CrossFadedConstantBinder",Gr),gi("SourceExpressionBinder",Yn),gi("CrossFadedCompositeBinder",_a),gi("CompositeExpressionBinder",wn),gi("ProgramConfiguration",Gl,{omit:["_buffers"]}),gi("ProgramConfigurationSet",Ka);const Xr=8192,sl=Math.pow(2,14)-1,El=-sl-1;function jn(C){const w=Xr/C.extent,I=C.loadGeometry();for(let H=0;H<I.length;H++){const q=I[H];for(let ee=0;ee<q.length;ee++){const ie=q[ee],oe=Math.round(ie.x*w),de=Math.round(ie.y*w);ie.x=We(oe,El,sl),ie.y=We(de,El,sl),(oe<ie.x||oe>ie.x+1||de<ie.y||de>ie.y+1)&&Vt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return I}function ya(C,w){return{type:C.type,id:C.id,properties:C.properties,geometry:w?jn(C):[]}}function go(C,w,I,H,q){C.emplaceBack(2*w+(H+1)/2,2*I+(q+1)/2)}class dA{constructor(w){this.zoom=w.zoom,this.overscaling=w.overscaling,this.layers=w.layers,this.layerIds=this.layers.map(I=>I.id),this.index=w.index,this.hasPattern=!1,this.layoutVertexArray=new ot,this.indexArray=new ki,this.segments=new Mi,this.programConfigurations=new Ka(w.layers,w.zoom),this.stateDependentLayerIds=this.layers.filter(I=>I.isStateDependent()).map(I=>I.id)}populate(w,I,H){const q=this.layers[0],ee=[];let ie=null,oe=!1;q.type==="circle"&&(ie=q.layout.get("circle-sort-key"),oe=!ie.isConstant());for(const{feature:de,id:_e,index:Ee,sourceLayerIndex:Fe}of w){const Pe=this.layers[0]._featureFilter.needGeometry,He=ya(de,Pe);if(!this.layers[0]._featureFilter.filter(new Er(this.zoom),He,H))continue;const Ne=oe?ie.evaluate(He,{},H):void 0,tt={id:_e,properties:de.properties,type:de.type,sourceLayerIndex:Fe,index:Ee,geometry:Pe?He.geometry:jn(de),patterns:{},sortKey:Ne};ee.push(tt)}oe&&ee.sort((de,_e)=>de.sortKey-_e.sortKey);for(const de of ee){const{geometry:_e,index:Ee,sourceLayerIndex:Fe}=de,Pe=w[Ee].feature;this.addFeature(de,_e,Ee,H),I.featureIndex.insert(Pe,_e,Ee,Fe,this.index)}}update(w,I,H){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(w,I,this.stateDependentLayers,H)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(w){this.uploaded||(this.layoutVertexBuffer=w.createVertexBuffer(this.layoutVertexArray,or),this.indexBuffer=w.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(w),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(w,I,H,q){for(const ee of I)for(const ie of ee){const oe=ie.x,de=ie.y;if(oe<0||oe>=Xr||de<0||de>=Xr)continue;const _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,w.sortKey),Ee=_e.vertexLength;go(this.layoutVertexArray,oe,de,-1,-1),go(this.layoutVertexArray,oe,de,1,-1),go(this.layoutVertexArray,oe,de,1,1),go(this.layoutVertexArray,oe,de,-1,1),this.indexArray.emplaceBack(Ee,Ee+1,Ee+2),this.indexArray.emplaceBack(Ee,Ee+3,Ee+2),_e.vertexLength+=4,_e.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,w,H,{},q)}}function sc(C,w){for(let I=0;I<C.length;I++)if(nl(w,C[I]))return!0;for(let I=0;I<w.length;I++)if(nl(C,w[I]))return!0;return!!pA(C,w)}function Lh(C,w,I){return!!nl(C,w)||!!gA(w,C,I)}function nc(C,w){if(C.length===1)return oc(w,C[0]);for(let I=0;I<w.length;I++){const H=w[I];for(let q=0;q<H.length;q++)if(nl(C,H[q]))return!0}for(let I=0;I<C.length;I++)if(oc(w,C[I]))return!0;for(let I=0;I<w.length;I++)if(pA(C,w[I]))return!0;return!1}function Qh(C,w,I){if(C.length>1){if(pA(C,w))return!0;for(let H=0;H<w.length;H++)if(gA(w[H],C,I))return!0}for(let H=0;H<C.length;H++)if(gA(C[H],w,I))return!0;return!1}function pA(C,w){if(C.length===0||w.length===0)return!1;for(let I=0;I<C.length-1;I++){const H=C[I],q=C[I+1];for(let ee=0;ee<w.length-1;ee++)if(Oh(H,q,w[ee],w[ee+1]))return!0}return!1}function Oh(C,w,I,H){return vt(C,I,H)!==vt(w,I,H)&&vt(C,w,I)!==vt(C,w,H)}function gA(C,w,I){const H=I*I;if(w.length===1)return C.distSqr(w[0])<H;for(let q=1;q<w.length;q++)if(ac(C,w[q-1],w[q])<H)return!0;return!1}function ac(C,w,I){const H=w.distSqr(I);if(H===0)return C.distSqr(w);const q=((C.x-w.x)*(I.x-w.x)+(C.y-w.y)*(I.y-w.y))/H;return C.distSqr(q<0?w:q>1?I:I.sub(w)._mult(q)._add(w))}function oc(C,w){let I,H,q,ee=!1;for(let ie=0;ie<C.length;ie++){I=C[ie];for(let oe=0,de=I.length-1;oe<I.length;de=oe++)H=I[oe],q=I[de],H.y>w.y!=q.y>w.y&&w.x<(q.x-H.x)*(w.y-H.y)/(q.y-H.y)+H.x&&(ee=!ee)}return ee}function nl(C,w){let I=!1;for(let H=0,q=C.length-1;H<C.length;q=H++){const ee=C[H],ie=C[q];ee.y>w.y!=ie.y>w.y&&w.x<(ie.x-ee.x)*(w.y-ee.y)/(ie.y-ee.y)+ee.x&&(I=!I)}return I}function Rh(C,w,I){const H=I[0],q=I[2];if(C.x<H.x&&w.x<H.x||C.x>q.x&&w.x>q.x||C.y<H.y&&w.y<H.y||C.y>q.y&&w.y>q.y)return!1;const ee=vt(C,w,I[0]);return ee!==vt(C,w,I[1])||ee!==vt(C,w,I[2])||ee!==vt(C,w,I[3])}function Tl(C,w,I){const H=w.paint.get(C).value;return H.kind==="constant"?H.value:I.programConfigurations.get(w.id).getMaxValue(C)}function Wl(C){return Math.sqrt(C[0]*C[0]+C[1]*C[1])}function ql(C,w,I,H,q){if(!w[0]&&!w[1])return C;const ee=ge.convert(w)._mult(q);I==="viewport"&&ee._rotate(-H);const ie=[];for(let oe=0;oe<C.length;oe++)ie.push(C[oe].sub(ee));return ie}let lc,Ac;gi("CircleBucket",dA,{omit:["layers"]});var Hh={get paint(){return Ac=Ac||new Ns({"circle-radius":new Ni(me.paint_circle["circle-radius"]),"circle-color":new Ni(me.paint_circle["circle-color"]),"circle-blur":new Ni(me.paint_circle["circle-blur"]),"circle-opacity":new Ni(me.paint_circle["circle-opacity"]),"circle-translate":new Fi(me.paint_circle["circle-translate"]),"circle-translate-anchor":new Fi(me.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Fi(me.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Fi(me.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ni(me.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ni(me.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ni(me.paint_circle["circle-stroke-opacity"])})},get layout(){return lc=lc||new Ns({"circle-sort-key":new Ni(me.layout_circle["circle-sort-key"])})}},Ks=1e-6,al=typeof Float32Array<"u"?Float32Array:Array;function mA(C){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function cc(C,w,I){var H=w[0],q=w[1],ee=w[2],ie=w[3],oe=w[4],de=w[5],_e=w[6],Ee=w[7],Fe=w[8],Pe=w[9],He=w[10],Ne=w[11],tt=w[12],at=w[13],ct=w[14],mt=w[15],ht=I[0],bt=I[1],Ct=I[2],Qt=I[3];return C[0]=ht*H+bt*oe+Ct*Fe+Qt*tt,C[1]=ht*q+bt*de+Ct*Pe+Qt*at,C[2]=ht*ee+bt*_e+Ct*He+Qt*ct,C[3]=ht*ie+bt*Ee+Ct*Ne+Qt*mt,C[4]=(ht=I[4])*H+(bt=I[5])*oe+(Ct=I[6])*Fe+(Qt=I[7])*tt,C[5]=ht*q+bt*de+Ct*Pe+Qt*at,C[6]=ht*ee+bt*_e+Ct*He+Qt*ct,C[7]=ht*ie+bt*Ee+Ct*Ne+Qt*mt,C[8]=(ht=I[8])*H+(bt=I[9])*oe+(Ct=I[10])*Fe+(Qt=I[11])*tt,C[9]=ht*q+bt*de+Ct*Pe+Qt*at,C[10]=ht*ee+bt*_e+Ct*He+Qt*ct,C[11]=ht*ie+bt*Ee+Ct*Ne+Qt*mt,C[12]=(ht=I[12])*H+(bt=I[13])*oe+(Ct=I[14])*Fe+(Qt=I[15])*tt,C[13]=ht*q+bt*de+Ct*Pe+Qt*at,C[14]=ht*ee+bt*_e+Ct*He+Qt*ct,C[15]=ht*ie+bt*Ee+Ct*Ne+Qt*mt,C}Math.hypot||(Math.hypot=function(){for(var C=0,w=arguments.length;w--;)C+=arguments[w]*arguments[w];return Math.sqrt(C)});var Sl,zh=cc;function Xl(C,w,I){var H=w[0],q=w[1],ee=w[2],ie=w[3];return C[0]=I[0]*H+I[4]*q+I[8]*ee+I[12]*ie,C[1]=I[1]*H+I[5]*q+I[9]*ee+I[13]*ie,C[2]=I[2]*H+I[6]*q+I[10]*ee+I[14]*ie,C[3]=I[3]*H+I[7]*q+I[11]*ee+I[15]*ie,C}Sl=new al(4),al!=Float32Array&&(Sl[0]=0,Sl[1]=0,Sl[2]=0,Sl[3]=0);class Nh extends Dn{constructor(w){super(w,Hh)}createBucket(w){return new dA(w)}queryRadius(w){const I=w;return Tl("circle-radius",this,I)+Tl("circle-stroke-width",this,I)+Wl(this.paint.get("circle-translate"))}queryIntersectsFeature(w,I,H,q,ee,ie,oe,de){const _e=ql(w,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),ie.angle,oe),Ee=this.paint.get("circle-radius").evaluate(I,H)+this.paint.get("circle-stroke-width").evaluate(I,H),Fe=this.paint.get("circle-pitch-alignment")==="map",Pe=Fe?_e:function(Ne,tt){return Ne.map(at=>hc(at,tt))}(_e,de),He=Fe?Ee*oe:Ee;for(const Ne of q)for(const tt of Ne){const at=Fe?tt:hc(tt,de);let ct=He;const mt=Xl([],[tt.x,tt.y,0,1],de);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ct*=mt[3]/ie.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ct*=ie.cameraToCenterDistance/mt[3]),Lh(Pe,at,ct))return!0}return!1}}function hc(C,w){const I=Xl([],[C.x,C.y,0,1],w);return new ge(I[0]/I[3],I[1]/I[3])}class uc extends dA{}let fc;gi("HeatmapBucket",uc,{omit:["layers"]});var Vh={get paint(){return fc=fc||new Ns({"heatmap-radius":new Ni(me.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ni(me.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Fi(me.paint_heatmap["heatmap-intensity"]),"heatmap-color":new bl(me.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Fi(me.paint_heatmap["heatmap-opacity"])})}};function _A(C,{width:w,height:I},H,q){if(q){if(q instanceof Uint8ClampedArray)q=new Uint8Array(q.buffer);else if(q.length!==w*I*H)throw new RangeError(`mismatched image size. expected: ${q.length} but got: ${w*I*H}`)}else q=new Uint8Array(w*I*H);return C.width=w,C.height=I,C.data=q,C}function dc(C,{width:w,height:I},H){if(w===C.width&&I===C.height)return;const q=_A({},{width:w,height:I},H);yA(C,q,{x:0,y:0},{x:0,y:0},{width:Math.min(C.width,w),height:Math.min(C.height,I)},H),C.width=w,C.height=I,C.data=q.data}function yA(C,w,I,H,q,ee){if(q.width===0||q.height===0)return w;if(q.width>C.width||q.height>C.height||I.x>C.width-q.width||I.y>C.height-q.height)throw new RangeError("out of range source coordinates for image copy");if(q.width>w.width||q.height>w.height||H.x>w.width-q.width||H.y>w.height-q.height)throw new RangeError("out of range destination coordinates for image copy");const ie=C.data,oe=w.data;if(ie===oe)throw new Error("srcData equals dstData, so image is already copied");for(let de=0;de<q.height;de++){const _e=((I.y+de)*C.width+I.x)*ee,Ee=((H.y+de)*w.width+H.x)*ee;for(let Fe=0;Fe<q.width*ee;Fe++)oe[Ee+Fe]=ie[_e+Fe]}return w}class Il{constructor(w,I){_A(this,w,1,I)}resize(w){dc(this,w,1)}clone(){return new Il({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(w,I,H,q,ee){yA(w,I,H,q,ee,1)}}class xn{constructor(w,I){_A(this,w,4,I)}resize(w){dc(this,w,4)}replace(w,I){I?this.data.set(w):this.data=w instanceof Uint8ClampedArray?new Uint8Array(w.buffer):w}clone(){return new xn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(w,I,H,q,ee){yA(w,I,H,q,ee,4)}}function pc(C){const w={},I=C.resolution||256,H=C.clips?C.clips.length:1,q=C.image||new xn({width:I,height:H});if(Math.log(I)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${I}`);const ee=(ie,oe,de)=>{w[C.evaluationKey]=de;const _e=C.expression.evaluate(w);q.data[ie+oe+0]=Math.floor(255*_e.r/_e.a),q.data[ie+oe+1]=Math.floor(255*_e.g/_e.a),q.data[ie+oe+2]=Math.floor(255*_e.b/_e.a),q.data[ie+oe+3]=Math.floor(255*_e.a)};if(C.clips)for(let ie=0,oe=0;ie<H;++ie,oe+=4*I)for(let de=0,_e=0;de<I;de++,_e+=4){const Ee=de/(I-1),{start:Fe,end:Pe}=C.clips[ie];ee(oe,_e,Fe*(1-Ee)+Pe*Ee)}else for(let ie=0,oe=0;ie<I;ie++,oe+=4)ee(0,oe,ie/(I-1));return q}gi("AlphaImage",Il),gi("RGBAImage",xn);class Kh extends Dn{createBucket(w){return new uc(w)}constructor(w){super(w,Vh),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(w){w==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=pc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let gc;var Gh={get paint(){return gc=gc||new Ns({"hillshade-illumination-direction":new Fi(me.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Fi(me.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Fi(me.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Fi(me.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Fi(me.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Fi(me.paint_hillshade["hillshade-accent-color"])})}};class Wh extends Dn{constructor(w){super(w,Gh)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const qh=ts([{name:"a_pos",components:2,type:"Int16"}],4),{members:Xh}=qh;var vA={exports:{}};function Yl(C,w,I){I=I||2;var H,q,ee,ie,oe,de,_e,Ee=w&&w.length,Fe=Ee?w[0]*I:C.length,Pe=mc(C,0,Fe,I,!0),He=[];if(!Pe||Pe.next===Pe.prev)return He;if(Ee&&(Pe=function(tt,at,ct,mt){var ht,bt,Ct,Qt=[];for(ht=0,bt=at.length;ht<bt;ht++)(Ct=mc(tt,at[ht]*mt,ht<bt-1?at[ht+1]*mt:tt.length,mt,!1))===Ct.next&&(Ct.steiner=!0),Qt.push(iu(Ct));for(Qt.sort($h),ht=0;ht<Qt.length;ht++)ct=eu(Qt[ht],ct);return ct}(C,w,Pe,I)),C.length>80*I){H=ee=C[0],q=ie=C[1];for(var Ne=I;Ne<Fe;Ne+=I)(oe=C[Ne])<H&&(H=oe),(de=C[Ne+1])<q&&(q=de),oe>ee&&(ee=oe),de>ie&&(ie=de);_e=(_e=Math.max(ee-H,ie-q))!==0?32767/_e:0}return Fl(Pe,He,I,H,q,_e,0),He}function mc(C,w,I,H,q){var ee,ie;if(q===xA(C,w,I,H)>0)for(ee=w;ee<I;ee+=H)ie=vc(ee,C[ee],C[ee+1],ie);else for(ee=I-H;ee>=w;ee-=H)ie=vc(ee,C[ee],C[ee+1],ie);return ie&&jl(ie,ie.next)&&(Dl(ie),ie=ie.next),ie}function Ho(C,w){if(!C)return C;w||(w=C);var I,H=C;do if(I=!1,H.steiner||!jl(H,H.next)&&rs(H.prev,H,H.next)!==0)H=H.next;else{if(Dl(H),(H=w=H.prev)===H.next)break;I=!0}while(I||H!==w);return w}function Fl(C,w,I,H,q,ee,ie){if(C){!ie&&ee&&function(Ee,Fe,Pe,He){var Ne=Ee;do Ne.z===0&&(Ne.z=bA(Ne.x,Ne.y,Fe,Pe,He)),Ne.prevZ=Ne.prev,Ne.nextZ=Ne.next,Ne=Ne.next;while(Ne!==Ee);Ne.prevZ.nextZ=null,Ne.prevZ=null,function(tt){var at,ct,mt,ht,bt,Ct,Qt,fi,Ci=1;do{for(ct=tt,tt=null,bt=null,Ct=0;ct;){for(Ct++,mt=ct,Qt=0,at=0;at<Ci&&(Qt++,mt=mt.nextZ);at++);for(fi=Ci;Qt>0||fi>0&&mt;)Qt!==0&&(fi===0||!mt||ct.z<=mt.z)?(ht=ct,ct=ct.nextZ,Qt--):(ht=mt,mt=mt.nextZ,fi--),bt?bt.nextZ=ht:tt=ht,ht.prevZ=bt,bt=ht;ct=mt}bt.nextZ=null,Ci*=2}while(Ct>1)}(Ne)}(C,H,q,ee);for(var oe,de,_e=C;C.prev!==C.next;)if(oe=C.prev,de=C.next,ee?jh(C,H,q,ee):Yh(C))w.push(oe.i/I|0),w.push(C.i/I|0),w.push(de.i/I|0),Dl(C),C=de.next,_e=de.next;else if((C=de)===_e){ie?ie===1?Fl(C=Zh(Ho(C),w,I),w,I,H,q,ee,2):ie===2&&Jh(C,w,I,H,q,ee):Fl(Ho(C),w,I,H,q,ee,1);break}}}function Yh(C){var w=C.prev,I=C,H=C.next;if(rs(w,I,H)>=0)return!1;for(var q=w.x,ee=I.x,ie=H.x,oe=w.y,de=I.y,_e=H.y,Ee=q<ee?q<ie?q:ie:ee<ie?ee:ie,Fe=oe<de?oe<_e?oe:_e:de<_e?de:_e,Pe=q>ee?q>ie?q:ie:ee>ie?ee:ie,He=oe>de?oe>_e?oe:_e:de>_e?de:_e,Ne=H.next;Ne!==w;){if(Ne.x>=Ee&&Ne.x<=Pe&&Ne.y>=Fe&&Ne.y<=He&&ol(q,oe,ee,de,ie,_e,Ne.x,Ne.y)&&rs(Ne.prev,Ne,Ne.next)>=0)return!1;Ne=Ne.next}return!0}function jh(C,w,I,H){var q=C.prev,ee=C,ie=C.next;if(rs(q,ee,ie)>=0)return!1;for(var oe=q.x,de=ee.x,_e=ie.x,Ee=q.y,Fe=ee.y,Pe=ie.y,He=oe<de?oe<_e?oe:_e:de<_e?de:_e,Ne=Ee<Fe?Ee<Pe?Ee:Pe:Fe<Pe?Fe:Pe,tt=oe>de?oe>_e?oe:_e:de>_e?de:_e,at=Ee>Fe?Ee>Pe?Ee:Pe:Fe>Pe?Fe:Pe,ct=bA(He,Ne,w,I,H),mt=bA(tt,at,w,I,H),ht=C.prevZ,bt=C.nextZ;ht&&ht.z>=ct&&bt&&bt.z<=mt;){if(ht.x>=He&&ht.x<=tt&&ht.y>=Ne&&ht.y<=at&&ht!==q&&ht!==ie&&ol(oe,Ee,de,Fe,_e,Pe,ht.x,ht.y)&&rs(ht.prev,ht,ht.next)>=0||(ht=ht.prevZ,bt.x>=He&&bt.x<=tt&&bt.y>=Ne&&bt.y<=at&&bt!==q&&bt!==ie&&ol(oe,Ee,de,Fe,_e,Pe,bt.x,bt.y)&&rs(bt.prev,bt,bt.next)>=0))return!1;bt=bt.nextZ}for(;ht&&ht.z>=ct;){if(ht.x>=He&&ht.x<=tt&&ht.y>=Ne&&ht.y<=at&&ht!==q&&ht!==ie&&ol(oe,Ee,de,Fe,_e,Pe,ht.x,ht.y)&&rs(ht.prev,ht,ht.next)>=0)return!1;ht=ht.prevZ}for(;bt&&bt.z<=mt;){if(bt.x>=He&&bt.x<=tt&&bt.y>=Ne&&bt.y<=at&&bt!==q&&bt!==ie&&ol(oe,Ee,de,Fe,_e,Pe,bt.x,bt.y)&&rs(bt.prev,bt,bt.next)>=0)return!1;bt=bt.nextZ}return!0}function Zh(C,w,I){var H=C;do{var q=H.prev,ee=H.next.next;!jl(q,ee)&&_c(q,H,H.next,ee)&&kl(q,ee)&&kl(ee,q)&&(w.push(q.i/I|0),w.push(H.i/I|0),w.push(ee.i/I|0),Dl(H),Dl(H.next),H=C=ee),H=H.next}while(H!==C);return Ho(H)}function Jh(C,w,I,H,q,ee){var ie=C;do{for(var oe=ie.next.next;oe!==ie.prev;){if(ie.i!==oe.i&&ru(ie,oe)){var de=yc(ie,oe);return ie=Ho(ie,ie.next),de=Ho(de,de.next),Fl(ie,w,I,H,q,ee,0),void Fl(de,w,I,H,q,ee,0)}oe=oe.next}ie=ie.next}while(ie!==C)}function $h(C,w){return C.x-w.x}function eu(C,w){var I=function(q,ee){var ie,oe=ee,de=q.x,_e=q.y,Ee=-1/0;do{if(_e<=oe.y&&_e>=oe.next.y&&oe.next.y!==oe.y){var Fe=oe.x+(_e-oe.y)*(oe.next.x-oe.x)/(oe.next.y-oe.y);if(Fe<=de&&Fe>Ee&&(Ee=Fe,ie=oe.x<oe.next.x?oe:oe.next,Fe===de))return ie}oe=oe.next}while(oe!==ee);if(!ie)return null;var Pe,He=ie,Ne=ie.x,tt=ie.y,at=1/0;oe=ie;do de>=oe.x&&oe.x>=Ne&&de!==oe.x&&ol(_e<tt?de:Ee,_e,Ne,tt,_e<tt?Ee:de,_e,oe.x,oe.y)&&(Pe=Math.abs(_e-oe.y)/(de-oe.x),kl(oe,q)&&(Pe<at||Pe===at&&(oe.x>ie.x||oe.x===ie.x&&tu(ie,oe)))&&(ie=oe,at=Pe)),oe=oe.next;while(oe!==He);return ie}(C,w);if(!I)return w;var H=yc(I,C);return Ho(H,H.next),Ho(I,I.next)}function tu(C,w){return rs(C.prev,C,w.prev)<0&&rs(w.next,C,C.next)<0}function bA(C,w,I,H,q){return(C=1431655765&((C=858993459&((C=252645135&((C=16711935&((C=(C-I)*q|0)|C<<8))|C<<4))|C<<2))|C<<1))|(w=1431655765&((w=858993459&((w=252645135&((w=16711935&((w=(w-H)*q|0)|w<<8))|w<<4))|w<<2))|w<<1))<<1}function iu(C){var w=C,I=C;do(w.x<I.x||w.x===I.x&&w.y<I.y)&&(I=w),w=w.next;while(w!==C);return I}function ol(C,w,I,H,q,ee,ie,oe){return(q-ie)*(w-oe)>=(C-ie)*(ee-oe)&&(C-ie)*(H-oe)>=(I-ie)*(w-oe)&&(I-ie)*(ee-oe)>=(q-ie)*(H-oe)}function ru(C,w){return C.next.i!==w.i&&C.prev.i!==w.i&&!function(I,H){var q=I;do{if(q.i!==I.i&&q.next.i!==I.i&&q.i!==H.i&&q.next.i!==H.i&&_c(q,q.next,I,H))return!0;q=q.next}while(q!==I);return!1}(C,w)&&(kl(C,w)&&kl(w,C)&&function(I,H){var q=I,ee=!1,ie=(I.x+H.x)/2,oe=(I.y+H.y)/2;do q.y>oe!=q.next.y>oe&&q.next.y!==q.y&&ie<(q.next.x-q.x)*(oe-q.y)/(q.next.y-q.y)+q.x&&(ee=!ee),q=q.next;while(q!==I);return ee}(C,w)&&(rs(C.prev,C,w.prev)||rs(C,w.prev,w))||jl(C,w)&&rs(C.prev,C,C.next)>0&&rs(w.prev,w,w.next)>0)}function rs(C,w,I){return(w.y-C.y)*(I.x-w.x)-(w.x-C.x)*(I.y-w.y)}function jl(C,w){return C.x===w.x&&C.y===w.y}function _c(C,w,I,H){var q=Jl(rs(C,w,I)),ee=Jl(rs(C,w,H)),ie=Jl(rs(I,H,C)),oe=Jl(rs(I,H,w));return q!==ee&&ie!==oe||!(q!==0||!Zl(C,I,w))||!(ee!==0||!Zl(C,H,w))||!(ie!==0||!Zl(I,C,H))||!(oe!==0||!Zl(I,w,H))}function Zl(C,w,I){return w.x<=Math.max(C.x,I.x)&&w.x>=Math.min(C.x,I.x)&&w.y<=Math.max(C.y,I.y)&&w.y>=Math.min(C.y,I.y)}function Jl(C){return C>0?1:C<0?-1:0}function kl(C,w){return rs(C.prev,C,C.next)<0?rs(C,w,C.next)>=0&&rs(C,C.prev,w)>=0:rs(C,w,C.prev)<0||rs(C,C.next,w)<0}function yc(C,w){var I=new wA(C.i,C.x,C.y),H=new wA(w.i,w.x,w.y),q=C.next,ee=w.prev;return C.next=w,w.prev=C,I.next=q,q.prev=I,H.next=I,I.prev=H,ee.next=H,H.prev=ee,H}function vc(C,w,I,H){var q=new wA(C,w,I);return H?(q.next=H.next,q.prev=H,H.next.prev=q,H.next=q):(q.prev=q,q.next=q),q}function Dl(C){C.next.prev=C.prev,C.prev.next=C.next,C.prevZ&&(C.prevZ.nextZ=C.nextZ),C.nextZ&&(C.nextZ.prevZ=C.prevZ)}function wA(C,w,I){this.i=C,this.x=w,this.y=I,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function xA(C,w,I,H){for(var q=0,ee=w,ie=I-H;ee<I;ee+=H)q+=(C[ie]-C[ee])*(C[ee+1]+C[ie+1]),ie=ee;return q}vA.exports=Yl,vA.exports.default=Yl,Yl.deviation=function(C,w,I,H){var q=w&&w.length,ee=Math.abs(xA(C,0,q?w[0]*I:C.length,I));if(q)for(var ie=0,oe=w.length;ie<oe;ie++)ee-=Math.abs(xA(C,w[ie]*I,ie<oe-1?w[ie+1]*I:C.length,I));var de=0;for(ie=0;ie<H.length;ie+=3){var _e=H[ie]*I,Ee=H[ie+1]*I,Fe=H[ie+2]*I;de+=Math.abs((C[_e]-C[Fe])*(C[Ee+1]-C[_e+1])-(C[_e]-C[Ee])*(C[Fe+1]-C[_e+1]))}return ee===0&&de===0?0:Math.abs((de-ee)/ee)},Yl.flatten=function(C){for(var w=C[0][0].length,I={vertices:[],holes:[],dimensions:w},H=0,q=0;q<C.length;q++){for(var ee=0;ee<C[q].length;ee++)for(var ie=0;ie<w;ie++)I.vertices.push(C[q][ee][ie]);q>0&&I.holes.push(H+=C[q-1].length)}return I};var bc=ne(vA.exports);function su(C,w,I,H,q){wc(C,w,I,H||C.length-1,q||nu)}function wc(C,w,I,H,q){for(;H>I;){if(H-I>600){var ee=H-I+1,ie=w-I+1,oe=Math.log(ee),de=.5*Math.exp(2*oe/3),_e=.5*Math.sqrt(oe*de*(ee-de)/ee)*(ie-ee/2<0?-1:1);wc(C,w,Math.max(I,Math.floor(w-ie*de/ee+_e)),Math.min(H,Math.floor(w+(ee-ie)*de/ee+_e)),q)}var Ee=C[w],Fe=I,Pe=H;for(Ul(C,I,w),q(C[H],Ee)>0&&Ul(C,I,H);Fe<Pe;){for(Ul(C,Fe,Pe),Fe++,Pe--;q(C[Fe],Ee)<0;)Fe++;for(;q(C[Pe],Ee)>0;)Pe--}q(C[I],Ee)===0?Ul(C,I,Pe):Ul(C,++Pe,H),Pe<=w&&(I=Pe+1),w<=Pe&&(H=Pe-1)}}function Ul(C,w,I){var H=C[w];C[w]=C[I],C[I]=H}function nu(C,w){return C<w?-1:C>w?1:0}function CA(C,w){const I=C.length;if(I<=1)return[C];const H=[];let q,ee;for(let ie=0;ie<I;ie++){const oe=Ut(C[ie]);oe!==0&&(C[ie].area=Math.abs(oe),ee===void 0&&(ee=oe<0),ee===oe<0?(q&&H.push(q),q=[C[ie]]):q.push(C[ie]))}if(q&&H.push(q),w>1)for(let ie=0;ie<H.length;ie++)H[ie].length<=w||(su(H[ie],w,1,H[ie].length-1,au),H[ie]=H[ie].slice(0,w));return H}function au(C,w){return w.area-C.area}function EA(C,w,I){const H=I.patternDependencies;let q=!1;for(const ee of w){const ie=ee.paint.get(`${C}-pattern`);ie.isConstant()||(q=!0);const oe=ie.constantOr(null);oe&&(q=!0,H[oe.to]=!0,H[oe.from]=!0)}return q}function TA(C,w,I,H,q){const ee=q.patternDependencies;for(const ie of w){const oe=ie.paint.get(`${C}-pattern`).value;if(oe.kind!=="constant"){let de=oe.evaluate({zoom:H-1},I,{},q.availableImages),_e=oe.evaluate({zoom:H},I,{},q.availableImages),Ee=oe.evaluate({zoom:H+1},I,{},q.availableImages);de=de&&de.name?de.name:de,_e=_e&&_e.name?_e.name:_e,Ee=Ee&&Ee.name?Ee.name:Ee,ee[de]=!0,ee[_e]=!0,ee[Ee]=!0,I.patterns[ie.id]={min:de,mid:_e,max:Ee}}}return I}class IA{constructor(w){this.zoom=w.zoom,this.overscaling=w.overscaling,this.layers=w.layers,this.layerIds=this.layers.map(I=>I.id),this.index=w.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new gt,this.indexArray=new ki,this.indexArray2=new xi,this.programConfigurations=new Ka(w.layers,w.zoom),this.segments=new Mi,this.segments2=new Mi,this.stateDependentLayerIds=this.layers.filter(I=>I.isStateDependent()).map(I=>I.id)}populate(w,I,H){this.hasPattern=EA("fill",this.layers,I);const q=this.layers[0].layout.get("fill-sort-key"),ee=!q.isConstant(),ie=[];for(const{feature:oe,id:de,index:_e,sourceLayerIndex:Ee}of w){const Fe=this.layers[0]._featureFilter.needGeometry,Pe=ya(oe,Fe);if(!this.layers[0]._featureFilter.filter(new Er(this.zoom),Pe,H))continue;const He=ee?q.evaluate(Pe,{},H,I.availableImages):void 0,Ne={id:de,properties:oe.properties,type:oe.type,sourceLayerIndex:Ee,index:_e,geometry:Fe?Pe.geometry:jn(oe),patterns:{},sortKey:He};ie.push(Ne)}ee&&ie.sort((oe,de)=>oe.sortKey-de.sortKey);for(const oe of ie){const{geometry:de,index:_e,sourceLayerIndex:Ee}=oe;if(this.hasPattern){const Fe=TA("fill",this.layers,oe,this.zoom,I);this.patternFeatures.push(Fe)}else this.addFeature(oe,de,_e,H,{});I.featureIndex.insert(w[_e].feature,de,_e,Ee,this.index)}}update(w,I,H){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(w,I,this.stateDependentLayers,H)}addFeatures(w,I,H){for(const q of this.patternFeatures)this.addFeature(q,q.geometry,q.index,I,H)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(w){this.uploaded||(this.layoutVertexBuffer=w.createVertexBuffer(this.layoutVertexArray,Xh),this.indexBuffer=w.createIndexBuffer(this.indexArray),this.indexBuffer2=w.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(w),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(w,I,H,q,ee){for(const ie of CA(I,500)){let oe=0;for(const He of ie)oe+=He.length;const de=this.segments.prepareSegment(oe,this.layoutVertexArray,this.indexArray),_e=de.vertexLength,Ee=[],Fe=[];for(const He of ie){if(He.length===0)continue;He!==ie[0]&&Fe.push(Ee.length/2);const Ne=this.segments2.prepareSegment(He.length,this.layoutVertexArray,this.indexArray2),tt=Ne.vertexLength;this.layoutVertexArray.emplaceBack(He[0].x,He[0].y),this.indexArray2.emplaceBack(tt+He.length-1,tt),Ee.push(He[0].x),Ee.push(He[0].y);for(let at=1;at<He.length;at++)this.layoutVertexArray.emplaceBack(He[at].x,He[at].y),this.indexArray2.emplaceBack(tt+at-1,tt+at),Ee.push(He[at].x),Ee.push(He[at].y);Ne.vertexLength+=He.length,Ne.primitiveLength+=He.length}const Pe=bc(Ee,Fe);for(let He=0;He<Pe.length;He+=3)this.indexArray.emplaceBack(_e+Pe[He],_e+Pe[He+1],_e+Pe[He+2]);de.vertexLength+=oe,de.primitiveLength+=Pe.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,w,H,ee,q)}}let xc,Bc;gi("FillBucket",IA,{omit:["layers","patternFeatures"]});var ou={get paint(){return Bc=Bc||new Ns({"fill-antialias":new Fi(me.paint_fill["fill-antialias"]),"fill-opacity":new Ni(me.paint_fill["fill-opacity"]),"fill-color":new Ni(me.paint_fill["fill-color"]),"fill-outline-color":new Ni(me.paint_fill["fill-outline-color"]),"fill-translate":new Fi(me.paint_fill["fill-translate"]),"fill-translate-anchor":new Fi(me.paint_fill["fill-translate-anchor"]),"fill-pattern":new $o(me.paint_fill["fill-pattern"])})},get layout(){return xc=xc||new Ns({"fill-sort-key":new Ni(me.layout_fill["fill-sort-key"])})}};class lu extends Dn{constructor(w){super(w,ou)}recalculate(w,I){super.recalculate(w,I);const H=this.paint._values["fill-outline-color"];H.value.kind==="constant"&&H.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(w){return new IA(w)}queryRadius(){return Wl(this.paint.get("fill-translate"))}queryIntersectsFeature(w,I,H,q,ee,ie,oe){return nc(ql(w,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),ie.angle,oe),q)}isTileClipped(){return!0}}const Au=ts([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),cu=ts([{name:"a_centroid",components:2,type:"Int16"}],4),{members:hu}=Au;var mo={},uu=ae,Cc=ll;function ll(C,w,I,H,q){this.properties={},this.extent=I,this.type=0,this._pbf=C,this._geometry=-1,this._keys=H,this._values=q,C.readFields(fu,this,w)}function fu(C,w,I){C==1?w.id=I.readVarint():C==2?function(H,q){for(var ee=H.readVarint()+H.pos;H.pos<ee;){var ie=q._keys[H.readVarint()],oe=q._values[H.readVarint()];q.properties[ie]=oe}}(I,w):C==3?w.type=I.readVarint():C==4&&(w._geometry=I.pos)}function du(C){for(var w,I,H=0,q=0,ee=C.length,ie=ee-1;q<ee;ie=q++)H+=((I=C[ie]).x-(w=C[q]).x)*(w.y+I.y);return H}ll.types=["Unknown","Point","LineString","Polygon"],ll.prototype.loadGeometry=function(){var C=this._pbf;C.pos=this._geometry;for(var w,I=C.readVarint()+C.pos,H=1,q=0,ee=0,ie=0,oe=[];C.pos<I;){if(q<=0){var de=C.readVarint();H=7&de,q=de>>3}if(q--,H===1||H===2)ee+=C.readSVarint(),ie+=C.readSVarint(),H===1&&(w&&oe.push(w),w=[]),w.push(new uu(ee,ie));else{if(H!==7)throw new Error("unknown command "+H);w&&w.push(w[0].clone())}}return w&&oe.push(w),oe},ll.prototype.bbox=function(){var C=this._pbf;C.pos=this._geometry;for(var w=C.readVarint()+C.pos,I=1,H=0,q=0,ee=0,ie=1/0,oe=-1/0,de=1/0,_e=-1/0;C.pos<w;){if(H<=0){var Ee=C.readVarint();I=7&Ee,H=Ee>>3}if(H--,I===1||I===2)(q+=C.readSVarint())<ie&&(ie=q),q>oe&&(oe=q),(ee+=C.readSVarint())<de&&(de=ee),ee>_e&&(_e=ee);else if(I!==7)throw new Error("unknown command "+I)}return[ie,de,oe,_e]},ll.prototype.toGeoJSON=function(C,w,I){var H,q,ee=this.extent*Math.pow(2,I),ie=this.extent*C,oe=this.extent*w,de=this.loadGeometry(),_e=ll.types[this.type];function Ee(He){for(var Ne=0;Ne<He.length;Ne++){var tt=He[Ne];He[Ne]=[360*(tt.x+ie)/ee-180,360/Math.PI*Math.atan(Math.exp((180-360*(tt.y+oe)/ee)*Math.PI/180))-90]}}switch(this.type){case 1:var Fe=[];for(H=0;H<de.length;H++)Fe[H]=de[H][0];Ee(de=Fe);break;case 2:for(H=0;H<de.length;H++)Ee(de[H]);break;case 3:for(de=function(He){var Ne=He.length;if(Ne<=1)return[He];for(var tt,at,ct=[],mt=0;mt<Ne;mt++){var ht=du(He[mt]);ht!==0&&(at===void 0&&(at=ht<0),at===ht<0?(tt&&ct.push(tt),tt=[He[mt]]):tt.push(He[mt]))}return tt&&ct.push(tt),ct}(de),H=0;H<de.length;H++)for(q=0;q<de[H].length;q++)Ee(de[H][q])}de.length===1?de=de[0]:_e="Multi"+_e;var Pe={type:"Feature",geometry:{type:_e,coordinates:de},properties:this.properties};return"id"in this&&(Pe.id=this.id),Pe};var pu=Cc,Ec=Tc;function Tc(C,w){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=C,this._keys=[],this._values=[],this._features=[],C.readFields(gu,this,w),this.length=this._features.length}function gu(C,w,I){C===15?w.version=I.readVarint():C===1?w.name=I.readString():C===5?w.extent=I.readVarint():C===2?w._features.push(I.pos):C===3?w._keys.push(I.readString()):C===4&&w._values.push(function(H){for(var q=null,ee=H.readVarint()+H.pos;H.pos<ee;){var ie=H.readVarint()>>3;q=ie===1?H.readString():ie===2?H.readFloat():ie===3?H.readDouble():ie===4?H.readVarint64():ie===5?H.readVarint():ie===6?H.readSVarint():ie===7?H.readBoolean():null}return q}(I))}Tc.prototype.feature=function(C){if(C<0||C>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[C];var w=this._pbf.readVarint()+this._pbf.pos;return new pu(this._pbf,w,this.extent,this._keys,this._values)};var mu=Ec;function _u(C,w,I){if(C===3){var H=new mu(I,I.readVarint()+I.pos);H.length&&(w[H.name]=H)}}mo.VectorTile=function(C,w){this.layers=C.readFields(_u,{},w)},mo.VectorTileFeature=Cc,mo.VectorTileLayer=Ec;const yu=mo.VectorTileFeature.types,FA=Math.pow(2,13);function Ml(C,w,I,H,q,ee,ie,oe){C.emplaceBack(w,I,2*Math.floor(H*FA)+ie,q*FA*2,ee*FA*2,Math.round(oe))}class kA{constructor(w){this.zoom=w.zoom,this.overscaling=w.overscaling,this.layers=w.layers,this.layerIds=this.layers.map(I=>I.id),this.index=w.index,this.hasPattern=!1,this.layoutVertexArray=new St,this.centroidVertexArray=new Bt,this.indexArray=new ki,this.programConfigurations=new Ka(w.layers,w.zoom),this.segments=new Mi,this.stateDependentLayerIds=this.layers.filter(I=>I.isStateDependent()).map(I=>I.id)}populate(w,I,H){this.features=[],this.hasPattern=EA("fill-extrusion",this.layers,I);for(const{feature:q,id:ee,index:ie,sourceLayerIndex:oe}of w){const de=this.layers[0]._featureFilter.needGeometry,_e=ya(q,de);if(!this.layers[0]._featureFilter.filter(new Er(this.zoom),_e,H))continue;const Ee={id:ee,sourceLayerIndex:oe,index:ie,geometry:de?_e.geometry:jn(q),properties:q.properties,type:q.type,patterns:{}};this.hasPattern?this.features.push(TA("fill-extrusion",this.layers,Ee,this.zoom,I)):this.addFeature(Ee,Ee.geometry,ie,H,{}),I.featureIndex.insert(q,Ee.geometry,ie,oe,this.index,!0)}}addFeatures(w,I,H){for(const q of this.features){const{geometry:ee}=q;this.addFeature(q,ee,q.index,I,H)}}update(w,I,H){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(w,I,this.stateDependentLayers,H)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(w){this.uploaded||(this.layoutVertexBuffer=w.createVertexBuffer(this.layoutVertexArray,hu),this.centroidVertexBuffer=w.createVertexBuffer(this.centroidVertexArray,cu.members,!0),this.indexBuffer=w.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(w),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(w,I,H,q,ee){const ie={x:0,y:0,vertexCount:0};for(const oe of CA(I,500)){let de=0;for(const Ne of oe)de+=Ne.length;let _e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const Ne of oe){if(Ne.length===0||bu(Ne))continue;let tt=0;for(let at=0;at<Ne.length;at++){const ct=Ne[at];if(at>=1){const mt=Ne[at-1];if(!vu(ct,mt)){_e.vertexLength+4>Mi.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ht=ct.sub(mt)._perp()._unit(),bt=mt.dist(ct);tt+bt>32768&&(tt=0),Ml(this.layoutVertexArray,ct.x,ct.y,ht.x,ht.y,0,0,tt),Ml(this.layoutVertexArray,ct.x,ct.y,ht.x,ht.y,0,1,tt),ie.x+=2*ct.x,ie.y+=2*ct.y,ie.vertexCount+=2,tt+=bt,Ml(this.layoutVertexArray,mt.x,mt.y,ht.x,ht.y,0,0,tt),Ml(this.layoutVertexArray,mt.x,mt.y,ht.x,ht.y,0,1,tt),ie.x+=2*mt.x,ie.y+=2*mt.y,ie.vertexCount+=2;const Ct=_e.vertexLength;this.indexArray.emplaceBack(Ct,Ct+2,Ct+1),this.indexArray.emplaceBack(Ct+1,Ct+2,Ct+3),_e.vertexLength+=4,_e.primitiveLength+=2}}}}if(_e.vertexLength+de>Mi.MAX_VERTEX_ARRAY_LENGTH&&(_e=this.segments.prepareSegment(de,this.layoutVertexArray,this.indexArray)),yu[w.type]!=="Polygon")continue;const Ee=[],Fe=[],Pe=_e.vertexLength;for(const Ne of oe)if(Ne.length!==0){Ne!==oe[0]&&Fe.push(Ee.length/2);for(let tt=0;tt<Ne.length;tt++){const at=Ne[tt];Ml(this.layoutVertexArray,at.x,at.y,0,0,1,1,0),ie.x+=at.x,ie.y+=at.y,ie.vertexCount+=1,Ee.push(at.x),Ee.push(at.y)}}const He=bc(Ee,Fe);for(let Ne=0;Ne<He.length;Ne+=3)this.indexArray.emplaceBack(Pe+He[Ne],Pe+He[Ne+2],Pe+He[Ne+1]);_e.primitiveLength+=He.length/3,_e.vertexLength+=de}for(let oe=0;oe<ie.vertexCount;oe++)this.centroidVertexArray.emplaceBack(Math.floor(ie.x/ie.vertexCount),Math.floor(ie.y/ie.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,w,H,ee,q)}}function vu(C,w){return C.x===w.x&&(C.x<0||C.x>Xr)||C.y===w.y&&(C.y<0||C.y>Xr)}function bu(C){return C.every(w=>w.x<0)||C.every(w=>w.x>Xr)||C.every(w=>w.y<0)||C.every(w=>w.y>Xr)}let Sc;gi("FillExtrusionBucket",kA,{omit:["layers","features"]});var wu={get paint(){return Sc=Sc||new Ns({"fill-extrusion-opacity":new Fi(me["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ni(me["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Fi(me["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Fi(me["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new $o(me["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ni(me["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ni(me["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Fi(me["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class xu extends Dn{constructor(w){super(w,wu)}createBucket(w){return new kA(w)}queryRadius(){return Wl(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(w,I,H,q,ee,ie,oe,de){const _e=ql(w,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),ie.angle,oe),Ee=this.paint.get("fill-extrusion-height").evaluate(I,H),Fe=this.paint.get("fill-extrusion-base").evaluate(I,H),Pe=function(Ne,tt,at,ct){const mt=[];for(const ht of Ne){const bt=[ht.x,ht.y,0,1];Xl(bt,bt,tt),mt.push(new ge(bt[0]/bt[3],bt[1]/bt[3]))}return mt}(_e,de),He=function(Ne,tt,at,ct){const mt=[],ht=[],bt=ct[8]*tt,Ct=ct[9]*tt,Qt=ct[10]*tt,fi=ct[11]*tt,Ci=ct[8]*at,ui=ct[9]*at,li=ct[10]*at,ti=ct[11]*at;for(const yi of Ne){const si=[],Gt=[];for(const Pi of yi){const Si=Pi.x,ir=Pi.y,Rr=ct[0]*Si+ct[4]*ir+ct[12],zr=ct[1]*Si+ct[5]*ir+ct[13],fs=ct[2]*Si+ct[6]*ir+ct[14],fn=ct[3]*Si+ct[7]*ir+ct[15],Gs=fs+Qt,os=fn+fi,ms=Rr+Ci,Ss=zr+ui,nn=fs+li,Ws=fn+ti,ls=new ge((Rr+bt)/os,(zr+Ct)/os);ls.z=Gs/os,si.push(ls);const ds=new ge(ms/Ws,Ss/Ws);ds.z=nn/Ws,Gt.push(ds)}mt.push(si),ht.push(Gt)}return[mt,ht]}(q,Fe,Ee,de);return function(Ne,tt,at){let ct=1/0;nc(at,tt)&&(ct=Ic(at,tt[0]));for(let mt=0;mt<tt.length;mt++){const ht=tt[mt],bt=Ne[mt];for(let Ct=0;Ct<ht.length-1;Ct++){const Qt=ht[Ct],fi=[Qt,ht[Ct+1],bt[Ct+1],bt[Ct],Qt];sc(at,fi)&&(ct=Math.min(ct,Ic(at,fi)))}}return ct!==1/0&&ct}(He[0],He[1],Pe)}}function Pl(C,w){return C.x*w.x+C.y*w.y}function Ic(C,w){if(C.length===1){let I=0;const H=w[I++];let q;for(;!q||H.equals(q);)if(q=w[I++],!q)return 1/0;for(;I<w.length;I++){const ee=w[I],ie=C[0],oe=q.sub(H),de=ee.sub(H),_e=ie.sub(H),Ee=Pl(oe,oe),Fe=Pl(oe,de),Pe=Pl(de,de),He=Pl(_e,oe),Ne=Pl(_e,de),tt=Ee*Pe-Fe*Fe,at=(Pe*He-Fe*Ne)/tt,ct=(Ee*Ne-Fe*He)/tt,mt=H.z*(1-at-ct)+q.z*at+ee.z*ct;if(isFinite(mt))return mt}return 1/0}{let I=1/0;for(const H of w)I=Math.min(I,H.z);return I}}const Bu=ts([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Cu}=Bu,Eu=ts([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Tu}=Eu,Su=mo.VectorTileFeature.types,Iu=Math.cos(Math.PI/180*37.5),Fc=Math.pow(2,14)/.5;class DA{constructor(w){this.zoom=w.zoom,this.overscaling=w.overscaling,this.layers=w.layers,this.layerIds=this.layers.map(I=>I.id),this.index=w.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(I=>{this.gradients[I.id]={}}),this.layoutVertexArray=new It,this.layoutVertexArray2=new Lt,this.indexArray=new ki,this.programConfigurations=new Ka(w.layers,w.zoom),this.segments=new Mi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(I=>I.isStateDependent()).map(I=>I.id)}populate(w,I,H){this.hasPattern=EA("line",this.layers,I);const q=this.layers[0].layout.get("line-sort-key"),ee=!q.isConstant(),ie=[];for(const{feature:oe,id:de,index:_e,sourceLayerIndex:Ee}of w){const Fe=this.layers[0]._featureFilter.needGeometry,Pe=ya(oe,Fe);if(!this.layers[0]._featureFilter.filter(new Er(this.zoom),Pe,H))continue;const He=ee?q.evaluate(Pe,{},H):void 0,Ne={id:de,properties:oe.properties,type:oe.type,sourceLayerIndex:Ee,index:_e,geometry:Fe?Pe.geometry:jn(oe),patterns:{},sortKey:He};ie.push(Ne)}ee&&ie.sort((oe,de)=>oe.sortKey-de.sortKey);for(const oe of ie){const{geometry:de,index:_e,sourceLayerIndex:Ee}=oe;if(this.hasPattern){const Fe=TA("line",this.layers,oe,this.zoom,I);this.patternFeatures.push(Fe)}else this.addFeature(oe,de,_e,H,{});I.featureIndex.insert(w[_e].feature,de,_e,Ee,this.index)}}update(w,I,H){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(w,I,this.stateDependentLayers,H)}addFeatures(w,I,H){for(const q of this.patternFeatures)this.addFeature(q,q.geometry,q.index,I,H)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(w){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=w.createVertexBuffer(this.layoutVertexArray2,Tu)),this.layoutVertexBuffer=w.createVertexBuffer(this.layoutVertexArray,Cu),this.indexBuffer=w.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(w),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(w){if(w.properties&&Object.prototype.hasOwnProperty.call(w.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(w.properties,"mapbox_clip_end"))return{start:+w.properties.mapbox_clip_start,end:+w.properties.mapbox_clip_end}}addFeature(w,I,H,q,ee){const ie=this.layers[0].layout,oe=ie.get("line-join").evaluate(w,{}),de=ie.get("line-cap"),_e=ie.get("line-miter-limit"),Ee=ie.get("line-round-limit");this.lineClips=this.lineFeatureClips(w);for(const Fe of I)this.addLine(Fe,w,oe,de,_e,Ee);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,w,H,ee,q)}addLine(w,I,H,q,ee,ie){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ct=0;ct<w.length-1;ct++)this.totalDistance+=w[ct].dist(w[ct+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const oe=Su[I.type]==="Polygon";let de=w.length;for(;de>=2&&w[de-1].equals(w[de-2]);)de--;let _e=0;for(;_e<de-1&&w[_e].equals(w[_e+1]);)_e++;if(de<(oe?3:2))return;H==="bevel"&&(ee=1.05);const Ee=this.overscaling<=16?15*Xr/(512*this.overscaling):0,Fe=this.segments.prepareSegment(10*de,this.layoutVertexArray,this.indexArray);let Pe,He,Ne,tt,at;this.e1=this.e2=-1,oe&&(Pe=w[de-2],at=w[_e].sub(Pe)._unit()._perp());for(let ct=_e;ct<de;ct++){if(Ne=ct===de-1?oe?w[_e+1]:void 0:w[ct+1],Ne&&w[ct].equals(Ne))continue;at&&(tt=at),Pe&&(He=Pe),Pe=w[ct],at=Ne?Ne.sub(Pe)._unit()._perp():tt,tt=tt||at;let mt=tt.add(at);mt.x===0&&mt.y===0||mt._unit();const ht=tt.x*at.x+tt.y*at.y,bt=mt.x*at.x+mt.y*at.y,Ct=bt!==0?1/bt:1/0,Qt=2*Math.sqrt(2-2*bt),fi=bt<Iu&&He&&Ne,Ci=tt.x*at.y-tt.y*at.x>0;if(fi&&ct>_e){const ti=Pe.dist(He);if(ti>2*Ee){const yi=Pe.sub(Pe.sub(He)._mult(Ee/ti)._round());this.updateDistance(He,yi),this.addCurrentVertex(yi,tt,0,0,Fe),He=yi}}const ui=He&&Ne;let li=ui?H:oe?"butt":q;if(ui&&li==="round"&&(Ct<ie?li="miter":Ct<=2&&(li="fakeround")),li==="miter"&&Ct>ee&&(li="bevel"),li==="bevel"&&(Ct>2&&(li="flipbevel"),Ct<ee&&(li="miter")),He&&this.updateDistance(He,Pe),li==="miter")mt._mult(Ct),this.addCurrentVertex(Pe,mt,0,0,Fe);else if(li==="flipbevel"){if(Ct>100)mt=at.mult(-1);else{const ti=Ct*tt.add(at).mag()/tt.sub(at).mag();mt._perp()._mult(ti*(Ci?-1:1))}this.addCurrentVertex(Pe,mt,0,0,Fe),this.addCurrentVertex(Pe,mt.mult(-1),0,0,Fe)}else if(li==="bevel"||li==="fakeround"){const ti=-Math.sqrt(Ct*Ct-1),yi=Ci?ti:0,si=Ci?0:ti;if(He&&this.addCurrentVertex(Pe,tt,yi,si,Fe),li==="fakeround"){const Gt=Math.round(180*Qt/Math.PI/20);for(let Pi=1;Pi<Gt;Pi++){let Si=Pi/Gt;if(Si!==.5){const Rr=Si-.5;Si+=Si*Rr*(Si-1)*((1.0904+ht*(ht*(3.55645-1.43519*ht)-3.2452))*Rr*Rr+(.848013+ht*(.215638*ht-1.06021)))}const ir=at.sub(tt)._mult(Si)._add(tt)._unit()._mult(Ci?-1:1);this.addHalfVertex(Pe,ir.x,ir.y,!1,Ci,0,Fe)}}Ne&&this.addCurrentVertex(Pe,at,-yi,-si,Fe)}else if(li==="butt")this.addCurrentVertex(Pe,mt,0,0,Fe);else if(li==="square"){const ti=He?1:-1;this.addCurrentVertex(Pe,mt,ti,ti,Fe)}else li==="round"&&(He&&(this.addCurrentVertex(Pe,tt,0,0,Fe),this.addCurrentVertex(Pe,tt,1,1,Fe,!0)),Ne&&(this.addCurrentVertex(Pe,at,-1,-1,Fe,!0),this.addCurrentVertex(Pe,at,0,0,Fe)));if(fi&&ct<de-1){const ti=Pe.dist(Ne);if(ti>2*Ee){const yi=Pe.add(Ne.sub(Pe)._mult(Ee/ti)._round());this.updateDistance(Pe,yi),this.addCurrentVertex(yi,at,0,0,Fe),Pe=yi}}}}addCurrentVertex(w,I,H,q,ee,ie=!1){const oe=I.y*q-I.x,de=-I.y-I.x*q;this.addHalfVertex(w,I.x+I.y*H,I.y-I.x*H,ie,!1,H,ee),this.addHalfVertex(w,oe,de,ie,!0,-q,ee),this.distance>Fc/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(w,I,H,q,ee,ie))}addHalfVertex({x:w,y:I},H,q,ee,ie,oe,de){const _e=.5*(this.lineClips?this.scaledDistance*(Fc-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((w<<1)+(ee?1:0),(I<<1)+(ie?1:0),Math.round(63*H)+128,Math.round(63*q)+128,1+(oe===0?0:oe<0?-1:1)|(63&_e)<<2,_e>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const Ee=de.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Ee),de.primitiveLength++),ie?this.e2=Ee:this.e1=Ee}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(w,I){this.distance+=w.dist(I),this.updateScaledDistance()}}let kc,Dc;gi("LineBucket",DA,{omit:["layers","patternFeatures"]});var Uc={get paint(){return Dc=Dc||new Ns({"line-opacity":new Ni(me.paint_line["line-opacity"]),"line-color":new Ni(me.paint_line["line-color"]),"line-translate":new Fi(me.paint_line["line-translate"]),"line-translate-anchor":new Fi(me.paint_line["line-translate-anchor"]),"line-width":new Ni(me.paint_line["line-width"]),"line-gap-width":new Ni(me.paint_line["line-gap-width"]),"line-offset":new Ni(me.paint_line["line-offset"]),"line-blur":new Ni(me.paint_line["line-blur"]),"line-dasharray":new vl(me.paint_line["line-dasharray"]),"line-pattern":new $o(me.paint_line["line-pattern"]),"line-gradient":new bl(me.paint_line["line-gradient"])})},get layout(){return kc=kc||new Ns({"line-cap":new Fi(me.layout_line["line-cap"]),"line-join":new Ni(me.layout_line["line-join"]),"line-miter-limit":new Fi(me.layout_line["line-miter-limit"]),"line-round-limit":new Fi(me.layout_line["line-round-limit"]),"line-sort-key":new Ni(me.layout_line["line-sort-key"])})}};class Fu extends Ni{possiblyEvaluate(w,I){return I=new Er(Math.floor(I.zoom),{now:I.now,fadeDuration:I.fadeDuration,zoomHistory:I.zoomHistory,transition:I.transition}),super.possiblyEvaluate(w,I)}evaluate(w,I,H,q){return I=et({},I,{zoom:Math.floor(I.zoom)}),super.evaluate(w,I,H,q)}}let $l;class ku extends Dn{constructor(w){super(w,Uc),this.gradientVersion=0,$l||($l=new Fu(Uc.paint.properties["line-width"].specification),$l.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(w){w==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Sa,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(w,I){super.recalculate(w,I),this.paint._values["line-floorwidth"]=$l.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,w)}createBucket(w){return new DA(w)}queryRadius(w){const I=w,H=Mc(Tl("line-width",this,I),Tl("line-gap-width",this,I)),q=Tl("line-offset",this,I);return H/2+Math.abs(q)+Wl(this.paint.get("line-translate"))}queryIntersectsFeature(w,I,H,q,ee,ie,oe){const de=ql(w,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),ie.angle,oe),_e=oe/2*Mc(this.paint.get("line-width").evaluate(I,H),this.paint.get("line-gap-width").evaluate(I,H)),Ee=this.paint.get("line-offset").evaluate(I,H);return Ee&&(q=function(Fe,Pe){const He=[];for(let Ne=0;Ne<Fe.length;Ne++){const tt=Fe[Ne],at=[];for(let ct=0;ct<tt.length;ct++){const mt=tt[ct-1],ht=tt[ct],bt=tt[ct+1],Ct=ct===0?new ge(0,0):ht.sub(mt)._unit()._perp(),Qt=ct===tt.length-1?new ge(0,0):bt.sub(ht)._unit()._perp(),fi=Ct._add(Qt)._unit(),Ci=fi.x*Qt.x+fi.y*Qt.y;Ci!==0&&fi._mult(1/Ci),at.push(fi._mult(Pe)._add(ht))}He.push(at)}return He}(q,Ee*oe)),function(Fe,Pe,He){for(let Ne=0;Ne<Pe.length;Ne++){const tt=Pe[Ne];if(Fe.length>=3){for(let at=0;at<tt.length;at++)if(nl(Fe,tt[at]))return!0}if(Qh(Fe,tt,He))return!0}return!1}(de,q,_e)}isTileClipped(){return!0}}function Mc(C,w){return w>0?w+2*C:C}const Du=ts([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Uu=ts([{name:"a_projected_pos",components:3,type:"Float32"}],4);ts([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Mu=ts([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);ts([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Pc=ts([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Pu=ts([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Lu(C,w,I){return C.sections.forEach(H=>{H.text=function(q,ee,ie){const oe=ee.layout.get("text-transform").evaluate(ie,{});return oe==="uppercase"?q=q.toLocaleUpperCase():oe==="lowercase"&&(q=q.toLocaleLowerCase()),ns.applyArabicShaping&&(q=ns.applyArabicShaping(q)),q}(H.text,w,I)}),C}ts([{name:"triangle",components:3,type:"Uint16"}]),ts([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ts([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ts([{type:"Float32",name:"offsetX"}]),ts([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ts([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Ll={"!":"ï¸","#":"ï¼",$:"ï¼","%":"ï¼","&":"ï¼","(":"ï¸µ",")":"ï¸¶","*":"ï¼","+":"ï¼",",":"ï¸","-":"ï¸²",".":"ã»","/":"ï¼",":":"ï¸",";":"ï¸","<":"ï¸¿","=":"ï¼",">":"ï¹","?":"ï¸","@":"ï¼ ","[":"ï¹","\\":"ï¼¼","]":"ï¹","^":"ï¼¾",_:"ï¸³","`":"ï½","{":"ï¸·","|":"â","}":"ï¸¸","~":"ï½","Â¢":"ï¿ ","Â£":"ï¿¡","Â¥":"ï¿¥","Â¦":"ï¿¤","Â¬":"ï¿¢","Â¯":"ï¿£","â":"ï¸²","â":"ï¸±","â":"ï¹","â":"ï¹","â":"ï¹","â":"ï¹","â¦":"ï¸","â§":"ã»","â©":"ï¿¦","ã":"ï¸","ã":"ï¸","ã":"ï¸¿","ã":"ï¹","ã":"ï¸½","ã":"ï¸¾","ã":"ï¹","ã":"ï¹","ã":"ï¹","ã":"ï¹","ã":"ï¸»","ã":"ï¸¼","ã":"ï¸¹","ã":"ï¸º","ã":"ï¸","ã":"ï¸","ï¼":"ï¸","ï¼":"ï¸µ","ï¼":"ï¸¶","ï¼":"ï¸","ï¼":"ï¸²","ï¼":"ã»","ï¼":"ï¸","ï¼":"ï¸","ï¼":"ï¸¿","ï¼":"ï¹","ï¼":"ï¸","ï¼»":"ï¹","ï¼½":"ï¹","ï¼¿":"ï¸³","ï½":"ï¸·","ï½":"â","ï½":"ï¸¸","ï½":"ï¸µ","ï½ ":"ï¸¶","ï½¡":"ï¸","ï½¢":"ï¹","ï½£":"ï¹"};var us=24,Lc=Dr,Qc=function(C,w,I,H,q){var ee,ie,oe=8*q-H-1,de=(1<<oe)-1,_e=de>>1,Ee=-7,Fe=q-1,Pe=-1,He=C[w+Fe];for(Fe+=Pe,ee=He&(1<<-Ee)-1,He>>=-Ee,Ee+=oe;Ee>0;ee=256*ee+C[w+Fe],Fe+=Pe,Ee-=8);for(ie=ee&(1<<-Ee)-1,ee>>=-Ee,Ee+=H;Ee>0;ie=256*ie+C[w+Fe],Fe+=Pe,Ee-=8);if(ee===0)ee=1-_e;else{if(ee===de)return ie?NaN:1/0*(He?-1:1);ie+=Math.pow(2,H),ee-=_e}return(He?-1:1)*ie*Math.pow(2,ee-H)},Oc=function(C,w,I,H,q,ee){var ie,oe,de,_e=8*ee-q-1,Ee=(1<<_e)-1,Fe=Ee>>1,Pe=q===23?Math.pow(2,-24)-Math.pow(2,-77):0,He=0,Ne=1,tt=w<0||w===0&&1/w<0?1:0;for(w=Math.abs(w),isNaN(w)||w===1/0?(oe=isNaN(w)?1:0,ie=Ee):(ie=Math.floor(Math.log(w)/Math.LN2),w*(de=Math.pow(2,-ie))<1&&(ie--,de*=2),(w+=ie+Fe>=1?Pe/de:Pe*Math.pow(2,1-Fe))*de>=2&&(ie++,de/=2),ie+Fe>=Ee?(oe=0,ie=Ee):ie+Fe>=1?(oe=(w*de-1)*Math.pow(2,q),ie+=Fe):(oe=w*Math.pow(2,Fe-1)*Math.pow(2,q),ie=0));q>=8;C[I+He]=255&oe,He+=Ne,oe/=256,q-=8);for(ie=ie<<q|oe,_e+=q;_e>0;C[I+He]=255&ie,He+=Ne,ie/=256,_e-=8);C[I+He-Ne]|=128*tt};function Dr(C){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(C)?C:new Uint8Array(C||0),this.pos=0,this.type=0,this.length=this.buf.length}Dr.Varint=0,Dr.Fixed64=1,Dr.Bytes=2,Dr.Fixed32=5;var UA=4294967296,Rc=1/UA,Hc=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Wa(C){return C.type===Dr.Bytes?C.readVarint()+C.pos:C.pos+1}function Al(C,w,I){return I?4294967296*w+(C>>>0):4294967296*(w>>>0)+(C>>>0)}function zc(C,w,I){var H=w<=16383?1:w<=2097151?2:w<=268435455?3:Math.floor(Math.log(w)/(7*Math.LN2));I.realloc(H);for(var q=I.pos-1;q>=C;q--)I.buf[q+H]=I.buf[q]}function Qu(C,w){for(var I=0;I<C.length;I++)w.writeVarint(C[I])}function Ou(C,w){for(var I=0;I<C.length;I++)w.writeSVarint(C[I])}function Ru(C,w){for(var I=0;I<C.length;I++)w.writeFloat(C[I])}function Hu(C,w){for(var I=0;I<C.length;I++)w.writeDouble(C[I])}function zu(C,w){for(var I=0;I<C.length;I++)w.writeBoolean(C[I])}function Nu(C,w){for(var I=0;I<C.length;I++)w.writeFixed32(C[I])}function Vu(C,w){for(var I=0;I<C.length;I++)w.writeSFixed32(C[I])}function Ku(C,w){for(var I=0;I<C.length;I++)w.writeFixed64(C[I])}function Gu(C,w){for(var I=0;I<C.length;I++)w.writeSFixed64(C[I])}function eA(C,w){return(C[w]|C[w+1]<<8|C[w+2]<<16)+16777216*C[w+3]}function cl(C,w,I){C[I]=w,C[I+1]=w>>>8,C[I+2]=w>>>16,C[I+3]=w>>>24}function Nc(C,w){return(C[w]|C[w+1]<<8|C[w+2]<<16)+(C[w+3]<<24)}Dr.prototype={destroy:function(){this.buf=null},readFields:function(C,w,I){for(I=I||this.length;this.pos<I;){var H=this.readVarint(),q=H>>3,ee=this.pos;this.type=7&H,C(q,w,this),this.pos===ee&&this.skip(H)}return w},readMessage:function(C,w){return this.readFields(C,w,this.readVarint()+this.pos)},readFixed32:function(){var C=eA(this.buf,this.pos);return this.pos+=4,C},readSFixed32:function(){var C=Nc(this.buf,this.pos);return this.pos+=4,C},readFixed64:function(){var C=eA(this.buf,this.pos)+eA(this.buf,this.pos+4)*UA;return this.pos+=8,C},readSFixed64:function(){var C=eA(this.buf,this.pos)+Nc(this.buf,this.pos+4)*UA;return this.pos+=8,C},readFloat:function(){var C=Qc(this.buf,this.pos,!0,23,4);return this.pos+=4,C},readDouble:function(){var C=Qc(this.buf,this.pos,!0,52,8);return this.pos+=8,C},readVarint:function(C){var w,I,H=this.buf;return w=127&(I=H[this.pos++]),I<128?w:(w|=(127&(I=H[this.pos++]))<<7,I<128?w:(w|=(127&(I=H[this.pos++]))<<14,I<128?w:(w|=(127&(I=H[this.pos++]))<<21,I<128?w:function(q,ee,ie){var oe,de,_e=ie.buf;if(oe=(112&(de=_e[ie.pos++]))>>4,de<128||(oe|=(127&(de=_e[ie.pos++]))<<3,de<128)||(oe|=(127&(de=_e[ie.pos++]))<<10,de<128)||(oe|=(127&(de=_e[ie.pos++]))<<17,de<128)||(oe|=(127&(de=_e[ie.pos++]))<<24,de<128)||(oe|=(1&(de=_e[ie.pos++]))<<31,de<128))return Al(q,oe,ee);throw new Error("Expected varint not more than 10 bytes")}(w|=(15&(I=H[this.pos]))<<28,C,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var C=this.readVarint();return C%2==1?(C+1)/-2:C/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var C=this.readVarint()+this.pos,w=this.pos;return this.pos=C,C-w>=12&&Hc?function(I,H,q){return Hc.decode(I.subarray(H,q))}(this.buf,w,C):function(I,H,q){for(var ee="",ie=H;ie<q;){var oe,de,_e,Ee=I[ie],Fe=null,Pe=Ee>239?4:Ee>223?3:Ee>191?2:1;if(ie+Pe>q)break;Pe===1?Ee<128&&(Fe=Ee):Pe===2?(192&(oe=I[ie+1]))==128&&(Fe=(31&Ee)<<6|63&oe)<=127&&(Fe=null):Pe===3?(de=I[ie+2],(192&(oe=I[ie+1]))==128&&(192&de)==128&&((Fe=(15&Ee)<<12|(63&oe)<<6|63&de)<=2047||Fe>=55296&&Fe<=57343)&&(Fe=null)):Pe===4&&(de=I[ie+2],_e=I[ie+3],(192&(oe=I[ie+1]))==128&&(192&de)==128&&(192&_e)==128&&((Fe=(15&Ee)<<18|(63&oe)<<12|(63&de)<<6|63&_e)<=65535||Fe>=1114112)&&(Fe=null)),Fe===null?(Fe=65533,Pe=1):Fe>65535&&(Fe-=65536,ee+=String.fromCharCode(Fe>>>10&1023|55296),Fe=56320|1023&Fe),ee+=String.fromCharCode(Fe),ie+=Pe}return ee}(this.buf,w,C)},readBytes:function(){var C=this.readVarint()+this.pos,w=this.buf.subarray(this.pos,C);return this.pos=C,w},readPackedVarint:function(C,w){if(this.type!==Dr.Bytes)return C.push(this.readVarint(w));var I=Wa(this);for(C=C||[];this.pos<I;)C.push(this.readVarint(w));return C},readPackedSVarint:function(C){if(this.type!==Dr.Bytes)return C.push(this.readSVarint());var w=Wa(this);for(C=C||[];this.pos<w;)C.push(this.readSVarint());return C},readPackedBoolean:function(C){if(this.type!==Dr.Bytes)return C.push(this.readBoolean());var w=Wa(this);for(C=C||[];this.pos<w;)C.push(this.readBoolean());return C},readPackedFloat:function(C){if(this.type!==Dr.Bytes)return C.push(this.readFloat());var w=Wa(this);for(C=C||[];this.pos<w;)C.push(this.readFloat());return C},readPackedDouble:function(C){if(this.type!==Dr.Bytes)return C.push(this.readDouble());var w=Wa(this);for(C=C||[];this.pos<w;)C.push(this.readDouble());return C},readPackedFixed32:function(C){if(this.type!==Dr.Bytes)return C.push(this.readFixed32());var w=Wa(this);for(C=C||[];this.pos<w;)C.push(this.readFixed32());return C},readPackedSFixed32:function(C){if(this.type!==Dr.Bytes)return C.push(this.readSFixed32());var w=Wa(this);for(C=C||[];this.pos<w;)C.push(this.readSFixed32());return C},readPackedFixed64:function(C){if(this.type!==Dr.Bytes)return C.push(this.readFixed64());var w=Wa(this);for(C=C||[];this.pos<w;)C.push(this.readFixed64());return C},readPackedSFixed64:function(C){if(this.type!==Dr.Bytes)return C.push(this.readSFixed64());var w=Wa(this);for(C=C||[];this.pos<w;)C.push(this.readSFixed64());return C},skip:function(C){var w=7&C;if(w===Dr.Varint)for(;this.buf[this.pos++]>127;);else if(w===Dr.Bytes)this.pos=this.readVarint()+this.pos;else if(w===Dr.Fixed32)this.pos+=4;else{if(w!==Dr.Fixed64)throw new Error("Unimplemented type: "+w);this.pos+=8}},writeTag:function(C,w){this.writeVarint(C<<3|w)},realloc:function(C){for(var w=this.length||16;w<this.pos+C;)w*=2;if(w!==this.length){var I=new Uint8Array(w);I.set(this.buf),this.buf=I,this.length=w}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(C){this.realloc(4),cl(this.buf,C,this.pos),this.pos+=4},writeSFixed32:function(C){this.realloc(4),cl(this.buf,C,this.pos),this.pos+=4},writeFixed64:function(C){this.realloc(8),cl(this.buf,-1&C,this.pos),cl(this.buf,Math.floor(C*Rc),this.pos+4),this.pos+=8},writeSFixed64:function(C){this.realloc(8),cl(this.buf,-1&C,this.pos),cl(this.buf,Math.floor(C*Rc),this.pos+4),this.pos+=8},writeVarint:function(C){(C=+C||0)>268435455||C<0?function(w,I){var H,q;if(w>=0?(H=w%4294967296|0,q=w/4294967296|0):(q=~(-w/4294967296),4294967295^(H=~(-w%4294967296))?H=H+1|0:(H=0,q=q+1|0)),w>=18446744073709552e3||w<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");I.realloc(10),function(ee,ie,oe){oe.buf[oe.pos++]=127&ee|128,ee>>>=7,oe.buf[oe.pos++]=127&ee|128,ee>>>=7,oe.buf[oe.pos++]=127&ee|128,ee>>>=7,oe.buf[oe.pos++]=127&ee|128,oe.buf[oe.pos]=127&(ee>>>=7)}(H,0,I),function(ee,ie){var oe=(7&ee)<<4;ie.buf[ie.pos++]|=oe|((ee>>>=3)?128:0),ee&&(ie.buf[ie.pos++]=127&ee|((ee>>>=7)?128:0),ee&&(ie.buf[ie.pos++]=127&ee|((ee>>>=7)?128:0),ee&&(ie.buf[ie.pos++]=127&ee|((ee>>>=7)?128:0),ee&&(ie.buf[ie.pos++]=127&ee|((ee>>>=7)?128:0),ee&&(ie.buf[ie.pos++]=127&ee)))))}(q,I)}(C,this):(this.realloc(4),this.buf[this.pos++]=127&C|(C>127?128:0),C<=127||(this.buf[this.pos++]=127&(C>>>=7)|(C>127?128:0),C<=127||(this.buf[this.pos++]=127&(C>>>=7)|(C>127?128:0),C<=127||(this.buf[this.pos++]=C>>>7&127))))},writeSVarint:function(C){this.writeVarint(C<0?2*-C-1:2*C)},writeBoolean:function(C){this.writeVarint(!!C)},writeString:function(C){C=String(C),this.realloc(4*C.length),this.pos++;var w=this.pos;this.pos=function(H,q,ee){for(var ie,oe,de=0;de<q.length;de++){if((ie=q.charCodeAt(de))>55295&&ie<57344){if(!oe){ie>56319||de+1===q.length?(H[ee++]=239,H[ee++]=191,H[ee++]=189):oe=ie;continue}if(ie<56320){H[ee++]=239,H[ee++]=191,H[ee++]=189,oe=ie;continue}ie=oe-55296<<10|ie-56320|65536,oe=null}else oe&&(H[ee++]=239,H[ee++]=191,H[ee++]=189,oe=null);ie<128?H[ee++]=ie:(ie<2048?H[ee++]=ie>>6|192:(ie<65536?H[ee++]=ie>>12|224:(H[ee++]=ie>>18|240,H[ee++]=ie>>12&63|128),H[ee++]=ie>>6&63|128),H[ee++]=63&ie|128)}return ee}(this.buf,C,this.pos);var I=this.pos-w;I>=128&&zc(w,I,this),this.pos=w-1,this.writeVarint(I),this.pos+=I},writeFloat:function(C){this.realloc(4),Oc(this.buf,C,this.pos,!0,23,4),this.pos+=4},writeDouble:function(C){this.realloc(8),Oc(this.buf,C,this.pos,!0,52,8),this.pos+=8},writeBytes:function(C){var w=C.length;this.writeVarint(w),this.realloc(w);for(var I=0;I<w;I++)this.buf[this.pos++]=C[I]},writeRawMessage:function(C,w){this.pos++;var I=this.pos;C(w,this);var H=this.pos-I;H>=128&&zc(I,H,this),this.pos=I-1,this.writeVarint(H),this.pos+=H},writeMessage:function(C,w,I){this.writeTag(C,Dr.Bytes),this.writeRawMessage(w,I)},writePackedVarint:function(C,w){w.length&&this.writeMessage(C,Qu,w)},writePackedSVarint:function(C,w){w.length&&this.writeMessage(C,Ou,w)},writePackedBoolean:function(C,w){w.length&&this.writeMessage(C,zu,w)},writePackedFloat:function(C,w){w.length&&this.writeMessage(C,Ru,w)},writePackedDouble:function(C,w){w.length&&this.writeMessage(C,Hu,w)},writePackedFixed32:function(C,w){w.length&&this.writeMessage(C,Nu,w)},writePackedSFixed32:function(C,w){w.length&&this.writeMessage(C,Vu,w)},writePackedFixed64:function(C,w){w.length&&this.writeMessage(C,Ku,w)},writePackedSFixed64:function(C,w){w.length&&this.writeMessage(C,Gu,w)},writeBytesField:function(C,w){this.writeTag(C,Dr.Bytes),this.writeBytes(w)},writeFixed32Field:function(C,w){this.writeTag(C,Dr.Fixed32),this.writeFixed32(w)},writeSFixed32Field:function(C,w){this.writeTag(C,Dr.Fixed32),this.writeSFixed32(w)},writeFixed64Field:function(C,w){this.writeTag(C,Dr.Fixed64),this.writeFixed64(w)},writeSFixed64Field:function(C,w){this.writeTag(C,Dr.Fixed64),this.writeSFixed64(w)},writeVarintField:function(C,w){this.writeTag(C,Dr.Varint),this.writeVarint(w)},writeSVarintField:function(C,w){this.writeTag(C,Dr.Varint),this.writeSVarint(w)},writeStringField:function(C,w){this.writeTag(C,Dr.Bytes),this.writeString(w)},writeFloatField:function(C,w){this.writeTag(C,Dr.Fixed32),this.writeFloat(w)},writeDoubleField:function(C,w){this.writeTag(C,Dr.Fixed64),this.writeDouble(w)},writeBooleanField:function(C,w){this.writeVarintField(C,!!w)}};var MA=ne(Lc);const PA=3;function Wu(C,w,I){C===1&&I.readMessage(qu,w)}function qu(C,w,I){if(C===3){const{id:H,bitmap:q,width:ee,height:ie,left:oe,top:de,advance:_e}=I.readMessage(Xu,{});w.push({id:H,bitmap:new Il({width:ee+2*PA,height:ie+2*PA},q),metrics:{width:ee,height:ie,left:oe,top:de,advance:_e}})}}function Xu(C,w,I){C===1?w.id=I.readVarint():C===2?w.bitmap=I.readBytes():C===3?w.width=I.readVarint():C===4?w.height=I.readVarint():C===5?w.left=I.readSVarint():C===6?w.top=I.readSVarint():C===7&&(w.advance=I.readVarint())}const Vc=PA;function Kc(C){let w=0,I=0;for(const ie of C)w+=ie.w*ie.h,I=Math.max(I,ie.w);C.sort((ie,oe)=>oe.h-ie.h);const H=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(w/.95)),I),h:1/0}];let q=0,ee=0;for(const ie of C)for(let oe=H.length-1;oe>=0;oe--){const de=H[oe];if(!(ie.w>de.w||ie.h>de.h)){if(ie.x=de.x,ie.y=de.y,ee=Math.max(ee,ie.y+ie.h),q=Math.max(q,ie.x+ie.w),ie.w===de.w&&ie.h===de.h){const _e=H.pop();oe<H.length&&(H[oe]=_e)}else ie.h===de.h?(de.x+=ie.w,de.w-=ie.w):ie.w===de.w?(de.y+=ie.h,de.h-=ie.h):(H.push({x:de.x+ie.w,y:de.y,w:de.w-ie.w,h:ie.h}),de.y+=ie.h,de.h-=ie.h);break}}return{w:q,h:ee,fill:w/(q*ee)||0}}const sn=1;class LA{constructor(w,{pixelRatio:I,version:H,stretchX:q,stretchY:ee,content:ie}){this.paddedRect=w,this.pixelRatio=I,this.stretchX=q,this.stretchY=ee,this.content=ie,this.version=H}get tl(){return[this.paddedRect.x+sn,this.paddedRect.y+sn]}get br(){return[this.paddedRect.x+this.paddedRect.w-sn,this.paddedRect.y+this.paddedRect.h-sn]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*sn)/this.pixelRatio,(this.paddedRect.h-2*sn)/this.pixelRatio]}}class Gc{constructor(w,I){const H={},q={};this.haveRenderCallbacks=[];const ee=[];this.addImages(w,H,ee),this.addImages(I,q,ee);const{w:ie,h:oe}=Kc(ee),de=new xn({width:ie||1,height:oe||1});for(const _e in w){const Ee=w[_e],Fe=H[_e].paddedRect;xn.copy(Ee.data,de,{x:0,y:0},{x:Fe.x+sn,y:Fe.y+sn},Ee.data)}for(const _e in I){const Ee=I[_e],Fe=q[_e].paddedRect,Pe=Fe.x+sn,He=Fe.y+sn,Ne=Ee.data.width,tt=Ee.data.height;xn.copy(Ee.data,de,{x:0,y:0},{x:Pe,y:He},Ee.data),xn.copy(Ee.data,de,{x:0,y:tt-1},{x:Pe,y:He-1},{width:Ne,height:1}),xn.copy(Ee.data,de,{x:0,y:0},{x:Pe,y:He+tt},{width:Ne,height:1}),xn.copy(Ee.data,de,{x:Ne-1,y:0},{x:Pe-1,y:He},{width:1,height:tt}),xn.copy(Ee.data,de,{x:0,y:0},{x:Pe+Ne,y:He},{width:1,height:tt})}this.image=de,this.iconPositions=H,this.patternPositions=q}addImages(w,I,H){for(const q in w){const ee=w[q],ie={x:0,y:0,w:ee.data.width+2*sn,h:ee.data.height+2*sn};H.push(ie),I[q]=new LA(ie,ee),ee.hasRenderCallback&&this.haveRenderCallbacks.push(q)}}patchUpdatedImages(w,I){w.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const H in w.updatedImages)this.patchUpdatedImage(this.iconPositions[H],w.getImage(H),I),this.patchUpdatedImage(this.patternPositions[H],w.getImage(H),I)}patchUpdatedImage(w,I,H){if(!w||!I||w.version===I.version)return;w.version=I.version;const[q,ee]=w.tl;H.update(I.data,void 0,{x:q,y:ee})}}var _o;gi("ImagePosition",LA),gi("ImageAtlas",Gc),D.WritingMode=void 0,(_o=D.WritingMode||(D.WritingMode={}))[_o.none=0]="none",_o[_o.horizontal=1]="horizontal",_o[_o.vertical=2]="vertical",_o[_o.horizontalOnly=3]="horizontalOnly";const Ql=-17;class Ol{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(w,I){const H=new Ol;return H.scale=w||1,H.fontStack=I,H}static forImage(w){const I=new Ol;return I.imageName=w,I}}class hl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(w,I){const H=new hl;for(let q=0;q<w.sections.length;q++){const ee=w.sections[q];ee.image?H.addImageSection(ee):H.addTextSection(ee,I)}return H}length(){return this.text.length}getSection(w){return this.sections[this.sectionIndex[w]]}getSectionIndex(w){return this.sectionIndex[w]}getCharCode(w){return this.text.charCodeAt(w)}verticalizePunctuation(){this.text=function(w){let I="";for(let H=0;H<w.length;H++){const q=w.charCodeAt(H+1)||null,ee=w.charCodeAt(H-1)||null;I+=q&&hi(q)&&!Ll[w[H+1]]||ee&&hi(ee)&&!Ll[w[H-1]]||!Ll[w[H]]?w[H]:Ll[w[H]]}return I}(this.text)}trim(){let w=0;for(let H=0;H<this.text.length&&iA[this.text.charCodeAt(H)];H++)w++;let I=this.text.length;for(let H=this.text.length-1;H>=0&&H>=w&&iA[this.text.charCodeAt(H)];H--)I--;this.text=this.text.substring(w,I),this.sectionIndex=this.sectionIndex.slice(w,I)}substring(w,I){const H=new hl;return H.text=this.text.substring(w,I),H.sectionIndex=this.sectionIndex.slice(w,I),H.sections=this.sections,H}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((w,I)=>Math.max(w,this.sections[I].scale),0)}addTextSection(w,I){this.text+=w.text,this.sections.push(Ol.forText(w.scale,w.fontStack||I));const H=this.sections.length-1;for(let q=0;q<w.text.length;++q)this.sectionIndex.push(H)}addImageSection(w){const I=w.image?w.image.name:"";if(I.length===0)return void Vt("Can't add FormattedSection with an empty image.");const H=this.getNextImageSectionCharCode();H?(this.text+=String.fromCharCode(H),this.sections.push(Ol.forImage(I)),this.sectionIndex.push(this.sections.length-1)):Vt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function tA(C,w,I,H,q,ee,ie,oe,de,_e,Ee,Fe,Pe,He,Ne,tt){const at=hl.fromFeature(C,q);let ct;Fe===D.WritingMode.vertical&&at.verticalizePunctuation();const{processBidirectionalText:mt,processStyledBidirectionalText:ht}=ns;if(mt&&at.sections.length===1){ct=[];const Qt=mt(at.toString(),QA(at,_e,ee,w,H,He,Ne));for(const fi of Qt){const Ci=new hl;Ci.text=fi,Ci.sections=at.sections;for(let ui=0;ui<fi.length;ui++)Ci.sectionIndex.push(0);ct.push(Ci)}}else if(ht){ct=[];const Qt=ht(at.text,at.sectionIndex,QA(at,_e,ee,w,H,He,Ne));for(const fi of Qt){const Ci=new hl;Ci.text=fi[0],Ci.sectionIndex=fi[1],Ci.sections=at.sections,ct.push(Ci)}}else ct=function(Qt,fi){const Ci=[],ui=Qt.text;let li=0;for(const ti of fi)Ci.push(Qt.substring(li,ti)),li=ti;return li<ui.length&&Ci.push(Qt.substring(li,ui.length)),Ci}(at,QA(at,_e,ee,w,H,He,Ne));const bt=[],Ct={positionedLines:bt,text:at.toString(),top:Ee[1],bottom:Ee[1],left:Ee[0],right:Ee[0],writingMode:Fe,iconsInText:!1,verticalizable:!1};return function(Qt,fi,Ci,ui,li,ti,yi,si,Gt,Pi,Si,ir){let Rr=0,zr=Ql,fs=0,fn=0;const Gs=si==="right"?1:si==="left"?0:.5;let os=0;for(const ls of li){ls.trim();const ds=ls.getMaxScale(),Ps=(ds-1)*us,qs={positionedGlyphs:[],lineOffset:0};Qt.positionedLines[os]=qs;const an=qs.positionedGlyphs;let on=0;if(!ls.length()){zr+=ti,++os;continue}for(let Is=0;Is<ls.length();Is++){const fr=ls.getSection(Is),dn=ls.getSectionIndex(Is),Fs=ls.getCharCode(Is);let Xs=0,Pn=null,Zn=null,Jn=null,qa=us;const Ln=!(Gt===D.WritingMode.horizontal||!Si&&!jt(Fs)||Si&&(iA[Fs]||(ms=Fs,je.Arabic(ms)||je["Arabic Supplement"](ms)||je["Arabic Extended-A"](ms)||je["Arabic Presentation Forms-A"](ms)||je["Arabic Presentation Forms-B"](ms))));if(fr.imageName){const Cn=ui[fr.imageName];if(!Cn)continue;Jn=fr.imageName,Qt.iconsInText=Qt.iconsInText||!0,Zn=Cn.paddedRect;const ln=Cn.displaySize;fr.scale=fr.scale*us/ir,Pn={width:ln[0],height:ln[1],left:sn,top:-Vc,advance:Ln?ln[1]:ln[0]},Xs=Ps+(us-ln[1]*fr.scale),qa=Pn.advance;const Xa=Ln?ln[0]*fr.scale-us*ds:ln[1]*fr.scale-us*ds;Xa>0&&Xa>on&&(on=Xa)}else{const Cn=Ci[fr.fontStack],ln=Cn&&Cn[Fs];if(ln&&ln.rect)Zn=ln.rect,Pn=ln.metrics;else{const Xa=fi[fr.fontStack],Vl=Xa&&Xa[Fs];if(!Vl)continue;Pn=Vl.metrics}Xs=(ds-fr.scale)*us}Ln?(Qt.verticalizable=!0,an.push({glyph:Fs,imageName:Jn,x:Rr,y:zr+Xs,vertical:Ln,scale:fr.scale,fontStack:fr.fontStack,sectionIndex:dn,metrics:Pn,rect:Zn}),Rr+=qa*fr.scale+Pi):(an.push({glyph:Fs,imageName:Jn,x:Rr,y:zr+Xs,vertical:Ln,scale:fr.scale,fontStack:fr.fontStack,sectionIndex:dn,metrics:Pn,rect:Zn}),Rr+=Pn.advance*fr.scale+Pi)}an.length!==0&&(fs=Math.max(Rr-Pi,fs),Zu(an,0,an.length-1,Gs,on)),Rr=0;const Jr=ti*ds+on;qs.lineOffset=Math.max(on,Ps),zr+=Jr,fn=Math.max(Jr,fn),++os}var ms;const Ss=zr-Ql,{horizontalAlign:nn,verticalAlign:Ws}=OA(yi);(function(ls,ds,Ps,qs,an,on,Jr,Is,fr){const dn=(ds-Ps)*an;let Fs=0;Fs=on!==Jr?-Is*qs-Ql:(-qs*fr+.5)*Jr;for(const Xs of ls)for(const Pn of Xs.positionedGlyphs)Pn.x+=dn,Pn.y+=Fs})(Qt.positionedLines,Gs,nn,Ws,fs,fn,ti,Ss,li.length),Qt.top+=-Ws*Ss,Qt.bottom=Qt.top+Ss,Qt.left+=-nn*fs,Qt.right=Qt.left+fs}(Ct,w,I,H,ct,ie,oe,de,Fe,_e,Pe,tt),!function(Qt){for(const fi of Qt)if(fi.positionedGlyphs.length!==0)return!1;return!0}(bt)&&Ct}const iA={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Yu={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Wc(C,w,I,H,q,ee){if(w.imageName){const ie=H[w.imageName];return ie?ie.displaySize[0]*w.scale*us/ee+q:0}{const ie=I[w.fontStack],oe=ie&&ie[C];return oe?oe.metrics.advance*w.scale+q:0}}function qc(C,w,I,H){const q=Math.pow(C-w,2);return H?C<w?q/2:2*q:q+Math.abs(I)*I}function ju(C,w,I){let H=0;return C===10&&(H-=1e4),I&&(H+=150),C!==40&&C!==65288||(H+=50),w!==41&&w!==65289||(H+=50),H}function Xc(C,w,I,H,q,ee){let ie=null,oe=qc(w,I,q,ee);for(const de of H){const _e=qc(w-de.x,I,q,ee)+de.badness;_e<=oe&&(ie=de,oe=_e)}return{index:C,x:w,priorBreak:ie,badness:oe}}function Yc(C){return C?Yc(C.priorBreak).concat(C.index):[]}function QA(C,w,I,H,q,ee,ie){if(ee!=="point")return[];if(!C)return[];const oe=[],de=function(Pe,He,Ne,tt,at,ct){let mt=0;for(let ht=0;ht<Pe.length();ht++){const bt=Pe.getSection(ht);mt+=Wc(Pe.getCharCode(ht),bt,tt,at,He,ct)}return mt/Math.max(1,Math.ceil(mt/Ne))}(C,w,I,H,q,ie),_e=C.text.indexOf("â")>=0;let Ee=0;for(let Pe=0;Pe<C.length();Pe++){const He=C.getSection(Pe),Ne=C.getCharCode(Pe);if(iA[Ne]||(Ee+=Wc(Ne,He,H,q,w,ie)),Pe<C.length()-1){const tt=!((Fe=Ne)<11904||!(je["Bopomofo Extended"](Fe)||je.Bopomofo(Fe)||je["CJK Compatibility Forms"](Fe)||je["CJK Compatibility Ideographs"](Fe)||je["CJK Compatibility"](Fe)||je["CJK Radicals Supplement"](Fe)||je["CJK Strokes"](Fe)||je["CJK Symbols and Punctuation"](Fe)||je["CJK Unified Ideographs Extension A"](Fe)||je["CJK Unified Ideographs"](Fe)||je["Enclosed CJK Letters and Months"](Fe)||je["Halfwidth and Fullwidth Forms"](Fe)||je.Hiragana(Fe)||je["Ideographic Description Characters"](Fe)||je["Kangxi Radicals"](Fe)||je["Katakana Phonetic Extensions"](Fe)||je.Katakana(Fe)||je["Vertical Forms"](Fe)||je["Yi Radicals"](Fe)||je["Yi Syllables"](Fe)));(Yu[Ne]||tt||He.imageName)&&oe.push(Xc(Pe+1,Ee,de,oe,ju(Ne,C.getCharCode(Pe+1),tt&&_e),!1))}}var Fe;return Yc(Xc(C.length(),Ee,de,oe,0,!0))}function OA(C){let w=.5,I=.5;switch(C){case"right":case"top-right":case"bottom-right":w=1;break;case"left":case"top-left":case"bottom-left":w=0}switch(C){case"bottom":case"bottom-right":case"bottom-left":I=1;break;case"top":case"top-right":case"top-left":I=0}return{horizontalAlign:w,verticalAlign:I}}function Zu(C,w,I,H,q){if(!H&&!q)return;const ee=C[I],ie=(C[I].x+ee.metrics.advance*ee.scale)*H;for(let oe=w;oe<=I;oe++)C[oe].x-=ie,C[oe].y+=q}function Ju(C,w,I){const{horizontalAlign:H,verticalAlign:q}=OA(I),ee=w[0]-C.displaySize[0]*H,ie=w[1]-C.displaySize[1]*q;return{image:C,top:ie,bottom:ie+C.displaySize[1],left:ee,right:ee+C.displaySize[0]}}function jc(C,w,I,H,q,ee){const ie=C.image;let oe;if(ie.content){const at=ie.content,ct=ie.pixelRatio||1;oe=[at[0]/ct,at[1]/ct,ie.displaySize[0]-at[2]/ct,ie.displaySize[1]-at[3]/ct]}const de=w.left*ee,_e=w.right*ee;let Ee,Fe,Pe,He;I==="width"||I==="both"?(He=q[0]+de-H[3],Fe=q[0]+_e+H[1]):(He=q[0]+(de+_e-ie.displaySize[0])/2,Fe=He+ie.displaySize[0]);const Ne=w.top*ee,tt=w.bottom*ee;return I==="height"||I==="both"?(Ee=q[1]+Ne-H[0],Pe=q[1]+tt+H[2]):(Ee=q[1]+(Ne+tt-ie.displaySize[1])/2,Pe=Ee+ie.displaySize[1]),{image:ie,top:Ee,right:Fe,bottom:Pe,left:He,collisionPadding:oe}}const Rl=255,va=128,yo=Rl*va;function Zc(C,w){const{expression:I}=w;if(I.kind==="constant")return{kind:"constant",layoutSize:I.evaluate(new Er(C+1))};if(I.kind==="source")return{kind:"source"};{const{zoomStops:H,interpolationType:q}=I;let ee=0;for(;ee<H.length&&H[ee]<=C;)ee++;ee=Math.max(0,ee-1);let ie=ee;for(;ie<H.length&&H[ie]<C+1;)ie++;ie=Math.min(H.length-1,ie);const oe=H[ee],de=H[ie];return I.kind==="composite"?{kind:"composite",minZoom:oe,maxZoom:de,interpolationType:q}:{kind:"camera",minZoom:oe,maxZoom:de,minSize:I.evaluate(new Er(oe)),maxSize:I.evaluate(new Er(de)),interpolationType:q}}}function RA(C,w,I){let H="never";const q=C.get(w);return q?H=q:C.get(I)&&(H="always"),H}const $u=mo.VectorTileFeature.types,ef=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function rA(C,w,I,H,q,ee,ie,oe,de,_e,Ee,Fe,Pe){const He=oe?Math.min(yo,Math.round(oe[0])):0,Ne=oe?Math.min(yo,Math.round(oe[1])):0;C.emplaceBack(w,I,Math.round(32*H),Math.round(32*q),ee,ie,(He<<1)+(de?1:0),Ne,16*_e,16*Ee,256*Fe,256*Pe)}function HA(C,w,I){C.emplaceBack(w.x,w.y,I),C.emplaceBack(w.x,w.y,I),C.emplaceBack(w.x,w.y,I),C.emplaceBack(w.x,w.y,I)}function tf(C){for(const w of C.sections)if(zi(w.text))return!0;return!1}class zA{constructor(w){this.layoutVertexArray=new Rt,this.indexArray=new ki,this.programConfigurations=w,this.segments=new Mi,this.dynamicLayoutVertexArray=new Jt,this.opacityVertexArray=new Bi,this.hasVisibleVertices=!1,this.placedSymbolArray=new ve}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(w,I,H,q){this.isEmpty()||(H&&(this.layoutVertexBuffer=w.createVertexBuffer(this.layoutVertexArray,Du.members),this.indexBuffer=w.createIndexBuffer(this.indexArray,I),this.dynamicLayoutVertexBuffer=w.createVertexBuffer(this.dynamicLayoutVertexArray,Uu.members,!0),this.opacityVertexBuffer=w.createVertexBuffer(this.opacityVertexArray,ef,!0),this.opacityVertexBuffer.itemSize=1),(H||q)&&this.programConfigurations.upload(w))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}gi("SymbolBuffers",zA);class NA{constructor(w,I,H){this.layoutVertexArray=new w,this.layoutAttributes=I,this.indexArray=new H,this.segments=new Mi,this.collisionVertexArray=new oi}upload(w){this.layoutVertexBuffer=w.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=w.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=w.createVertexBuffer(this.collisionVertexArray,Mu.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}gi("CollisionBuffers",NA);class ul{constructor(w){this.collisionBoxArray=w.collisionBoxArray,this.zoom=w.zoom,this.overscaling=w.overscaling,this.layers=w.layers,this.layerIds=this.layers.map(ie=>ie.id),this.index=w.index,this.pixelRatio=w.pixelRatio,this.sourceLayerIndex=w.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=mA([]),this.placementViewportMatrix=mA([]);const I=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Zc(this.zoom,I["text-size"]),this.iconSizeData=Zc(this.zoom,I["icon-size"]);const H=this.layers[0].layout,q=H.get("symbol-sort-key"),ee=H.get("symbol-z-order");this.canOverlap=RA(H,"text-overlap","text-allow-overlap")!=="never"||RA(H,"icon-overlap","icon-allow-overlap")!=="never"||H.get("text-ignore-placement")||H.get("icon-ignore-placement"),this.sortFeaturesByKey=ee!=="viewport-y"&&!q.isConstant(),this.sortFeaturesByY=(ee==="viewport-y"||ee==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,H.get("symbol-placement")==="point"&&(this.writingModes=H.get("text-writing-mode").map(ie=>D.WritingMode[ie])),this.stateDependentLayerIds=this.layers.filter(ie=>ie.isStateDependent()).map(ie=>ie.id),this.sourceID=w.sourceID}createArrays(){this.text=new zA(new Ka(this.layers,this.zoom,w=>/^text/.test(w))),this.icon=new zA(new Ka(this.layers,this.zoom,w=>/^icon/.test(w))),this.glyphOffsetArray=new Qe,this.lineVertexArray=new $e,this.symbolInstances=new Se,this.textAnchorOffsets=new rt}calculateGlyphDependencies(w,I,H,q,ee){for(let ie=0;ie<w.length;ie++)if(I[w.charCodeAt(ie)]=!0,(H||q)&&ee){const oe=Ll[w.charAt(ie)];oe&&(I[oe.charCodeAt(0)]=!0)}}populate(w,I,H){const q=this.layers[0],ee=q.layout,ie=ee.get("text-font"),oe=ee.get("text-field"),de=ee.get("icon-image"),_e=(oe.value.kind!=="constant"||oe.value.value instanceof Zi&&!oe.value.value.isEmpty()||oe.value.value.toString().length>0)&&(ie.value.kind!=="constant"||ie.value.value.length>0),Ee=de.value.kind!=="constant"||!!de.value.value||Object.keys(de.parameters).length>0,Fe=ee.get("symbol-sort-key");if(this.features=[],!_e&&!Ee)return;const Pe=I.iconDependencies,He=I.glyphDependencies,Ne=I.availableImages,tt=new Er(this.zoom);for(const{feature:at,id:ct,index:mt,sourceLayerIndex:ht}of w){const bt=q._featureFilter.needGeometry,Ct=ya(at,bt);if(!q._featureFilter.filter(tt,Ct,H))continue;let Qt,fi;if(bt||(Ct.geometry=jn(at)),_e){const ui=q.getValueAndResolveTokens("text-field",Ct,H,Ne),li=Zi.factory(ui);tf(li)&&(this.hasRTLText=!0),(!this.hasRTLText||Ha()==="unavailable"||this.hasRTLText&&ns.isParsed())&&(Qt=Lu(li,q,Ct))}if(Ee){const ui=q.getValueAndResolveTokens("icon-image",Ct,H,Ne);fi=ui instanceof Dt?ui:Dt.fromString(ui)}if(!Qt&&!fi)continue;const Ci=this.sortFeaturesByKey?Fe.evaluate(Ct,{},H):void 0;if(this.features.push({id:ct,text:Qt,icon:fi,index:mt,sourceLayerIndex:ht,geometry:Ct.geometry,properties:at.properties,type:$u[at.type],sortKey:Ci}),fi&&(Pe[fi.name]=!0),Qt){const ui=ie.evaluate(Ct,{},H).join(","),li=ee.get("text-rotation-alignment")!=="viewport"&&ee.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(D.WritingMode.vertical)>=0;for(const ti of Qt.sections)if(ti.image)Pe[ti.image.name]=!0;else{const yi=yt(Qt.toString()),si=ti.fontStack||ui,Gt=He[si]=He[si]||{};this.calculateGlyphDependencies(ti.text,Gt,li,this.allowVerticalPlacement,yi)}}}ee.get("symbol-placement")==="line"&&(this.features=function(at){const ct={},mt={},ht=[];let bt=0;function Ct(ui){ht.push(at[ui]),bt++}function Qt(ui,li,ti){const yi=mt[ui];return delete mt[ui],mt[li]=yi,ht[yi].geometry[0].pop(),ht[yi].geometry[0]=ht[yi].geometry[0].concat(ti[0]),yi}function fi(ui,li,ti){const yi=ct[li];return delete ct[li],ct[ui]=yi,ht[yi].geometry[0].shift(),ht[yi].geometry[0]=ti[0].concat(ht[yi].geometry[0]),yi}function Ci(ui,li,ti){const yi=ti?li[0][li[0].length-1]:li[0][0];return`${ui}:${yi.x}:${yi.y}`}for(let ui=0;ui<at.length;ui++){const li=at[ui],ti=li.geometry,yi=li.text?li.text.toString():null;if(!yi){Ct(ui);continue}const si=Ci(yi,ti),Gt=Ci(yi,ti,!0);if(si in mt&&Gt in ct&&mt[si]!==ct[Gt]){const Pi=fi(si,Gt,ti),Si=Qt(si,Gt,ht[Pi].geometry);delete ct[si],delete mt[Gt],mt[Ci(yi,ht[Si].geometry,!0)]=Si,ht[Pi].geometry=null}else si in mt?Qt(si,Gt,ti):Gt in ct?fi(si,Gt,ti):(Ct(ui),ct[si]=bt-1,mt[Gt]=bt-1)}return ht.filter(ui=>ui.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((at,ct)=>at.sortKey-ct.sortKey)}update(w,I,H){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(w,I,this.layers,H),this.icon.programConfigurations.updatePaintArrays(w,I,this.layers,H))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(w){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(w),this.iconCollisionBox.upload(w)),this.text.upload(w,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(w,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(w,I){const H=this.lineVertexArray.length;if(w.segment!==void 0){let q=w.dist(I[w.segment+1]),ee=w.dist(I[w.segment]);const ie={};for(let oe=w.segment+1;oe<I.length;oe++)ie[oe]={x:I[oe].x,y:I[oe].y,tileUnitDistanceFromAnchor:q},oe<I.length-1&&(q+=I[oe+1].dist(I[oe]));for(let oe=w.segment||0;oe>=0;oe--)ie[oe]={x:I[oe].x,y:I[oe].y,tileUnitDistanceFromAnchor:ee},oe>0&&(ee+=I[oe-1].dist(I[oe]));for(let oe=0;oe<I.length;oe++){const de=ie[oe];this.lineVertexArray.emplaceBack(de.x,de.y,de.tileUnitDistanceFromAnchor)}}return{lineStartIndex:H,lineLength:this.lineVertexArray.length-H}}addSymbols(w,I,H,q,ee,ie,oe,de,_e,Ee,Fe,Pe){const He=w.indexArray,Ne=w.layoutVertexArray,tt=w.segments.prepareSegment(4*I.length,Ne,He,this.canOverlap?ie.sortKey:void 0),at=this.glyphOffsetArray.length,ct=tt.vertexLength,mt=this.allowVerticalPlacement&&oe===D.WritingMode.vertical?Math.PI/2:0,ht=ie.text&&ie.text.sections;for(let bt=0;bt<I.length;bt++){const{tl:Ct,tr:Qt,bl:fi,br:Ci,tex:ui,pixelOffsetTL:li,pixelOffsetBR:ti,minFontScaleX:yi,minFontScaleY:si,glyphOffset:Gt,isSDF:Pi,sectionIndex:Si}=I[bt],ir=tt.vertexLength,Rr=Gt[1];rA(Ne,de.x,de.y,Ct.x,Rr+Ct.y,ui.x,ui.y,H,Pi,li.x,li.y,yi,si),rA(Ne,de.x,de.y,Qt.x,Rr+Qt.y,ui.x+ui.w,ui.y,H,Pi,ti.x,li.y,yi,si),rA(Ne,de.x,de.y,fi.x,Rr+fi.y,ui.x,ui.y+ui.h,H,Pi,li.x,ti.y,yi,si),rA(Ne,de.x,de.y,Ci.x,Rr+Ci.y,ui.x+ui.w,ui.y+ui.h,H,Pi,ti.x,ti.y,yi,si),HA(w.dynamicLayoutVertexArray,de,mt),He.emplaceBack(ir,ir+1,ir+2),He.emplaceBack(ir+1,ir+2,ir+3),tt.vertexLength+=4,tt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Gt[0]),bt!==I.length-1&&Si===I[bt+1].sectionIndex||w.programConfigurations.populatePaintArrays(Ne.length,ie,ie.index,{},Pe,ht&&ht[Si])}w.placedSymbolArray.emplaceBack(de.x,de.y,at,this.glyphOffsetArray.length-at,ct,_e,Ee,de.segment,H?H[0]:0,H?H[1]:0,q[0],q[1],oe,0,!1,0,Fe)}_addCollisionDebugVertex(w,I,H,q,ee,ie){return I.emplaceBack(0,0),w.emplaceBack(H.x,H.y,q,ee,Math.round(ie.x),Math.round(ie.y))}addCollisionDebugVertices(w,I,H,q,ee,ie,oe){const de=ee.segments.prepareSegment(4,ee.layoutVertexArray,ee.indexArray),_e=de.vertexLength,Ee=ee.layoutVertexArray,Fe=ee.collisionVertexArray,Pe=oe.anchorX,He=oe.anchorY;this._addCollisionDebugVertex(Ee,Fe,ie,Pe,He,new ge(w,I)),this._addCollisionDebugVertex(Ee,Fe,ie,Pe,He,new ge(H,I)),this._addCollisionDebugVertex(Ee,Fe,ie,Pe,He,new ge(H,q)),this._addCollisionDebugVertex(Ee,Fe,ie,Pe,He,new ge(w,q)),de.vertexLength+=4;const Ne=ee.indexArray;Ne.emplaceBack(_e,_e+1),Ne.emplaceBack(_e+1,_e+2),Ne.emplaceBack(_e+2,_e+3),Ne.emplaceBack(_e+3,_e),de.primitiveLength+=4}addDebugCollisionBoxes(w,I,H,q){for(let ee=w;ee<I;ee++){const ie=this.collisionBoxArray.get(ee);this.addCollisionDebugVertices(ie.x1,ie.y1,ie.x2,ie.y2,q?this.textCollisionBox:this.iconCollisionBox,ie.anchorPoint,H)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new NA(ar,Pc.members,xi),this.iconCollisionBox=new NA(ar,Pc.members,xi);for(let w=0;w<this.symbolInstances.length;w++){const I=this.symbolInstances.get(w);this.addDebugCollisionBoxes(I.textBoxStartIndex,I.textBoxEndIndex,I,!0),this.addDebugCollisionBoxes(I.verticalTextBoxStartIndex,I.verticalTextBoxEndIndex,I,!0),this.addDebugCollisionBoxes(I.iconBoxStartIndex,I.iconBoxEndIndex,I,!1),this.addDebugCollisionBoxes(I.verticalIconBoxStartIndex,I.verticalIconBoxEndIndex,I,!1)}}_deserializeCollisionBoxesForSymbol(w,I,H,q,ee,ie,oe,de,_e){const Ee={};for(let Fe=I;Fe<H;Fe++){const Pe=w.get(Fe);Ee.textBox={x1:Pe.x1,y1:Pe.y1,x2:Pe.x2,y2:Pe.y2,anchorPointX:Pe.anchorPointX,anchorPointY:Pe.anchorPointY},Ee.textFeatureIndex=Pe.featureIndex;break}for(let Fe=q;Fe<ee;Fe++){const Pe=w.get(Fe);Ee.verticalTextBox={x1:Pe.x1,y1:Pe.y1,x2:Pe.x2,y2:Pe.y2,anchorPointX:Pe.anchorPointX,anchorPointY:Pe.anchorPointY},Ee.verticalTextFeatureIndex=Pe.featureIndex;break}for(let Fe=ie;Fe<oe;Fe++){const Pe=w.get(Fe);Ee.iconBox={x1:Pe.x1,y1:Pe.y1,x2:Pe.x2,y2:Pe.y2,anchorPointX:Pe.anchorPointX,anchorPointY:Pe.anchorPointY},Ee.iconFeatureIndex=Pe.featureIndex;break}for(let Fe=de;Fe<_e;Fe++){const Pe=w.get(Fe);Ee.verticalIconBox={x1:Pe.x1,y1:Pe.y1,x2:Pe.x2,y2:Pe.y2,anchorPointX:Pe.anchorPointX,anchorPointY:Pe.anchorPointY},Ee.verticalIconFeatureIndex=Pe.featureIndex;break}return Ee}deserializeCollisionBoxes(w){this.collisionArrays=[];for(let I=0;I<this.symbolInstances.length;I++){const H=this.symbolInstances.get(I);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(w,H.textBoxStartIndex,H.textBoxEndIndex,H.verticalTextBoxStartIndex,H.verticalTextBoxEndIndex,H.iconBoxStartIndex,H.iconBoxEndIndex,H.verticalIconBoxStartIndex,H.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(w,I){const H=w.placedSymbolArray.get(I),q=H.vertexStartIndex+4*H.numGlyphs;for(let ee=H.vertexStartIndex;ee<q;ee+=4)w.indexArray.emplaceBack(ee,ee+1,ee+2),w.indexArray.emplaceBack(ee+1,ee+2,ee+3)}getSortedSymbolIndexes(w){if(this.sortedAngle===w&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const I=Math.sin(w),H=Math.cos(w),q=[],ee=[],ie=[];for(let oe=0;oe<this.symbolInstances.length;++oe){ie.push(oe);const de=this.symbolInstances.get(oe);q.push(0|Math.round(I*de.anchorX+H*de.anchorY)),ee.push(de.featureIndex)}return ie.sort((oe,de)=>q[oe]-q[de]||ee[de]-ee[oe]),ie}addToSortKeyRanges(w,I){const H=this.sortKeyRanges[this.sortKeyRanges.length-1];H&&H.sortKey===I?H.symbolInstanceEnd=w+1:this.sortKeyRanges.push({sortKey:I,symbolInstanceStart:w,symbolInstanceEnd:w+1})}sortFeatures(w){if(this.sortFeaturesByY&&this.sortedAngle!==w&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(w),this.sortedAngle=w,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const I of this.symbolInstanceIndexes){const H=this.symbolInstances.get(I);this.featureSortOrder.push(H.featureIndex),[H.rightJustifiedTextSymbolIndex,H.centerJustifiedTextSymbolIndex,H.leftJustifiedTextSymbolIndex].forEach((q,ee,ie)=>{q>=0&&ie.indexOf(q)===ee&&this.addIndicesForPlacedSymbol(this.text,q)}),H.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,H.verticalPlacedTextSymbolIndex),H.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,H.placedIconSymbolIndex),H.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,H.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Jc,$c;gi("SymbolBucket",ul,{omit:["layers","collisionBoxArray","features","compareText"]}),ul.MAX_GLYPHS=65535,ul.addDynamicAttributes=HA;var VA={get paint(){return $c=$c||new Ns({"icon-opacity":new Ni(me.paint_symbol["icon-opacity"]),"icon-color":new Ni(me.paint_symbol["icon-color"]),"icon-halo-color":new Ni(me.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ni(me.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ni(me.paint_symbol["icon-halo-blur"]),"icon-translate":new Fi(me.paint_symbol["icon-translate"]),"icon-translate-anchor":new Fi(me.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ni(me.paint_symbol["text-opacity"]),"text-color":new Ni(me.paint_symbol["text-color"],{runtimeType:Wi,getOverride:C=>C.textColor,hasOverride:C=>!!C.textColor}),"text-halo-color":new Ni(me.paint_symbol["text-halo-color"]),"text-halo-width":new Ni(me.paint_symbol["text-halo-width"]),"text-halo-blur":new Ni(me.paint_symbol["text-halo-blur"]),"text-translate":new Fi(me.paint_symbol["text-translate"]),"text-translate-anchor":new Fi(me.paint_symbol["text-translate-anchor"])})},get layout(){return Jc=Jc||new Ns({"symbol-placement":new Fi(me.layout_symbol["symbol-placement"]),"symbol-spacing":new Fi(me.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Fi(me.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ni(me.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Fi(me.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Fi(me.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Fi(me.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Fi(me.layout_symbol["icon-ignore-placement"]),"icon-optional":new Fi(me.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Fi(me.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ni(me.layout_symbol["icon-size"]),"icon-text-fit":new Fi(me.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Fi(me.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ni(me.layout_symbol["icon-image"]),"icon-rotate":new Ni(me.layout_symbol["icon-rotate"]),"icon-padding":new Ni(me.layout_symbol["icon-padding"]),"icon-keep-upright":new Fi(me.layout_symbol["icon-keep-upright"]),"icon-offset":new Ni(me.layout_symbol["icon-offset"]),"icon-anchor":new Ni(me.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Fi(me.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Fi(me.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Fi(me.layout_symbol["text-rotation-alignment"]),"text-field":new Ni(me.layout_symbol["text-field"]),"text-font":new Ni(me.layout_symbol["text-font"]),"text-size":new Ni(me.layout_symbol["text-size"]),"text-max-width":new Ni(me.layout_symbol["text-max-width"]),"text-line-height":new Fi(me.layout_symbol["text-line-height"]),"text-letter-spacing":new Ni(me.layout_symbol["text-letter-spacing"]),"text-justify":new Ni(me.layout_symbol["text-justify"]),"text-radial-offset":new Ni(me.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Fi(me.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Ni(me.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Ni(me.layout_symbol["text-anchor"]),"text-max-angle":new Fi(me.layout_symbol["text-max-angle"]),"text-writing-mode":new Fi(me.layout_symbol["text-writing-mode"]),"text-rotate":new Ni(me.layout_symbol["text-rotate"]),"text-padding":new Fi(me.layout_symbol["text-padding"]),"text-keep-upright":new Fi(me.layout_symbol["text-keep-upright"]),"text-transform":new Ni(me.layout_symbol["text-transform"]),"text-offset":new Ni(me.layout_symbol["text-offset"]),"text-allow-overlap":new Fi(me.layout_symbol["text-allow-overlap"]),"text-overlap":new Fi(me.layout_symbol["text-overlap"]),"text-ignore-placement":new Fi(me.layout_symbol["text-ignore-placement"]),"text-optional":new Fi(me.layout_symbol["text-optional"])})}};class eh{constructor(w){if(w.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=w.property.overrides?w.property.overrides.runtimeType:Vi,this.defaultValue=w}evaluate(w){if(w.formattedSection){const I=this.defaultValue.property.overrides;if(I&&I.hasOverride(w.formattedSection))return I.getOverride(w.formattedSection)}return w.feature&&w.featureState?this.defaultValue.evaluate(w.feature,w.featureState):this.defaultValue.property.specification.default}eachChild(w){this.defaultValue.isConstant()||w(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}gi("FormatSectionOverride",eh,{omit:["defaultValue"]});class sA extends Dn{constructor(w){super(w,VA)}recalculate(w,I){if(super.recalculate(w,I),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const H=this.layout.get("text-writing-mode");if(H){const q=[];for(const ee of H)q.indexOf(ee)<0&&q.push(ee);this.layout._values["text-writing-mode"]=q}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(w,I,H,q){const ee=this.layout.get(w).evaluate(I,{},H,q),ie=this._unevaluatedLayout._values[w];return ie.isDataDriven()||$s(ie.value)||!ee?ee:function(oe,de){return de.replace(/{([^{}]+)}/g,(_e,Ee)=>Ee in oe?String(oe[Ee]):"")}(I.properties,ee)}createBucket(w){return new ul(w)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const w of VA.paint.overridableProperties){if(!sA.hasPaintOverride(this.layout,w))continue;const I=this.paint.get(w),H=new eh(I),q=new Ur(H,I.property.specification);let ee=null;ee=I.value.kind==="constant"||I.value.kind==="source"?new yr("source",q):new Fr("composite",q,I.value.zoomStops),this.paint._values[w]=new zs(I.property,ee,I.parameters)}}_handleOverridablePaintPropertyUpdate(w,I,H){return!(!this.layout||I.isDataDriven()||H.isDataDriven())&&sA.hasPaintOverride(this.layout,w)}static hasPaintOverride(w,I){const H=w.get("text-field"),q=VA.paint.properties[I];let ee=!1;const ie=oe=>{for(const de of oe)if(q.overrides&&q.overrides.hasOverride(de))return void(ee=!0)};if(H.value.kind==="constant"&&H.value.value instanceof Zi)ie(H.value.value.sections);else if(H.value.kind==="source"){const oe=_e=>{ee||(_e instanceof Cr&&_r(_e.value)===$i?ie(_e.value.sections):_e instanceof Fa?ie(_e.sections):_e.eachChild(oe))},de=H.value;de._styleExpression&&oe(de._styleExpression.expression)}return ee}}let th;var rf={get paint(){return th=th||new Ns({"background-color":new Fi(me.paint_background["background-color"]),"background-pattern":new vl(me.paint_background["background-pattern"]),"background-opacity":new Fi(me.paint_background["background-opacity"])})}};class sf extends Dn{constructor(w){super(w,rf)}}let ih;var nf={get paint(){return ih=ih||new Ns({"raster-opacity":new Fi(me.paint_raster["raster-opacity"]),"raster-hue-rotate":new Fi(me.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Fi(me.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Fi(me.paint_raster["raster-brightness-max"]),"raster-saturation":new Fi(me.paint_raster["raster-saturation"]),"raster-contrast":new Fi(me.paint_raster["raster-contrast"]),"raster-resampling":new Fi(me.paint_raster["raster-resampling"]),"raster-fade-duration":new Fi(me.paint_raster["raster-fade-duration"])})}};class af extends Dn{constructor(w){super(w,nf)}}class of extends Dn{constructor(w){super(w,{}),this.onAdd=I=>{this.implementation.onAdd&&this.implementation.onAdd(I,I.painter.context.gl)},this.onRemove=I=>{this.implementation.onRemove&&this.implementation.onRemove(I,I.painter.context.gl)},this.implementation=w}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class lf{constructor(w){this._callback=w,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const KA=63710088e-1;class vo{constructor(w,I){if(isNaN(w)||isNaN(I))throw new Error(`Invalid LngLat object: (${w}, ${I})`);if(this.lng=+w,this.lat=+I,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new vo(ut(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(w){const I=Math.PI/180,H=this.lat*I,q=w.lat*I,ee=Math.sin(H)*Math.sin(q)+Math.cos(H)*Math.cos(q)*Math.cos((w.lng-this.lng)*I);return KA*Math.acos(Math.min(ee,1))}static convert(w){if(w instanceof vo)return w;if(Array.isArray(w)&&(w.length===2||w.length===3))return new vo(Number(w[0]),Number(w[1]));if(!Array.isArray(w)&&typeof w=="object"&&w!==null)return new vo(Number("lng"in w?w.lng:w.lon),Number(w.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const rh=2*Math.PI*KA;function sh(C){return rh*Math.cos(C*Math.PI/180)}function nh(C){return(180+C)/360}function ah(C){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+C*Math.PI/360)))/360}function oh(C,w){return C/sh(w)}function GA(C){return 360/Math.PI*Math.atan(Math.exp((180-360*C)*Math.PI/180))-90}class nA{constructor(w,I,H=0){this.x=+w,this.y=+I,this.z=+H}static fromLngLat(w,I=0){const H=vo.convert(w);return new nA(nh(H.lng),ah(H.lat),oh(I,H.lat))}toLngLat(){return new vo(360*this.x-180,GA(this.y))}toAltitude(){return this.z*sh(GA(this.y))}meterInMercatorCoordinateUnits(){return 1/rh*(w=GA(this.y),1/Math.cos(w*Math.PI/180));var w}}function lh(C,w,I){var H=2*Math.PI*6378137/256/Math.pow(2,I);return[C*H-2*Math.PI*6378137/2,w*H-2*Math.PI*6378137/2]}class WA{constructor(w,I,H){if(w<0||w>25||H<0||H>=Math.pow(2,w)||I<0||I>=Math.pow(2,w))throw new Error(`x=${I}, y=${H}, z=${w} outside of bounds. 0<=x<${Math.pow(2,w)}, 0<=y<${Math.pow(2,w)} 0<=z<=25 `);this.z=w,this.x=I,this.y=H,this.key=Hl(0,w,w,I,H)}equals(w){return this.z===w.z&&this.x===w.x&&this.y===w.y}url(w,I,H){const q=(ie=this.y,oe=this.z,de=lh(256*(ee=this.x),256*(ie=Math.pow(2,oe)-ie-1),oe),_e=lh(256*(ee+1),256*(ie+1),oe),de[0]+","+de[1]+","+_e[0]+","+_e[1]);var ee,ie,oe,de,_e;const Ee=function(Fe,Pe,He){let Ne,tt="";for(let at=Fe;at>0;at--)Ne=1<<at-1,tt+=(Pe&Ne?1:0)+(He&Ne?2:0);return tt}(this.z,this.x,this.y);return w[(this.x+this.y)%w.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(H==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,I>1?"@2x":"").replace(/{quadkey}/g,Ee).replace(/{bbox-epsg-3857}/g,q)}isChildOf(w){const I=this.z-w.z;return I>0&&w.x===this.x>>I&&w.y===this.y>>I}getTilePoint(w){const I=Math.pow(2,this.z);return new ge((w.x*I-this.x)*Xr,(w.y*I-this.y)*Xr)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ah{constructor(w,I){this.wrap=w,this.canonical=I,this.key=Hl(w,I.z,I.z,I.x,I.y)}}class Bn{constructor(w,I,H,q,ee){if(w<H)throw new Error(`overscaledZ should be >= z; overscaledZ = ${w}; z = ${H}`);this.overscaledZ=w,this.wrap=I,this.canonical=new WA(H,+q,+ee),this.key=Hl(I,w,H,q,ee)}clone(){return new Bn(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(w){return this.overscaledZ===w.overscaledZ&&this.wrap===w.wrap&&this.canonical.equals(w.canonical)}scaledTo(w){if(w>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${w}; overscaledZ = ${this.overscaledZ}`);const I=this.canonical.z-w;return w>this.canonical.z?new Bn(w,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Bn(w,this.wrap,w,this.canonical.x>>I,this.canonical.y>>I)}calculateScaledKey(w,I){if(w>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${w}; overscaledZ = ${this.overscaledZ}`);const H=this.canonical.z-w;return w>this.canonical.z?Hl(this.wrap*+I,w,this.canonical.z,this.canonical.x,this.canonical.y):Hl(this.wrap*+I,w,w,this.canonical.x>>H,this.canonical.y>>H)}isChildOf(w){if(w.wrap!==this.wrap)return!1;const I=this.canonical.z-w.canonical.z;return w.overscaledZ===0||w.overscaledZ<this.overscaledZ&&w.canonical.x===this.canonical.x>>I&&w.canonical.y===this.canonical.y>>I}children(w){if(this.overscaledZ>=w)return[new Bn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const I=this.canonical.z+1,H=2*this.canonical.x,q=2*this.canonical.y;return[new Bn(I,this.wrap,I,H,q),new Bn(I,this.wrap,I,H+1,q),new Bn(I,this.wrap,I,H,q+1),new Bn(I,this.wrap,I,H+1,q+1)]}isLessThan(w){return this.wrap<w.wrap||!(this.wrap>w.wrap)&&(this.overscaledZ<w.overscaledZ||!(this.overscaledZ>w.overscaledZ)&&(this.canonical.x<w.canonical.x||!(this.canonical.x>w.canonical.x)&&this.canonical.y<w.canonical.y))}wrapped(){return new Bn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(w){return new Bn(this.overscaledZ,w,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ah(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(w){return this.canonical.getTilePoint(new nA(w.x-this.wrap,w.y))}}function Hl(C,w,I,H,q){(C*=2)<0&&(C=-1*C-1);const ee=1<<I;return(ee*ee*C+ee*q+H).toString(36)+I.toString(36)+w.toString(36)}gi("CanonicalTileID",WA),gi("OverscaledTileID",Bn,{omit:["posMatrix"]});class ch{constructor(w,I,H){if(this.uid=w,I.height!==I.width)throw new RangeError("DEM tiles must be square");if(H&&H!=="mapbox"&&H!=="terrarium")return void Vt(`"${H}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=I.height;const q=this.dim=I.height-2;this.data=new Uint32Array(I.data.buffer),this.encoding=H||"mapbox";for(let ee=0;ee<q;ee++)this.data[this._idx(-1,ee)]=this.data[this._idx(0,ee)],this.data[this._idx(q,ee)]=this.data[this._idx(q-1,ee)],this.data[this._idx(ee,-1)]=this.data[this._idx(ee,0)],this.data[this._idx(ee,q)]=this.data[this._idx(ee,q-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(q,-1)]=this.data[this._idx(q-1,0)],this.data[this._idx(-1,q)]=this.data[this._idx(0,q-1)],this.data[this._idx(q,q)]=this.data[this._idx(q-1,q-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let ee=0;ee<q;ee++)for(let ie=0;ie<q;ie++){const oe=this.get(ee,ie);oe>this.max&&(this.max=oe),oe<this.min&&(this.min=oe)}}get(w,I){const H=new Uint8Array(this.data.buffer),q=4*this._idx(w,I);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(H[q],H[q+1],H[q+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(w,I){if(w<-1||w>=this.dim+1||I<-1||I>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(I+1)*this.stride+(w+1)}_unpackMapbox(w,I,H){return(256*w*256+256*I+H)/10-1e4}_unpackTerrarium(w,I,H){return 256*w+I+H/256-32768}getPixels(){return new xn({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(w,I,H){if(this.dim!==w.dim)throw new Error("dem dimension mismatch");let q=I*this.dim,ee=I*this.dim+this.dim,ie=H*this.dim,oe=H*this.dim+this.dim;switch(I){case-1:q=ee-1;break;case 1:ee=q+1}switch(H){case-1:ie=oe-1;break;case 1:oe=ie+1}const de=-I*this.dim,_e=-H*this.dim;for(let Ee=ie;Ee<oe;Ee++)for(let Fe=q;Fe<ee;Fe++)this.data[this._idx(Fe,Ee)]=w.data[this._idx(Fe+de,Ee+_e)]}}gi("DEMData",ch);class hh{constructor(w){this._stringToNumber={},this._numberToString=[];for(let I=0;I<w.length;I++){const H=w[I];this._stringToNumber[H]=I,this._numberToString[I]=H}}encode(w){return this._stringToNumber[w]}decode(w){if(w>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${w} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[w]}}class uh{constructor(w,I,H,q,ee){this.type="Feature",this._vectorTileFeature=w,w._z=I,w._x=H,w._y=q,this.properties=w.properties,this.id=ee}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(w){this._geometry=w}toJSON(){const w={geometry:this.geometry};for(const I in this)I!=="_geometry"&&I!=="_vectorTileFeature"&&(w[I]=this[I]);return w}}class fh{constructor(w,I){this.tileID=w,this.x=w.canonical.x,this.y=w.canonical.y,this.z=w.canonical.z,this.grid=new qi(Xr,16,0),this.grid3D=new qi(Xr,16,0),this.featureIndexArray=new dt,this.promoteId=I}insert(w,I,H,q,ee,ie){const oe=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(H,q,ee);const de=ie?this.grid3D:this.grid;for(let _e=0;_e<I.length;_e++){const Ee=I[_e],Fe=[1/0,1/0,-1/0,-1/0];for(let Pe=0;Pe<Ee.length;Pe++){const He=Ee[Pe];Fe[0]=Math.min(Fe[0],He.x),Fe[1]=Math.min(Fe[1],He.y),Fe[2]=Math.max(Fe[2],He.x),Fe[3]=Math.max(Fe[3],He.y)}Fe[0]<Xr&&Fe[1]<Xr&&Fe[2]>=0&&Fe[3]>=0&&de.insert(oe,Fe[0],Fe[1],Fe[2],Fe[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new mo.VectorTile(new MA(this.rawTileData)).layers,this.sourceLayerCoder=new hh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(w,I,H,q){this.loadVTLayers();const ee=w.params||{},ie=Xr/w.tileSize/w.scale,oe=Fo(ee.filter),de=w.queryGeometry,_e=w.queryPadding*ie,Ee=ph(de),Fe=this.grid.query(Ee.minX-_e,Ee.minY-_e,Ee.maxX+_e,Ee.maxY+_e),Pe=ph(w.cameraQueryGeometry),He=this.grid3D.query(Pe.minX-_e,Pe.minY-_e,Pe.maxX+_e,Pe.maxY+_e,(at,ct,mt,ht)=>function(bt,Ct,Qt,fi,Ci){for(const li of bt)if(Ct<=li.x&&Qt<=li.y&&fi>=li.x&&Ci>=li.y)return!0;const ui=[new ge(Ct,Qt),new ge(Ct,Ci),new ge(fi,Ci),new ge(fi,Qt)];if(bt.length>2){for(const li of ui)if(nl(bt,li))return!0}for(let li=0;li<bt.length-1;li++)if(Rh(bt[li],bt[li+1],ui))return!0;return!1}(w.cameraQueryGeometry,at-_e,ct-_e,mt+_e,ht+_e));for(const at of He)Fe.push(at);Fe.sort(Af);const Ne={};let tt;for(let at=0;at<Fe.length;at++){const ct=Fe[at];if(ct===tt)continue;tt=ct;const mt=this.featureIndexArray.get(ct);let ht=null;this.loadMatchingFeature(Ne,mt.bucketIndex,mt.sourceLayerIndex,mt.featureIndex,oe,ee.layers,ee.availableImages,I,H,q,(bt,Ct,Qt)=>(ht||(ht=jn(bt)),Ct.queryIntersectsFeature(de,bt,Qt,ht,this.z,w.transform,ie,w.pixelPosMatrix)))}return Ne}loadMatchingFeature(w,I,H,q,ee,ie,oe,de,_e,Ee,Fe){const Pe=this.bucketLayerIDs[I];if(ie&&!function(at,ct){for(let mt=0;mt<at.length;mt++)if(ct.indexOf(at[mt])>=0)return!0;return!1}(ie,Pe))return;const He=this.sourceLayerCoder.decode(H),Ne=this.vtLayers[He].feature(q);if(ee.needGeometry){const at=ya(Ne,!0);if(!ee.filter(new Er(this.tileID.overscaledZ),at,this.tileID.canonical))return}else if(!ee.filter(new Er(this.tileID.overscaledZ),Ne))return;const tt=this.getId(Ne,He);for(let at=0;at<Pe.length;at++){const ct=Pe[at];if(ie&&ie.indexOf(ct)<0)continue;const mt=de[ct];if(!mt)continue;let ht={};tt&&Ee&&(ht=Ee.getState(mt.sourceLayer||"_geojsonTileLayer",tt));const bt=et({},_e[ct]);bt.paint=dh(bt.paint,mt.paint,Ne,ht,oe),bt.layout=dh(bt.layout,mt.layout,Ne,ht,oe);const Ct=!Fe||Fe(Ne,mt,ht);if(!Ct)continue;const Qt=new uh(Ne,this.z,this.x,this.y,tt);Qt.layer=bt;let fi=w[ct];fi===void 0&&(fi=w[ct]=[]),fi.push({featureIndex:q,feature:Qt,intersectionZ:Ct})}}lookupSymbolFeatures(w,I,H,q,ee,ie,oe,de){const _e={};this.loadVTLayers();const Ee=Fo(ee);for(const Fe of w)this.loadMatchingFeature(_e,H,q,Fe,Ee,ie,oe,de,I);return _e}hasLayer(w){for(const I of this.bucketLayerIDs)for(const H of I)if(w===H)return!0;return!1}getId(w,I){let H=w.id;return this.promoteId&&(H=w.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[I]],typeof H=="boolean"&&(H=Number(H))),H}}function dh(C,w,I,H,q){return nt(C,(ee,ie)=>{const oe=w instanceof Mo?w.get(ie):null;return oe&&oe.evaluate?oe.evaluate(I,H,q):oe})}function ph(C){let w=1/0,I=1/0,H=-1/0,q=-1/0;for(const ee of C)w=Math.min(w,ee.x),I=Math.min(I,ee.y),H=Math.max(H,ee.x),q=Math.max(q,ee.y);return{minX:w,minY:I,maxX:H,maxY:q}}function Af(C,w){return w-C}function gh(C,w,I,H,q){const ee=[];for(let ie=0;ie<C.length;ie++){const oe=C[ie];let de;for(let _e=0;_e<oe.length-1;_e++){let Ee=oe[_e],Fe=oe[_e+1];Ee.x<w&&Fe.x<w||(Ee.x<w?Ee=new ge(w,Ee.y+(w-Ee.x)/(Fe.x-Ee.x)*(Fe.y-Ee.y))._round():Fe.x<w&&(Fe=new ge(w,Ee.y+(w-Ee.x)/(Fe.x-Ee.x)*(Fe.y-Ee.y))._round()),Ee.y<I&&Fe.y<I||(Ee.y<I?Ee=new ge(Ee.x+(I-Ee.y)/(Fe.y-Ee.y)*(Fe.x-Ee.x),I)._round():Fe.y<I&&(Fe=new ge(Ee.x+(I-Ee.y)/(Fe.y-Ee.y)*(Fe.x-Ee.x),I)._round()),Ee.x>=H&&Fe.x>=H||(Ee.x>=H?Ee=new ge(H,Ee.y+(H-Ee.x)/(Fe.x-Ee.x)*(Fe.y-Ee.y))._round():Fe.x>=H&&(Fe=new ge(H,Ee.y+(H-Ee.x)/(Fe.x-Ee.x)*(Fe.y-Ee.y))._round()),Ee.y>=q&&Fe.y>=q||(Ee.y>=q?Ee=new ge(Ee.x+(q-Ee.y)/(Fe.y-Ee.y)*(Fe.x-Ee.x),q)._round():Fe.y>=q&&(Fe=new ge(Ee.x+(q-Ee.y)/(Fe.y-Ee.y)*(Fe.x-Ee.x),q)._round()),de&&Ee.equals(de[de.length-1])||(de=[Ee],ee.push(de)),de.push(Fe)))))}}return ee}gi("FeatureIndex",fh,{omit:["rawTileData","sourceLayerCoder"]});class bo extends ge{constructor(w,I,H,q){super(w,I),this.angle=H,q!==void 0&&(this.segment=q)}clone(){return new bo(this.x,this.y,this.angle,this.segment)}}function mh(C,w,I,H,q){if(w.segment===void 0||I===0)return!0;let ee=w,ie=w.segment+1,oe=0;for(;oe>-I/2;){if(ie--,ie<0)return!1;oe-=C[ie].dist(ee),ee=C[ie]}oe+=C[ie].dist(C[ie+1]),ie++;const de=[];let _e=0;for(;oe<I/2;){const Ee=C[ie],Fe=C[ie+1];if(!Fe)return!1;let Pe=C[ie-1].angleTo(Ee)-Ee.angleTo(Fe);for(Pe=Math.abs((Pe+3*Math.PI)%(2*Math.PI)-Math.PI),de.push({distance:oe,angleDelta:Pe}),_e+=Pe;oe-de[0].distance>H;)_e-=de.shift().angleDelta;if(_e>q)return!1;ie++,oe+=Ee.dist(Fe)}return!0}function _h(C){let w=0;for(let I=0;I<C.length-1;I++)w+=C[I].dist(C[I+1]);return w}function yh(C,w,I){return C?.6*w*I:0}function vh(C,w){return Math.max(C?C.right-C.left:0,w?w.right-w.left:0)}function cf(C,w,I,H,q,ee){const ie=yh(I,q,ee),oe=vh(I,H)*ee;let de=0;const _e=_h(C)/2;for(let Ee=0;Ee<C.length-1;Ee++){const Fe=C[Ee],Pe=C[Ee+1],He=Fe.dist(Pe);if(de+He>_e){const Ne=(_e-de)/He,tt=ks.number(Fe.x,Pe.x,Ne),at=ks.number(Fe.y,Pe.y,Ne),ct=new bo(tt,at,Pe.angleTo(Fe),Ee);return ct._round(),!ie||mh(C,ct,oe,ie,w)?ct:void 0}de+=He}}function hf(C,w,I,H,q,ee,ie,oe,de){const _e=yh(H,ee,ie),Ee=vh(H,q),Fe=Ee*ie,Pe=C[0].x===0||C[0].x===de||C[0].y===0||C[0].y===de;return w-Fe<w/4&&(w=Fe+w/4),bh(C,Pe?w/2*oe%w:(Ee/2+2*ee)*ie*oe%w,w,_e,I,Fe,Pe,!1,de)}function bh(C,w,I,H,q,ee,ie,oe,de){const _e=ee/2,Ee=_h(C);let Fe=0,Pe=w-I,He=[];for(let Ne=0;Ne<C.length-1;Ne++){const tt=C[Ne],at=C[Ne+1],ct=tt.dist(at),mt=at.angleTo(tt);for(;Pe+I<Fe+ct;){Pe+=I;const ht=(Pe-Fe)/ct,bt=ks.number(tt.x,at.x,ht),Ct=ks.number(tt.y,at.y,ht);if(bt>=0&&bt<de&&Ct>=0&&Ct<de&&Pe-_e>=0&&Pe+_e<=Ee){const Qt=new bo(bt,Ct,mt,Ne);Qt._round(),H&&!mh(C,Qt,ee,H,q)||He.push(Qt)}}Fe+=ct}return oe||He.length||ie||(He=bh(C,Fe/2,I,H,q,ee,ie,!0,de)),He}gi("Anchor",bo);const fl=sn;function wh(C,w,I,H){const q=[],ee=C.image,ie=ee.pixelRatio,oe=ee.paddedRect.w-2*fl,de=ee.paddedRect.h-2*fl,_e=C.right-C.left,Ee=C.bottom-C.top,Fe=ee.stretchX||[[0,oe]],Pe=ee.stretchY||[[0,de]],He=(ti,yi)=>ti+yi[1]-yi[0],Ne=Fe.reduce(He,0),tt=Pe.reduce(He,0),at=oe-Ne,ct=de-tt;let mt=0,ht=Ne,bt=0,Ct=tt,Qt=0,fi=at,Ci=0,ui=ct;if(ee.content&&H){const ti=ee.content;mt=aA(Fe,0,ti[0]),bt=aA(Pe,0,ti[1]),ht=aA(Fe,ti[0],ti[2]),Ct=aA(Pe,ti[1],ti[3]),Qt=ti[0]-mt,Ci=ti[1]-bt,fi=ti[2]-ti[0]-ht,ui=ti[3]-ti[1]-Ct}const li=(ti,yi,si,Gt)=>{const Pi=oA(ti.stretch-mt,ht,_e,C.left),Si=lA(ti.fixed-Qt,fi,ti.stretch,Ne),ir=oA(yi.stretch-bt,Ct,Ee,C.top),Rr=lA(yi.fixed-Ci,ui,yi.stretch,tt),zr=oA(si.stretch-mt,ht,_e,C.left),fs=lA(si.fixed-Qt,fi,si.stretch,Ne),fn=oA(Gt.stretch-bt,Ct,Ee,C.top),Gs=lA(Gt.fixed-Ci,ui,Gt.stretch,tt),os=new ge(Pi,ir),ms=new ge(zr,ir),Ss=new ge(zr,fn),nn=new ge(Pi,fn),Ws=new ge(Si/ie,Rr/ie),ls=new ge(fs/ie,Gs/ie),ds=w*Math.PI/180;if(ds){const an=Math.sin(ds),on=Math.cos(ds),Jr=[on,-an,an,on];os._matMult(Jr),ms._matMult(Jr),nn._matMult(Jr),Ss._matMult(Jr)}const Ps=ti.stretch+ti.fixed,qs=yi.stretch+yi.fixed;return{tl:os,tr:ms,bl:nn,br:Ss,tex:{x:ee.paddedRect.x+fl+Ps,y:ee.paddedRect.y+fl+qs,w:si.stretch+si.fixed-Ps,h:Gt.stretch+Gt.fixed-qs},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ws,pixelOffsetBR:ls,minFontScaleX:fi/ie/_e,minFontScaleY:ui/ie/Ee,isSDF:I}};if(H&&(ee.stretchX||ee.stretchY)){const ti=xh(Fe,at,Ne),yi=xh(Pe,ct,tt);for(let si=0;si<ti.length-1;si++){const Gt=ti[si],Pi=ti[si+1];for(let Si=0;Si<yi.length-1;Si++)q.push(li(Gt,yi[Si],Pi,yi[Si+1]))}}else q.push(li({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:oe+1},{fixed:0,stretch:de+1}));return q}function aA(C,w,I){let H=0;for(const q of C)H+=Math.max(w,Math.min(I,q[1]))-Math.max(w,Math.min(I,q[0]));return H}function xh(C,w,I){const H=[{fixed:-fl,stretch:0}];for(const[q,ee]of C){const ie=H[H.length-1];H.push({fixed:q-ie.stretch,stretch:ie.stretch}),H.push({fixed:q-ie.stretch,stretch:ie.stretch+(ee-q)})}return H.push({fixed:w+fl,stretch:I}),H}function oA(C,w,I,H){return C/w*I+H}function lA(C,w,I,H){return C-w*I/H}class AA{constructor(w,I,H,q,ee,ie,oe,de,_e,Ee){if(this.boxStartIndex=w.length,_e){let Fe=ie.top,Pe=ie.bottom;const He=ie.collisionPadding;He&&(Fe-=He[1],Pe+=He[3]);let Ne=Pe-Fe;Ne>0&&(Ne=Math.max(10,Ne),this.circleDiameter=Ne)}else{let Fe=ie.top*oe-de[0],Pe=ie.bottom*oe+de[2],He=ie.left*oe-de[3],Ne=ie.right*oe+de[1];const tt=ie.collisionPadding;if(tt&&(He-=tt[0]*oe,Fe-=tt[1]*oe,Ne+=tt[2]*oe,Pe+=tt[3]*oe),Ee){const at=new ge(He,Fe),ct=new ge(Ne,Fe),mt=new ge(He,Pe),ht=new ge(Ne,Pe),bt=Ee*Math.PI/180;at._rotate(bt),ct._rotate(bt),mt._rotate(bt),ht._rotate(bt),He=Math.min(at.x,ct.x,mt.x,ht.x),Ne=Math.max(at.x,ct.x,mt.x,ht.x),Fe=Math.min(at.y,ct.y,mt.y,ht.y),Pe=Math.max(at.y,ct.y,mt.y,ht.y)}w.emplaceBack(I.x,I.y,He,Fe,Ne,Pe,H,q,ee)}this.boxEndIndex=w.length}}class uf{constructor(w=[],I=ff){if(this.data=w,this.length=this.data.length,this.compare=I,this.length>0)for(let H=(this.length>>1)-1;H>=0;H--)this._down(H)}push(w){this.data.push(w),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const w=this.data[0],I=this.data.pop();return this.length--,this.length>0&&(this.data[0]=I,this._down(0)),w}peek(){return this.data[0]}_up(w){const{data:I,compare:H}=this,q=I[w];for(;w>0;){const ee=w-1>>1,ie=I[ee];if(H(q,ie)>=0)break;I[w]=ie,w=ee}I[w]=q}_down(w){const{data:I,compare:H}=this,q=this.length>>1,ee=I[w];for(;w<q;){let ie=1+(w<<1),oe=I[ie];const de=ie+1;if(de<this.length&&H(I[de],oe)<0&&(ie=de,oe=I[de]),H(oe,ee)>=0)break;I[w]=oe,w=ie}I[w]=ee}}function ff(C,w){return C<w?-1:C>w?1:0}function df(C,w=1,I=!1){let H=1/0,q=1/0,ee=-1/0,ie=-1/0;const oe=C[0];for(let He=0;He<oe.length;He++){const Ne=oe[He];(!He||Ne.x<H)&&(H=Ne.x),(!He||Ne.y<q)&&(q=Ne.y),(!He||Ne.x>ee)&&(ee=Ne.x),(!He||Ne.y>ie)&&(ie=Ne.y)}const de=Math.min(ee-H,ie-q);let _e=de/2;const Ee=new uf([],pf);if(de===0)return new ge(H,q);for(let He=H;He<ee;He+=de)for(let Ne=q;Ne<ie;Ne+=de)Ee.push(new dl(He+_e,Ne+_e,_e,C));let Fe=function(He){let Ne=0,tt=0,at=0;const ct=He[0];for(let mt=0,ht=ct.length,bt=ht-1;mt<ht;bt=mt++){const Ct=ct[mt],Qt=ct[bt],fi=Ct.x*Qt.y-Qt.x*Ct.y;tt+=(Ct.x+Qt.x)*fi,at+=(Ct.y+Qt.y)*fi,Ne+=3*fi}return new dl(tt/Ne,at/Ne,0,He)}(C),Pe=Ee.length;for(;Ee.length;){const He=Ee.pop();(He.d>Fe.d||!Fe.d)&&(Fe=He,I&&console.log("found best %d after %d probes",Math.round(1e4*He.d)/1e4,Pe)),He.max-Fe.d<=w||(_e=He.h/2,Ee.push(new dl(He.p.x-_e,He.p.y-_e,_e,C)),Ee.push(new dl(He.p.x+_e,He.p.y-_e,_e,C)),Ee.push(new dl(He.p.x-_e,He.p.y+_e,_e,C)),Ee.push(new dl(He.p.x+_e,He.p.y+_e,_e,C)),Pe+=4)}return I&&(console.log(`num probes: ${Pe}`),console.log(`best distance: ${Fe.d}`)),Fe.p}function pf(C,w){return w.max-C.max}function dl(C,w,I,H){this.p=new ge(C,w),this.h=I,this.d=function(q,ee){let ie=!1,oe=1/0;for(let de=0;de<ee.length;de++){const _e=ee[de];for(let Ee=0,Fe=_e.length,Pe=Fe-1;Ee<Fe;Pe=Ee++){const He=_e[Ee],Ne=_e[Pe];He.y>q.y!=Ne.y>q.y&&q.x<(Ne.x-He.x)*(q.y-He.y)/(Ne.y-He.y)+He.x&&(ie=!ie),oe=Math.min(oe,ac(q,He,Ne))}}return(ie?1:-1)*Math.sqrt(oe)}(this.p,H),this.max=this.d+this.h*Math.SQRT2}var Ts;D.TextAnchorEnum=void 0,(Ts=D.TextAnchorEnum||(D.TextAnchorEnum={}))[Ts.center=1]="center",Ts[Ts.left=2]="left",Ts[Ts.right=3]="right",Ts[Ts.top=4]="top",Ts[Ts.bottom=5]="bottom",Ts[Ts["top-left"]=6]="top-left",Ts[Ts["top-right"]=7]="top-right",Ts[Ts["bottom-left"]=8]="bottom-left",Ts[Ts["bottom-right"]=9]="bottom-right";const wo=7,qA=Number.POSITIVE_INFINITY;function Bh(C,w){return w[1]!==qA?function(I,H,q){let ee=0,ie=0;switch(H=Math.abs(H),q=Math.abs(q),I){case"top-right":case"top-left":case"top":ie=q-wo;break;case"bottom-right":case"bottom-left":case"bottom":ie=-q+wo}switch(I){case"top-right":case"bottom-right":case"right":ee=-H;break;case"top-left":case"bottom-left":case"left":ee=H}return[ee,ie]}(C,w[0],w[1]):function(I,H){let q=0,ee=0;H<0&&(H=0);const ie=H/Math.SQRT2;switch(I){case"top-right":case"top-left":ee=ie-wo;break;case"bottom-right":case"bottom-left":ee=-ie+wo;break;case"bottom":ee=-H+wo;break;case"top":ee=H-wo}switch(I){case"top-right":case"bottom-right":q=-ie;break;case"top-left":case"bottom-left":q=ie;break;case"left":q=H;break;case"right":q=-H}return[q,ee]}(C,w[0])}function Ch(C,w,I){var H;const q=C.layout,ee=(H=q.get("text-variable-anchor-offset"))===null||H===void 0?void 0:H.evaluate(w,{},I);if(ee){const oe=ee.values,de=[];for(let _e=0;_e<oe.length;_e+=2){const Ee=de[_e]=oe[_e],Fe=oe[_e+1].map(Pe=>Pe*us);Ee.startsWith("top")?Fe[1]-=wo:Ee.startsWith("bottom")&&(Fe[1]+=wo),de[_e+1]=Fe}return new dr(de)}const ie=q.get("text-variable-anchor");if(ie){let oe;oe=C._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[q.get("text-radial-offset").evaluate(w,{},I)*us,qA]:q.get("text-offset").evaluate(w,{},I).map(_e=>_e*us);const de=[];for(const _e of ie)de.push(_e,Bh(_e,oe));return new dr(de)}return null}function XA(C){switch(C){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function gf(C,w,I,H,q,ee,ie,oe,de,_e,Ee){let Fe=ee.textMaxSize.evaluate(w,{});Fe===void 0&&(Fe=ie);const Pe=C.layers[0].layout,He=Pe.get("icon-offset").evaluate(w,{},Ee),Ne=Th(I.horizontal),tt=ie/24,at=C.tilePixelRatio*tt,ct=C.tilePixelRatio*Fe/24,mt=C.tilePixelRatio*oe,ht=C.tilePixelRatio*Pe.get("symbol-spacing"),bt=Pe.get("text-padding")*C.tilePixelRatio,Ct=function(Gt,Pi,Si,ir=1){const Rr=Gt.get("icon-padding").evaluate(Pi,{},Si),zr=Rr&&Rr.values;return[zr[0]*ir,zr[1]*ir,zr[2]*ir,zr[3]*ir]}(Pe,w,Ee,C.tilePixelRatio),Qt=Pe.get("text-max-angle")/180*Math.PI,fi=Pe.get("text-rotation-alignment")!=="viewport"&&Pe.get("symbol-placement")!=="point",Ci=Pe.get("icon-rotation-alignment")==="map"&&Pe.get("symbol-placement")!=="point",ui=Pe.get("symbol-placement"),li=ht/2,ti=Pe.get("icon-text-fit");let yi;H&&ti!=="none"&&(C.allowVerticalPlacement&&I.vertical&&(yi=jc(H,I.vertical,ti,Pe.get("icon-text-fit-padding"),He,tt)),Ne&&(H=jc(H,Ne,ti,Pe.get("icon-text-fit-padding"),He,tt)));const si=(Gt,Pi)=>{Pi.x<0||Pi.x>=Xr||Pi.y<0||Pi.y>=Xr||function(Si,ir,Rr,zr,fs,fn,Gs,os,ms,Ss,nn,Ws,ls,ds,Ps,qs,an,on,Jr,Is,fr,dn,Fs,Xs,Pn){const Zn=Si.addToLineVertexArray(ir,Rr);let Jn,qa,Ln,Cn,ln=0,Xa=0,Vl=0,kh=0,ic=-1,rc=-1;const Ya={};let Dh=bn("");if(Si.allowVerticalPlacement&&zr.vertical){const Ls=os.layout.get("text-rotate").evaluate(fr,{},Xs)+90;Ln=new AA(ms,ir,Ss,nn,Ws,zr.vertical,ls,ds,Ps,Ls),Gs&&(Cn=new AA(ms,ir,Ss,nn,Ws,Gs,an,on,Ps,Ls))}if(fs){const Ls=os.layout.get("icon-rotate").evaluate(fr,{}),En=os.layout.get("icon-text-fit")!=="none",zo=wh(fs,Ls,Fs,En),ea=Gs?wh(Gs,Ls,Fs,En):void 0;qa=new AA(ms,ir,Ss,nn,Ws,fs,an,on,!1,Ls),ln=4*zo.length;const No=Si.iconSizeData;let ba=null;No.kind==="source"?(ba=[va*os.layout.get("icon-size").evaluate(fr,{})],ba[0]>yo&&Vt(`${Si.layerIds[0]}: Value for "icon-size" is >= ${Rl}. Reduce your "icon-size".`)):No.kind==="composite"&&(ba=[va*dn.compositeIconSizes[0].evaluate(fr,{},Xs),va*dn.compositeIconSizes[1].evaluate(fr,{},Xs)],(ba[0]>yo||ba[1]>yo)&&Vt(`${Si.layerIds[0]}: Value for "icon-size" is >= ${Rl}. Reduce your "icon-size".`)),Si.addSymbols(Si.icon,zo,ba,Is,Jr,fr,D.WritingMode.none,ir,Zn.lineStartIndex,Zn.lineLength,-1,Xs),ic=Si.icon.placedSymbolArray.length-1,ea&&(Xa=4*ea.length,Si.addSymbols(Si.icon,ea,ba,Is,Jr,fr,D.WritingMode.vertical,ir,Zn.lineStartIndex,Zn.lineLength,-1,Xs),rc=Si.icon.placedSymbolArray.length-1)}const Uh=Object.keys(zr.horizontal);for(const Ls of Uh){const En=zr.horizontal[Ls];if(!Jn){Dh=bn(En.text);const ea=os.layout.get("text-rotate").evaluate(fr,{},Xs);Jn=new AA(ms,ir,Ss,nn,Ws,En,ls,ds,Ps,ea)}const zo=En.positionedLines.length===1;if(Vl+=Eh(Si,ir,En,fn,os,Ps,fr,qs,Zn,zr.vertical?D.WritingMode.horizontal:D.WritingMode.horizontalOnly,zo?Uh:[Ls],Ya,ic,dn,Xs),zo)break}zr.vertical&&(kh+=Eh(Si,ir,zr.vertical,fn,os,Ps,fr,qs,Zn,D.WritingMode.vertical,["vertical"],Ya,rc,dn,Xs));const yf=Jn?Jn.boxStartIndex:Si.collisionBoxArray.length,vf=Jn?Jn.boxEndIndex:Si.collisionBoxArray.length,bf=Ln?Ln.boxStartIndex:Si.collisionBoxArray.length,wf=Ln?Ln.boxEndIndex:Si.collisionBoxArray.length,xf=qa?qa.boxStartIndex:Si.collisionBoxArray.length,Bf=qa?qa.boxEndIndex:Si.collisionBoxArray.length,Cf=Cn?Cn.boxStartIndex:Si.collisionBoxArray.length,Ef=Cn?Cn.boxEndIndex:Si.collisionBoxArray.length;let $n=-1;const hA=(Ls,En)=>Ls&&Ls.circleDiameter?Math.max(Ls.circleDiameter,En):En;$n=hA(Jn,$n),$n=hA(Ln,$n),$n=hA(qa,$n),$n=hA(Cn,$n);const Mh=$n>-1?1:0;Mh&&($n*=Pn/us),Si.glyphOffsetArray.length>=ul.MAX_GLYPHS&&Vt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),fr.sortKey!==void 0&&Si.addToSortKeyRanges(Si.symbolInstances.length,fr.sortKey);const Tf=Ch(os,fr,Xs),[Sf,If]=function(Ls,En){const zo=Ls.length,ea=En==null?void 0:En.values;if((ea==null?void 0:ea.length)>0)for(let No=0;No<ea.length;No+=2){const ba=ea[No+1];Ls.emplaceBack(D.TextAnchorEnum[ea[No]],ba[0],ba[1])}return[zo,Ls.length]}(Si.textAnchorOffsets,Tf);Si.symbolInstances.emplaceBack(ir.x,ir.y,Ya.right>=0?Ya.right:-1,Ya.center>=0?Ya.center:-1,Ya.left>=0?Ya.left:-1,Ya.vertical||-1,ic,rc,Dh,yf,vf,bf,wf,xf,Bf,Cf,Ef,Ss,Vl,kh,ln,Xa,Mh,0,ls,$n,Sf,If)}(C,Pi,Gt,I,H,q,yi,C.layers[0],C.collisionBoxArray,w.index,w.sourceLayerIndex,C.index,at,[bt,bt,bt,bt],fi,de,mt,Ct,Ci,He,w,ee,_e,Ee,ie)};if(ui==="line")for(const Gt of gh(w.geometry,0,0,Xr,Xr)){const Pi=hf(Gt,ht,Qt,I.vertical||Ne,H,24,ct,C.overscaling,Xr);for(const Si of Pi)Ne&&mf(C,Ne.text,li,Si)||si(Gt,Si)}else if(ui==="line-center"){for(const Gt of w.geometry)if(Gt.length>1){const Pi=cf(Gt,Qt,I.vertical||Ne,H,24,ct);Pi&&si(Gt,Pi)}}else if(w.type==="Polygon")for(const Gt of CA(w.geometry,0)){const Pi=df(Gt,16);si(Gt[0],new bo(Pi.x,Pi.y,0))}else if(w.type==="LineString")for(const Gt of w.geometry)si(Gt,new bo(Gt[0].x,Gt[0].y,0));else if(w.type==="Point")for(const Gt of w.geometry)for(const Pi of Gt)si([Pi],new bo(Pi.x,Pi.y,0))}function Eh(C,w,I,H,q,ee,ie,oe,de,_e,Ee,Fe,Pe,He,Ne){const tt=function(mt,ht,bt,Ct,Qt,fi,Ci,ui){const li=Ct.layout.get("text-rotate").evaluate(fi,{})*Math.PI/180,ti=[];for(const yi of ht.positionedLines)for(const si of yi.positionedGlyphs){if(!si.rect)continue;const Gt=si.rect||{};let Pi=Vc+1,Si=!0,ir=1,Rr=0;const zr=(Qt||ui)&&si.vertical,fs=si.metrics.advance*si.scale/2;if(ui&&ht.verticalizable&&(Rr=yi.lineOffset/2-(si.imageName?-(us-si.metrics.width*si.scale)/2:(si.scale-1)*us)),si.imageName){const Jr=Ci[si.imageName];Si=Jr.sdf,ir=Jr.pixelRatio,Pi=sn/ir}const fn=Qt?[si.x+fs,si.y]:[0,0];let Gs=Qt?[0,0]:[si.x+fs+bt[0],si.y+bt[1]-Rr],os=[0,0];zr&&(os=Gs,Gs=[0,0]);const ms=(si.metrics.left-Pi)*si.scale-fs+Gs[0],Ss=(-si.metrics.top-Pi)*si.scale+Gs[1],nn=ms+Gt.w*si.scale/ir,Ws=Ss+Gt.h*si.scale/ir,ls=new ge(ms,Ss),ds=new ge(nn,Ss),Ps=new ge(ms,Ws),qs=new ge(nn,Ws);if(zr){const Jr=new ge(-fs,fs-Ql),Is=-Math.PI/2,fr=us/2-fs,dn=new ge(5-Ql-fr,-(si.imageName?fr:0)),Fs=new ge(...os);ls._rotateAround(Is,Jr)._add(dn)._add(Fs),ds._rotateAround(Is,Jr)._add(dn)._add(Fs),Ps._rotateAround(Is,Jr)._add(dn)._add(Fs),qs._rotateAround(Is,Jr)._add(dn)._add(Fs)}if(li){const Jr=Math.sin(li),Is=Math.cos(li),fr=[Is,-Jr,Jr,Is];ls._matMult(fr),ds._matMult(fr),Ps._matMult(fr),qs._matMult(fr)}const an=new ge(0,0),on=new ge(0,0);ti.push({tl:ls,tr:ds,bl:Ps,br:qs,tex:Gt,writingMode:ht.writingMode,glyphOffset:fn,sectionIndex:si.sectionIndex,isSDF:Si,pixelOffsetTL:an,pixelOffsetBR:on,minFontScaleX:0,minFontScaleY:0})}return ti}(0,I,oe,q,ee,ie,H,C.allowVerticalPlacement),at=C.textSizeData;let ct=null;at.kind==="source"?(ct=[va*q.layout.get("text-size").evaluate(ie,{})],ct[0]>yo&&Vt(`${C.layerIds[0]}: Value for "text-size" is >= ${Rl}. Reduce your "text-size".`)):at.kind==="composite"&&(ct=[va*He.compositeTextSizes[0].evaluate(ie,{},Ne),va*He.compositeTextSizes[1].evaluate(ie,{},Ne)],(ct[0]>yo||ct[1]>yo)&&Vt(`${C.layerIds[0]}: Value for "text-size" is >= ${Rl}. Reduce your "text-size".`)),C.addSymbols(C.text,tt,ct,oe,ee,ie,_e,w,de.lineStartIndex,de.lineLength,Pe,Ne);for(const mt of Ee)Fe[mt]=C.text.placedSymbolArray.length-1;return 4*tt.length}function Th(C){for(const w in C)return C[w];return null}function mf(C,w,I,H){const q=C.compareText;if(w in q){const ee=q[w];for(let ie=ee.length-1;ie>=0;ie--)if(H.dist(ee[ie])<I)return!0}else q[w]=[];return q[w].push(H),!1}const Sh=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class YA{static from(w){if(!(w instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[I,H]=new Uint8Array(w,0,2);if(I!==219)throw new Error("Data does not appear to be in a KDBush format.");const q=H>>4;if(q!==1)throw new Error(`Got v${q} data when expected v1.`);const ee=Sh[15&H];if(!ee)throw new Error("Unrecognized array type.");const[ie]=new Uint16Array(w,2,1),[oe]=new Uint32Array(w,4,1);return new YA(oe,ie,ee,w)}constructor(w,I=64,H=Float64Array,q){if(isNaN(w)||w<0)throw new Error(`Unpexpected numItems value: ${w}.`);this.numItems=+w,this.nodeSize=Math.min(Math.max(+I,2),65535),this.ArrayType=H,this.IndexArrayType=w<65536?Uint16Array:Uint32Array;const ee=Sh.indexOf(this.ArrayType),ie=2*w*this.ArrayType.BYTES_PER_ELEMENT,oe=w*this.IndexArrayType.BYTES_PER_ELEMENT,de=(8-oe%8)%8;if(ee<0)throw new Error(`Unexpected typed array class: ${H}.`);q&&q instanceof ArrayBuffer?(this.data=q,this.ids=new this.IndexArrayType(this.data,8,w),this.coords=new this.ArrayType(this.data,8+oe+de,2*w),this._pos=2*w,this._finished=!0):(this.data=new ArrayBuffer(8+ie+oe+de),this.ids=new this.IndexArrayType(this.data,8,w),this.coords=new this.ArrayType(this.data,8+oe+de,2*w),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+ee]),new Uint16Array(this.data,2,1)[0]=I,new Uint32Array(this.data,4,1)[0]=w)}add(w,I){const H=this._pos>>1;return this.ids[H]=H,this.coords[this._pos++]=w,this.coords[this._pos++]=I,H}finish(){const w=this._pos>>1;if(w!==this.numItems)throw new Error(`Added ${w} items when expected ${this.numItems}.`);return jA(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(w,I,H,q){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:ee,coords:ie,nodeSize:oe}=this,de=[0,ee.length-1,0],_e=[];for(;de.length;){const Ee=de.pop()||0,Fe=de.pop()||0,Pe=de.pop()||0;if(Fe-Pe<=oe){for(let at=Pe;at<=Fe;at++){const ct=ie[2*at],mt=ie[2*at+1];ct>=w&&ct<=H&&mt>=I&&mt<=q&&_e.push(ee[at])}continue}const He=Pe+Fe>>1,Ne=ie[2*He],tt=ie[2*He+1];Ne>=w&&Ne<=H&&tt>=I&&tt<=q&&_e.push(ee[He]),(Ee===0?w<=Ne:I<=tt)&&(de.push(Pe),de.push(He-1),de.push(1-Ee)),(Ee===0?H>=Ne:q>=tt)&&(de.push(He+1),de.push(Fe),de.push(1-Ee))}return _e}within(w,I,H){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:q,coords:ee,nodeSize:ie}=this,oe=[0,q.length-1,0],de=[],_e=H*H;for(;oe.length;){const Ee=oe.pop()||0,Fe=oe.pop()||0,Pe=oe.pop()||0;if(Fe-Pe<=ie){for(let at=Pe;at<=Fe;at++)Fh(ee[2*at],ee[2*at+1],w,I)<=_e&&de.push(q[at]);continue}const He=Pe+Fe>>1,Ne=ee[2*He],tt=ee[2*He+1];Fh(Ne,tt,w,I)<=_e&&de.push(q[He]),(Ee===0?w-H<=Ne:I-H<=tt)&&(oe.push(Pe),oe.push(He-1),oe.push(1-Ee)),(Ee===0?w+H>=Ne:I+H>=tt)&&(oe.push(He+1),oe.push(Fe),oe.push(1-Ee))}return de}}function jA(C,w,I,H,q,ee){if(q-H<=I)return;const ie=H+q>>1;Ih(C,w,ie,H,q,ee),jA(C,w,I,H,ie-1,1-ee),jA(C,w,I,ie+1,q,1-ee)}function Ih(C,w,I,H,q,ee){for(;q>H;){if(q-H>600){const _e=q-H+1,Ee=I-H+1,Fe=Math.log(_e),Pe=.5*Math.exp(2*Fe/3),He=.5*Math.sqrt(Fe*Pe*(_e-Pe)/_e)*(Ee-_e/2<0?-1:1);Ih(C,w,I,Math.max(H,Math.floor(I-Ee*Pe/_e+He)),Math.min(q,Math.floor(I+(_e-Ee)*Pe/_e+He)),ee)}const ie=w[2*I+ee];let oe=H,de=q;for(zl(C,w,H,I),w[2*q+ee]>ie&&zl(C,w,H,q);oe<de;){for(zl(C,w,oe,de),oe++,de--;w[2*oe+ee]<ie;)oe++;for(;w[2*de+ee]>ie;)de--}w[2*H+ee]===ie?zl(C,w,H,de):(de++,zl(C,w,de,q)),de<=I&&(H=de+1),I<=de&&(q=de-1)}}function zl(C,w,I,H){ZA(C,I,H),ZA(w,2*I,2*H),ZA(w,2*I+1,2*H+1)}function ZA(C,w,I){const H=C[w];C[w]=C[I],C[I]=H}function Fh(C,w,I,H){const q=C-I,ee=w-H;return q*q+ee*ee}var JA;D.PerformanceMarkers=void 0,(JA=D.PerformanceMarkers||(D.PerformanceMarkers={})).create="create",JA.load="load",JA.fullLoad="fullLoad";let cA=null,Nl=[];const $A=1e3/60,ec="loadTime",tc="fullLoadTime",_f={mark(C){performance.mark(C)},frame(C){const w=C;cA!=null&&Nl.push(w-cA),cA=w},clearMetrics(){cA=null,Nl=[],performance.clearMeasures(ec),performance.clearMeasures(tc);for(const C in D.PerformanceMarkers)performance.clearMarks(D.PerformanceMarkers[C])},getPerformanceMetrics(){performance.measure(ec,D.PerformanceMarkers.create,D.PerformanceMarkers.load),performance.measure(tc,D.PerformanceMarkers.create,D.PerformanceMarkers.fullLoad);const C=performance.getEntriesByName(ec)[0].duration,w=performance.getEntriesByName(tc)[0].duration,I=Nl.length,H=1/(Nl.reduce((ee,ie)=>ee+ie,0)/I/1e3),q=Nl.filter(ee=>ee>$A).reduce((ee,ie)=>ee+(ie-$A)/$A,0);return{loadTime:C,fullLoadTime:w,fps:H,percentDroppedFrames:q/(I+q)*100,totalFrames:I}}};D.AJAXError=b,D.ARRAY_TYPE=al,D.Actor=class{constructor(C,w,I){this.receive=H=>{const q=H.data,ee=q.id;if(ee&&(!q.targetMapId||this.mapId===q.targetMapId))if(q.type==="<cancel>"){delete this.tasks[ee];const ie=this.cancelCallbacks[ee];delete this.cancelCallbacks[ee],ie&&ie()}else Pt()||q.mustQueue?(this.tasks[ee]=q,this.taskQueue.push(ee),this.invoker.trigger()):this.processTask(ee,q)},this.process=()=>{if(!this.taskQueue.length)return;const H=this.taskQueue.shift(),q=this.tasks[H];delete this.tasks[H],this.taskQueue.length&&this.invoker.trigger(),q&&this.processTask(H,q)},this.target=C,this.parent=w,this.mapId=I,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new lf(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Pt()?C:window}send(C,w,I,H,q=!1){const ee=Math.round(1e18*Math.random()).toString(36).substring(0,10);I&&(this.callbacks[ee]=I);const ie=Ai(this.globalScope)?void 0:[];return this.target.postMessage({id:ee,type:C,hasCallback:!!I,targetMapId:H,mustQueue:q,sourceMapId:this.mapId,data:we(w,ie)},ie),{cancel:()=>{I&&delete this.callbacks[ee],this.target.postMessage({id:ee,type:"<cancel>",targetMapId:H,sourceMapId:this.mapId})}}}processTask(C,w){if(w.type==="<response>"){const I=this.callbacks[C];delete this.callbacks[C],I&&(w.error?I(Re(w.error)):I(null,Re(w.data)))}else{let I=!1;const H=Ai(this.globalScope)?void 0:[],q=w.hasCallback?(oe,de)=>{I=!0,delete this.cancelCallbacks[C],this.target.postMessage({id:C,type:"<response>",sourceMapId:this.mapId,error:oe?we(oe):null,data:we(de,H)},H)}:oe=>{I=!0};let ee=null;const ie=Re(w.data);if(this.parent[w.type])ee=this.parent[w.type](w.sourceMapId,ie,q);else if(this.parent.getWorkerSource){const oe=w.type.split(".");ee=this.parent.getWorkerSource(w.sourceMapId,oe[0],ie.source)[oe[1]](ie,q)}else q(new Error(`Could not find function ${w.type}`));!I&&ee&&ee.cancel&&(this.cancelCallbacks[C]=ee.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},D.AlphaImage=Il,D.CanonicalTileID=WA,D.CollisionBoxArray=he,D.CollisionCircleLayoutArray=class extends Bl{},D.Color=wi,D.DEMData=ch,D.DataConstantProperty=Fi,D.DictionaryCoder=hh,D.EXTENT=Xr,D.ErrorEvent=Ve,D.EvaluationParameters=Er,D.Event=Te,D.Evented=Ue,D.FeatureIndex=fh,D.FillBucket=IA,D.FillExtrusionBucket=kA,D.GeoJSONFeature=uh,D.ImageAtlas=Gc,D.ImagePosition=LA,D.KDBush=YA,D.LineBucket=DA,D.LineStripIndexArray=class extends X{},D.LngLat=vo,D.MercatorCoordinate=nA,D.ONE_EM=us,D.OverscaledTileID=Bn,D.PerformanceUtils=_f,D.Point=ge,D.Pos3dArray=class extends Lo{},D.PosArray=Bt,D.Properties=Ns,D.Protobuf=MA,D.QuadTriangleArray=class extends rl{},D.RGBAImage=xn,D.RasterBoundsArray=class extends Qo{},D.RequestPerformance=class{constructor(C){this._marks={start:[C.url,"start"].join("#"),end:[C.url,"end"].join("#"),measure:C.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let C=performance.getEntriesByName(this._marks.measure);return C.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),C=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),C}},D.SegmentVector=Mi,D.SymbolBucket=ul,D.Transitionable=Jo,D.TriangleIndexArray=ki,D.Uniform1f=cs,D.Uniform1i=class extends is{constructor(C,w){super(C,w),this.current=0}set(C){this.current!==C&&(this.current=C,this.gl.uniform1i(this.location,C))}},D.Uniform2f=class extends is{constructor(C,w){super(C,w),this.current=[0,0]}set(C){C[0]===this.current[0]&&C[1]===this.current[1]||(this.current=C,this.gl.uniform2f(this.location,C[0],C[1]))}},D.Uniform3f=class extends is{constructor(C,w){super(C,w),this.current=[0,0,0]}set(C){C[0]===this.current[0]&&C[1]===this.current[1]&&C[2]===this.current[2]||(this.current=C,this.gl.uniform3f(this.location,C[0],C[1],C[2]))}},D.Uniform4f=Cs,D.UniformColor=po,D.UniformMatrix4f=class extends is{constructor(C,w){super(C,w),this.current=hs}set(C){if(C[12]!==this.current[12]||C[0]!==this.current[0])return this.current=C,void this.gl.uniformMatrix4fv(this.location,!1,C);for(let w=1;w<16;w++)if(C[w]!==this.current[w]){this.current=C,this.gl.uniformMatrix4fv(this.location,!1,C);break}}},D.UnwrappedTileID=Ah,D.ValidationError=wt,D.ZoomHistory=Xe,D.addDynamicAttributes=HA,D.arrayBufferToImage=function(C,w){const I=new Image;I.onload=()=>{w(null,I),URL.revokeObjectURL(I.src),I.onload=null,window.requestAnimationFrame(()=>{I.src=Ei})},I.onerror=()=>w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const H=new Blob([new Uint8Array(C)],{type:"image/png"});I.src=C.byteLength?URL.createObjectURL(H):Ei},D.arrayBufferToImageBitmap=function(C,w){const I=new Blob([new Uint8Array(C)],{type:"image/png"});createImageBitmap(I).then(H=>{w(null,H)}).catch(H=>{w(new Error(`Could not load image because of ${H.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},D.asyncAll=function(C,w,I){if(!C.length)return I(null,[]);let H=C.length;const q=new Array(C.length);let ee=null;C.forEach((ie,oe)=>{w(ie,(de,_e)=>{de&&(ee=de),q[oe]=_e,--H==0&&I(ee,q)})})},D.bezier=Oe,D.browser=vi,D.clamp=We,D.clipLine=gh,D.clone=function(C){var w=new al(16);return w[0]=C[0],w[1]=C[1],w[2]=C[2],w[3]=C[3],w[4]=C[4],w[5]=C[5],w[6]=C[6],w[7]=C[7],w[8]=C[8],w[9]=C[9],w[10]=C[10],w[11]=C[11],w[12]=C[12],w[13]=C[13],w[14]=C[14],w[15]=C[15],w},D.clone$1=Tt,D.collisionCircleLayout=Pu,D.config=d,D.copy=function(C,w){return C[0]=w[0],C[1]=w[1],C[2]=w[2],C[3]=w[3],C[4]=w[4],C[5]=w[5],C[6]=w[6],C[7]=w[7],C[8]=w[8],C[9]=w[9],C[10]=w[10],C[11]=w[11],C[12]=w[12],C[13]=w[13],C[14]=w[14],C[15]=w[15],C},D.create=function(){var C=new al(16);return al!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=0,C[12]=0,C[13]=0,C[14]=0),C[0]=1,C[5]=1,C[10]=1,C[15]=1,C},D.createExpression=Ji,D.createFilter=Fo,D.createLayout=ts,D.createStyleLayer=function(C){if(C.type==="custom")return new of(C);switch(C.type){case"background":return new sf(C);case"circle":return new Nh(C);case"fill":return new lu(C);case"fill-extrusion":return new xu(C);case"heatmap":return new Kh(C);case"hillshade":return new Wh(C);case"line":return new ku(C);case"raster":return new af(C);case"symbol":return new sA(C)}},D.deepEqual=function C(w,I){if(Array.isArray(w)){if(!Array.isArray(I)||w.length!==I.length)return!1;for(let H=0;H<w.length;H++)if(!C(w[H],I[H]))return!1;return!0}if(typeof w=="object"&&w!==null&&I!==null){if(typeof I!="object"||Object.keys(w).length!==Object.keys(I).length)return!1;for(const H in w)if(!C(w[H],I[H]))return!1;return!0}return w===I},D.defaultEasing=Je,D.derefLayers=function(C){C=C.slice();const w=Object.create(null);for(let I=0;I<C.length;I++)w[C[I].id]=C[I];for(let I=0;I<C.length;I++)"ref"in C[I]&&(C[I]=qe(C[I],w[C[I].ref]));return C},D.diffStyles=function(C,w){if(!C)return[{command:pt.setStyle,args:[w]}];let I=[];try{if(!lt(C.version,w.version))return[{command:pt.setStyle,args:[w]}];lt(C.center,w.center)||I.push({command:pt.setCenter,args:[w.center]}),lt(C.zoom,w.zoom)||I.push({command:pt.setZoom,args:[w.zoom]}),lt(C.bearing,w.bearing)||I.push({command:pt.setBearing,args:[w.bearing]}),lt(C.pitch,w.pitch)||I.push({command:pt.setPitch,args:[w.pitch]}),lt(C.sprite,w.sprite)||I.push({command:pt.setSprite,args:[w.sprite]}),lt(C.glyphs,w.glyphs)||I.push({command:pt.setGlyphs,args:[w.glyphs]}),lt(C.transition,w.transition)||I.push({command:pt.setTransition,args:[w.transition]}),lt(C.light,w.light)||I.push({command:pt.setLight,args:[w.light]});const H={},q=[];(function(ie,oe,de,_e){let Ee;for(Ee in oe=oe||{},ie=ie||{})Object.prototype.hasOwnProperty.call(ie,Ee)&&(Object.prototype.hasOwnProperty.call(oe,Ee)||zt(Ee,de,_e));for(Ee in oe)Object.prototype.hasOwnProperty.call(oe,Ee)&&(Object.prototype.hasOwnProperty.call(ie,Ee)?lt(ie[Ee],oe[Ee])||(ie[Ee].type==="geojson"&&oe[Ee].type==="geojson"&&Mt(ie,oe,Ee)?de.push({command:pt.setGeoJSONSourceData,args:[Ee,oe[Ee].data]}):Nt(Ee,oe,de,_e)):Ft(Ee,oe,de))})(C.sources,w.sources,q,H);const ee=[];C.layers&&C.layers.forEach(ie=>{H[ie.source]?I.push({command:pt.removeLayer,args:[ie.id]}):ee.push(ie)}),I=I.concat(q),function(ie,oe,de){oe=oe||[];const _e=(ie=ie||[]).map(ri),Ee=oe.map(ri),Fe=ie.reduce(ci,{}),Pe=oe.reduce(ci,{}),He=_e.slice(),Ne=Object.create(null);let tt,at,ct,mt,ht,bt,Ct;for(tt=0,at=0;tt<_e.length;tt++)ct=_e[tt],Object.prototype.hasOwnProperty.call(Pe,ct)?at++:(de.push({command:pt.removeLayer,args:[ct]}),He.splice(He.indexOf(ct,at),1));for(tt=0,at=0;tt<Ee.length;tt++)ct=Ee[Ee.length-1-tt],He[He.length-1-tt]!==ct&&(Object.prototype.hasOwnProperty.call(Fe,ct)?(de.push({command:pt.removeLayer,args:[ct]}),He.splice(He.lastIndexOf(ct,He.length-at),1)):at++,bt=He[He.length-tt],de.push({command:pt.addLayer,args:[Pe[ct],bt]}),He.splice(He.length-tt,0,ct),Ne[ct]=!0);for(tt=0;tt<Ee.length;tt++)if(ct=Ee[tt],mt=Fe[ct],ht=Pe[ct],!Ne[ct]&&!lt(mt,ht))if(lt(mt.source,ht.source)&&lt(mt["source-layer"],ht["source-layer"])&&lt(mt.type,ht.type)){for(Ct in $t(mt.layout,ht.layout,de,ct,null,pt.setLayoutProperty),$t(mt.paint,ht.paint,de,ct,null,pt.setPaintProperty),lt(mt.filter,ht.filter)||de.push({command:pt.setFilter,args:[ct,ht.filter]}),lt(mt.minzoom,ht.minzoom)&&lt(mt.maxzoom,ht.maxzoom)||de.push({command:pt.setLayerZoomRange,args:[ct,ht.minzoom,ht.maxzoom]}),mt)Object.prototype.hasOwnProperty.call(mt,Ct)&&Ct!=="layout"&&Ct!=="paint"&&Ct!=="filter"&&Ct!=="metadata"&&Ct!=="minzoom"&&Ct!=="maxzoom"&&(Ct.indexOf("paint.")===0?$t(mt[Ct],ht[Ct],de,ct,Ct.slice(6),pt.setPaintProperty):lt(mt[Ct],ht[Ct])||de.push({command:pt.setLayerProperty,args:[ct,Ct,ht[Ct]]}));for(Ct in ht)Object.prototype.hasOwnProperty.call(ht,Ct)&&!Object.prototype.hasOwnProperty.call(mt,Ct)&&Ct!=="layout"&&Ct!=="paint"&&Ct!=="filter"&&Ct!=="metadata"&&Ct!=="minzoom"&&Ct!=="maxzoom"&&(Ct.indexOf("paint.")===0?$t(mt[Ct],ht[Ct],de,ct,Ct.slice(6),pt.setPaintProperty):lt(mt[Ct],ht[Ct])||de.push({command:pt.setLayerProperty,args:[ct,Ct,ht[Ct]]}))}else de.push({command:pt.removeLayer,args:[ct]}),bt=He[He.lastIndexOf(ct)+1],de.push({command:pt.addLayer,args:[ht,bt]})}(ee,w.layers,I)}catch(H){console.warn("Unable to compute style diff:",H),I=[{command:pt.setStyle,args:[w]}]}return I},D.dot=function(C,w){return C[0]*w[0]+C[1]*w[1]+C[2]*w[2]+C[3]*w[3]},D.earthRadius=KA,D.emitValidationErrors=Wn,D.emptyStyle=function(){const C={},w=me.$version;for(const I in me.$root){const H=me.$root[I];if(H.required){let q=null;q=I==="version"?w:H.type==="array"?[]:{},q!=null&&(C[I]=q)}}return C},D.equals=function(C,w){var I=C[0],H=C[1],q=C[2],ee=C[3],ie=C[4],oe=C[5],de=C[6],_e=C[7],Ee=C[8],Fe=C[9],Pe=C[10],He=C[11],Ne=C[12],tt=C[13],at=C[14],ct=C[15],mt=w[0],ht=w[1],bt=w[2],Ct=w[3],Qt=w[4],fi=w[5],Ci=w[6],ui=w[7],li=w[8],ti=w[9],yi=w[10],si=w[11],Gt=w[12],Pi=w[13],Si=w[14],ir=w[15];return Math.abs(I-mt)<=Ks*Math.max(1,Math.abs(I),Math.abs(mt))&&Math.abs(H-ht)<=Ks*Math.max(1,Math.abs(H),Math.abs(ht))&&Math.abs(q-bt)<=Ks*Math.max(1,Math.abs(q),Math.abs(bt))&&Math.abs(ee-Ct)<=Ks*Math.max(1,Math.abs(ee),Math.abs(Ct))&&Math.abs(ie-Qt)<=Ks*Math.max(1,Math.abs(ie),Math.abs(Qt))&&Math.abs(oe-fi)<=Ks*Math.max(1,Math.abs(oe),Math.abs(fi))&&Math.abs(de-Ci)<=Ks*Math.max(1,Math.abs(de),Math.abs(Ci))&&Math.abs(_e-ui)<=Ks*Math.max(1,Math.abs(_e),Math.abs(ui))&&Math.abs(Ee-li)<=Ks*Math.max(1,Math.abs(Ee),Math.abs(li))&&Math.abs(Fe-ti)<=Ks*Math.max(1,Math.abs(Fe),Math.abs(ti))&&Math.abs(Pe-yi)<=Ks*Math.max(1,Math.abs(Pe),Math.abs(yi))&&Math.abs(He-si)<=Ks*Math.max(1,Math.abs(He),Math.abs(si))&&Math.abs(Ne-Gt)<=Ks*Math.max(1,Math.abs(Ne),Math.abs(Gt))&&Math.abs(tt-Pi)<=Ks*Math.max(1,Math.abs(tt),Math.abs(Pi))&&Math.abs(at-Si)<=Ks*Math.max(1,Math.abs(at),Math.abs(Si))&&Math.abs(ct-ir)<=Ks*Math.max(1,Math.abs(ct),Math.abs(ir))},D.evaluateSizeForFeature=function(C,{uSize:w,uSizeT:I},{lowerSize:H,upperSize:q}){return C.kind==="source"?H/va:C.kind==="composite"?ks.number(H/va,q/va,I):w},D.evaluateSizeForZoom=function(C,w){let I=0,H=0;if(C.kind==="constant")H=C.layoutSize;else if(C.kind!=="source"){const{interpolationType:q,minZoom:ee,maxZoom:ie}=C,oe=q?We(gs.interpolationFactor(q,w,ee,ie),0,1):0;C.kind==="camera"?H=ks.number(C.minSize,C.maxSize,oe):I=oe}return{uSizeT:I,uSize:H}},D.evented=bs,D.extend=et,D.filterObject=ft,D.findLineIntersection=function(C,w,I,H){const q=w.y-C.y,ee=w.x-C.x,ie=H.y-I.y,oe=H.x-I.x,de=ie*ee-oe*q;if(de===0)return null;const _e=(oe*(C.y-I.y)-ie*(C.x-I.x))/de;return new ge(C.x+_e*ee,C.y+_e*q)},D.fromScaling=function(C,w){return C[0]=w[0],C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=w[1],C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=w[2],C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C},D.getAnchorAlignment=OA,D.getAnchorJustification=XA,D.getArrayBuffer=se,D.getDefaultExportFromCjs=ne,D.getJSON=function(C,w){return W(et(C,{type:"json"}),w)},D.getOverlapMode=RA,D.getProtocolAction=k,D.getRTLTextPluginStatus=Ha,D.getReferrer=S,D.getVideo=function(C,w){const I=window.document.createElement("video");I.muted=!0,I.onloadstart=function(){w(null,I)};for(let H=0;H<C.length;H++){const q=window.document.createElement("source");le(C[H])||(I.crossOrigin="Anonymous"),q.src=C[H],I.appendChild(q)}return{cancel:()=>{}}},D.groupByLayout=function(C,w){const I={};for(let q=0;q<C.length;q++){const ee=w&&w[C[q].id]||_l(C[q]);w&&(w[C[q].id]=ee);let ie=I[ee];ie||(ie=I[ee]=[]),ie.push(C[q])}const H=[];for(const q in I)H.push(I[q]);return H},D.identity=mA,D.interpolate=ks,D.invert=function(C,w){var I=w[0],H=w[1],q=w[2],ee=w[3],ie=w[4],oe=w[5],de=w[6],_e=w[7],Ee=w[8],Fe=w[9],Pe=w[10],He=w[11],Ne=w[12],tt=w[13],at=w[14],ct=w[15],mt=I*oe-H*ie,ht=I*de-q*ie,bt=I*_e-ee*ie,Ct=H*de-q*oe,Qt=H*_e-ee*oe,fi=q*_e-ee*de,Ci=Ee*tt-Fe*Ne,ui=Ee*at-Pe*Ne,li=Ee*ct-He*Ne,ti=Fe*at-Pe*tt,yi=Fe*ct-He*tt,si=Pe*ct-He*at,Gt=mt*si-ht*yi+bt*ti+Ct*li-Qt*ui+fi*Ci;return Gt?(C[0]=(oe*si-de*yi+_e*ti)*(Gt=1/Gt),C[1]=(q*yi-H*si-ee*ti)*Gt,C[2]=(tt*fi-at*Qt+ct*Ct)*Gt,C[3]=(Pe*Qt-Fe*fi-He*Ct)*Gt,C[4]=(de*li-ie*si-_e*ui)*Gt,C[5]=(I*si-q*li+ee*ui)*Gt,C[6]=(at*bt-Ne*fi-ct*ht)*Gt,C[7]=(Ee*fi-Pe*bt+He*ht)*Gt,C[8]=(ie*yi-oe*li+_e*Ci)*Gt,C[9]=(H*li-I*yi-ee*Ci)*Gt,C[10]=(Ne*Qt-tt*bt+ct*mt)*Gt,C[11]=(Fe*bt-Ee*Qt-He*mt)*Gt,C[12]=(oe*ui-ie*ti-de*Ci)*Gt,C[13]=(I*ti-H*ui+q*Ci)*Gt,C[14]=(tt*ht-Ne*Ct-at*mt)*Gt,C[15]=(Ee*Ct-Fe*ht+Pe*mt)*Gt,C):null},D.isImageBitmap=Ri,D.isSafari=Ai,D.isWorker=Pt,D.keysDifference=function(C,w){const I=[];for(const H in C)H in w||I.push(H);return I},D.lazyLoadRTLTextPlugin=function(){ns.isLoading()||ns.isLoaded()||Ha()!=="deferred"||pa()},D.makeRequest=W,D.mapObject=nt,D.mercatorXfromLng=nh,D.mercatorYfromLat=ah,D.mercatorZfromAltitude=oh,D.mul=zh,D.mul$1=function(C,w,I){return C[0]=w[0]*I[0],C[1]=w[1]*I[1],C[2]=w[2]*I[2],C[3]=w[3]*I[3],C},D.multiply=cc,D.nextPowerOfTwo=function(C){return C<=1?1:Math.pow(2,Math.ceil(Math.log(C)/Math.LN2))},D.operations=pt,D.ortho=function(C,w,I,H,q,ee,ie){var oe=1/(w-I),de=1/(H-q),_e=1/(ee-ie);return C[0]=-2*oe,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*de,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=2*_e,C[11]=0,C[12]=(w+I)*oe,C[13]=(q+H)*de,C[14]=(ie+ee)*_e,C[15]=1,C},D.parseCacheControl=function(C){const w={};if(C.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(I,H,q,ee)=>{const ie=q||ee;return w[H]=!ie||ie.toLowerCase(),""}),w["max-age"]){const I=parseInt(w["max-age"],10);isNaN(I)?delete w["max-age"]:w["max-age"]=I}return w},D.parseGlyphPbf=function(C){return new MA(C).readFields(Wu,[])},D.pbf=Lc,D.performSymbolLayout=function(C){C.bucket.createArrays(),C.bucket.tilePixelRatio=Xr/(512*C.bucket.overscaling),C.bucket.compareText={},C.bucket.iconsNeedLinear=!1;const w=C.bucket.layers[0],I=w.layout,H=w._unevaluatedLayout._values,q={layoutIconSize:H["icon-size"].possiblyEvaluate(new Er(C.bucket.zoom+1),C.canonical),layoutTextSize:H["text-size"].possiblyEvaluate(new Er(C.bucket.zoom+1),C.canonical),textMaxSize:H["text-size"].possiblyEvaluate(new Er(18))};if(C.bucket.textSizeData.kind==="composite"){const{minZoom:_e,maxZoom:Ee}=C.bucket.textSizeData;q.compositeTextSizes=[H["text-size"].possiblyEvaluate(new Er(_e),C.canonical),H["text-size"].possiblyEvaluate(new Er(Ee),C.canonical)]}if(C.bucket.iconSizeData.kind==="composite"){const{minZoom:_e,maxZoom:Ee}=C.bucket.iconSizeData;q.compositeIconSizes=[H["icon-size"].possiblyEvaluate(new Er(_e),C.canonical),H["icon-size"].possiblyEvaluate(new Er(Ee),C.canonical)]}const ee=I.get("text-line-height")*us,ie=I.get("text-rotation-alignment")!=="viewport"&&I.get("symbol-placement")!=="point",oe=I.get("text-keep-upright"),de=I.get("text-size");for(const _e of C.bucket.features){const Ee=I.get("text-font").evaluate(_e,{},C.canonical).join(","),Fe=de.evaluate(_e,{},C.canonical),Pe=q.layoutTextSize.evaluate(_e,{},C.canonical),He=q.layoutIconSize.evaluate(_e,{},C.canonical),Ne={horizontal:{},vertical:void 0},tt=_e.text;let at,ct=[0,0];if(tt){const bt=tt.toString(),Ct=I.get("text-letter-spacing").evaluate(_e,{},C.canonical)*us,Qt=Et(bt)?Ct:0,fi=I.get("text-anchor").evaluate(_e,{},C.canonical),Ci=Ch(w,_e,C.canonical);if(!Ci){const si=I.get("text-radial-offset").evaluate(_e,{},C.canonical);ct=si?Bh(fi,[si*us,qA]):I.get("text-offset").evaluate(_e,{},C.canonical).map(Gt=>Gt*us)}let ui=ie?"center":I.get("text-justify").evaluate(_e,{},C.canonical);const li=I.get("symbol-placement"),ti=li==="point"?I.get("text-max-width").evaluate(_e,{},C.canonical)*us:0,yi=()=>{C.bucket.allowVerticalPlacement&&yt(bt)&&(Ne.vertical=tA(tt,C.glyphMap,C.glyphPositions,C.imagePositions,Ee,ti,ee,fi,"left",Qt,ct,D.WritingMode.vertical,!0,li,Pe,Fe))};if(!ie&&Ci){const si=new Set;if(ui==="auto")for(let Pi=0;Pi<Ci.values.length;Pi+=2)si.add(XA(Ci.values[Pi]));else si.add(ui);let Gt=!1;for(const Pi of si)if(!Ne.horizontal[Pi])if(Gt)Ne.horizontal[Pi]=Ne.horizontal[0];else{const Si=tA(tt,C.glyphMap,C.glyphPositions,C.imagePositions,Ee,ti,ee,"center",Pi,Qt,ct,D.WritingMode.horizontal,!1,li,Pe,Fe);Si&&(Ne.horizontal[Pi]=Si,Gt=Si.positionedLines.length===1)}yi()}else{ui==="auto"&&(ui=XA(fi));const si=tA(tt,C.glyphMap,C.glyphPositions,C.imagePositions,Ee,ti,ee,fi,ui,Qt,ct,D.WritingMode.horizontal,!1,li,Pe,Fe);si&&(Ne.horizontal[ui]=si),yi(),yt(bt)&&ie&&oe&&(Ne.vertical=tA(tt,C.glyphMap,C.glyphPositions,C.imagePositions,Ee,ti,ee,fi,ui,Qt,ct,D.WritingMode.vertical,!1,li,Pe,Fe))}}let mt=!1;if(_e.icon&&_e.icon.name){const bt=C.imageMap[_e.icon.name];bt&&(at=Ju(C.imagePositions[_e.icon.name],I.get("icon-offset").evaluate(_e,{},C.canonical),I.get("icon-anchor").evaluate(_e,{},C.canonical)),mt=!!bt.sdf,C.bucket.sdfIcons===void 0?C.bucket.sdfIcons=mt:C.bucket.sdfIcons!==mt&&Vt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(bt.pixelRatio!==C.bucket.pixelRatio||I.get("icon-rotate").constantOr(1)!==0)&&(C.bucket.iconsNeedLinear=!0))}const ht=Th(Ne.horizontal)||Ne.vertical;C.bucket.iconsInText=!!ht&&ht.iconsInText,(ht||at)&&gf(C.bucket,_e,Ne,at,C.imageMap,q,Pe,He,ct,mt,C.canonical)}C.showCollisionBoxes&&C.bucket.generateCollisionDebugBuffers()},D.perspective=function(C,w,I,H,q){var ee,ie=1/Math.tan(w/2);return C[0]=ie/I,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=ie,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,q!=null&&q!==1/0?(C[10]=(q+H)*(ee=1/(H-q)),C[14]=2*q*H*ee):(C[10]=-1,C[14]=-2*H),C},D.pick=function(C,w){const I={};for(let H=0;H<w.length;H++){const q=w[H];q in C&&(I[q]=C[q])}return I},D.plugin=ns,D.pointGeometry=ae,D.polygonIntersectsPolygon=sc,D.potpack=Kc,D.register=gi,D.registerForPluginStateChange=function(C){return C({pluginStatus:nr,pluginURL:Xi}),bs.on("pluginStateChange",C),C},D.renderColorRamp=pc,D.rotateX=function(C,w,I){var H=Math.sin(I),q=Math.cos(I),ee=w[4],ie=w[5],oe=w[6],de=w[7],_e=w[8],Ee=w[9],Fe=w[10],Pe=w[11];return w!==C&&(C[0]=w[0],C[1]=w[1],C[2]=w[2],C[3]=w[3],C[12]=w[12],C[13]=w[13],C[14]=w[14],C[15]=w[15]),C[4]=ee*q+_e*H,C[5]=ie*q+Ee*H,C[6]=oe*q+Fe*H,C[7]=de*q+Pe*H,C[8]=_e*q-ee*H,C[9]=Ee*q-ie*H,C[10]=Fe*q-oe*H,C[11]=Pe*q-de*H,C},D.rotateZ=function(C,w,I){var H=Math.sin(I),q=Math.cos(I),ee=w[0],ie=w[1],oe=w[2],de=w[3],_e=w[4],Ee=w[5],Fe=w[6],Pe=w[7];return w!==C&&(C[8]=w[8],C[9]=w[9],C[10]=w[10],C[11]=w[11],C[12]=w[12],C[13]=w[13],C[14]=w[14],C[15]=w[15]),C[0]=ee*q+_e*H,C[1]=ie*q+Ee*H,C[2]=oe*q+Fe*H,C[3]=de*q+Pe*H,C[4]=_e*q-ee*H,C[5]=Ee*q-ie*H,C[6]=Fe*q-oe*H,C[7]=Pe*q-de*H,C},D.sameOrigin=le,D.scale=function(C,w,I){var H=I[0],q=I[1],ee=I[2];return C[0]=w[0]*H,C[1]=w[1]*H,C[2]=w[2]*H,C[3]=w[3]*H,C[4]=w[4]*q,C[5]=w[5]*q,C[6]=w[6]*q,C[7]=w[7]*q,C[8]=w[8]*ee,C[9]=w[9]*ee,C[10]=w[10]*ee,C[11]=w[11]*ee,C[12]=w[12],C[13]=w[13],C[14]=w[14],C[15]=w[15],C},D.setRTLTextPlugin=function(C,w,I=!1){if(nr===Oi||nr===mr||nr===ur)throw new Error("setRTLTextPlugin cannot be called multiple times.");Xi=vi.resolveURL(C),nr=Oi,vr=w,Sr(),I||pa()},D.sphericalToCartesian=function([C,w,I]){return w+=90,w*=Math.PI/180,I*=Math.PI/180,{x:C*Math.cos(w)*Math.sin(I),y:C*Math.sin(w)*Math.sin(I),z:C*Math.cos(I)}},D.toEvaluationFeature=ya,D.transformMat4=Xl,D.translate=function(C,w,I){var H,q,ee,ie,oe,de,_e,Ee,Fe,Pe,He,Ne,tt=I[0],at=I[1],ct=I[2];return w===C?(C[12]=w[0]*tt+w[4]*at+w[8]*ct+w[12],C[13]=w[1]*tt+w[5]*at+w[9]*ct+w[13],C[14]=w[2]*tt+w[6]*at+w[10]*ct+w[14],C[15]=w[3]*tt+w[7]*at+w[11]*ct+w[15]):(q=w[1],ee=w[2],ie=w[3],oe=w[4],de=w[5],_e=w[6],Ee=w[7],Fe=w[8],Pe=w[9],He=w[10],Ne=w[11],C[0]=H=w[0],C[1]=q,C[2]=ee,C[3]=ie,C[4]=oe,C[5]=de,C[6]=_e,C[7]=Ee,C[8]=Fe,C[9]=Pe,C[10]=He,C[11]=Ne,C[12]=H*tt+oe*at+Fe*ct+w[12],C[13]=q*tt+de*at+Pe*ct+w[13],C[14]=ee*tt+_e*at+He*ct+w[14],C[15]=ie*tt+Ee*at+Ne*ct+w[15]),C},D.triggerPluginCompletionEvent=Or,D.unicodeBlockLookup=je,D.uniqueId=function(){return At++},D.v8Spec=me,D.validateCustomStyleLayer=function(C){const w=[],I=C.id;return I===void 0&&w.push({message:`layers.${I}: missing required property "id"`}),C.render===void 0&&w.push({message:`layers.${I}: missing required method "render"`}),C.renderingMode&&C.renderingMode!=="2d"&&C.renderingMode!=="3d"&&w.push({message:`layers.${I}: property "renderingMode" must be either "2d" or "3d"`}),w},D.validateLight=co,D.validateStyle=Ra,D.vectorTile=mo,D.warnOnce=Vt,D.wrap=ut}),Y(["./shared"],function(D){class ne{constructor(Ie){this.keyCache={},Ie&&this.replace(Ie)}replace(Ie){this._layerConfigs={},this._layers={},this.update(Ie,[])}update(Ie,ce){for(const xe of Ie){this._layerConfigs[xe.id]=xe;const Me=this._layers[xe.id]=D.createStyleLayer(xe);Me._featureFilter=D.createFilter(Me.filter),this.keyCache[xe.id]&&delete this.keyCache[xe.id]}for(const xe of ce)delete this.keyCache[xe],delete this._layerConfigs[xe],delete this._layers[xe];this.familiesBySource={};const ye=D.groupByLayout(Object.values(this._layerConfigs),this.keyCache);for(const xe of ye){const Me=xe.map(xt=>this._layers[xt.id]),Ge=Me[0];if(Ge.visibility==="none")continue;const Le=Ge.source||"";let Ke=this.familiesBySource[Le];Ke||(Ke=this.familiesBySource[Le]={});const st=Ge.sourceLayer||"_geojsonTileLayer";let _t=Ke[st];_t||(_t=Ke[st]=[]),_t.push(Me)}}}class ae{constructor(Ie){const ce={},ye=[];for(const Le in Ie){const Ke=Ie[Le],st=ce[Le]={};for(const _t in Ke){const xt=Ke[+_t];if(!xt||xt.bitmap.width===0||xt.bitmap.height===0)continue;const kt={x:0,y:0,w:xt.bitmap.width+2,h:xt.bitmap.height+2};ye.push(kt),st[_t]={rect:kt,metrics:xt.metrics}}}const{w:xe,h:Me}=D.potpack(ye),Ge=new D.AlphaImage({width:xe||1,height:Me||1});for(const Le in Ie){const Ke=Ie[Le];for(const st in Ke){const _t=Ke[+st];if(!_t||_t.bitmap.width===0||_t.bitmap.height===0)continue;const xt=ce[Le][st].rect;D.AlphaImage.copy(_t.bitmap,Ge,{x:0,y:0},{x:xt.x+1,y:xt.y+1},_t.bitmap)}}this.image=Ge,this.positions=ce}}D.register("GlyphAtlas",ae);class ue{constructor(Ie){this.tileID=new D.OverscaledTileID(Ie.tileID.overscaledZ,Ie.tileID.wrap,Ie.tileID.canonical.z,Ie.tileID.canonical.x,Ie.tileID.canonical.y),this.uid=Ie.uid,this.zoom=Ie.zoom,this.pixelRatio=Ie.pixelRatio,this.tileSize=Ie.tileSize,this.source=Ie.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Ie.showCollisionBoxes,this.collectResourceTiming=!!Ie.collectResourceTiming,this.returnDependencies=!!Ie.returnDependencies,this.promoteId=Ie.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(Ie,ce,ye,xe,Me){this.status="parsing",this.data=Ie,this.collisionBoxArray=new D.CollisionBoxArray;const Ge=new D.DictionaryCoder(Object.keys(Ie.layers).sort()),Le=new D.FeatureIndex(this.tileID,this.promoteId);Le.bucketLayerIDs=[];const Ke={},st={featureIndex:Le,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ye},_t=ce.familiesBySource[this.source];for(const Ki in _t){const Xt=Ie.layers[Ki];if(!Xt)continue;Xt.version===1&&D.warnOnce(`Vector tile source "${this.source}" layer "${Ki}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const br=Ge.encode(Ki),wi=[];for(let Ir=0;Ir<Xt.length;Ir++){const Pr=Xt.feature(Ir),Zi=Le.getId(Pr,Ki);wi.push({feature:Pr,id:Zi,index:Ir,sourceLayerIndex:br})}for(const Ir of _t[Ki]){const Pr=Ir[0];Pr.source!==this.source&&D.warnOnce(`layer.source = ${Pr.source} does not equal this.source = ${this.source}`),Pr.minzoom&&this.zoom<Math.floor(Pr.minzoom)||Pr.maxzoom&&this.zoom>=Pr.maxzoom||Pr.visibility!=="none"&&(ge(Ir,this.zoom,ye),(Ke[Pr.id]=Pr.createBucket({index:Le.bucketLayerIDs.length,layers:Ir,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:br,sourceID:this.source})).populate(wi,st,this.tileID.canonical),Le.bucketLayerIDs.push(Ir.map(Zi=>Zi.id)))}}let xt,kt,ai,Di;const ni=D.mapObject(st.glyphDependencies,Ki=>Object.keys(Ki).map(Number));this.inFlightDependencies.forEach(Ki=>Ki==null?void 0:Ki.cancel()),this.inFlightDependencies=[];const ei=++this.dependencySentinel;Object.keys(ni).length?this.inFlightDependencies.push(xe.send("getGlyphs",{uid:this.uid,stacks:ni,source:this.source,tileID:this.tileID,type:"glyphs"},(Ki,Xt)=>{ei===this.dependencySentinel&&(xt||(xt=Ki,kt=Xt,hr.call(this)))})):kt={};const Ui=Object.keys(st.iconDependencies);Ui.length?this.inFlightDependencies.push(xe.send("getImages",{icons:Ui,source:this.source,tileID:this.tileID,type:"icons"},(Ki,Xt)=>{ei===this.dependencySentinel&&(xt||(xt=Ki,ai=Xt,hr.call(this)))})):ai={};const Qi=Object.keys(st.patternDependencies);function hr(){if(xt)return Me(xt);if(kt&&ai&&Di){const Ki=new ae(kt),Xt=new D.ImageAtlas(ai,Di);for(const br in Ke){const wi=Ke[br];wi instanceof D.SymbolBucket?(ge(wi.layers,this.zoom,ye),D.performSymbolLayout({bucket:wi,glyphMap:kt,glyphPositions:Ki.positions,imageMap:ai,imagePositions:Xt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):wi.hasPattern&&(wi instanceof D.LineBucket||wi instanceof D.FillBucket||wi instanceof D.FillExtrusionBucket)&&(ge(wi.layers,this.zoom,ye),wi.addFeatures(st,this.tileID.canonical,Xt.patternPositions))}this.status="done",Me(null,{buckets:Object.values(Ke).filter(br=>!br.isEmpty()),featureIndex:Le,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ki.image,imageAtlas:Xt,glyphMap:this.returnDependencies?kt:null,iconMap:this.returnDependencies?ai:null,glyphPositions:this.returnDependencies?Ki.positions:null})}}Qi.length?this.inFlightDependencies.push(xe.send("getImages",{icons:Qi,source:this.source,tileID:this.tileID,type:"patterns"},(Ki,Xt)=>{ei===this.dependencySentinel&&(xt||(xt=Ki,Di=Xt,hr.call(this)))})):Di={},hr.call(this)}}function ge(it,Ie,ce){const ye=new D.EvaluationParameters(Ie);for(const xe of it)xe.recalculate(ye,ce)}function Be(it,Ie){const ce=D.getArrayBuffer(it.request,(ye,xe,Me,Ge)=>{ye?Ie(ye):xe&&Ie(null,{vectorTile:new D.vectorTile.VectorTile(new D.Protobuf(xe)),rawData:xe,cacheControl:Me,expires:Ge})});return()=>{ce.cancel(),Ie()}}class De{constructor(Ie,ce,ye,xe){this.actor=Ie,this.layerIndex=ce,this.availableImages=ye,this.loadVectorData=xe||Be,this.fetching={},this.loading={},this.loaded={}}loadTile(Ie,ce){const ye=Ie.uid;this.loading||(this.loading={});const xe=!!(Ie&&Ie.request&&Ie.request.collectResourceTiming)&&new D.RequestPerformance(Ie.request),Me=this.loading[ye]=new ue(Ie);Me.abort=this.loadVectorData(Ie,(Ge,Le)=>{if(delete this.loading[ye],Ge||!Le)return Me.status="done",this.loaded[ye]=Me,ce(Ge);const Ke=Le.rawData,st={};Le.expires&&(st.expires=Le.expires),Le.cacheControl&&(st.cacheControl=Le.cacheControl);const _t={};if(xe){const xt=xe.finish();xt&&(_t.resourceTiming=JSON.parse(JSON.stringify(xt)))}Me.vectorTile=Le.vectorTile,Me.parse(Le.vectorTile,this.layerIndex,this.availableImages,this.actor,(xt,kt)=>{if(delete this.fetching[ye],xt||!kt)return ce(xt);ce(null,D.extend({rawTileData:Ke.slice(0)},kt,st,_t))}),this.loaded=this.loaded||{},this.loaded[ye]=Me,this.fetching[ye]={rawTileData:Ke,cacheControl:st,resourceTiming:_t}})}reloadTile(Ie,ce){const ye=this.loaded,xe=Ie.uid;if(ye&&ye[xe]){const Me=ye[xe];Me.showCollisionBoxes=Ie.showCollisionBoxes,Me.status==="parsing"?Me.parse(Me.vectorTile,this.layerIndex,this.availableImages,this.actor,(Ge,Le)=>{if(Ge||!Le)return ce(Ge,Le);let Ke;if(this.fetching[xe]){const{rawTileData:st,cacheControl:_t,resourceTiming:xt}=this.fetching[xe];delete this.fetching[xe],Ke=D.extend({rawTileData:st.slice(0)},Le,_t,xt)}else Ke=Le;ce(null,Ke)}):Me.status==="done"&&(Me.vectorTile?Me.parse(Me.vectorTile,this.layerIndex,this.availableImages,this.actor,ce):ce())}}abortTile(Ie,ce){const ye=this.loading,xe=Ie.uid;ye&&ye[xe]&&ye[xe].abort&&(ye[xe].abort(),delete ye[xe]),ce()}removeTile(Ie,ce){const ye=this.loaded,xe=Ie.uid;ye&&ye[xe]&&delete ye[xe],ce()}}class ze{constructor(){this.loaded={}}loadTile(Ie,ce){const{uid:ye,encoding:xe,rawImageData:Me}=Ie,Ge=D.isImageBitmap(Me)?this.getImageData(Me):Me,Le=new D.DEMData(ye,Ge,xe);this.loaded=this.loaded||{},this.loaded[ye]=Le,ce(null,Le)}getImageData(Ie){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Ie.width,Ie.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Ie.width,this.offscreenCanvas.height=Ie.height,this.offscreenCanvasContext.drawImage(Ie,0,0,Ie.width,Ie.height);const ce=this.offscreenCanvasContext.getImageData(-1,-1,Ie.width+2,Ie.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new D.RGBAImage({width:ce.width,height:ce.height},ce.data)}removeTile(Ie){const ce=this.loaded,ye=Ie.uid;ce&&ce[ye]&&delete ce[ye]}}function Oe(it,Ie){if(it.length!==0){Je(it[0],Ie);for(var ce=1;ce<it.length;ce++)Je(it[ce],!Ie)}}function Je(it,Ie){for(var ce=0,ye=0,xe=0,Me=it.length,Ge=Me-1;xe<Me;Ge=xe++){var Le=(it[xe][0]-it[Ge][0])*(it[Ge][1]+it[xe][1]),Ke=ce+Le;ye+=Math.abs(ce)>=Math.abs(Le)?ce-Ke+Le:Le-Ke+ce,ce=Ke}ce+ye>=0!=!!Ie&&it.reverse()}var We=D.getDefaultExportFromCjs(function it(Ie,ce){var ye,xe=Ie&&Ie.type;if(xe==="FeatureCollection")for(ye=0;ye<Ie.features.length;ye++)it(Ie.features[ye],ce);else if(xe==="GeometryCollection")for(ye=0;ye<Ie.geometries.length;ye++)it(Ie.geometries[ye],ce);else if(xe==="Feature")it(Ie.geometry,ce);else if(xe==="Polygon")Oe(Ie.coordinates,ce);else if(xe==="MultiPolygon")for(ye=0;ye<Ie.coordinates.length;ye++)Oe(Ie.coordinates[ye],ce);return Ie});const ut=D.vectorTile.VectorTileFeature.prototype.toGeoJSON;var et={exports:{}},At=D.pointGeometry,nt=D.vectorTile.VectorTileFeature,ft=Tt;function Tt(it,Ie){this.options=Ie||{},this.features=it,this.length=it.length}function qt(it,Ie){this.id=typeof it.id=="number"?it.id:void 0,this.type=it.type,this.rawGeometry=it.type===1?[it.geometry]:it.geometry,this.properties=it.tags,this.extent=Ie||4096}Tt.prototype.feature=function(it){return new qt(this.features[it],this.options.extent)},qt.prototype.loadGeometry=function(){var it=this.rawGeometry;this.geometry=[];for(var Ie=0;Ie<it.length;Ie++){for(var ce=it[Ie],ye=[],xe=0;xe<ce.length;xe++)ye.push(new At(ce[xe][0],ce[xe][1]));this.geometry.push(ye)}return this.geometry},qt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var it=this.geometry,Ie=1/0,ce=-1/0,ye=1/0,xe=-1/0,Me=0;Me<it.length;Me++)for(var Ge=it[Me],Le=0;Le<Ge.length;Le++){var Ke=Ge[Le];Ie=Math.min(Ie,Ke.x),ce=Math.max(ce,Ke.x),ye=Math.min(ye,Ke.y),xe=Math.max(xe,Ke.y)}return[Ie,ye,ce,xe]},qt.prototype.toGeoJSON=nt.prototype.toGeoJSON;var Vt=D.pbf,vt=ft;function Ut(it){var Ie=new Vt;return function(ce,ye){for(var xe in ce.layers)ye.writeMessage(3,Pt,ce.layers[xe])}(it,Ie),Ie.finish()}function Pt(it,Ie){var ce;Ie.writeVarintField(15,it.version||1),Ie.writeStringField(1,it.name||""),Ie.writeVarintField(5,it.extent||4096);var ye={keys:[],values:[],keycache:{},valuecache:{}};for(ce=0;ce<it.length;ce++)ye.feature=it.feature(ce),Ie.writeMessage(2,Yt,ye);var xe=ye.keys;for(ce=0;ce<xe.length;ce++)Ie.writeStringField(3,xe[ce]);var Me=ye.values;for(ce=0;ce<Me.length;ce++)Ie.writeMessage(4,Yi,Me[ce])}function Yt(it,Ie){var ce=it.feature;ce.id!==void 0&&Ie.writeVarintField(1,ce.id),Ie.writeMessage(2,Ai,it),Ie.writeVarintField(3,ce.type),Ie.writeMessage(4,Li,ce)}function Ai(it,Ie){var ce=it.feature,ye=it.keys,xe=it.values,Me=it.keycache,Ge=it.valuecache;for(var Le in ce.properties){var Ke=ce.properties[Le],st=Me[Le];if(Ke!==null){st===void 0&&(ye.push(Le),Me[Le]=st=ye.length-1),Ie.writeVarint(st);var _t=typeof Ke;_t!=="string"&&_t!=="boolean"&&_t!=="number"&&(Ke=JSON.stringify(Ke));var xt=_t+":"+Ke,kt=Ge[xt];kt===void 0&&(xe.push(Ke),Ge[xt]=kt=xe.length-1),Ie.writeVarint(kt)}}}function Ri(it,Ie){return(Ie<<3)+(7&it)}function Ei(it){return it<<1^it>>31}function Li(it,Ie){for(var ce=it.loadGeometry(),ye=it.type,xe=0,Me=0,Ge=ce.length,Le=0;Le<Ge;Le++){var Ke=ce[Le],st=1;ye===1&&(st=Ke.length),Ie.writeVarint(Ri(1,st));for(var _t=ye===3?Ke.length-1:Ke.length,xt=0;xt<_t;xt++){xt===1&&ye!==1&&Ie.writeVarint(Ri(2,_t-1));var kt=Ke[xt].x-xe,ai=Ke[xt].y-Me;Ie.writeVarint(Ei(kt)),Ie.writeVarint(Ei(ai)),xe+=kt,Me+=ai}ye===3&&Ie.writeVarint(Ri(7,1))}}function Yi(it,Ie){var ce=typeof it;ce==="string"?Ie.writeStringField(1,it):ce==="boolean"?Ie.writeBooleanField(7,it):ce==="number"&&(it%1!=0?Ie.writeDoubleField(3,it):it<0?Ie.writeSVarintField(6,it):Ie.writeVarintField(5,it))}et.exports=Ut,et.exports.fromVectorTileJs=Ut,et.exports.fromGeojsonVt=function(it,Ie){Ie=Ie||{};var ce={};for(var ye in it)ce[ye]=new vt(it[ye].features,Ie),ce[ye].name=ye,ce[ye].version=Ie.version,ce[ye].extent=Ie.extent;return Ut({layers:ce})},et.exports.GeoJSONWrapper=vt;var vi=D.getDefaultExportFromCjs(et.exports);const d={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:it=>it},b=Math.fround||(S=new Float32Array(1),it=>(S[0]=+it,S[0]));var S;const k=3,R=5,W=6;class se{constructor(Ie){this.options=Object.assign(Object.create(d),Ie),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Ie){const{log:ce,minZoom:ye,maxZoom:xe}=this.options;ce&&console.time("total time");const Me=`prepare ${Ie.length} points`;ce&&console.time(Me),this.points=Ie;const Ge=[];for(let Ke=0;Ke<Ie.length;Ke++){const st=Ie[Ke];if(!st.geometry)continue;const[_t,xt]=st.geometry.coordinates,kt=b(be(_t)),ai=b(Te(xt));Ge.push(kt,ai,1/0,Ke,-1,1),this.options.reduce&&Ge.push(0)}let Le=this.trees[xe+1]=this._createTree(Ge);ce&&console.timeEnd(Me);for(let Ke=xe;Ke>=ye;Ke--){const st=+Date.now();Le=this.trees[Ke]=this._createTree(this._cluster(Le,Ke)),ce&&console.log("z%d: %d clusters in %dms",Ke,Le.numItems,+Date.now()-st)}return ce&&console.timeEnd("total time"),this}getClusters(Ie,ce){let ye=((Ie[0]+180)%360+360)%360-180;const xe=Math.max(-90,Math.min(90,Ie[1]));let Me=Ie[2]===180?180:((Ie[2]+180)%360+360)%360-180;const Ge=Math.max(-90,Math.min(90,Ie[3]));if(Ie[2]-Ie[0]>=360)ye=-180,Me=180;else if(ye>Me){const xt=this.getClusters([ye,xe,180,Ge],ce),kt=this.getClusters([-180,xe,Me,Ge],ce);return xt.concat(kt)}const Le=this.trees[this._limitZoom(ce)],Ke=Le.range(be(ye),Te(Ge),be(Me),Te(xe)),st=Le.data,_t=[];for(const xt of Ke){const kt=this.stride*xt;_t.push(st[kt+R]>1?le(st,kt,this.clusterProps):this.points[st[kt+k]])}return _t}getChildren(Ie){const ce=this._getOriginId(Ie),ye=this._getOriginZoom(Ie),xe="No cluster with the specified id.",Me=this.trees[ye];if(!Me)throw new Error(xe);const Ge=Me.data;if(ce*this.stride>=Ge.length)throw new Error(xe);const Le=this.options.radius/(this.options.extent*Math.pow(2,ye-1)),Ke=Me.within(Ge[ce*this.stride],Ge[ce*this.stride+1],Le),st=[];for(const _t of Ke){const xt=_t*this.stride;Ge[xt+4]===Ie&&st.push(Ge[xt+R]>1?le(Ge,xt,this.clusterProps):this.points[Ge[xt+k]])}if(st.length===0)throw new Error(xe);return st}getLeaves(Ie,ce,ye){const xe=[];return this._appendLeaves(xe,Ie,ce=ce||10,ye=ye||0,0),xe}getTile(Ie,ce,ye){const xe=this.trees[this._limitZoom(Ie)],Me=Math.pow(2,Ie),{extent:Ge,radius:Le}=this.options,Ke=Le/Ge,st=(ye-Ke)/Me,_t=(ye+1+Ke)/Me,xt={features:[]};return this._addTileFeatures(xe.range((ce-Ke)/Me,st,(ce+1+Ke)/Me,_t),xe.data,ce,ye,Me,xt),ce===0&&this._addTileFeatures(xe.range(1-Ke/Me,st,1,_t),xe.data,Me,ye,Me,xt),ce===Me-1&&this._addTileFeatures(xe.range(0,st,Ke/Me,_t),xe.data,-1,ye,Me,xt),xt.features.length?xt:null}getClusterExpansionZoom(Ie){let ce=this._getOriginZoom(Ie)-1;for(;ce<=this.options.maxZoom;){const ye=this.getChildren(Ie);if(ce++,ye.length!==1)break;Ie=ye[0].properties.cluster_id}return ce}_appendLeaves(Ie,ce,ye,xe,Me){const Ge=this.getChildren(ce);for(const Le of Ge){const Ke=Le.properties;if(Ke&&Ke.cluster?Me+Ke.point_count<=xe?Me+=Ke.point_count:Me=this._appendLeaves(Ie,Ke.cluster_id,ye,xe,Me):Me<xe?Me++:Ie.push(Le),Ie.length===ye)break}return Me}_createTree(Ie){const ce=new D.KDBush(Ie.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ye=0;ye<Ie.length;ye+=this.stride)ce.add(Ie[ye],Ie[ye+1]);return ce.finish(),ce.data=Ie,ce}_addTileFeatures(Ie,ce,ye,xe,Me,Ge){for(const Le of Ie){const Ke=Le*this.stride,st=ce[Ke+R]>1;let _t,xt,kt;if(st)_t=fe(ce,Ke,this.clusterProps),xt=ce[Ke],kt=ce[Ke+1];else{const ni=this.points[ce[Ke+k]];_t=ni.properties;const[ei,Ui]=ni.geometry.coordinates;xt=be(ei),kt=Te(Ui)}const ai={type:1,geometry:[[Math.round(this.options.extent*(xt*Me-ye)),Math.round(this.options.extent*(kt*Me-xe))]],tags:_t};let Di;Di=st||this.options.generateId?ce[Ke+k]:this.points[ce[Ke+k]].id,Di!==void 0&&(ai.id=Di),Ge.features.push(ai)}}_limitZoom(Ie){return Math.max(this.options.minZoom,Math.min(Math.floor(+Ie),this.options.maxZoom+1))}_cluster(Ie,ce){const{radius:ye,extent:xe,reduce:Me,minPoints:Ge}=this.options,Le=ye/(xe*Math.pow(2,ce)),Ke=Ie.data,st=[],_t=this.stride;for(let xt=0;xt<Ke.length;xt+=_t){if(Ke[xt+2]<=ce)continue;Ke[xt+2]=ce;const kt=Ke[xt],ai=Ke[xt+1],Di=Ie.within(Ke[xt],Ke[xt+1],Le),ni=Ke[xt+R];let ei=ni;for(const Ui of Di){const Qi=Ui*_t;Ke[Qi+2]>ce&&(ei+=Ke[Qi+R])}if(ei>ni&&ei>=Ge){let Ui,Qi=kt*ni,hr=ai*ni,Ki=-1;const Xt=((xt/_t|0)<<5)+(ce+1)+this.points.length;for(const br of Di){const wi=br*_t;if(Ke[wi+2]<=ce)continue;Ke[wi+2]=ce;const Ir=Ke[wi+R];Qi+=Ke[wi]*Ir,hr+=Ke[wi+1]*Ir,Ke[wi+4]=Xt,Me&&(Ui||(Ui=this._map(Ke,xt,!0),Ki=this.clusterProps.length,this.clusterProps.push(Ui)),Me(Ui,this._map(Ke,wi)))}Ke[xt+4]=Xt,st.push(Qi/ei,hr/ei,1/0,Xt,-1,ei),Me&&st.push(Ki)}else{for(let Ui=0;Ui<_t;Ui++)st.push(Ke[xt+Ui]);if(ei>1)for(const Ui of Di){const Qi=Ui*_t;if(!(Ke[Qi+2]<=ce)){Ke[Qi+2]=ce;for(let hr=0;hr<_t;hr++)st.push(Ke[Qi+hr])}}}}return st}_getOriginId(Ie){return Ie-this.points.length>>5}_getOriginZoom(Ie){return(Ie-this.points.length)%32}_map(Ie,ce,ye){if(Ie[ce+R]>1){const Ge=this.clusterProps[Ie[ce+W]];return ye?Object.assign({},Ge):Ge}const xe=this.points[Ie[ce+k]].properties,Me=this.options.map(xe);return ye&&Me===xe?Object.assign({},Me):Me}}function le(it,Ie,ce){return{type:"Feature",id:it[Ie+k],properties:fe(it,Ie,ce),geometry:{type:"Point",coordinates:[(ye=it[Ie],360*(ye-.5)),Ve(it[Ie+1])]}};var ye}function fe(it,Ie,ce){const ye=it[Ie+R],xe=ye>=1e4?`${Math.round(ye/1e3)}k`:ye>=1e3?Math.round(ye/100)/10+"k":ye,Me=it[Ie+W],Ge=Me===-1?{}:Object.assign({},ce[Me]);return Object.assign(Ge,{cluster:!0,cluster_id:it[Ie+k],point_count:ye,point_count_abbreviated:xe})}function be(it){return it/360+.5}function Te(it){const Ie=Math.sin(it*Math.PI/180),ce=.5-.25*Math.log((1+Ie)/(1-Ie))/Math.PI;return ce<0?0:ce>1?1:ce}function Ve(it){const Ie=(180-360*it)*Math.PI/180;return 360*Math.atan(Math.exp(Ie))/Math.PI-90}function Ue(it,Ie,ce,ye){for(var xe,Me=ye,Ge=ce-Ie>>1,Le=ce-Ie,Ke=it[Ie],st=it[Ie+1],_t=it[ce],xt=it[ce+1],kt=Ie+3;kt<ce;kt+=3){var ai=me(it[kt],it[kt+1],Ke,st,_t,xt);if(ai>Me)xe=kt,Me=ai;else if(ai===Me){var Di=Math.abs(kt-Ge);Di<Le&&(xe=kt,Le=Di)}}Me>ye&&(xe-Ie>3&&Ue(it,Ie,xe,ye),it[xe+2]=Me,ce-xe>3&&Ue(it,xe,ce,ye))}function me(it,Ie,ce,ye,xe,Me){var Ge=xe-ce,Le=Me-ye;if(Ge!==0||Le!==0){var Ke=((it-ce)*Ge+(Ie-ye)*Le)/(Ge*Ge+Le*Le);Ke>1?(ce=xe,ye=Me):Ke>0&&(ce+=Ge*Ke,ye+=Le*Ke)}return(Ge=it-ce)*Ge+(Le=Ie-ye)*Le}function ke(it,Ie,ce,ye){var xe={id:it===void 0?null:it,type:Ie,geometry:ce,tags:ye,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Me){var Ge=Me.geometry,Le=Me.type;if(Le==="Point"||Le==="MultiPoint"||Le==="LineString")qe(Me,Ge);else if(Le==="Polygon"||Le==="MultiLineString")for(var Ke=0;Ke<Ge.length;Ke++)qe(Me,Ge[Ke]);else if(Le==="MultiPolygon")for(Ke=0;Ke<Ge.length;Ke++)for(var st=0;st<Ge[Ke].length;st++)qe(Me,Ge[Ke][st])}(xe),xe}function qe(it,Ie){for(var ce=0;ce<Ie.length;ce+=3)it.minX=Math.min(it.minX,Ie[ce]),it.minY=Math.min(it.minY,Ie[ce+1]),it.maxX=Math.max(it.maxX,Ie[ce]),it.maxY=Math.max(it.maxY,Ie[ce+1])}function lt(it,Ie,ce,ye){if(Ie.geometry){var xe=Ie.geometry.coordinates,Me=Ie.geometry.type,Ge=Math.pow(ce.tolerance/((1<<ce.maxZoom)*ce.extent),2),Le=[],Ke=Ie.id;if(ce.promoteId?Ke=Ie.properties[ce.promoteId]:ce.generateId&&(Ke=ye||0),Me==="Point")pt(xe,Le);else if(Me==="MultiPoint")for(var st=0;st<xe.length;st++)pt(xe[st],Le);else if(Me==="LineString")Ft(xe,Le,Ge,!1);else if(Me==="MultiLineString"){if(ce.lineMetrics){for(st=0;st<xe.length;st++)Ft(xe[st],Le=[],Ge,!1),it.push(ke(Ke,"LineString",Le,Ie.properties));return}zt(xe,Le,Ge,!1)}else if(Me==="Polygon")zt(xe,Le,Ge,!0);else{if(Me!=="MultiPolygon"){if(Me==="GeometryCollection"){for(st=0;st<Ie.geometry.geometries.length;st++)lt(it,{id:Ke,geometry:Ie.geometry.geometries[st],properties:Ie.properties},ce,ye);return}throw new Error("Input data is not a valid GeoJSON object.")}for(st=0;st<xe.length;st++){var _t=[];zt(xe[st],_t,Ge,!0),Le.push(_t)}}it.push(ke(Ke,Me,Le,Ie.properties))}}function pt(it,Ie){Ie.push(Nt(it[0])),Ie.push(Mt(it[1])),Ie.push(0)}function Ft(it,Ie,ce,ye){for(var xe,Me,Ge=0,Le=0;Le<it.length;Le++){var Ke=Nt(it[Le][0]),st=Mt(it[Le][1]);Ie.push(Ke),Ie.push(st),Ie.push(0),Le>0&&(Ge+=ye?(xe*st-Ke*Me)/2:Math.sqrt(Math.pow(Ke-xe,2)+Math.pow(st-Me,2))),xe=Ke,Me=st}var _t=Ie.length-3;Ie[2]=1,Ue(Ie,0,_t,ce),Ie[_t+2]=1,Ie.size=Math.abs(Ge),Ie.start=0,Ie.end=Ie.size}function zt(it,Ie,ce,ye){for(var xe=0;xe<it.length;xe++){var Me=[];Ft(it[xe],Me,ce,ye),Ie.push(Me)}}function Nt(it){return it/360+.5}function Mt(it){var Ie=Math.sin(it*Math.PI/180),ce=.5-.25*Math.log((1+Ie)/(1-Ie))/Math.PI;return ce<0?0:ce>1?1:ce}function $t(it,Ie,ce,ye,xe,Me,Ge,Le){if(ye/=Ie,Me>=(ce/=Ie)&&Ge<ye)return it;if(Ge<ce||Me>=ye)return null;for(var Ke=[],st=0;st<it.length;st++){var _t=it[st],xt=_t.geometry,kt=_t.type,ai=xe===0?_t.minX:_t.minY,Di=xe===0?_t.maxX:_t.maxY;if(ai>=ce&&Di<ye)Ke.push(_t);else if(!(Di<ce||ai>=ye)){var ni=[];if(kt==="Point"||kt==="MultiPoint")ri(xt,ni,ce,ye,xe);else if(kt==="LineString")ci(xt,ni,ce,ye,xe,!1,Le.lineMetrics);else if(kt==="MultiLineString")di(xt,ni,ce,ye,xe,!1);else if(kt==="Polygon")di(xt,ni,ce,ye,xe,!0);else if(kt==="MultiPolygon")for(var ei=0;ei<xt.length;ei++){var Ui=[];di(xt[ei],Ui,ce,ye,xe,!0),Ui.length&&ni.push(Ui)}if(ni.length){if(Le.lineMetrics&&kt==="LineString"){for(ei=0;ei<ni.length;ei++)Ke.push(ke(_t.id,kt,ni[ei],_t.tags));continue}kt!=="LineString"&&kt!=="MultiLineString"||(ni.length===1?(kt="LineString",ni=ni[0]):kt="MultiLineString"),kt!=="Point"&&kt!=="MultiPoint"||(kt=ni.length===3?"Point":"MultiPoint"),Ke.push(ke(_t.id,kt,ni,_t.tags))}}}return Ke.length?Ke:null}function ri(it,Ie,ce,ye,xe){for(var Me=0;Me<it.length;Me+=3){var Ge=it[Me+xe];Ge>=ce&&Ge<=ye&&(Ie.push(it[Me]),Ie.push(it[Me+1]),Ie.push(it[Me+2]))}}function ci(it,Ie,ce,ye,xe,Me,Ge){for(var Le,Ke,st=wt(it),_t=xe===0?Hi:Vi,xt=it.start,kt=0;kt<it.length-3;kt+=3){var ai=it[kt],Di=it[kt+1],ni=it[kt+2],ei=it[kt+3],Ui=it[kt+4],Qi=xe===0?ai:Di,hr=xe===0?ei:Ui,Ki=!1;Ge&&(Le=Math.sqrt(Math.pow(ai-ei,2)+Math.pow(Di-Ui,2))),Qi<ce?hr>ce&&(Ke=_t(st,ai,Di,ei,Ui,ce),Ge&&(st.start=xt+Le*Ke)):Qi>ye?hr<ye&&(Ke=_t(st,ai,Di,ei,Ui,ye),Ge&&(st.start=xt+Le*Ke)):ii(st,ai,Di,ni),hr<ce&&Qi>=ce&&(Ke=_t(st,ai,Di,ei,Ui,ce),Ki=!0),hr>ye&&Qi<=ye&&(Ke=_t(st,ai,Di,ei,Ui,ye),Ki=!0),!Me&&Ki&&(Ge&&(st.end=xt+Le*Ke),Ie.push(st),st=wt(it)),Ge&&(xt+=Le)}var Xt=it.length-3;ai=it[Xt],Di=it[Xt+1],ni=it[Xt+2],(Qi=xe===0?ai:Di)>=ce&&Qi<=ye&&ii(st,ai,Di,ni),Xt=st.length-3,Me&&Xt>=3&&(st[Xt]!==st[0]||st[Xt+1]!==st[1])&&ii(st,st[0],st[1],st[2]),st.length&&Ie.push(st)}function wt(it){var Ie=[];return Ie.size=it.size,Ie.start=it.start,Ie.end=it.end,Ie}function di(it,Ie,ce,ye,xe,Me){for(var Ge=0;Ge<it.length;Ge++)ci(it[Ge],Ie,ce,ye,xe,Me,!1)}function ii(it,Ie,ce,ye){it.push(Ie),it.push(ce),it.push(ye)}function Hi(it,Ie,ce,ye,xe,Me){var Ge=(Me-Ie)/(ye-Ie);return it.push(Me),it.push(ce+(xe-ce)*Ge),it.push(1),Ge}function Vi(it,Ie,ce,ye,xe,Me){var Ge=(Me-ce)/(xe-ce);return it.push(Ie+(ye-Ie)*Ge),it.push(Me),it.push(1),Ge}function Ot(it,Ie){for(var ce=[],ye=0;ye<it.length;ye++){var xe,Me=it[ye],Ge=Me.type;if(Ge==="Point"||Ge==="MultiPoint"||Ge==="LineString")xe=_i(Me.geometry,Ie);else if(Ge==="MultiLineString"||Ge==="Polygon"){xe=[];for(var Le=0;Le<Me.geometry.length;Le++)xe.push(_i(Me.geometry[Le],Ie))}else if(Ge==="MultiPolygon")for(xe=[],Le=0;Le<Me.geometry.length;Le++){for(var Ke=[],st=0;st<Me.geometry[Le].length;st++)Ke.push(_i(Me.geometry[Le][st],Ie));xe.push(Ke)}ce.push(ke(Me.id,Ge,xe,Me.tags))}return ce}function _i(it,Ie){var ce=[];ce.size=it.size,it.start!==void 0&&(ce.start=it.start,ce.end=it.end);for(var ye=0;ye<it.length;ye+=3)ce.push(it[ye]+Ie,it[ye+1],it[ye+2]);return ce}function Ti(it,Ie){if(it.transformed)return it;var ce,ye,xe,Me=1<<it.z,Ge=it.x,Le=it.y;for(ce=0;ce<it.features.length;ce++){var Ke=it.features[ce],st=Ke.geometry,_t=Ke.type;if(Ke.geometry=[],_t===1)for(ye=0;ye<st.length;ye+=2)Ke.geometry.push(Wi(st[ye],st[ye+1],Ie,Me,Ge,Le));else for(ye=0;ye<st.length;ye++){var xt=[];for(xe=0;xe<st[ye].length;xe+=2)xt.push(Wi(st[ye][xe],st[ye][xe+1],Ie,Me,Ge,Le));Ke.geometry.push(xt)}}return it.transformed=!0,it}function Wi(it,Ie,ce,ye,xe,Me){return[Math.round(ce*(it*ye-xe)),Math.round(ce*(Ie*ye-Me))]}function Zt(it,Ie,ce,ye,xe){for(var Me=Ie===xe.maxZoom?0:xe.tolerance/((1<<Ie)*xe.extent),Ge={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ce,y:ye,z:Ie,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Le=0;Le<it.length;Le++){Ge.numFeatures++,mi(Ge,it[Le],Me,xe);var Ke=it[Le].minX,st=it[Le].minY,_t=it[Le].maxX,xt=it[Le].maxY;Ke<Ge.minX&&(Ge.minX=Ke),st<Ge.minY&&(Ge.minY=st),_t>Ge.maxX&&(Ge.maxX=_t),xt>Ge.maxY&&(Ge.maxY=xt)}return Ge}function mi(it,Ie,ce,ye){var xe=Ie.geometry,Me=Ie.type,Ge=[];if(Me==="Point"||Me==="MultiPoint")for(var Le=0;Le<xe.length;Le+=3)Ge.push(xe[Le]),Ge.push(xe[Le+1]),it.numPoints++,it.numSimplified++;else if(Me==="LineString")bi(Ge,xe,it,ce,!1,!1);else if(Me==="MultiLineString"||Me==="Polygon")for(Le=0;Le<xe.length;Le++)bi(Ge,xe[Le],it,ce,Me==="Polygon",Le===0);else if(Me==="MultiPolygon")for(var Ke=0;Ke<xe.length;Ke++){var st=xe[Ke];for(Le=0;Le<st.length;Le++)bi(Ge,st[Le],it,ce,!0,Le===0)}if(Ge.length){var _t=Ie.tags||null;if(Me==="LineString"&&ye.lineMetrics){for(var xt in _t={},Ie.tags)_t[xt]=Ie.tags[xt];_t.mapbox_clip_start=xe.start/xe.size,_t.mapbox_clip_end=xe.end/xe.size}var kt={geometry:Ge,type:Me==="Polygon"||Me==="MultiPolygon"?3:Me==="LineString"||Me==="MultiLineString"?2:1,tags:_t};Ie.id!==null&&(kt.id=Ie.id),it.features.push(kt)}}function bi(it,Ie,ce,ye,xe,Me){var Ge=ye*ye;if(ye>0&&Ie.size<(xe?Ge:ye))ce.numPoints+=Ie.length/3;else{for(var Le=[],Ke=0;Ke<Ie.length;Ke+=3)(ye===0||Ie[Ke+2]>Ge)&&(ce.numSimplified++,Le.push(Ie[Ke]),Le.push(Ie[Ke+1])),ce.numPoints++;xe&&function(st,_t){for(var xt=0,kt=0,ai=st.length,Di=ai-2;kt<ai;Di=kt,kt+=2)xt+=(st[kt]-st[Di])*(st[kt+1]+st[Di+1]);if(xt>0===_t)for(kt=0,ai=st.length;kt<ai/2;kt+=2){var ni=st[kt],ei=st[kt+1];st[kt]=st[ai-2-kt],st[kt+1]=st[ai-1-kt],st[ai-2-kt]=ni,st[ai-1-kt]=ei}}(Le,Me),it.push(Le)}}function $i(it,Ie){var ce=(Ie=this.options=function(xe,Me){for(var Ge in Me)xe[Ge]=Me[Ge];return xe}(Object.create(this.options),Ie)).debug;if(ce&&console.time("preprocess data"),Ie.maxZoom<0||Ie.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ie.promoteId&&Ie.generateId)throw new Error("promoteId and generateId cannot be used together.");var ye=function(xe,Me){var Ge=[];if(xe.type==="FeatureCollection")for(var Le=0;Le<xe.features.length;Le++)lt(Ge,xe.features[Le],Me,Le);else lt(Ge,xe.type==="Feature"?xe:{geometry:xe},Me);return Ge}(it,Ie);this.tiles={},this.tileCoords=[],ce&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ie.indexMaxZoom,Ie.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ye=function(xe,Me){var Ge=Me.buffer/Me.extent,Le=xe,Ke=$t(xe,1,-1-Ge,Ge,0,-1,2,Me),st=$t(xe,1,1-Ge,2+Ge,0,-1,2,Me);return(Ke||st)&&(Le=$t(xe,1,-Ge,1+Ge,0,-1,2,Me)||[],Ke&&(Le=Ot(Ke,1).concat(Le)),st&&(Le=Le.concat(Ot(st,-1)))),Le}(ye,Ie),ye.length&&this.splitTile(ye,0,0,0),ce&&(ye.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function tr(it,Ie,ce){return 32*((1<<it)*ce+Ie)+it}function Ar(it,Ie){return Ie?it.properties[Ie]:it.id}function Tr(it,Ie){if(it==null)return!0;if(it.type==="Feature")return Ar(it,Ie)!=null;if(it.type==="FeatureCollection"){const ce=new Set;for(const ye of it.features){const xe=Ar(ye,Ie);if(xe==null||ce.has(xe))return!1;ce.add(xe)}return!0}return!1}function ji(it,Ie){const ce=new Map;if(it!=null)if(it.type==="Feature")ce.set(Ar(it,Ie),it);else for(const ye of it.features)ce.set(Ar(ye,Ie),ye);return ce}function Ii(it,Ie){const ce=it.tileID.canonical;if(!this._geoJSONIndex)return Ie(null,null);const ye=this._geoJSONIndex.getTile(ce.z,ce.x,ce.y);if(!ye)return Ie(null,null);const xe=new class{constructor(Ge){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=D.EXTENT,this.length=Ge.length,this._features=Ge}feature(Ge){return new class{constructor(Le){this._feature=Le,this.extent=D.EXTENT,this.type=Le.type,this.properties=Le.tags,"id"in Le&&!isNaN(Le.id)&&(this.id=parseInt(Le.id,10))}loadGeometry(){if(this._feature.type===1){const Le=[];for(const Ke of this._feature.geometry)Le.push([new D.Point(Ke[0],Ke[1])]);return Le}{const Le=[];for(const Ke of this._feature.geometry){const st=[];for(const _t of Ke)st.push(new D.Point(_t[0],_t[1]));Le.push(st)}return Le}}toGeoJSON(Le,Ke,st){return ut.call(this,Le,Ke,st)}}(this._features[Ge])}}(ye.features);let Me=vi(xe);Me.byteOffset===0&&Me.byteLength===Me.buffer.byteLength||(Me=new Uint8Array(Me)),Ie(null,{vectorTile:xe,rawData:Me.buffer})}$i.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},$i.prototype.splitTile=function(it,Ie,ce,ye,xe,Me,Ge){for(var Le=[it,Ie,ce,ye],Ke=this.options,st=Ke.debug;Le.length;){ye=Le.pop(),ce=Le.pop(),Ie=Le.pop(),it=Le.pop();var _t=1<<Ie,xt=tr(Ie,ce,ye),kt=this.tiles[xt];if(!kt&&(st>1&&console.time("creation"),kt=this.tiles[xt]=Zt(it,Ie,ce,ye,Ke),this.tileCoords.push({z:Ie,x:ce,y:ye}),st)){st>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ie,ce,ye,kt.numFeatures,kt.numPoints,kt.numSimplified),console.timeEnd("creation"));var ai="z"+Ie;this.stats[ai]=(this.stats[ai]||0)+1,this.total++}if(kt.source=it,xe){if(Ie===Ke.maxZoom||Ie===xe)continue;var Di=1<<xe-Ie;if(ce!==Math.floor(Me/Di)||ye!==Math.floor(Ge/Di))continue}else if(Ie===Ke.indexMaxZoom||kt.numPoints<=Ke.indexMaxPoints)continue;if(kt.source=null,it.length!==0){st>1&&console.time("clipping");var ni,ei,Ui,Qi,hr,Ki,Xt=.5*Ke.buffer/Ke.extent,br=.5-Xt,wi=.5+Xt,Ir=1+Xt;ni=ei=Ui=Qi=null,hr=$t(it,_t,ce-Xt,ce+wi,0,kt.minX,kt.maxX,Ke),Ki=$t(it,_t,ce+br,ce+Ir,0,kt.minX,kt.maxX,Ke),it=null,hr&&(ni=$t(hr,_t,ye-Xt,ye+wi,1,kt.minY,kt.maxY,Ke),ei=$t(hr,_t,ye+br,ye+Ir,1,kt.minY,kt.maxY,Ke),hr=null),Ki&&(Ui=$t(Ki,_t,ye-Xt,ye+wi,1,kt.minY,kt.maxY,Ke),Qi=$t(Ki,_t,ye+br,ye+Ir,1,kt.minY,kt.maxY,Ke),Ki=null),st>1&&console.timeEnd("clipping"),Le.push(ni||[],Ie+1,2*ce,2*ye),Le.push(ei||[],Ie+1,2*ce,2*ye+1),Le.push(Ui||[],Ie+1,2*ce+1,2*ye),Le.push(Qi||[],Ie+1,2*ce+1,2*ye+1)}}},$i.prototype.getTile=function(it,Ie,ce){var ye=this.options,xe=ye.extent,Me=ye.debug;if(it<0||it>24)return null;var Ge=1<<it,Le=tr(it,Ie=(Ie%Ge+Ge)%Ge,ce);if(this.tiles[Le])return Ti(this.tiles[Le],xe);Me>1&&console.log("drilling down to z%d-%d-%d",it,Ie,ce);for(var Ke,st=it,_t=Ie,xt=ce;!Ke&&st>0;)st--,_t=Math.floor(_t/2),xt=Math.floor(xt/2),Ke=this.tiles[tr(st,_t,xt)];return Ke&&Ke.source?(Me>1&&console.log("found parent tile z%d-%d-%d",st,_t,xt),Me>1&&console.time("drilling down"),this.splitTile(Ke.source,st,_t,xt,it,Ie,ce),Me>1&&console.timeEnd("drilling down"),this.tiles[Le]?Ti(this.tiles[Le],xe):null):null};class Qs extends De{constructor(Ie,ce,ye,xe){super(Ie,ce,ye,Ii),this._dataUpdateable=new Map,this.loadGeoJSON=(Me,Ge)=>{const{promoteId:Le}=Me;if(Me.request)return D.getJSON(Me.request,(Ke,st,_t,xt)=>{this._dataUpdateable=Tr(st,Le)?ji(st,Le):void 0,Ge(Ke,st,_t,xt)});if(typeof Me.data=="string")try{const Ke=JSON.parse(Me.data);this._dataUpdateable=Tr(Ke,Le)?ji(Ke,Le):void 0,Ge(null,Ke)}catch{Ge(new Error(`Input data given to '${Me.source}' is not a valid GeoJSON object.`))}else Me.dataDiff?this._dataUpdateable?(function(Ke,st,_t){var xt,kt,ai,Di;if(st.removeAll&&Ke.clear(),st.remove)for(const ni of st.remove)Ke.delete(ni);if(st.add)for(const ni of st.add){const ei=Ar(ni,_t);ei!=null&&Ke.set(ei,ni)}if(st.update)for(const ni of st.update){let ei=Ke.get(ni.id);if(ei==null)continue;const Ui=!ni.removeAllProperties&&(((xt=ni.removeProperties)===null||xt===void 0?void 0:xt.length)>0||((kt=ni.addOrUpdateProperties)===null||kt===void 0?void 0:kt.length)>0);if((ni.newGeometry||ni.removeAllProperties||Ui)&&(ei={...ei},Ke.set(ni.id,ei),Ui&&(ei.properties={...ei.properties})),ni.newGeometry&&(ei.geometry=ni.newGeometry),ni.removeAllProperties)ei.properties={};else if(((ai=ni.removeProperties)===null||ai===void 0?void 0:ai.length)>0)for(const Qi of ni.removeProperties)Object.prototype.hasOwnProperty.call(ei.properties,Qi)&&delete ei.properties[Qi];if(((Di=ni.addOrUpdateProperties)===null||Di===void 0?void 0:Di.length)>0)for(const{key:Qi,value:hr}of ni.addOrUpdateProperties)ei.properties[Qi]=hr}}(this._dataUpdateable,Me.dataDiff,Le),Ge(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):Ge(new Error(`Cannot update existing geojson data in ${Me.source}`)):Ge(new Error(`Input data given to '${Me.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},xe&&(this.loadGeoJSON=xe)}loadData(Ie,ce){var ye;(ye=this._pendingRequest)===null||ye===void 0||ye.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const xe=!!(Ie&&Ie.request&&Ie.request.collectResourceTiming)&&new D.RequestPerformance(Ie.request);this._pendingCallback=ce,this._pendingRequest=this.loadGeoJSON(Ie,(Me,Ge)=>{if(delete this._pendingCallback,delete this._pendingRequest,Me||!Ge)return ce(Me);if(typeof Ge!="object")return ce(new Error(`Input data given to '${Ie.source}' is not a valid GeoJSON object.`));{We(Ge,!0);try{if(Ie.filter){const Ke=D.createExpression(Ie.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ke.result==="error")throw new Error(Ke.value.map(_t=>`${_t.key}: ${_t.message}`).join(", "));Ge={type:"FeatureCollection",features:Ge.features.filter(_t=>Ke.value.evaluate({zoom:0},_t))}}this._geoJSONIndex=Ie.cluster?new se(function({superclusterOptions:Ke,clusterProperties:st}){if(!st||!Ke)return Ke;const _t={},xt={},kt={accumulated:null,zoom:0},ai={properties:null},Di=Object.keys(st);for(const ni of Di){const[ei,Ui]=st[ni],Qi=D.createExpression(Ui),hr=D.createExpression(typeof ei=="string"?[ei,["accumulated"],["get",ni]]:ei);_t[ni]=Qi.value,xt[ni]=hr.value}return Ke.map=ni=>{ai.properties=ni;const ei={};for(const Ui of Di)ei[Ui]=_t[Ui].evaluate(kt,ai);return ei},Ke.reduce=(ni,ei)=>{ai.properties=ei;for(const Ui of Di)kt.accumulated=ni[Ui],ni[Ui]=xt[Ui].evaluate(kt,ai)},Ke}(Ie)).load(Ge.features):function(Ke,st){return new $i(Ke,st)}(Ge,Ie.geojsonVtOptions)}catch(Ke){return ce(Ke)}this.loaded={};const Le={};if(xe){const Ke=xe.finish();Ke&&(Le.resourceTiming={},Le.resourceTiming[Ie.source]=JSON.parse(JSON.stringify(Ke)))}ce(null,Le)}})}reloadTile(Ie,ce){const ye=this.loaded;return ye&&ye[Ie.uid]?super.reloadTile(Ie,ce):this.loadTile(Ie,ce)}removeSource(Ie,ce){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ce()}getClusterExpansionZoom(Ie,ce){try{ce(null,this._geoJSONIndex.getClusterExpansionZoom(Ie.clusterId))}catch(ye){ce(ye)}}getClusterChildren(Ie,ce){try{ce(null,this._geoJSONIndex.getChildren(Ie.clusterId))}catch(ye){ce(ye)}}getClusterLeaves(Ie,ce){try{ce(null,this._geoJSONIndex.getLeaves(Ie.clusterId,Ie.limit,Ie.offset))}catch(ye){ce(ye)}}}class $r{constructor(Ie){this.self=Ie,this.actor=new D.Actor(Ie,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:De,geojson:Qs},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ce,ye)=>{if(this.workerSourceTypes[ce])throw new Error(`Worker source with name "${ce}" already registered.`);this.workerSourceTypes[ce]=ye},this.self.registerRTLTextPlugin=ce=>{if(D.plugin.isParsed())throw new Error("RTL text plugin already registered.");D.plugin.applyArabicShaping=ce.applyArabicShaping,D.plugin.processBidirectionalText=ce.processBidirectionalText,D.plugin.processStyledBidirectionalText=ce.processStyledBidirectionalText}}setReferrer(Ie,ce){this.referrer=ce}setImages(Ie,ce,ye){this.availableImages[Ie]=ce;for(const xe in this.workerSources[Ie]){const Me=this.workerSources[Ie][xe];for(const Ge in Me)Me[Ge].availableImages=ce}ye()}setLayers(Ie,ce,ye){this.getLayerIndex(Ie).replace(ce),ye()}updateLayers(Ie,ce,ye){this.getLayerIndex(Ie).update(ce.layers,ce.removedIds),ye()}loadTile(Ie,ce,ye){this.getWorkerSource(Ie,ce.type,ce.source).loadTile(ce,ye)}loadDEMTile(Ie,ce,ye){this.getDEMWorkerSource(Ie,ce.source).loadTile(ce,ye)}reloadTile(Ie,ce,ye){this.getWorkerSource(Ie,ce.type,ce.source).reloadTile(ce,ye)}abortTile(Ie,ce,ye){this.getWorkerSource(Ie,ce.type,ce.source).abortTile(ce,ye)}removeTile(Ie,ce,ye){this.getWorkerSource(Ie,ce.type,ce.source).removeTile(ce,ye)}removeDEMTile(Ie,ce){this.getDEMWorkerSource(Ie,ce.source).removeTile(ce)}removeSource(Ie,ce,ye){if(!this.workerSources[Ie]||!this.workerSources[Ie][ce.type]||!this.workerSources[Ie][ce.type][ce.source])return;const xe=this.workerSources[Ie][ce.type][ce.source];delete this.workerSources[Ie][ce.type][ce.source],xe.removeSource!==void 0?xe.removeSource(ce,ye):ye()}loadWorkerSource(Ie,ce,ye){try{this.self.importScripts(ce.url),ye()}catch(xe){ye(xe.toString())}}syncRTLPluginState(Ie,ce,ye){try{D.plugin.setState(ce);const xe=D.plugin.getPluginURL();if(D.plugin.isLoaded()&&!D.plugin.isParsed()&&xe!=null){this.self.importScripts(xe);const Me=D.plugin.isParsed();ye(Me?void 0:new Error(`RTL Text Plugin failed to import scripts from ${xe}`),Me)}}catch(xe){ye(xe.toString())}}getAvailableImages(Ie){let ce=this.availableImages[Ie];return ce||(ce=[]),ce}getLayerIndex(Ie){let ce=this.layerIndexes[Ie];return ce||(ce=this.layerIndexes[Ie]=new ne),ce}getWorkerSource(Ie,ce,ye){if(this.workerSources[Ie]||(this.workerSources[Ie]={}),this.workerSources[Ie][ce]||(this.workerSources[Ie][ce]={}),!this.workerSources[Ie][ce][ye]){const xe={send:(Me,Ge,Le)=>{this.actor.send(Me,Ge,Le,Ie)}};this.workerSources[Ie][ce][ye]=new this.workerSourceTypes[ce](xe,this.getLayerIndex(Ie),this.getAvailableImages(Ie))}return this.workerSources[Ie][ce][ye]}getDEMWorkerSource(Ie,ce){return this.demWorkerSources[Ie]||(this.demWorkerSources[Ie]={}),this.demWorkerSources[Ie][ce]||(this.demWorkerSources[Ie][ce]=new ze),this.demWorkerSources[Ie][ce]}}return D.isWorker()&&(self.worker=new $r(self)),$r}),Y(["./shared"],function(D){var ne="3.3.1";class ae{static testProp(x){if(!ae.docStyle)return x[0];for(let Q=0;Q<x.length;Q++)if(x[Q]in ae.docStyle)return x[Q];return x[0]}static create(x,Q,G){const X=window.document.createElement(x);return Q!==void 0&&(X.className=Q),G&&G.appendChild(X),X}static createNS(x,Q){return window.document.createElementNS(x,Q)}static disableDrag(){ae.docStyle&&ae.selectProp&&(ae.userSelect=ae.docStyle[ae.selectProp],ae.docStyle[ae.selectProp]="none")}static enableDrag(){ae.docStyle&&ae.selectProp&&(ae.docStyle[ae.selectProp]=ae.userSelect)}static setTransform(x,Q){x.style[ae.transformProp]=Q}static addEventListener(x,Q,G,X={}){x.addEventListener(Q,G,"passive"in X?X:X.capture)}static removeEventListener(x,Q,G,X={}){x.removeEventListener(Q,G,"passive"in X?X:X.capture)}static suppressClickInternal(x){x.preventDefault(),x.stopPropagation(),window.removeEventListener("click",ae.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",ae.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",ae.suppressClickInternal,!0)},0)}static mousePos(x,Q){const G=x.getBoundingClientRect();return new D.Point(Q.clientX-G.left-x.clientLeft,Q.clientY-G.top-x.clientTop)}static touchPos(x,Q){const G=x.getBoundingClientRect(),X=[];for(let te=0;te<Q.length;te++)X.push(new D.Point(Q[te].clientX-G.left-x.clientLeft,Q[te].clientY-G.top-x.clientTop));return X}static mouseButton(x){return x.button}static remove(x){x.parentNode&&x.parentNode.removeChild(x)}}ae.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,ae.selectProp=ae.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),ae.transformProp=ae.testProp(["transform","WebkitTransform"]);const ue={supported:!1,testSupport:function(J){!De&&Be&&(ze?Oe(J):ge=J)}};let ge,Be,De=!1,ze=!1;function Oe(J){const x=J.createTexture();J.bindTexture(J.TEXTURE_2D,x);try{if(J.texImage2D(J.TEXTURE_2D,0,J.RGBA,J.RGBA,J.UNSIGNED_BYTE,Be),J.isContextLost())return;ue.supported=!0}catch{}J.deleteTexture(x),De=!0}var Je,We;typeof document<"u"&&(Be=document.createElement("img"),Be.onload=function(){ge&&Oe(ge),ge=null,ze=!0},Be.onerror=function(){De=!0,ge=null},Be.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(J){let x,Q,G,X;J.resetRequestQueue=()=>{x=[],Q=0,G=0,X={}},J.addThrottleControl=ve=>{const Ce=G++;return X[Ce]=ve,Ce},J.removeThrottleControl=ve=>{delete X[ve],he()},J.getImage=(ve,Ce,Se=!0)=>{ue.supported&&(ve.headers||(ve.headers={}),ve.headers.accept="image/webp,*/*");const Qe={requestParameters:ve,supportImageRefresh:Se,callback:Ce,cancelled:!1,completed:!1,cancel:()=>{Qe.completed||Qe.cancelled||(Qe.cancelled=!0,Qe.innerRequest&&(Qe.innerRequest.cancel(),Q--),he())}};return x.push(Qe),he(),Qe};const te=ve=>{const{requestParameters:Ce,supportImageRefresh:Se,callback:Qe}=ve;return D.extend(Ce,{type:"image"}),(Se!==!1||D.isWorker()||D.getProtocolAction(Ce.url)||Ce.headers&&!Object.keys(Ce.headers).reduce(($e,Ze)=>$e&&Ze==="accept",!0)?D.makeRequest:pe)(Ce,($e,Ze,rt,Ye)=>{Ae(ve,Qe,$e,Ze,rt,Ye)})},Ae=(ve,Ce,Se,Qe,$e,Ze)=>{Se?Ce(Se):Qe instanceof HTMLImageElement||D.isImageBitmap(Qe)?Ce(null,Qe):Qe&&((rt,Ye)=>{typeof createImageBitmap=="function"?D.arrayBufferToImageBitmap(rt,Ye):D.arrayBufferToImage(rt,Ye)})(Qe,(rt,Ye)=>{rt!=null?Ce(rt):Ye!=null&&Ce(null,Ye,{cacheControl:$e,expires:Ze})}),ve.cancelled||(ve.completed=!0,Q--,he())},he=()=>{const ve=(()=>{const Ce=Object.keys(X);let Se=!1;if(Ce.length>0){for(const Qe of Ce)if(Se=X[Qe](),Se)break}return Se})()?D.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:D.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let Ce=Q;Ce<ve&&x.length>0;Ce++){const Se=x.shift();if(Se.cancelled){Ce--;continue}const Qe=te(Se);Q++,Se.innerRequest=Qe}},pe=(ve,Ce)=>{const Se=new Image,Qe=ve.url;let $e=!1;const Ze=ve.credentials;return Ze&&Ze==="include"?Se.crossOrigin="use-credentials":(Ze&&Ze==="same-origin"||!D.sameOrigin(Qe))&&(Se.crossOrigin="anonymous"),Se.fetchPriority="high",Se.onload=()=>{Ce(null,Se),Se.onerror=Se.onload=null},Se.onerror=()=>{$e||Ce(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),Se.onerror=Se.onload=null},Se.src=Qe,{cancel:()=>{$e=!0,Se.src=""}}}}(Je||(Je={})),Je.resetRequestQueue(),function(J){J.Glyphs="Glyphs",J.Image="Image",J.Source="Source",J.SpriteImage="SpriteImage",J.SpriteJSON="SpriteJSON",J.Style="Style",J.Tile="Tile",J.Unknown="Unknown"}(We||(We={}));class ut{constructor(x){this._transformRequestFn=x}transformRequest(x,Q){return this._transformRequestFn&&this._transformRequestFn(x,Q)||{url:x}}normalizeSpriteURL(x,Q,G){const X=function(te){const Ae=te.match(et);if(!Ae)throw new Error(`Unable to parse URL "${te}"`);return{protocol:Ae[1],authority:Ae[2],path:Ae[3]||"/",params:Ae[4]?Ae[4].split("&"):[]}}(x);return X.path+=`${Q}${G}`,function(te){const Ae=te.params.length?`?${te.params.join("&")}`:"";return`${te.protocol}://${te.authority}${te.path}${Ae}`}(X)}setTransformRequest(x){this._transformRequestFn=x}}const et=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function At(J){var x=new D.ARRAY_TYPE(3);return x[0]=J[0],x[1]=J[1],x[2]=J[2],x}var nt,ft=function(J,x,Q){return J[0]=x[0]-Q[0],J[1]=x[1]-Q[1],J[2]=x[2]-Q[2],J};nt=new D.ARRAY_TYPE(3),D.ARRAY_TYPE!=Float32Array&&(nt[0]=0,nt[1]=0,nt[2]=0);var Tt=function(J){var x=J[0],Q=J[1];return x*x+Q*Q};function qt(J){const x=[];if(typeof J=="string")x.push({id:"default",url:J});else if(J&&J.length>0){const Q=[];for(const{id:G,url:X}of J){const te=`${G}${X}`;Q.indexOf(te)===-1&&(Q.push(te),x.push({id:G,url:X}))}}return x}function Vt(J,x,Q,G,X){if(G)return void J(G);if(X!==Object.values(x).length||X!==Object.values(Q).length)return;const te={};for(const Ae in x){te[Ae]={};const he=D.browser.getImageCanvasContext(Q[Ae]),pe=x[Ae];for(const ve in pe){const{width:Ce,height:Se,x:Qe,y:$e,sdf:Ze,pixelRatio:rt,stretchX:Ye,stretchY:dt,content:Bt}=pe[ve];te[Ae][ve]={data:null,pixelRatio:rt,sdf:Ze,stretchX:Ye,stretchY:dt,content:Bt,spriteData:{width:Ce,height:Se,x:Qe,y:$e,context:he}}}}J(null,te)}(function(){var J=new D.ARRAY_TYPE(2);D.ARRAY_TYPE!=Float32Array&&(J[0]=0,J[1]=0)})();class vt{constructor(x,Q,G,X){this.context=x,this.format=G,this.texture=x.gl.createTexture(),this.update(Q,X)}update(x,Q,G){const{width:X,height:te}=x,Ae=!(this.size&&this.size[0]===X&&this.size[1]===te||G),{context:he}=this,{gl:pe}=he;if(this.useMipmap=!!(Q&&Q.useMipmap),pe.bindTexture(pe.TEXTURE_2D,this.texture),he.pixelStoreUnpackFlipY.set(!1),he.pixelStoreUnpack.set(1),he.pixelStoreUnpackPremultiplyAlpha.set(this.format===pe.RGBA&&(!Q||Q.premultiply!==!1)),Ae)this.size=[X,te],x instanceof HTMLImageElement||x instanceof HTMLCanvasElement||x instanceof HTMLVideoElement||x instanceof ImageData||D.isImageBitmap(x)?pe.texImage2D(pe.TEXTURE_2D,0,this.format,this.format,pe.UNSIGNED_BYTE,x):pe.texImage2D(pe.TEXTURE_2D,0,this.format,X,te,0,this.format,pe.UNSIGNED_BYTE,x.data);else{const{x:ve,y:Ce}=G||{x:0,y:0};x instanceof HTMLImageElement||x instanceof HTMLCanvasElement||x instanceof HTMLVideoElement||x instanceof ImageData||D.isImageBitmap(x)?pe.texSubImage2D(pe.TEXTURE_2D,0,ve,Ce,pe.RGBA,pe.UNSIGNED_BYTE,x):pe.texSubImage2D(pe.TEXTURE_2D,0,ve,Ce,X,te,pe.RGBA,pe.UNSIGNED_BYTE,x.data)}this.useMipmap&&this.isSizePowerOfTwo()&&pe.generateMipmap(pe.TEXTURE_2D)}bind(x,Q,G){const{context:X}=this,{gl:te}=X;te.bindTexture(te.TEXTURE_2D,this.texture),G!==te.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(G=te.LINEAR),x!==this.filter&&(te.texParameteri(te.TEXTURE_2D,te.TEXTURE_MAG_FILTER,x),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_MIN_FILTER,G||x),this.filter=x),Q!==this.wrap&&(te.texParameteri(te.TEXTURE_2D,te.TEXTURE_WRAP_S,Q),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_WRAP_T,Q),this.wrap=Q)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:x}=this.context;x.deleteTexture(this.texture),this.texture=null}}function Ut(J){const{userImage:x}=J;return!!(x&&x.render&&x.render())&&(J.data.replace(new Uint8Array(x.data.buffer)),!0)}class Pt extends D.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new D.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(x){if(this.loaded!==x&&(this.loaded=x,x)){for(const{ids:Q,callback:G}of this.requestors)this._notify(Q,G);this.requestors=[]}}getImage(x){const Q=this.images[x];if(Q&&!Q.data&&Q.spriteData){const G=Q.spriteData;Q.data=new D.RGBAImage({width:G.width,height:G.height},G.context.getImageData(G.x,G.y,G.width,G.height).data),Q.spriteData=null}return Q}addImage(x,Q){if(this.images[x])throw new Error(`Image id ${x} already exist, use updateImage instead`);this._validate(x,Q)&&(this.images[x]=Q)}_validate(x,Q){let G=!0;const X=Q.data||Q.spriteData;return this._validateStretch(Q.stretchX,X&&X.width)||(this.fire(new D.ErrorEvent(new Error(`Image "${x}" has invalid "stretchX" value`))),G=!1),this._validateStretch(Q.stretchY,X&&X.height)||(this.fire(new D.ErrorEvent(new Error(`Image "${x}" has invalid "stretchY" value`))),G=!1),this._validateContent(Q.content,Q)||(this.fire(new D.ErrorEvent(new Error(`Image "${x}" has invalid "content" value`))),G=!1),G}_validateStretch(x,Q){if(!x)return!0;let G=0;for(const X of x){if(X[0]<G||X[1]<X[0]||Q<X[1])return!1;G=X[1]}return!0}_validateContent(x,Q){if(!x)return!0;if(x.length!==4)return!1;const G=Q.spriteData,X=G&&G.width||Q.data.width,te=G&&G.height||Q.data.height;return!(x[0]<0||X<x[0]||x[1]<0||te<x[1]||x[2]<0||X<x[2]||x[3]<0||te<x[3]||x[2]<x[0]||x[3]<x[1])}updateImage(x,Q,G=!0){const X=this.getImage(x);if(G&&(X.data.width!==Q.data.width||X.data.height!==Q.data.height))throw new Error(`size mismatch between old image (${X.data.width}x${X.data.height}) and new image (${Q.data.width}x${Q.data.height}).`);Q.version=X.version+1,this.images[x]=Q,this.updatedImages[x]=!0}removeImage(x){const Q=this.images[x];delete this.images[x],delete this.patterns[x],Q.userImage&&Q.userImage.onRemove&&Q.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(x,Q){let G=!0;if(!this.isLoaded())for(const X of x)this.images[X]||(G=!1);this.isLoaded()||G?this._notify(x,Q):this.requestors.push({ids:x,callback:Q})}_notify(x,Q){const G={};for(const X of x){let te=this.getImage(X);te||(this.fire(new D.Event("styleimagemissing",{id:X})),te=this.getImage(X)),te?G[X]={data:te.data.clone(),pixelRatio:te.pixelRatio,sdf:te.sdf,version:te.version,stretchX:te.stretchX,stretchY:te.stretchY,content:te.content,hasRenderCallback:!!(te.userImage&&te.userImage.render)}:D.warnOnce(`Image "${X}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}Q(null,G)}getPixelSize(){const{width:x,height:Q}=this.atlasImage;return{width:x,height:Q}}getPattern(x){const Q=this.patterns[x],G=this.getImage(x);if(!G)return null;if(Q&&Q.position.version===G.version)return Q.position;if(Q)Q.position.version=G.version;else{const X={w:G.data.width+2,h:G.data.height+2,x:0,y:0},te=new D.ImagePosition(X,G);this.patterns[x]={bin:X,position:te}}return this._updatePatternAtlas(),this.patterns[x].position}bind(x){const Q=x.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new vt(x,this.atlasImage,Q.RGBA),this.atlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE)}_updatePatternAtlas(){const x=[];for(const te in this.patterns)x.push(this.patterns[te].bin);const{w:Q,h:G}=D.potpack(x),X=this.atlasImage;X.resize({width:Q||1,height:G||1});for(const te in this.patterns){const{bin:Ae}=this.patterns[te],he=Ae.x+1,pe=Ae.y+1,ve=this.getImage(te).data,Ce=ve.width,Se=ve.height;D.RGBAImage.copy(ve,X,{x:0,y:0},{x:he,y:pe},{width:Ce,height:Se}),D.RGBAImage.copy(ve,X,{x:0,y:Se-1},{x:he,y:pe-1},{width:Ce,height:1}),D.RGBAImage.copy(ve,X,{x:0,y:0},{x:he,y:pe+Se},{width:Ce,height:1}),D.RGBAImage.copy(ve,X,{x:Ce-1,y:0},{x:he-1,y:pe},{width:1,height:Se}),D.RGBAImage.copy(ve,X,{x:0,y:0},{x:he+Ce,y:pe},{width:1,height:Se})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(x){for(const Q of x){if(this.callbackDispatchedThisFrame[Q])continue;this.callbackDispatchedThisFrame[Q]=!0;const G=this.getImage(Q);G||D.warnOnce(`Image with ID: "${Q}" was not found`),Ut(G)&&this.updateImage(Q,G)}}}const Yt=1e20;function Ai(J,x,Q,G,X,te,Ae,he,pe){for(let ve=x;ve<x+G;ve++)Ri(J,Q*te+ve,te,X,Ae,he,pe);for(let ve=Q;ve<Q+X;ve++)Ri(J,ve*te+x,1,G,Ae,he,pe)}function Ri(J,x,Q,G,X,te,Ae){te[0]=0,Ae[0]=-Yt,Ae[1]=Yt,X[0]=J[x];for(let he=1,pe=0,ve=0;he<G;he++){X[he]=J[x+he*Q];const Ce=he*he;do{const Se=te[pe];ve=(X[he]-X[Se]+Ce-Se*Se)/(he-Se)/2}while(ve<=Ae[pe]&&--pe>-1);pe++,te[pe]=he,Ae[pe]=ve,Ae[pe+1]=Yt}for(let he=0,pe=0;he<G;he++){for(;Ae[pe+1]<he;)pe++;const ve=te[pe],Ce=he-ve;J[x+he*Q]=X[ve]+Ce*Ce}}class Ei{constructor(x,Q){this.requestManager=x,this.localIdeographFontFamily=Q,this.entries={}}setURL(x){this.url=x}getGlyphs(x,Q){const G=[];for(const X in x)for(const te of x[X])G.push({stack:X,id:te});D.asyncAll(G,({stack:X,id:te},Ae)=>{let he=this.entries[X];he||(he=this.entries[X]={glyphs:{},requests:{},ranges:{}});let pe=he.glyphs[te];if(pe!==void 0)return void Ae(null,{stack:X,id:te,glyph:pe});if(pe=this._tinySDF(he,X,te),pe)return he.glyphs[te]=pe,void Ae(null,{stack:X,id:te,glyph:pe});const ve=Math.floor(te/256);if(256*ve>65535)return void Ae(new Error("glyphs > 65535 not supported"));if(he.ranges[ve])return void Ae(null,{stack:X,id:te,glyph:pe});if(!this.url)return void Ae(new Error("glyphsUrl is not set"));let Ce=he.requests[ve];Ce||(Ce=he.requests[ve]=[],Ei.loadGlyphRange(X,ve,this.url,this.requestManager,(Se,Qe)=>{if(Qe){for(const $e in Qe)this._doesCharSupportLocalGlyph(+$e)||(he.glyphs[+$e]=Qe[+$e]);he.ranges[ve]=!0}for(const $e of Ce)$e(Se,Qe);delete he.requests[ve]})),Ce.push((Se,Qe)=>{Se?Ae(Se):Qe&&Ae(null,{stack:X,id:te,glyph:Qe[te]||null})})},(X,te)=>{if(X)Q(X);else if(te){const Ae={};for(const{stack:he,id:pe,glyph:ve}of te)(Ae[he]||(Ae[he]={}))[pe]=ve&&{id:ve.id,bitmap:ve.bitmap.clone(),metrics:ve.metrics};Q(null,Ae)}})}_doesCharSupportLocalGlyph(x){return!!this.localIdeographFontFamily&&(D.unicodeBlockLookup["CJK Unified Ideographs"](x)||D.unicodeBlockLookup["Hangul Syllables"](x)||D.unicodeBlockLookup.Hiragana(x)||D.unicodeBlockLookup.Katakana(x))}_tinySDF(x,Q,G){const X=this.localIdeographFontFamily;if(!X||!this._doesCharSupportLocalGlyph(G))return;let te=x.tinySDF;if(!te){let he="400";/bold/i.test(Q)?he="900":/medium/i.test(Q)?he="500":/light/i.test(Q)&&(he="200"),te=x.tinySDF=new Ei.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:X,fontWeight:he})}const Ae=te.draw(String.fromCharCode(G));return{id:G,bitmap:new D.AlphaImage({width:Ae.width||30,height:Ae.height||30},Ae.data),metrics:{width:Ae.glyphWidth||24,height:Ae.glyphHeight||24,left:Ae.glyphLeft||0,top:Ae.glyphTop-27||-8,advance:Ae.glyphAdvance||24}}}}Ei.loadGlyphRange=function(J,x,Q,G,X){const te=256*x,Ae=te+255,he=G.transformRequest(Q.replace("{fontstack}",J).replace("{range}",`${te}-${Ae}`),We.Glyphs);D.getArrayBuffer(he,(pe,ve)=>{if(pe)X(pe);else if(ve){const Ce={};for(const Se of D.parseGlyphPbf(ve))Ce[Se.id]=Se;X(null,Ce)}})},Ei.TinySDF=class{constructor({fontSize:J=24,buffer:x=3,radius:Q=8,cutoff:G=.25,fontFamily:X="sans-serif",fontWeight:te="normal",fontStyle:Ae="normal"}={}){this.buffer=x,this.cutoff=G,this.radius=Q;const he=this.size=J+4*x,pe=this._createCanvas(he),ve=this.ctx=pe.getContext("2d",{willReadFrequently:!0});ve.font=`${Ae} ${te} ${J}px ${X}`,ve.textBaseline="alphabetic",ve.textAlign="left",ve.fillStyle="black",this.gridOuter=new Float64Array(he*he),this.gridInner=new Float64Array(he*he),this.f=new Float64Array(he),this.z=new Float64Array(he+1),this.v=new Uint16Array(he)}_createCanvas(J){const x=document.createElement("canvas");return x.width=x.height=J,x}draw(J){const{width:x,actualBoundingBoxAscent:Q,actualBoundingBoxDescent:G,actualBoundingBoxLeft:X,actualBoundingBoxRight:te}=this.ctx.measureText(J),Ae=Math.ceil(Q),he=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(te-X))),pe=Math.min(this.size-this.buffer,Ae+Math.ceil(G)),ve=he+2*this.buffer,Ce=pe+2*this.buffer,Se=Math.max(ve*Ce,0),Qe=new Uint8ClampedArray(Se),$e={data:Qe,width:ve,height:Ce,glyphWidth:he,glyphHeight:pe,glyphTop:Ae,glyphLeft:0,glyphAdvance:x};if(he===0||pe===0)return $e;const{ctx:Ze,buffer:rt,gridInner:Ye,gridOuter:dt}=this;Ze.clearRect(rt,rt,he,pe),Ze.fillText(J,rt,rt+Ae);const Bt=Ze.getImageData(rt,rt,he,pe);dt.fill(Yt,0,Se),Ye.fill(0,0,Se);for(let ot=0;ot<pe;ot++)for(let gt=0;gt<he;gt++){const St=Bt.data[4*(ot*he+gt)+3]/255;if(St===0)continue;const It=(ot+rt)*ve+gt+rt;if(St===1)dt[It]=0,Ye[It]=Yt;else{const Lt=.5-St;dt[It]=Lt>0?Lt*Lt:0,Ye[It]=Lt<0?Lt*Lt:0}}Ai(dt,0,0,ve,Ce,ve,this.f,this.v,this.z),Ai(Ye,rt,rt,he,pe,ve,this.f,this.v,this.z);for(let ot=0;ot<Se;ot++){const gt=Math.sqrt(dt[ot])-Math.sqrt(Ye[ot]);Qe[ot]=Math.round(255-255*(gt/this.radius+this.cutoff))}return $e}};class Li{constructor(){this.specification=D.v8Spec.light.position}possiblyEvaluate(x,Q){return D.sphericalToCartesian(x.expression.evaluate(Q))}interpolate(x,Q,G){return{x:D.interpolate.number(x.x,Q.x,G),y:D.interpolate.number(x.y,Q.y,G),z:D.interpolate.number(x.z,Q.z,G)}}}let Yi,vi;class d extends D.Evented{constructor(x){super(),Yi=Yi||new D.Properties({anchor:new D.DataConstantProperty(D.v8Spec.light.anchor),position:new Li,color:new D.DataConstantProperty(D.v8Spec.light.color),intensity:new D.DataConstantProperty(D.v8Spec.light.intensity)}),this._transitionable=new D.Transitionable(Yi),this.setLight(x),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(x,Q={}){if(!this._validate(D.validateLight,x,Q))for(const G in x){const X=x[G];G.endsWith("-transition")?this._transitionable.setTransition(G.slice(0,-11),X):this._transitionable.setValue(G,X)}}updateTransitions(x){this._transitioning=this._transitionable.transitioned(x,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(x){this.properties=this._transitioning.possiblyEvaluate(x)}_validate(x,Q,G){return(!G||G.validate!==!1)&&D.emitValidationErrors(this,x.call(D.validateStyle,D.extend({value:Q,style:{glyphs:!0,sprite:!0},styleSpec:D.v8Spec})))}}class b{constructor(x,Q){this.width=x,this.height=Q,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(x,Q){const G=x.join(",")+String(Q);return this.dashEntry[G]||(this.dashEntry[G]=this.addDash(x,Q)),this.dashEntry[G]}getDashRanges(x,Q,G){const X=[];let te=x.length%2==1?-x[x.length-1]*G:0,Ae=x[0]*G,he=!0;X.push({left:te,right:Ae,isDash:he,zeroLength:x[0]===0});let pe=x[0];for(let ve=1;ve<x.length;ve++){he=!he;const Ce=x[ve];te=pe*G,pe+=Ce,Ae=pe*G,X.push({left:te,right:Ae,isDash:he,zeroLength:Ce===0})}return X}addRoundDash(x,Q,G){const X=Q/2;for(let te=-G;te<=G;te++){const Ae=this.width*(this.nextRow+G+te);let he=0,pe=x[he];for(let ve=0;ve<this.width;ve++){ve/pe.right>1&&(pe=x[++he]);const Ce=Math.abs(ve-pe.left),Se=Math.abs(ve-pe.right),Qe=Math.min(Ce,Se);let $e;const Ze=te/G*(X+1);if(pe.isDash){const rt=X-Math.abs(Ze);$e=Math.sqrt(Qe*Qe+rt*rt)}else $e=X-Math.sqrt(Qe*Qe+Ze*Ze);this.data[Ae+ve]=Math.max(0,Math.min(255,$e+128))}}}addRegularDash(x){for(let he=x.length-1;he>=0;--he){const pe=x[he],ve=x[he+1];pe.zeroLength?x.splice(he,1):ve&&ve.isDash===pe.isDash&&(ve.left=pe.left,x.splice(he,1))}const Q=x[0],G=x[x.length-1];Q.isDash===G.isDash&&(Q.left=G.left-this.width,G.right=Q.right+this.width);const X=this.width*this.nextRow;let te=0,Ae=x[te];for(let he=0;he<this.width;he++){he/Ae.right>1&&(Ae=x[++te]);const pe=Math.abs(he-Ae.left),ve=Math.abs(he-Ae.right),Ce=Math.min(pe,ve);this.data[X+he]=Math.max(0,Math.min(255,(Ae.isDash?Ce:-Ce)+128))}}addDash(x,Q){const G=Q?7:0,X=2*G+1;if(this.nextRow+X>this.height)return D.warnOnce("LineAtlas out of space"),null;let te=0;for(let he=0;he<x.length;he++)te+=x[he];if(te!==0){const he=this.width/te,pe=this.getDashRanges(x,this.width,he);Q?this.addRoundDash(pe,he,G):this.addRegularDash(pe)}const Ae={y:(this.nextRow+G+.5)/this.height,height:2*G/this.height,width:te};return this.nextRow+=X,this.dirty=!0,Ae}bind(x){const Q=x.gl;this.texture?(Q.bindTexture(Q.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,Q.texSubImage2D(Q.TEXTURE_2D,0,0,0,this.width,this.height,Q.ALPHA,Q.UNSIGNED_BYTE,this.data))):(this.texture=Q.createTexture(),Q.bindTexture(Q.TEXTURE_2D,this.texture),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_S,Q.REPEAT),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_T,Q.REPEAT),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MIN_FILTER,Q.LINEAR),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MAG_FILTER,Q.LINEAR),Q.texImage2D(Q.TEXTURE_2D,0,Q.ALPHA,this.width,this.height,0,Q.ALPHA,Q.UNSIGNED_BYTE,this.data))}}class S{constructor(x,Q,G){this.workerPool=x,this.actors=[],this.currentActor=0,this.id=G;const X=this.workerPool.acquire(G);for(let te=0;te<X.length;te++){const Ae=new S.Actor(X[te],Q,G);Ae.name=`Worker ${te}`,this.actors.push(Ae)}if(!this.actors.length)throw new Error("No actors found")}broadcast(x,Q,G){D.asyncAll(this.actors,(X,te)=>{X.send(x,Q,te)},G=G||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(x=!0){this.actors.forEach(Q=>{Q.remove()}),this.actors=[],x&&this.workerPool.release(this.id)}}function k(J,x,Q){const G=function(X,te){if(X)return Q(X);if(te){const Ae=D.pick(D.extend(te,J),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);te.vector_layers&&(Ae.vectorLayers=te.vector_layers,Ae.vectorLayerIds=Ae.vectorLayers.map(he=>he.id)),Q(null,Ae)}};return J.url?D.getJSON(x.transformRequest(J.url,We.Source),G):D.browser.frame(()=>G(null,J))}S.Actor=D.Actor;class R{constructor(x,Q){x&&(Q?this.setSouthWest(x).setNorthEast(Q):Array.isArray(x)&&(x.length===4?this.setSouthWest([x[0],x[1]]).setNorthEast([x[2],x[3]]):this.setSouthWest(x[0]).setNorthEast(x[1])))}setNorthEast(x){return this._ne=x instanceof D.LngLat?new D.LngLat(x.lng,x.lat):D.LngLat.convert(x),this}setSouthWest(x){return this._sw=x instanceof D.LngLat?new D.LngLat(x.lng,x.lat):D.LngLat.convert(x),this}extend(x){const Q=this._sw,G=this._ne;let X,te;if(x instanceof D.LngLat)X=x,te=x;else{if(!(x instanceof R))return Array.isArray(x)?x.length===4||x.every(Array.isArray)?this.extend(R.convert(x)):this.extend(D.LngLat.convert(x)):x&&("lng"in x||"lon"in x)&&"lat"in x?this.extend(D.LngLat.convert(x)):this;if(X=x._sw,te=x._ne,!X||!te)return this}return Q||G?(Q.lng=Math.min(X.lng,Q.lng),Q.lat=Math.min(X.lat,Q.lat),G.lng=Math.max(te.lng,G.lng),G.lat=Math.max(te.lat,G.lat)):(this._sw=new D.LngLat(X.lng,X.lat),this._ne=new D.LngLat(te.lng,te.lat)),this}getCenter(){return new D.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new D.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new D.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(x){const{lng:Q,lat:G}=D.LngLat.convert(x);let X=this._sw.lng<=Q&&Q<=this._ne.lng;return this._sw.lng>this._ne.lng&&(X=this._sw.lng>=Q&&Q>=this._ne.lng),this._sw.lat<=G&&G<=this._ne.lat&&X}static convert(x){return x instanceof R?x:x&&new R(x)}static fromLngLat(x,Q=0){const G=360*Q/40075017,X=G/Math.cos(Math.PI/180*x.lat);return new R(new D.LngLat(x.lng-X,x.lat-G),new D.LngLat(x.lng+X,x.lat+G))}}class W{constructor(x,Q,G){this.bounds=R.convert(this.validateBounds(x)),this.minzoom=Q||0,this.maxzoom=G||24}validateBounds(x){return Array.isArray(x)&&x.length===4?[Math.max(-180,x[0]),Math.max(-90,x[1]),Math.min(180,x[2]),Math.min(90,x[3])]:[-180,-90,180,90]}contains(x){const Q=Math.pow(2,x.z),G=Math.floor(D.mercatorXfromLng(this.bounds.getWest())*Q),X=Math.floor(D.mercatorYfromLat(this.bounds.getNorth())*Q),te=Math.ceil(D.mercatorXfromLng(this.bounds.getEast())*Q),Ae=Math.ceil(D.mercatorYfromLat(this.bounds.getSouth())*Q);return x.x>=G&&x.x<te&&x.y>=X&&x.y<Ae}}class se extends D.Evented{constructor(x,Q,G,X){if(super(),this.load=()=>{this._loaded=!1,this.fire(new D.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=k(this._options,this.map._requestManager,(te,Ae)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),te?this.fire(new D.ErrorEvent(te)):Ae&&(D.extend(this,Ae),Ae.bounds&&(this.tileBounds=new W(Ae.bounds,this.minzoom,this.maxzoom)),this.fire(new D.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new D.Event("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>D.extend({},this._options),this.id=x,this.dispatcher=G,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,D.extend(this,D.pick(Q,["url","scheme","tileSize","promoteId"])),this._options=D.extend({type:"vector"},Q),this._collectResourceTiming=Q.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(X)}loaded(){return this._loaded}hasTile(x){return!this.tileBounds||this.tileBounds.contains(x.canonical)}onAdd(x){this.map=x,this.load()}setSourceProperty(x){this._tileJSONRequest&&this._tileJSONRequest.cancel(),x(),this.load()}setTiles(x){return this.setSourceProperty(()=>{this._options.tiles=x}),this}setUrl(x){return this.setSourceProperty(()=>{this.url=x,this._options.url=x}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(x,Q){const G=x.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),X={request:this.map._requestManager.transformRequest(G,We.Tile),uid:x.uid,tileID:x.tileID,zoom:x.tileID.overscaledZ,tileSize:this.tileSize*x.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function te(Ae,he){return delete x.request,x.aborted?Q(null):Ae&&Ae.status!==404?Q(Ae):(he&&he.resourceTiming&&(x.resourceTiming=he.resourceTiming),this.map._refreshExpiredTiles&&he&&x.setExpiryData(he),x.loadVectorData(he,this.map.painter),Q(null),void(x.reloadCallback&&(this.loadTile(x,x.reloadCallback),x.reloadCallback=null)))}X.request.collectResourceTiming=this._collectResourceTiming,x.actor&&x.state!=="expired"?x.state==="loading"?x.reloadCallback=Q:x.request=x.actor.send("reloadTile",X,te.bind(this)):(x.actor=this.dispatcher.getActor(),x.request=x.actor.send("loadTile",X,te.bind(this)))}abortTile(x){x.request&&(x.request.cancel(),delete x.request),x.actor&&x.actor.send("abortTile",{uid:x.uid,type:this.type,source:this.id},void 0)}unloadTile(x){x.unloadVectorData(),x.actor&&x.actor.send("removeTile",{uid:x.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class le extends D.Evented{constructor(x,Q,G,X){super(),this.id=x,this.dispatcher=G,this.setEventedParent(X),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=D.extend({type:"raster"},Q),D.extend(this,D.pick(Q,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new D.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=k(this._options,this.map._requestManager,(x,Q)=>{this._tileJSONRequest=null,this._loaded=!0,x?this.fire(new D.ErrorEvent(x)):Q&&(D.extend(this,Q),Q.bounds&&(this.tileBounds=new W(Q.bounds,this.minzoom,this.maxzoom)),this.fire(new D.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new D.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(x){this.map=x,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return D.extend({},this._options)}hasTile(x){return!this.tileBounds||this.tileBounds.contains(x.canonical)}loadTile(x,Q){const G=x.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);x.request=Je.getImage(this.map._requestManager.transformRequest(G,We.Tile),(X,te,Ae)=>{if(delete x.request,x.aborted)x.state="unloaded",Q(null);else if(X)x.state="errored",Q(X);else if(te){this.map._refreshExpiredTiles&&Ae&&x.setExpiryData(Ae);const he=this.map.painter.context,pe=he.gl;x.texture=this.map.painter.getTileTexture(te.width),x.texture?x.texture.update(te,{useMipmap:!0}):(x.texture=new vt(he,te,pe.RGBA,{useMipmap:!0}),x.texture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE,pe.LINEAR_MIPMAP_NEAREST),he.extTextureFilterAnisotropic&&pe.texParameterf(pe.TEXTURE_2D,he.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,he.extTextureFilterAnisotropicMax)),x.state="loaded",Q(null)}},this.map._refreshExpiredTiles)}abortTile(x,Q){x.request&&(x.request.cancel(),delete x.request),Q()}unloadTile(x,Q){x.texture&&this.map.painter.saveTileTexture(x.texture),Q()}hasTransition(){return!1}}class fe extends le{constructor(x,Q,G,X){super(x,Q,G,X),this.type="raster-dem",this.maxzoom=22,this._options=D.extend({type:"raster-dem"},Q),this.encoding=Q.encoding||"mapbox"}loadTile(x,Q){const G=x.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function X(te,Ae){te&&(x.state="errored",Q(te)),Ae&&(x.dem=Ae,x.needsHillshadePrepare=!0,x.needsTerrainPrepare=!0,x.state="loaded",Q(null))}x.request=Je.getImage(this.map._requestManager.transformRequest(G,We.Tile),(function(te,Ae){if(delete x.request,x.aborted)x.state="unloaded",Q(null);else if(te)x.state="errored",Q(te);else if(Ae){this.map._refreshExpiredTiles&&x.setExpiryData(Ae),delete Ae.cacheControl,delete Ae.expires;const he=D.isImageBitmap(Ae)&&(vi==null&&(vi=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),vi)?Ae:D.browser.getImageData(Ae,1),pe={uid:x.uid,coord:x.tileID,source:this.id,rawImageData:he,encoding:this.encoding};x.actor&&x.state!=="expired"||(x.actor=this.dispatcher.getActor(),x.actor.send("loadDEMTile",pe,X.bind(this)))}}).bind(this),this.map._refreshExpiredTiles),x.neighboringTiles=this._getNeighboringTiles(x.tileID)}_getNeighboringTiles(x){const Q=x.canonical,G=Math.pow(2,Q.z),X=(Q.x-1+G)%G,te=Q.x===0?x.wrap-1:x.wrap,Ae=(Q.x+1+G)%G,he=Q.x+1===G?x.wrap+1:x.wrap,pe={};return pe[new D.OverscaledTileID(x.overscaledZ,te,Q.z,X,Q.y).key]={backfilled:!1},pe[new D.OverscaledTileID(x.overscaledZ,he,Q.z,Ae,Q.y).key]={backfilled:!1},Q.y>0&&(pe[new D.OverscaledTileID(x.overscaledZ,te,Q.z,X,Q.y-1).key]={backfilled:!1},pe[new D.OverscaledTileID(x.overscaledZ,x.wrap,Q.z,Q.x,Q.y-1).key]={backfilled:!1},pe[new D.OverscaledTileID(x.overscaledZ,he,Q.z,Ae,Q.y-1).key]={backfilled:!1}),Q.y+1<G&&(pe[new D.OverscaledTileID(x.overscaledZ,te,Q.z,X,Q.y+1).key]={backfilled:!1},pe[new D.OverscaledTileID(x.overscaledZ,x.wrap,Q.z,Q.x,Q.y+1).key]={backfilled:!1},pe[new D.OverscaledTileID(x.overscaledZ,he,Q.z,Ae,Q.y+1).key]={backfilled:!1}),pe}unloadTile(x){x.demTexture&&this.map.painter.saveTileTexture(x.demTexture),x.fbo&&(x.fbo.destroy(),delete x.fbo),x.dem&&delete x.dem,delete x.neighboringTiles,x.state="unloaded",x.actor&&x.actor.send("removeDEMTile",{uid:x.uid,source:this.id})}}class be extends D.Evented{constructor(x,Q,G,X){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>D.extend({},this._options,{type:this.type,data:this._data}),this.id=x,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=G.getActor(),this.setEventedParent(X),this._data=Q.data,this._options=D.extend({},Q),this._collectResourceTiming=Q.collectResourceTiming,Q.maxzoom!==void 0&&(this.maxzoom=Q.maxzoom),Q.type&&(this.type=Q.type),Q.attribution&&(this.attribution=Q.attribution),this.promoteId=Q.promoteId;const te=D.EXTENT/this.tileSize;this.workerOptions=D.extend({source:this.id,cluster:Q.cluster||!1,geojsonVtOptions:{buffer:(Q.buffer!==void 0?Q.buffer:128)*te,tolerance:(Q.tolerance!==void 0?Q.tolerance:.375)*te,extent:D.EXTENT,maxZoom:this.maxzoom,lineMetrics:Q.lineMetrics||!1,generateId:Q.generateId||!1},superclusterOptions:{maxZoom:Q.clusterMaxZoom!==void 0?Q.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,Q.clusterMinPoints||2),extent:D.EXTENT,radius:(Q.clusterRadius||50)*te,log:!1,generateId:Q.generateId||!1},clusterProperties:Q.clusterProperties,filter:Q.filter},Q.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(x){this.map=x,this.load()}setData(x){return this._data=x,this._updateWorkerData(),this}updateData(x){return this._updateWorkerData(x),this}setClusterOptions(x){return this.workerOptions.cluster=x.cluster,x&&(x.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=x.clusterRadius),x.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=x.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(x,Q){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:x,source:this.id},Q),this}getClusterChildren(x,Q){return this.actor.send("geojson.getClusterChildren",{clusterId:x,source:this.id},Q),this}getClusterLeaves(x,Q,G,X){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:x,limit:Q,offset:G},X),this}_updateWorkerData(x){const Q=D.extend({},this.workerOptions);x?Q.dataDiff=x:typeof this._data=="string"?(Q.request=this.map._requestManager.transformRequest(D.browser.resolveURL(this._data),We.Source),Q.request.collectResourceTiming=this._collectResourceTiming):Q.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new D.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,Q,(G,X)=>{if(this._pendingLoads--,this._removed||X&&X.abandoned)return void this.fire(new D.Event("dataabort",{dataType:"source"}));let te=null;if(X&&X.resourceTiming&&X.resourceTiming[this.id]&&(te=X.resourceTiming[this.id].slice(0)),G)return void this.fire(new D.ErrorEvent(G));const Ae={dataType:"source"};this._collectResourceTiming&&te&&te.length>0&&D.extend(Ae,{resourceTiming:te}),this.fire(new D.Event("data",{...Ae,sourceDataType:"metadata"})),this.fire(new D.Event("data",{...Ae,sourceDataType:"content"}))})}loaded(){return this._pendingLoads===0}loadTile(x,Q){const G=x.actor?"reloadTile":"loadTile";x.actor=this.actor;const X={type:this.type,uid:x.uid,tileID:x.tileID,zoom:x.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};x.request=this.actor.send(G,X,(te,Ae)=>(delete x.request,x.unloadVectorData(),x.aborted?Q(null):te?Q(te):(x.loadVectorData(Ae,this.map.painter,G==="reloadTile"),Q(null))))}abortTile(x){x.request&&(x.request.cancel(),delete x.request),x.aborted=!0}unloadTile(x){x.unloadVectorData(),this.actor.send("removeTile",{uid:x.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var Te=D.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Ve extends D.Evented{constructor(x,Q,G,X){super(),this.load=(te,Ae)=>{this._loaded=!1,this.fire(new D.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=Je.getImage(this.map._requestManager.transformRequest(this.url,We.Image),(he,pe)=>{this._request=null,this._loaded=!0,he?this.fire(new D.ErrorEvent(he)):pe&&(this.image=pe,te&&(this.coordinates=te),Ae&&Ae(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const te=this.map.painter.context,Ae=te.gl;this.boundsBuffer||(this.boundsBuffer=te.createVertexBuffer(this._boundsArray,Te.members)),this.boundsSegments||(this.boundsSegments=D.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new vt(te,this.image,Ae.RGBA),this.texture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE));let he=!1;for(const pe in this.tiles){const ve=this.tiles[pe];ve.state!=="loaded"&&(ve.state="loaded",ve.texture=this.texture,he=!0)}he&&this.fire(new D.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=x,this.dispatcher=G,this.coordinates=Q.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(X),this.options=Q}loaded(){return this._loaded}updateImage(x){return x.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=x.url,this.load(x.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new D.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(x){this.map=x,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(x){this.coordinates=x;const Q=x.map(D.MercatorCoordinate.fromLngLat);this.tileID=function(X){let te=1/0,Ae=1/0,he=-1/0,pe=-1/0;for(const Qe of X)te=Math.min(te,Qe.x),Ae=Math.min(Ae,Qe.y),he=Math.max(he,Qe.x),pe=Math.max(pe,Qe.y);const ve=Math.max(he-te,pe-Ae),Ce=Math.max(0,Math.floor(-Math.log(ve)/Math.LN2)),Se=Math.pow(2,Ce);return new D.CanonicalTileID(Ce,Math.floor((te+he)/2*Se),Math.floor((Ae+pe)/2*Se))}(Q),this.minzoom=this.maxzoom=this.tileID.z;const G=Q.map(X=>this.tileID.getTilePoint(X)._round());return this._boundsArray=new D.RasterBoundsArray,this._boundsArray.emplaceBack(G[0].x,G[0].y,0,0),this._boundsArray.emplaceBack(G[1].x,G[1].y,D.EXTENT,0),this._boundsArray.emplaceBack(G[3].x,G[3].y,0,D.EXTENT),this._boundsArray.emplaceBack(G[2].x,G[2].y,D.EXTENT,D.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new D.Event("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(x,Q){this.tileID&&this.tileID.equals(x.tileID.canonical)?(this.tiles[String(x.tileID.wrap)]=x,x.buckets={},Q(null)):(x.state="errored",Q(null))}hasTransition(){return!1}}class Ue extends Ve{constructor(x,Q,G,X){super(x,Q,G,X),this.load=()=>{this._loaded=!1;const te=this.options;this.urls=[];for(const Ae of te.urls)this.urls.push(this.map._requestManager.transformRequest(Ae,We.Source).url);D.getVideo(this.urls,(Ae,he)=>{this._loaded=!0,Ae?this.fire(new D.ErrorEvent(Ae)):he&&(this.video=he,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const te=this.map.painter.context,Ae=te.gl;this.boundsBuffer||(this.boundsBuffer=te.createVertexBuffer(this._boundsArray,Te.members)),this.boundsSegments||(this.boundsSegments=D.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE),Ae.texSubImage2D(Ae.TEXTURE_2D,0,0,0,Ae.RGBA,Ae.UNSIGNED_BYTE,this.video)):(this.texture=new vt(te,this.video,Ae.RGBA),this.texture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE));let he=!1;for(const pe in this.tiles){const ve=this.tiles[pe];ve.state!=="loaded"&&(ve.state="loaded",ve.texture=this.texture,he=!0)}he&&this.fire(new D.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=Q}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(x){if(this.video){const Q=this.video.seekable;x<Q.start(0)||x>Q.end(0)?this.fire(new D.ErrorEvent(new D.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${Q.start(0)} and ${Q.end(0)}-second mark.`))):this.video.currentTime=x}}getVideo(){return this.video}onAdd(x){this.map||(this.map=x,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class me extends Ve{constructor(x,Q,G,X){super(x,Q,G,X),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new D.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let te=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,te=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,te=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const Ae=this.map.painter.context,he=Ae.gl;this.boundsBuffer||(this.boundsBuffer=Ae.createVertexBuffer(this._boundsArray,Te.members)),this.boundsSegments||(this.boundsSegments=D.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(te||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new vt(Ae,this.canvas,he.RGBA,{premultiply:!0});let pe=!1;for(const ve in this.tiles){const Ce=this.tiles[ve];Ce.state!=="loaded"&&(Ce.state="loaded",Ce.texture=this.texture,pe=!0)}pe&&this.fire(new D.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),Q.coordinates?Array.isArray(Q.coordinates)&&Q.coordinates.length===4&&!Q.coordinates.some(te=>!Array.isArray(te)||te.length!==2||te.some(Ae=>typeof Ae!="number"))||this.fire(new D.ErrorEvent(new D.ValidationError(`sources.${x}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new D.ErrorEvent(new D.ValidationError(`sources.${x}`,null,'missing required property "coordinates"'))),Q.animate&&typeof Q.animate!="boolean"&&this.fire(new D.ErrorEvent(new D.ValidationError(`sources.${x}`,null,'optional "animate" property must be a boolean value'))),Q.canvas?typeof Q.canvas=="string"||Q.canvas instanceof HTMLCanvasElement||this.fire(new D.ErrorEvent(new D.ValidationError(`sources.${x}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new D.ErrorEvent(new D.ValidationError(`sources.${x}`,null,'missing required property "canvas"'))),this.options=Q,this.animate=Q.animate===void 0||Q.animate}getCanvas(){return this.canvas}onAdd(x){this.map=x,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const x of[this.canvas.width,this.canvas.height])if(isNaN(x)||x<=0)return!0;return!1}}const ke={},qe=J=>{switch(J){case"geojson":return be;case"image":return Ve;case"raster":return le;case"raster-dem":return fe;case"vector":return se;case"video":return Ue;case"canvas":return me}return ke[J]};function lt(J,x){const Q=D.create();return D.translate(Q,Q,[1,1,0]),D.scale(Q,Q,[.5*J.width,.5*J.height,1]),D.multiply(Q,Q,J.calculatePosMatrix(x.toUnwrapped()))}function pt(J,x,Q,G,X,te){const Ae=function(Se,Qe,$e){if(Se)for(const Ze of Se){const rt=Qe[Ze];if(rt&&rt.source===$e&&rt.type==="fill-extrusion")return!0}else for(const Ze in Qe){const rt=Qe[Ze];if(rt.source===$e&&rt.type==="fill-extrusion")return!0}return!1}(X&&X.layers,x,J.id),he=te.maxPitchScaleFactor(),pe=J.tilesIn(G,he,Ae);pe.sort(Ft);const ve=[];for(const Se of pe)ve.push({wrappedTileID:Se.tileID.wrapped().key,queryResults:Se.tile.queryRenderedFeatures(x,Q,J._state,Se.queryGeometry,Se.cameraQueryGeometry,Se.scale,X,te,he,lt(J.transform,Se.tileID))});const Ce=function(Se){const Qe={},$e={};for(const Ze of Se){const rt=Ze.queryResults,Ye=Ze.wrappedTileID,dt=$e[Ye]=$e[Ye]||{};for(const Bt in rt){const ot=rt[Bt],gt=dt[Bt]=dt[Bt]||{},St=Qe[Bt]=Qe[Bt]||[];for(const It of ot)gt[It.featureIndex]||(gt[It.featureIndex]=!0,St.push(It))}}return Qe}(ve);for(const Se in Ce)Ce[Se].forEach(Qe=>{const $e=Qe.feature,Ze=J.getFeatureState($e.layer["source-layer"],$e.id);$e.source=$e.layer.source,$e.layer["source-layer"]&&($e.sourceLayer=$e.layer["source-layer"]),$e.state=Ze});return Ce}function Ft(J,x){const Q=J.tileID,G=x.tileID;return Q.overscaledZ-G.overscaledZ||Q.canonical.y-G.canonical.y||Q.wrap-G.wrap||Q.canonical.x-G.canonical.x}class zt{constructor(x,Q){this.timeAdded=0,this.fadeEndTime=0,this.tileID=x,this.uid=D.uniqueId(),this.uses=0,this.tileSize=Q,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(x){const Q=x+this.timeAdded;Q<this.fadeEndTime||(this.fadeEndTime=Q)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(x){this.demTexture&&x.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(x,Q,G){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",x){x.featureIndex&&(this.latestFeatureIndex=x.featureIndex,x.rawTileData?(this.latestRawTileData=x.rawTileData,this.latestFeatureIndex.rawTileData=x.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=x.collisionBoxArray,this.buckets=function(X,te){const Ae={};if(!te)return Ae;for(const he of X){const pe=he.layerIds.map(ve=>te.getLayer(ve)).filter(Boolean);if(pe.length!==0){he.layers=pe,he.stateDependentLayerIds&&(he.stateDependentLayers=he.stateDependentLayerIds.map(ve=>pe.filter(Ce=>Ce.id===ve)[0]));for(const ve of pe)Ae[ve.id]=he}}return Ae}(x.buckets,Q.style),this.hasSymbolBuckets=!1;for(const X in this.buckets){const te=this.buckets[X];if(te instanceof D.SymbolBucket){if(this.hasSymbolBuckets=!0,!G)break;te.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const X in this.buckets){const te=this.buckets[X];if(te instanceof D.SymbolBucket&&te.hasRTLText){this.hasRTLText=!0,D.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const X in this.buckets){const te=this.buckets[X];this.queryPadding=Math.max(this.queryPadding,Q.style.getLayer(X).queryRadius(te))}x.imageAtlas&&(this.imageAtlas=x.imageAtlas),x.glyphAtlasImage&&(this.glyphAtlasImage=x.glyphAtlasImage)}else this.collisionBoxArray=new D.CollisionBoxArray}unloadVectorData(){for(const x in this.buckets)this.buckets[x].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(x){return this.buckets[x.id]}upload(x){for(const G in this.buckets){const X=this.buckets[G];X.uploadPending()&&X.upload(x)}const Q=x.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new vt(x,this.imageAtlas.image,Q.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new vt(x,this.glyphAtlasImage,Q.ALPHA),this.glyphAtlasImage=null)}prepare(x){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(x,this.imageAtlasTexture)}queryRenderedFeatures(x,Q,G,X,te,Ae,he,pe,ve,Ce){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:X,cameraQueryGeometry:te,scale:Ae,tileSize:this.tileSize,pixelPosMatrix:Ce,transform:pe,params:he,queryPadding:this.queryPadding*ve},x,Q,G):{}}querySourceFeatures(x,Q){const G=this.latestFeatureIndex;if(!G||!G.rawTileData)return;const X=G.loadVTLayers(),te=Q&&Q.sourceLayer?Q.sourceLayer:"",Ae=X._geojsonTileLayer||X[te];if(!Ae)return;const he=D.createFilter(Q&&Q.filter),{z:pe,x:ve,y:Ce}=this.tileID.canonical,Se={z:pe,x:ve,y:Ce};for(let Qe=0;Qe<Ae.length;Qe++){const $e=Ae.feature(Qe);if(he.needGeometry){const Ye=D.toEvaluationFeature($e,!0);if(!he.filter(new D.EvaluationParameters(this.tileID.overscaledZ),Ye,this.tileID.canonical))continue}else if(!he.filter(new D.EvaluationParameters(this.tileID.overscaledZ),$e))continue;const Ze=G.getId($e,te),rt=new D.GeoJSONFeature($e,pe,ve,Ce,Ze);rt.tile=Se,x.push(rt)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(x){const Q=this.expirationTime;if(x.cacheControl){const G=D.parseCacheControl(x.cacheControl);G["max-age"]&&(this.expirationTime=Date.now()+1e3*G["max-age"])}else x.expires&&(this.expirationTime=new Date(x.expires).getTime());if(this.expirationTime){const G=Date.now();let X=!1;if(this.expirationTime>G)X=!1;else if(Q)if(this.expirationTime<Q)X=!0;else{const te=this.expirationTime-Q;te?this.expirationTime=G+Math.max(te,3e4):X=!0}else X=!0;X?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(x,Q){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(x).length===0)return;const G=this.latestFeatureIndex.loadVTLayers();for(const X in this.buckets){if(!Q.style.hasLayer(X))continue;const te=this.buckets[X],Ae=te.layers[0].sourceLayer||"_geojsonTileLayer",he=G[Ae],pe=x[Ae];if(!he||!pe||Object.keys(pe).length===0)continue;te.update(pe,he,this.imageAtlas&&this.imageAtlas.patternPositions||{});const ve=Q&&Q.style&&Q.style.getLayer(X);ve&&(this.queryPadding=Math.max(this.queryPadding,ve.queryRadius(te)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<D.browser.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(x){this.symbolFadeHoldUntil=D.browser.now()+x}setDependencies(x,Q){const G={};for(const X of Q)G[X]=!0;this.dependencies[x]=G}hasDependency(x,Q){for(const G of x){const X=this.dependencies[G];if(X){for(const te of Q)if(X[te])return!0}}return!1}}class Nt{constructor(x,Q){this.max=x,this.onRemove=Q,this.reset()}reset(){for(const x in this.data)for(const Q of this.data[x])Q.timeout&&clearTimeout(Q.timeout),this.onRemove(Q.value);return this.data={},this.order=[],this}add(x,Q,G){const X=x.wrapped().key;this.data[X]===void 0&&(this.data[X]=[]);const te={value:Q,timeout:void 0};if(G!==void 0&&(te.timeout=setTimeout(()=>{this.remove(x,te)},G)),this.data[X].push(te),this.order.push(X),this.order.length>this.max){const Ae=this._getAndRemoveByKey(this.order[0]);Ae&&this.onRemove(Ae)}return this}has(x){return x.wrapped().key in this.data}getAndRemove(x){return this.has(x)?this._getAndRemoveByKey(x.wrapped().key):null}_getAndRemoveByKey(x){const Q=this.data[x].shift();return Q.timeout&&clearTimeout(Q.timeout),this.data[x].length===0&&delete this.data[x],this.order.splice(this.order.indexOf(x),1),Q.value}getByKey(x){const Q=this.data[x];return Q?Q[0].value:null}get(x){return this.has(x)?this.data[x.wrapped().key][0].value:null}remove(x,Q){if(!this.has(x))return this;const G=x.wrapped().key,X=Q===void 0?0:this.data[G].indexOf(Q),te=this.data[G][X];return this.data[G].splice(X,1),te.timeout&&clearTimeout(te.timeout),this.data[G].length===0&&delete this.data[G],this.onRemove(te.value),this.order.splice(this.order.indexOf(G),1),this}setMaxSize(x){for(this.max=x;this.order.length>this.max;){const Q=this._getAndRemoveByKey(this.order[0]);Q&&this.onRemove(Q)}return this}filter(x){const Q=[];for(const G in this.data)for(const X of this.data[G])x(X.value)||Q.push(X);for(const G of Q)this.remove(G.value.tileID,G)}}class Mt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(x,Q,G){const X=String(Q);if(this.stateChanges[x]=this.stateChanges[x]||{},this.stateChanges[x][X]=this.stateChanges[x][X]||{},D.extend(this.stateChanges[x][X],G),this.deletedStates[x]===null){this.deletedStates[x]={};for(const te in this.state[x])te!==X&&(this.deletedStates[x][te]=null)}else if(this.deletedStates[x]&&this.deletedStates[x][X]===null){this.deletedStates[x][X]={};for(const te in this.state[x][X])G[te]||(this.deletedStates[x][X][te]=null)}else for(const te in G)this.deletedStates[x]&&this.deletedStates[x][X]&&this.deletedStates[x][X][te]===null&&delete this.deletedStates[x][X][te]}removeFeatureState(x,Q,G){if(this.deletedStates[x]===null)return;const X=String(Q);if(this.deletedStates[x]=this.deletedStates[x]||{},G&&Q!==void 0)this.deletedStates[x][X]!==null&&(this.deletedStates[x][X]=this.deletedStates[x][X]||{},this.deletedStates[x][X][G]=null);else if(Q!==void 0)if(this.stateChanges[x]&&this.stateChanges[x][X])for(G in this.deletedStates[x][X]={},this.stateChanges[x][X])this.deletedStates[x][X][G]=null;else this.deletedStates[x][X]=null;else this.deletedStates[x]=null}getState(x,Q){const G=String(Q),X=D.extend({},(this.state[x]||{})[G],(this.stateChanges[x]||{})[G]);if(this.deletedStates[x]===null)return{};if(this.deletedStates[x]){const te=this.deletedStates[x][Q];if(te===null)return{};for(const Ae in te)delete X[Ae]}return X}initializeTileState(x,Q){x.setFeatureState(this.state,Q)}coalesceChanges(x,Q){const G={};for(const X in this.stateChanges){this.state[X]=this.state[X]||{};const te={};for(const Ae in this.stateChanges[X])this.state[X][Ae]||(this.state[X][Ae]={}),D.extend(this.state[X][Ae],this.stateChanges[X][Ae]),te[Ae]=this.state[X][Ae];G[X]=te}for(const X in this.deletedStates){this.state[X]=this.state[X]||{};const te={};if(this.deletedStates[X]===null)for(const Ae in this.state[X])te[Ae]={},this.state[X][Ae]={};else for(const Ae in this.deletedStates[X]){if(this.deletedStates[X][Ae]===null)this.state[X][Ae]={};else for(const he of Object.keys(this.deletedStates[X][Ae]))delete this.state[X][Ae][he];te[Ae]=this.state[X][Ae]}G[X]=G[X]||{},D.extend(G[X],te)}if(this.stateChanges={},this.deletedStates={},Object.keys(G).length!==0)for(const X in x)x[X].setFeatureState(G,Q)}}class $t extends D.Evented{constructor(x,Q,G){super(),this.id=x,this.dispatcher=G,this.on("data",X=>{X.dataType==="source"&&X.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&X.dataType==="source"&&X.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((X,te,Ae,he)=>{const pe=new(qe(te.type))(X,te,Ae,he);if(pe.id!==X)throw new Error(`Expected Source id to be ${X} instead of ${pe.id}`);return pe})(x,Q,G,this),this._tiles={},this._cache=new Nt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Mt,this._didEmitContent=!1,this._updated=!1}onAdd(x){this.map=x,this._maxTileCacheSize=x?x._maxTileCacheSize:null,this._maxTileCacheZoomLevels=x?x._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(x)}onRemove(x){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(x)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const x in this._tiles){const Q=this._tiles[x];if(Q.state!=="loaded"&&Q.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const x=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,x&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(x,Q){return this._source.loadTile(x,Q)}_unloadTile(x){if(this._source.unloadTile)return this._source.unloadTile(x,()=>{})}_abortTile(x){this._source.abortTile&&this._source.abortTile(x,()=>{}),this._source.fire(new D.Event("dataabort",{tile:x,coord:x.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(x){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const Q in this._tiles){const G=this._tiles[Q];G.upload(x),G.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(x=>x.tileID).sort(ri).map(x=>x.key)}getRenderableIds(x){const Q=[];for(const G in this._tiles)this._isIdRenderable(G,x)&&Q.push(this._tiles[G]);return x?Q.sort((G,X)=>{const te=G.tileID,Ae=X.tileID,he=new D.Point(te.canonical.x,te.canonical.y)._rotate(this.transform.angle),pe=new D.Point(Ae.canonical.x,Ae.canonical.y)._rotate(this.transform.angle);return te.overscaledZ-Ae.overscaledZ||pe.y-he.y||pe.x-he.x}).map(G=>G.tileID.key):Q.map(G=>G.tileID).sort(ri).map(G=>G.key)}hasRenderableParent(x){const Q=this.findLoadedParent(x,0);return!!Q&&this._isIdRenderable(Q.tileID.key)}_isIdRenderable(x,Q){return this._tiles[x]&&this._tiles[x].hasData()&&!this._coveredTiles[x]&&(Q||!this._tiles[x].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const x in this._tiles)this._tiles[x].state!=="errored"&&this._reloadTile(x,"reloading")}}_reloadTile(x,Q){const G=this._tiles[x];G&&(G.state!=="loading"&&(G.state=Q),this._loadTile(G,this._tileLoaded.bind(this,G,x,Q)))}_tileLoaded(x,Q,G,X){if(X)return x.state="errored",void(X.status!==404?this._source.fire(new D.ErrorEvent(X,{tile:x})):this.update(this.transform,this.terrain));x.timeAdded=D.browser.now(),G==="expired"&&(x.refreshedUponExpiration=!0),this._setTileReloadTimer(Q,x),this.getSource().type==="raster-dem"&&x.dem&&this._backfillDEM(x),this._state.initializeTileState(x,this.map?this.map.painter:null),x.aborted||this._source.fire(new D.Event("data",{dataType:"source",tile:x,coord:x.tileID}))}_backfillDEM(x){const Q=this.getRenderableIds();for(let X=0;X<Q.length;X++){const te=Q[X];if(x.neighboringTiles&&x.neighboringTiles[te]){const Ae=this.getTileByID(te);G(x,Ae),G(Ae,x)}}function G(X,te){X.needsHillshadePrepare=!0,X.needsTerrainPrepare=!0;let Ae=te.tileID.canonical.x-X.tileID.canonical.x;const he=te.tileID.canonical.y-X.tileID.canonical.y,pe=Math.pow(2,X.tileID.canonical.z),ve=te.tileID.key;Ae===0&&he===0||Math.abs(he)>1||(Math.abs(Ae)>1&&(Math.abs(Ae+pe)===1?Ae+=pe:Math.abs(Ae-pe)===1&&(Ae-=pe)),te.dem&&X.dem&&(X.dem.backfillBorder(te.dem,Ae,he),X.neighboringTiles&&X.neighboringTiles[ve]&&(X.neighboringTiles[ve].backfilled=!0)))}}getTile(x){return this.getTileByID(x.key)}getTileByID(x){return this._tiles[x]}_retainLoadedChildren(x,Q,G,X){for(const te in this._tiles){let Ae=this._tiles[te];if(X[te]||!Ae.hasData()||Ae.tileID.overscaledZ<=Q||Ae.tileID.overscaledZ>G)continue;let he=Ae.tileID;for(;Ae&&Ae.tileID.overscaledZ>Q+1;){const ve=Ae.tileID.scaledTo(Ae.tileID.overscaledZ-1);Ae=this._tiles[ve.key],Ae&&Ae.hasData()&&(he=ve)}let pe=he;for(;pe.overscaledZ>Q;)if(pe=pe.scaledTo(pe.overscaledZ-1),x[pe.key]){X[he.key]=he;break}}}findLoadedParent(x,Q){if(x.key in this._loadedParentTiles){const G=this._loadedParentTiles[x.key];return G&&G.tileID.overscaledZ>=Q?G:null}for(let G=x.overscaledZ-1;G>=Q;G--){const X=x.scaledTo(G),te=this._getLoadedTile(X);if(te)return te}}_getLoadedTile(x){const Q=this._tiles[x.key];return Q&&Q.hasData()?Q:this._cache.getByKey(x.wrapped().key)}updateCacheSize(x){const Q=Math.ceil(x.width/this._source.tileSize)+1,G=Math.ceil(x.height/this._source.tileSize)+1,X=Math.floor(Q*G*(this._maxTileCacheZoomLevels===null?D.config.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),te=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,X):X;this._cache.setMaxSize(te)}handleWrapJump(x){const Q=Math.round((x-(this._prevLng===void 0?x:this._prevLng))/360);if(this._prevLng=x,Q){const G={};for(const X in this._tiles){const te=this._tiles[X];te.tileID=te.tileID.unwrapTo(te.tileID.wrap+Q),G[te.tileID.key]=te}this._tiles=G;for(const X in this._timers)clearTimeout(this._timers[X]),delete this._timers[X];for(const X in this._tiles)this._setTileReloadTimer(X,this._tiles[X])}}update(x,Q){if(this.transform=x,this.terrain=Q,!this._sourceLoaded||this._paused)return;let G;this.updateCacheSize(x),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?G=x.getVisibleUnwrappedCoordinates(this._source.tileID).map(Ce=>new D.OverscaledTileID(Ce.canonical.z,Ce.wrap,Ce.canonical.z,Ce.canonical.x,Ce.canonical.y)):(G=x.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:Q}),this._source.hasTile&&(G=G.filter(Ce=>this._source.hasTile(Ce)))):G=[];const X=x.coveringZoomLevel(this._source),te=Math.max(X-$t.maxOverzooming,this._source.minzoom),Ae=Math.max(X+$t.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const Ce={};for(const Se of G)if(Se.canonical.z>this._source.minzoom){const Qe=Se.scaledTo(Se.canonical.z-1);Ce[Qe.key]=Qe;const $e=Se.scaledTo(Math.max(this._source.minzoom,Math.min(Se.canonical.z,5)));Ce[$e.key]=$e}G=G.concat(Object.values(Ce))}const he=G.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,he&&this.fire(new D.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const pe=this._updateRetainedTiles(G,X);if(ci(this._source.type)){const Ce={},Se={},Qe=Object.keys(pe),$e=D.browser.now();for(const Ze of Qe){const rt=pe[Ze],Ye=this._tiles[Ze];if(!Ye||Ye.fadeEndTime!==0&&Ye.fadeEndTime<=$e)continue;const dt=this.findLoadedParent(rt,te);dt&&(this._addTile(dt.tileID),Ce[dt.tileID.key]=dt.tileID),Se[Ze]=rt}this._retainLoadedChildren(Se,X,Ae,pe);for(const Ze in Ce)pe[Ze]||(this._coveredTiles[Ze]=!0,pe[Ze]=Ce[Ze]);if(Q){const Ze={},rt={};for(const Ye of G)this._tiles[Ye.key].hasData()?Ze[Ye.key]=Ye:rt[Ye.key]=Ye;for(const Ye in rt){const dt=rt[Ye].children(this._source.maxzoom);this._tiles[dt[0].key]&&this._tiles[dt[1].key]&&this._tiles[dt[2].key]&&this._tiles[dt[3].key]&&(Ze[dt[0].key]=pe[dt[0].key]=dt[0],Ze[dt[1].key]=pe[dt[1].key]=dt[1],Ze[dt[2].key]=pe[dt[2].key]=dt[2],Ze[dt[3].key]=pe[dt[3].key]=dt[3],delete rt[Ye])}for(const Ye in rt){const dt=this.findLoadedParent(rt[Ye],this._source.minzoom);if(dt){Ze[dt.tileID.key]=pe[dt.tileID.key]=dt.tileID;for(const Bt in Ze)Ze[Bt].isChildOf(dt.tileID)&&delete Ze[Bt]}}for(const Ye in this._tiles)Ze[Ye]||(this._coveredTiles[Ye]=!0)}}for(const Ce in pe)this._tiles[Ce].clearFadeHold();const ve=D.keysDifference(this._tiles,pe);for(const Ce of ve){const Se=this._tiles[Ce];Se.hasSymbolBuckets&&!Se.holdingForFade()?Se.setHoldDuration(this.map._fadeDuration):Se.hasSymbolBuckets&&!Se.symbolFadeFinished()||this._removeTile(Ce)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const x in this._tiles)this._tiles[x].holdingForFade()&&this._removeTile(x)}_updateRetainedTiles(x,Q){const G={},X={},te=Math.max(Q-$t.maxOverzooming,this._source.minzoom),Ae=Math.max(Q+$t.maxUnderzooming,this._source.minzoom),he={};for(const pe of x){const ve=this._addTile(pe);G[pe.key]=pe,ve.hasData()||Q<this._source.maxzoom&&(he[pe.key]=pe)}this._retainLoadedChildren(he,Q,Ae,G);for(const pe of x){let ve=this._tiles[pe.key];if(ve.hasData())continue;if(Q+1>this._source.maxzoom){const Se=pe.children(this._source.maxzoom)[0],Qe=this.getTile(Se);if(Qe&&Qe.hasData()){G[Se.key]=Se;continue}}else{const Se=pe.children(this._source.maxzoom);if(G[Se[0].key]&&G[Se[1].key]&&G[Se[2].key]&&G[Se[3].key])continue}let Ce=ve.wasRequested();for(let Se=pe.overscaledZ-1;Se>=te;--Se){const Qe=pe.scaledTo(Se);if(X[Qe.key])break;if(X[Qe.key]=!0,ve=this.getTile(Qe),!ve&&Ce&&(ve=this._addTile(Qe)),ve){const $e=ve.hasData();if((Ce||$e)&&(G[Qe.key]=Qe),Ce=ve.wasRequested(),$e)break}}}return G}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const x in this._tiles){const Q=[];let G,X=this._tiles[x].tileID;for(;X.overscaledZ>0;){if(X.key in this._loadedParentTiles){G=this._loadedParentTiles[X.key];break}Q.push(X.key);const te=X.scaledTo(X.overscaledZ-1);if(G=this._getLoadedTile(te),G)break;X=te}for(const te of Q)this._loadedParentTiles[te]=G}}_addTile(x){let Q=this._tiles[x.key];if(Q)return Q;Q=this._cache.getAndRemove(x),Q&&(this._setTileReloadTimer(x.key,Q),Q.tileID=x,this._state.initializeTileState(Q,this.map?this.map.painter:null),this._cacheTimers[x.key]&&(clearTimeout(this._cacheTimers[x.key]),delete this._cacheTimers[x.key],this._setTileReloadTimer(x.key,Q)));const G=Q;return Q||(Q=new zt(x,this._source.tileSize*x.overscaleFactor()),this._loadTile(Q,this._tileLoaded.bind(this,Q,x.key,Q.state))),Q.uses++,this._tiles[x.key]=Q,G||this._source.fire(new D.Event("dataloading",{tile:Q,coord:Q.tileID,dataType:"source"})),Q}_setTileReloadTimer(x,Q){x in this._timers&&(clearTimeout(this._timers[x]),delete this._timers[x]);const G=Q.getExpiryTimeout();G&&(this._timers[x]=setTimeout(()=>{this._reloadTile(x,"expired"),delete this._timers[x]},G))}_removeTile(x){const Q=this._tiles[x];Q&&(Q.uses--,delete this._tiles[x],this._timers[x]&&(clearTimeout(this._timers[x]),delete this._timers[x]),Q.uses>0||(Q.hasData()&&Q.state!=="reloading"?this._cache.add(Q.tileID,Q,Q.getExpiryTimeout()):(Q.aborted=!0,this._abortTile(Q),this._unloadTile(Q))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const x in this._tiles)this._removeTile(x);this._cache.reset()}tilesIn(x,Q,G){const X=[],te=this.transform;if(!te)return X;const Ae=G?te.getCameraQueryGeometry(x):x,he=x.map(Ze=>te.pointCoordinate(Ze,this.terrain)),pe=Ae.map(Ze=>te.pointCoordinate(Ze,this.terrain)),ve=this.getIds();let Ce=1/0,Se=1/0,Qe=-1/0,$e=-1/0;for(const Ze of pe)Ce=Math.min(Ce,Ze.x),Se=Math.min(Se,Ze.y),Qe=Math.max(Qe,Ze.x),$e=Math.max($e,Ze.y);for(let Ze=0;Ze<ve.length;Ze++){const rt=this._tiles[ve[Ze]];if(rt.holdingForFade())continue;const Ye=rt.tileID,dt=Math.pow(2,te.zoom-rt.tileID.overscaledZ),Bt=Q*rt.queryPadding*D.EXTENT/rt.tileSize/dt,ot=[Ye.getTilePoint(new D.MercatorCoordinate(Ce,Se)),Ye.getTilePoint(new D.MercatorCoordinate(Qe,$e))];if(ot[0].x-Bt<D.EXTENT&&ot[0].y-Bt<D.EXTENT&&ot[1].x+Bt>=0&&ot[1].y+Bt>=0){const gt=he.map(It=>Ye.getTilePoint(It)),St=pe.map(It=>Ye.getTilePoint(It));X.push({tile:rt,tileID:Ye,queryGeometry:gt,cameraQueryGeometry:St,scale:dt})}}return X}getVisibleCoordinates(x){const Q=this.getRenderableIds(x).map(G=>this._tiles[G].tileID);for(const G of Q)G.posMatrix=this.transform.calculatePosMatrix(G.toUnwrapped());return Q}hasTransition(){if(this._source.hasTransition())return!0;if(ci(this._source.type)){const x=D.browser.now();for(const Q in this._tiles)if(this._tiles[Q].fadeEndTime>=x)return!0}return!1}setFeatureState(x,Q,G){this._state.updateState(x=x||"_geojsonTileLayer",Q,G)}removeFeatureState(x,Q,G){this._state.removeFeatureState(x=x||"_geojsonTileLayer",Q,G)}getFeatureState(x,Q){return this._state.getState(x=x||"_geojsonTileLayer",Q)}setDependencies(x,Q,G){const X=this._tiles[x];X&&X.setDependencies(Q,G)}reloadTilesForDependencies(x,Q){for(const G in this._tiles)this._tiles[G].hasDependency(x,Q)&&this._reloadTile(G,"reloading");this._cache.filter(G=>!G.hasDependency(x,Q))}}function ri(J,x){const Q=Math.abs(2*J.wrap)-+(J.wrap<0),G=Math.abs(2*x.wrap)-+(x.wrap<0);return J.overscaledZ-x.overscaledZ||G-Q||x.canonical.y-J.canonical.y||x.canonical.x-J.canonical.x}function ci(J){return J==="raster"||J==="image"||J==="video"}$t.maxOverzooming=10,$t.maxUnderzooming=3;const wt="mapboxgl_preloaded_worker_pool";class di{constructor(){this.active={}}acquire(x){if(!this.workers)for(this.workers=[];this.workers.length<di.workerCount;)this.workers.push(new Worker(D.config.WORKER_URL));return this.active[x]=!0,this.workers.slice()}release(x){delete this.active[x],this.numActive()===0&&(this.workers.forEach(Q=>{Q.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[wt]}numActive(){return Object.keys(this.active).length}}const ii=Math.floor(D.browser.hardwareConcurrency/2);let Hi;function Vi(){return Hi||(Hi=new di),Hi}di.workerCount=D.isSafari(globalThis)?Math.max(Math.min(ii,3),1):1;class Ot{constructor(x,Q){this.reset(x,Q)}reset(x,Q){this.points=x||[],this._distances=[0];for(let G=1;G<this.points.length;G++)this._distances[G]=this._distances[G-1]+this.points[G].dist(this.points[G-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(Q||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(x){if(this.points.length===1)return this.points[0];x=D.clamp(x,0,1);let Q=1,G=this._distances[Q];const X=x*this.paddedLength+this.padding;for(;G<X&&Q<this._distances.length;)G=this._distances[++Q];const te=Q-1,Ae=this._distances[te],he=G-Ae,pe=he>0?(X-Ae)/he:0;return this.points[te].mult(1-pe).add(this.points[Q].mult(pe))}}function _i(J,x){let Q=!0;return J==="always"||J!=="never"&&x!=="never"||(Q=!1),Q}class Ti{constructor(x,Q,G){const X=this.boxCells=[],te=this.circleCells=[];this.xCellCount=Math.ceil(x/G),this.yCellCount=Math.ceil(Q/G);for(let Ae=0;Ae<this.xCellCount*this.yCellCount;Ae++)X.push([]),te.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=x,this.height=Q,this.xScale=this.xCellCount/x,this.yScale=this.yCellCount/Q,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(x,Q,G,X,te){this._forEachCell(Q,G,X,te,this._insertBoxCell,this.boxUid++),this.boxKeys.push(x),this.bboxes.push(Q),this.bboxes.push(G),this.bboxes.push(X),this.bboxes.push(te)}insertCircle(x,Q,G,X){this._forEachCell(Q-X,G-X,Q+X,G+X,this._insertCircleCell,this.circleUid++),this.circleKeys.push(x),this.circles.push(Q),this.circles.push(G),this.circles.push(X)}_insertBoxCell(x,Q,G,X,te,Ae){this.boxCells[te].push(Ae)}_insertCircleCell(x,Q,G,X,te,Ae){this.circleCells[te].push(Ae)}_query(x,Q,G,X,te,Ae,he){if(G<0||x>this.width||X<0||Q>this.height)return[];const pe=[];if(x<=0&&Q<=0&&this.width<=G&&this.height<=X){if(te)return[{key:null,x1:x,y1:Q,x2:G,y2:X}];for(let ve=0;ve<this.boxKeys.length;ve++)pe.push({key:this.boxKeys[ve],x1:this.bboxes[4*ve],y1:this.bboxes[4*ve+1],x2:this.bboxes[4*ve+2],y2:this.bboxes[4*ve+3]});for(let ve=0;ve<this.circleKeys.length;ve++){const Ce=this.circles[3*ve],Se=this.circles[3*ve+1],Qe=this.circles[3*ve+2];pe.push({key:this.circleKeys[ve],x1:Ce-Qe,y1:Se-Qe,x2:Ce+Qe,y2:Se+Qe})}}else this._forEachCell(x,Q,G,X,this._queryCell,pe,{hitTest:te,overlapMode:Ae,seenUids:{box:{},circle:{}}},he);return pe}query(x,Q,G,X){return this._query(x,Q,G,X,!1,null)}hitTest(x,Q,G,X,te,Ae){return this._query(x,Q,G,X,!0,te,Ae).length>0}hitTestCircle(x,Q,G,X,te){const Ae=x-G,he=x+G,pe=Q-G,ve=Q+G;if(he<0||Ae>this.width||ve<0||pe>this.height)return!1;const Ce=[];return this._forEachCell(Ae,pe,he,ve,this._queryCellCircle,Ce,{hitTest:!0,overlapMode:X,circle:{x,y:Q,radius:G},seenUids:{box:{},circle:{}}},te),Ce.length>0}_queryCell(x,Q,G,X,te,Ae,he,pe){const{seenUids:ve,hitTest:Ce,overlapMode:Se}=he,Qe=this.boxCells[te];if(Qe!==null){const Ze=this.bboxes;for(const rt of Qe)if(!ve.box[rt]){ve.box[rt]=!0;const Ye=4*rt,dt=this.boxKeys[rt];if(x<=Ze[Ye+2]&&Q<=Ze[Ye+3]&&G>=Ze[Ye+0]&&X>=Ze[Ye+1]&&(!pe||pe(dt))&&(!Ce||!_i(Se,dt.overlapMode))&&(Ae.push({key:dt,x1:Ze[Ye],y1:Ze[Ye+1],x2:Ze[Ye+2],y2:Ze[Ye+3]}),Ce))return!0}}const $e=this.circleCells[te];if($e!==null){const Ze=this.circles;for(const rt of $e)if(!ve.circle[rt]){ve.circle[rt]=!0;const Ye=3*rt,dt=this.circleKeys[rt];if(this._circleAndRectCollide(Ze[Ye],Ze[Ye+1],Ze[Ye+2],x,Q,G,X)&&(!pe||pe(dt))&&(!Ce||!_i(Se,dt.overlapMode))){const Bt=Ze[Ye],ot=Ze[Ye+1],gt=Ze[Ye+2];if(Ae.push({key:dt,x1:Bt-gt,y1:ot-gt,x2:Bt+gt,y2:ot+gt}),Ce)return!0}}}return!1}_queryCellCircle(x,Q,G,X,te,Ae,he,pe){const{circle:ve,seenUids:Ce,overlapMode:Se}=he,Qe=this.boxCells[te];if(Qe!==null){const Ze=this.bboxes;for(const rt of Qe)if(!Ce.box[rt]){Ce.box[rt]=!0;const Ye=4*rt,dt=this.boxKeys[rt];if(this._circleAndRectCollide(ve.x,ve.y,ve.radius,Ze[Ye+0],Ze[Ye+1],Ze[Ye+2],Ze[Ye+3])&&(!pe||pe(dt))&&!_i(Se,dt.overlapMode))return Ae.push(!0),!0}}const $e=this.circleCells[te];if($e!==null){const Ze=this.circles;for(const rt of $e)if(!Ce.circle[rt]){Ce.circle[rt]=!0;const Ye=3*rt,dt=this.circleKeys[rt];if(this._circlesCollide(Ze[Ye],Ze[Ye+1],Ze[Ye+2],ve.x,ve.y,ve.radius)&&(!pe||pe(dt))&&!_i(Se,dt.overlapMode))return Ae.push(!0),!0}}}_forEachCell(x,Q,G,X,te,Ae,he,pe){const ve=this._convertToXCellCoord(x),Ce=this._convertToYCellCoord(Q),Se=this._convertToXCellCoord(G),Qe=this._convertToYCellCoord(X);for(let $e=ve;$e<=Se;$e++)for(let Ze=Ce;Ze<=Qe;Ze++)if(te.call(this,x,Q,G,X,this.xCellCount*Ze+$e,Ae,he,pe))return}_convertToXCellCoord(x){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(x*this.xScale)))}_convertToYCellCoord(x){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(x*this.yScale)))}_circlesCollide(x,Q,G,X,te,Ae){const he=X-x,pe=te-Q,ve=G+Ae;return ve*ve>he*he+pe*pe}_circleAndRectCollide(x,Q,G,X,te,Ae,he){const pe=(Ae-X)/2,ve=Math.abs(x-(X+pe));if(ve>pe+G)return!1;const Ce=(he-te)/2,Se=Math.abs(Q-(te+Ce));if(Se>Ce+G)return!1;if(ve<=pe||Se<=Ce)return!0;const Qe=ve-pe,$e=Se-Ce;return Qe*Qe+$e*$e<=G*G}}function Wi(J,x,Q,G,X){const te=D.create();return x?(D.scale(te,te,[1/X,1/X,1]),Q||D.rotateZ(te,te,G.angle)):D.multiply(te,G.labelPlaneMatrix,J),te}function Zt(J,x,Q,G,X){if(x){const te=D.clone(J);return D.scale(te,te,[X,X,1]),Q||D.rotateZ(te,te,-G.angle),te}return G.glCoordMatrix}function mi(J,x,Q){let G;Q?(G=[J.x,J.y,Q(J.x,J.y),1],D.transformMat4(G,G,x)):(G=[J.x,J.y,0,1],xe(G,G,x));const X=G[3];return{point:new D.Point(G[0]/X,G[1]/X),signedDistanceFromCamera:X}}function bi(J,x){return .5+J/x*.5}function $i(J,x){const Q=J[0]/J[3],G=J[1]/J[3];return Q>=-x[0]&&Q<=x[0]&&G>=-x[1]&&G<=x[1]}function tr(J,x,Q,G,X,te,Ae,he,pe,ve){const Ce=G?J.textSizeData:J.iconSizeData,Se=D.evaluateSizeForZoom(Ce,Q.transform.zoom),Qe=[256/Q.width*2+1,256/Q.height*2+1],$e=G?J.text.dynamicLayoutVertexArray:J.icon.dynamicLayoutVertexArray;$e.clear();const Ze=J.lineVertexArray,rt=G?J.text.placedSymbolArray:J.icon.placedSymbolArray,Ye=Q.transform.width/Q.transform.height;let dt=!1;for(let Bt=0;Bt<rt.length;Bt++){const ot=rt.get(Bt);if(ot.hidden||ot.writingMode===D.WritingMode.vertical&&!dt){ye(ot.numGlyphs,$e);continue}let gt;if(dt=!1,ve?(gt=[ot.anchorX,ot.anchorY,ve(ot.anchorX,ot.anchorY),1],D.transformMat4(gt,gt,x)):(gt=[ot.anchorX,ot.anchorY,0,1],xe(gt,gt,x)),!$i(gt,Qe)){ye(ot.numGlyphs,$e);continue}const St=bi(Q.transform.cameraToCenterDistance,gt[3]),It=D.evaluateSizeForFeature(Ce,Se,ot),Lt=Ae?It/St:It*St,Kt=new D.Point(ot.anchorX,ot.anchorY),Rt=mi(Kt,X,ve).point,Jt={projections:{},offsets:{}},Bi=ji(ot,Lt,!1,he,x,X,te,J.glyphOffsetArray,Ze,$e,Rt,Kt,Jt,Ye,pe,ve);dt=Bi.useVertical,(Bi.notEnoughRoom||dt||Bi.needsFlipping&&ji(ot,Lt,!0,he,x,X,te,J.glyphOffsetArray,Ze,$e,Rt,Kt,Jt,Ye,pe,ve).notEnoughRoom)&&ye(ot.numGlyphs,$e)}G?J.text.dynamicLayoutVertexBuffer.updateData($e):J.icon.dynamicLayoutVertexBuffer.updateData($e)}function Ar(J,x,Q,G,X,te,Ae,he,pe,ve,Ce,Se,Qe){const $e=he.glyphStartIndex+he.numGlyphs,Ze=he.lineStartIndex,rt=he.lineStartIndex+he.lineLength,Ye=x.getoffsetX(he.glyphStartIndex),dt=x.getoffsetX($e-1),Bt=Ie(J*Ye,Q,G,X,te,Ae,he.segment,Ze,rt,pe,ve,Ce,Se,Qe);if(!Bt)return null;const ot=Ie(J*dt,Q,G,X,te,Ae,he.segment,Ze,rt,pe,ve,Ce,Se,Qe);return ot?{first:Bt,last:ot}:null}function Tr(J,x,Q,G){return J===D.WritingMode.horizontal&&Math.abs(Q.y-x.y)>Math.abs(Q.x-x.x)*G?{useVertical:!0}:(J===D.WritingMode.vertical?x.y<Q.y:x.x>Q.x)?{needsFlipping:!0}:null}function ji(J,x,Q,G,X,te,Ae,he,pe,ve,Ce,Se,Qe,$e,Ze,rt){const Ye=x/24,dt=J.lineOffsetX*Ye,Bt=J.lineOffsetY*Ye;let ot;if(J.numGlyphs>1){const gt=J.glyphStartIndex+J.numGlyphs,St=J.lineStartIndex,It=J.lineStartIndex+J.lineLength,Lt=Ar(Ye,he,dt,Bt,Q,Ce,Se,J,pe,te,Qe,Ze,rt);if(!Lt)return{notEnoughRoom:!0};const Kt=mi(Lt.first.point,Ae,rt).point,Rt=mi(Lt.last.point,Ae,rt).point;if(G&&!Q){const Jt=Tr(J.writingMode,Kt,Rt,$e);if(Jt)return Jt}ot=[Lt.first];for(let Jt=J.glyphStartIndex+1;Jt<gt-1;Jt++)ot.push(Ie(Ye*he.getoffsetX(Jt),dt,Bt,Q,Ce,Se,J.segment,St,It,pe,te,Qe,Ze,rt));ot.push(Lt.last)}else{if(G&&!Q){const St=mi(Se,X,rt).point,It=J.lineStartIndex+J.segment+1,Lt=new D.Point(pe.getx(It),pe.gety(It)),Kt=mi(Lt,X,rt),Rt=Kt.signedDistanceFromCamera>0?Kt.point:Ii(Se,Lt,St,1,X,rt),Jt=Tr(J.writingMode,St,Rt,$e);if(Jt)return Jt}const gt=Ie(Ye*he.getoffsetX(J.glyphStartIndex),dt,Bt,Q,Ce,Se,J.segment,J.lineStartIndex,J.lineStartIndex+J.lineLength,pe,te,Qe,Ze,rt);if(!gt)return{notEnoughRoom:!0};ot=[gt]}for(const gt of ot)D.addDynamicAttributes(ve,gt.point,gt.angle);return{}}function Ii(J,x,Q,G,X,te){const Ae=mi(J.add(J.sub(x)._unit()),X,te).point,he=Q.sub(Ae);return Q.add(he._mult(G/he.mag()))}function Qs(J,x){const{projectionCache:Q,lineVertexArray:G,labelPlaneMatrix:X,tileAnchorPoint:te,distanceFromAnchor:Ae,getElevation:he,previousVertex:pe,direction:ve,absOffsetX:Ce}=x;if(Q.projections[J])return Q.projections[J];const Se=new D.Point(G.getx(J),G.gety(J)),Qe=mi(Se,X,he);if(Qe.signedDistanceFromCamera>0)return Q.projections[J]=Qe.point,Qe.point;const $e=J-ve;return Ii(Ae===0?te:new D.Point(G.getx($e),G.gety($e)),Se,pe,Ce-Ae+1,X,he)}function $r(J,x,Q){return J._unit()._perp()._mult(x*Q)}function it(J,x,Q,G,X,te,Ae,he){const{projectionCache:pe,direction:ve}=he;if(pe.offsets[J])return pe.offsets[J];const Ce=Q.add(x);if(J+ve<G||J+ve>=X)return pe.offsets[J]=Ce,Ce;const Se=Qs(J+ve,he),Qe=$r(Se.sub(Q),Ae,ve),$e=Q.add(Qe),Ze=Se.add(Qe);return pe.offsets[J]=D.findLineIntersection(te,Ce,$e,Ze)||Ce,pe.offsets[J]}function Ie(J,x,Q,G,X,te,Ae,he,pe,ve,Ce,Se,Qe,$e){const Ze=G?J-x:J+x;let rt=Ze>0?1:-1,Ye=0;G&&(rt*=-1,Ye=Math.PI),rt<0&&(Ye+=Math.PI);let dt,Bt,ot=rt>0?he+Ae:he+Ae+1,gt=X,St=X,It=0,Lt=0;const Kt=Math.abs(Ze),Rt=[];let Jt;for(;It+Lt<=Kt;){if(ot+=rt,ot<he||ot>=pe)return null;It+=Lt,St=gt,Bt=dt;const oi={projectionCache:Se,lineVertexArray:ve,labelPlaneMatrix:Ce,tileAnchorPoint:te,distanceFromAnchor:It,getElevation:$e,previousVertex:St,direction:rt,absOffsetX:Kt};if(gt=Qs(ot,oi),Q===0)Rt.push(St),Jt=gt.sub(St);else{let ki;const xi=gt.sub(St);ki=xi.mag()===0?$r(Qs(ot+rt,oi).sub(gt),Q,rt):$r(xi,Q,rt),Bt||(Bt=St.add(ki)),dt=it(ot,ki,gt,he,pe,Bt,Q,oi),Rt.push(Bt),Jt=dt.sub(Bt)}Lt=Jt.mag()}const Bi=Jt._mult((Kt-It)/Lt)._add(Bt||St),ar=Ye+Math.atan2(gt.y-St.y,gt.x-St.x);return Rt.push(Bi),{point:Bi,angle:Qe?ar:0,path:Rt}}const ce=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ye(J,x){for(let Q=0;Q<J;Q++){const G=x.length;x.resize(G+4),x.float32.set(ce,3*G)}}function xe(J,x,Q){const G=x[0],X=x[1];return J[0]=Q[0]*G+Q[4]*X+Q[12],J[1]=Q[1]*G+Q[5]*X+Q[13],J[3]=Q[3]*G+Q[7]*X+Q[15],J}const Me=100;class Ge{constructor(x,Q=new Ti(x.width+200,x.height+200,25),G=new Ti(x.width+200,x.height+200,25)){this.transform=x,this.grid=Q,this.ignoredGrid=G,this.pitchfactor=Math.cos(x._pitch)*x.cameraToCenterDistance,this.screenRightBoundary=x.width+Me,this.screenBottomBoundary=x.height+Me,this.gridRightBoundary=x.width+200,this.gridBottomBoundary=x.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(x,Q,G,X,te,Ae){const he=this.projectAndGetPerspectiveRatio(X,x.anchorPointX,x.anchorPointY,Ae),pe=G*he.perspectiveRatio,ve=x.x1*pe+he.point.x,Ce=x.y1*pe+he.point.y,Se=x.x2*pe+he.point.x,Qe=x.y2*pe+he.point.y;return!this.isInsideGrid(ve,Ce,Se,Qe)||Q!=="always"&&this.grid.hitTest(ve,Ce,Se,Qe,Q,te)||he.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[ve,Ce,Se,Qe],offscreen:this.isOffscreen(ve,Ce,Se,Qe)}}placeCollisionCircles(x,Q,G,X,te,Ae,he,pe,ve,Ce,Se,Qe,$e,Ze){const rt=[],Ye=new D.Point(Q.anchorX,Q.anchorY),dt=mi(Ye,Ae,Ze),Bt=bi(this.transform.cameraToCenterDistance,dt.signedDistanceFromCamera),ot=(Ce?te/Bt:te*Bt)/D.ONE_EM,gt=mi(Ye,he,Ze).point,St=Ar(ot,X,Q.lineOffsetX*ot,Q.lineOffsetY*ot,!1,gt,Ye,Q,G,he,{projections:{},offsets:{}},!1,Ze);let It=!1,Lt=!1,Kt=!0;if(St){const Rt=.5*Qe*Bt+$e,Jt=new D.Point(-100,-100),Bi=new D.Point(this.screenRightBoundary,this.screenBottomBoundary),ar=new Ot,oi=St.first,ki=St.last;let xi=[];for(let Mi=oi.path.length-1;Mi>=1;Mi--)xi.push(oi.path[Mi]);for(let Mi=1;Mi<ki.path.length;Mi++)xi.push(ki.path[Mi]);const Hr=2.5*Rt;if(pe){const Mi=xi.map(lr=>mi(lr,pe,Ze));xi=Mi.some(lr=>lr.signedDistanceFromCamera<=0)?[]:Mi.map(lr=>lr.point)}let or=[];if(xi.length>0){const Mi=xi[0].clone(),lr=xi[0].clone();for(let Kr=1;Kr<xi.length;Kr++)Mi.x=Math.min(Mi.x,xi[Kr].x),Mi.y=Math.min(Mi.y,xi[Kr].y),lr.x=Math.max(lr.x,xi[Kr].x),lr.y=Math.max(lr.y,xi[Kr].y);or=Mi.x>=Jt.x&&lr.x<=Bi.x&&Mi.y>=Jt.y&&lr.y<=Bi.y?[xi]:lr.x<Jt.x||Mi.x>Bi.x||lr.y<Jt.y||Mi.y>Bi.y?[]:D.clipLine([xi],Jt.x,Jt.y,Bi.x,Bi.y)}for(const Mi of or){ar.reset(Mi,.25*Rt);let lr=0;lr=ar.length<=.5*Rt?1:Math.ceil(ar.paddedLength/Hr)+1;for(let Kr=0;Kr<lr;Kr++){const kr=Kr/Math.max(lr-1,1),rn=ar.lerp(kr),ws=rn.x+Me,Zr=rn.y+Me;rt.push(ws,Zr,Rt,0);const Vs=ws-Rt,Un=Zr-Rt,bn=ws+Rt,Mn=Zr+Rt;if(Kt=Kt&&this.isOffscreen(Vs,Un,bn,Mn),Lt=Lt||this.isInsideGrid(Vs,Un,bn,Mn),x!=="always"&&this.grid.hitTestCircle(ws,Zr,Rt,x,Se)&&(It=!0,!ve))return{circles:[],offscreen:!1,collisionDetected:It}}}}return{circles:!ve&&It||!Lt||Bt<this.perspectiveRatioCutoff?[]:rt,offscreen:Kt,collisionDetected:It}}queryRenderedSymbols(x){if(x.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const Q=[];let G=1/0,X=1/0,te=-1/0,Ae=-1/0;for(const Ce of x){const Se=new D.Point(Ce.x+Me,Ce.y+Me);G=Math.min(G,Se.x),X=Math.min(X,Se.y),te=Math.max(te,Se.x),Ae=Math.max(Ae,Se.y),Q.push(Se)}const he=this.grid.query(G,X,te,Ae).concat(this.ignoredGrid.query(G,X,te,Ae)),pe={},ve={};for(const Ce of he){const Se=Ce.key;if(pe[Se.bucketInstanceId]===void 0&&(pe[Se.bucketInstanceId]={}),pe[Se.bucketInstanceId][Se.featureIndex])continue;const Qe=[new D.Point(Ce.x1,Ce.y1),new D.Point(Ce.x2,Ce.y1),new D.Point(Ce.x2,Ce.y2),new D.Point(Ce.x1,Ce.y2)];D.polygonIntersectsPolygon(Q,Qe)&&(pe[Se.bucketInstanceId][Se.featureIndex]=!0,ve[Se.bucketInstanceId]===void 0&&(ve[Se.bucketInstanceId]=[]),ve[Se.bucketInstanceId].push(Se.featureIndex))}return ve}insertCollisionBox(x,Q,G,X,te,Ae){(G?this.ignoredGrid:this.grid).insert({bucketInstanceId:X,featureIndex:te,collisionGroupID:Ae,overlapMode:Q},x[0],x[1],x[2],x[3])}insertCollisionCircles(x,Q,G,X,te,Ae){const he=G?this.ignoredGrid:this.grid,pe={bucketInstanceId:X,featureIndex:te,collisionGroupID:Ae,overlapMode:Q};for(let ve=0;ve<x.length;ve+=4)he.insertCircle(pe,x[ve],x[ve+1],x[ve+2])}projectAndGetPerspectiveRatio(x,Q,G,X){let te;return X?(te=[Q,G,X(Q,G),1],D.transformMat4(te,te,x)):(te=[Q,G,0,1],xe(te,te,x)),{point:new D.Point((te[0]/te[3]+1)/2*this.transform.width+Me,(-te[1]/te[3]+1)/2*this.transform.height+Me),perspectiveRatio:.5+this.transform.cameraToCenterDistance/te[3]*.5}}isOffscreen(x,Q,G,X){return G<Me||x>=this.screenRightBoundary||X<Me||Q>this.screenBottomBoundary}isInsideGrid(x,Q,G,X){return G>=0&&x<this.gridRightBoundary&&X>=0&&Q<this.gridBottomBoundary}getViewportMatrix(){const x=D.identity([]);return D.translate(x,x,[-100,-100,0]),x}}function Le(J,x,Q){return x*(D.EXTENT/(J.tileSize*Math.pow(2,Q-J.tileID.overscaledZ)))}class Ke{constructor(x,Q,G,X){this.opacity=x?Math.max(0,Math.min(1,x.opacity+(x.placed?Q:-Q))):X&&G?1:0,this.placed=G}isHidden(){return this.opacity===0&&!this.placed}}class st{constructor(x,Q,G,X,te){this.text=new Ke(x?x.text:null,Q,G,te),this.icon=new Ke(x?x.icon:null,Q,X,te)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class _t{constructor(x,Q,G){this.text=x,this.icon=Q,this.skipFade=G}}class xt{constructor(){this.invProjMatrix=D.create(),this.viewportMatrix=D.create(),this.circles=[]}}class kt{constructor(x,Q,G,X,te){this.bucketInstanceId=x,this.featureIndex=Q,this.sourceLayerIndex=G,this.bucketIndex=X,this.tileID=te}}class ai{constructor(x){this.crossSourceCollisions=x,this.maxGroupID=0,this.collisionGroups={}}get(x){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[x]){const Q=++this.maxGroupID;this.collisionGroups[x]={ID:Q,predicate:G=>G.collisionGroupID===Q}}return this.collisionGroups[x]}}function Di(J,x,Q,G,X){const{horizontalAlign:te,verticalAlign:Ae}=D.getAnchorAlignment(J);return new D.Point(-(te-.5)*x+G[0]*X,-(Ae-.5)*Q+G[1]*X)}function ni(J,x,Q,G,X,te){const{x1:Ae,x2:he,y1:pe,y2:ve,anchorPointX:Ce,anchorPointY:Se}=J,Qe=new D.Point(x,Q);return G&&Qe._rotate(X?te:-te),{x1:Ae+Qe.x,y1:pe+Qe.y,x2:he+Qe.x,y2:ve+Qe.y,anchorPointX:Ce,anchorPointY:Se}}class ei{constructor(x,Q,G,X,te){this.transform=x.clone(),this.terrain=Q,this.collisionIndex=new Ge(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=G,this.retainedQueryData={},this.collisionGroups=new ai(X),this.collisionCircleArrays={},this.prevPlacement=te,te&&(te.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(x,Q,G,X){const te=G.getBucket(Q),Ae=G.latestFeatureIndex;if(!te||!Ae||Q.id!==te.layerIds[0])return;const he=G.collisionBoxArray,pe=te.layers[0].layout,ve=Math.pow(2,this.transform.zoom-G.tileID.overscaledZ),Ce=G.tileSize/D.EXTENT,Se=this.transform.calculatePosMatrix(G.tileID.toUnwrapped()),Qe=pe.get("text-pitch-alignment")==="map",$e=pe.get("text-rotation-alignment")==="map",Ze=Le(G,1,this.transform.zoom),rt=Wi(Se,Qe,$e,this.transform,Ze);let Ye=null;if(Qe){const Bt=Zt(Se,Qe,$e,this.transform,Ze);Ye=D.multiply([],this.transform.labelPlaneMatrix,Bt)}this.retainedQueryData[te.bucketInstanceId]=new kt(te.bucketInstanceId,Ae,te.sourceLayerIndex,te.index,G.tileID);const dt={bucket:te,layout:pe,posMatrix:Se,textLabelPlaneMatrix:rt,labelToScreenMatrix:Ye,scale:ve,textPixelRatio:Ce,holdingForFade:G.holdingForFade(),collisionBoxArray:he,partiallyEvaluatedTextSize:D.evaluateSizeForZoom(te.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(te.sourceID)};if(X)for(const Bt of te.sortKeyRanges){const{sortKey:ot,symbolInstanceStart:gt,symbolInstanceEnd:St}=Bt;x.push({sortKey:ot,symbolInstanceStart:gt,symbolInstanceEnd:St,parameters:dt})}else x.push({symbolInstanceStart:0,symbolInstanceEnd:te.symbolInstances.length,parameters:dt})}attemptAnchorPlacement(x,Q,G,X,te,Ae,he,pe,ve,Ce,Se,Qe,$e,Ze,rt,Ye){const dt=D.TextAnchorEnum[x.textAnchor],Bt=[x.textOffset0,x.textOffset1],ot=Di(dt,G,X,Bt,te),gt=this.collisionIndex.placeCollisionBox(ni(Q,ot.x,ot.y,Ae,he,this.transform.angle),Se,pe,ve,Ce.predicate,Ye);if((!rt||this.collisionIndex.placeCollisionBox(ni(rt,ot.x,ot.y,Ae,he,this.transform.angle),Se,pe,ve,Ce.predicate,Ye).box.length!==0)&&gt.box.length>0){let St;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Qe.crossTileID]&&this.prevPlacement.placements[Qe.crossTileID]&&this.prevPlacement.placements[Qe.crossTileID].text&&(St=this.prevPlacement.variableOffsets[Qe.crossTileID].anchor),Qe.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[Qe.crossTileID]={textOffset:Bt,width:G,height:X,anchor:dt,textBoxScale:te,prevAnchor:St},this.markUsedJustification($e,dt,Qe,Ze),$e.allowVerticalPlacement&&(this.markUsedOrientation($e,Ze,Qe),this.placedOrientations[Qe.crossTileID]=Ze),{shift:ot,placedGlyphBoxes:gt}}}placeLayerBucketPart(x,Q,G){const{bucket:X,layout:te,posMatrix:Ae,textLabelPlaneMatrix:he,labelToScreenMatrix:pe,textPixelRatio:ve,holdingForFade:Ce,collisionBoxArray:Se,partiallyEvaluatedTextSize:Qe,collisionGroup:$e}=x.parameters,Ze=te.get("text-optional"),rt=te.get("icon-optional"),Ye=D.getOverlapMode(te,"text-overlap","text-allow-overlap"),dt=Ye==="always",Bt=D.getOverlapMode(te,"icon-overlap","icon-allow-overlap"),ot=Bt==="always",gt=te.get("text-rotation-alignment")==="map",St=te.get("text-pitch-alignment")==="map",It=te.get("icon-text-fit")!=="none",Lt=te.get("symbol-z-order")==="viewport-y",Kt=dt&&(ot||!X.hasIconData()||rt),Rt=ot&&(dt||!X.hasTextData()||Ze);!X.collisionArrays&&Se&&X.deserializeCollisionBoxes(Se);const Jt=this.retainedQueryData[X.bucketInstanceId].tileID,Bi=this.terrain?(oi,ki)=>this.terrain.getElevation(Jt,oi,ki):null,ar=(oi,ki)=>{var xi,Hr;if(Q[oi.crossTileID])return;if(Ce)return void(this.placements[oi.crossTileID]=new _t(!1,!1,!1));let or=!1,Mi=!1,lr=!0,Kr=null,kr={box:null,offscreen:null},rn={box:null,offscreen:null},ws=null,Zr=null,Vs=null,Un=0,bn=0,Mn=0;ki.textFeatureIndex?Un=ki.textFeatureIndex:oi.useRuntimeCollisionCircles&&(Un=oi.featureIndex),ki.verticalTextFeatureIndex&&(bn=ki.verticalTextFeatureIndex);const fo=ki.textBox;if(fo){const is=hs=>{let as=D.WritingMode.horizontal;if(X.allowVerticalPlacement&&!hs&&this.prevPlacement){const Es=this.prevPlacement.placedOrientations[oi.crossTileID];Es&&(this.placedOrientations[oi.crossTileID]=Es,as=Es,this.markUsedOrientation(X,as,oi))}return as},cs=(hs,as)=>{if(X.allowVerticalPlacement&&oi.numVerticalGlyphVertices>0&&ki.verticalTextBox){for(const Es of X.writingModes)if(Es===D.WritingMode.vertical?(kr=as(),rn=kr):kr=hs(),kr&&kr.box&&kr.box.length)break}else kr=hs()},Cs=oi.textAnchorOffsetStartIndex,po=oi.textAnchorOffsetEndIndex;if(po===Cs){const hs=(as,Es)=>{const Gr=this.collisionIndex.placeCollisionBox(as,Ye,ve,Ae,$e.predicate,Bi);return Gr&&Gr.box&&Gr.box.length&&(this.markUsedOrientation(X,Es,oi),this.placedOrientations[oi.crossTileID]=Es),Gr};cs(()=>hs(fo,D.WritingMode.horizontal),()=>{const as=ki.verticalTextBox;return X.allowVerticalPlacement&&oi.numVerticalGlyphVertices>0&&as?hs(as,D.WritingMode.vertical):{box:null,offscreen:null}}),is(kr&&kr.box&&kr.box.length)}else{let hs=D.TextAnchorEnum[(Hr=(xi=this.prevPlacement)===null||xi===void 0?void 0:xi.variableOffsets[oi.crossTileID])===null||Hr===void 0?void 0:Hr.anchor];const as=(Gr,Yn,wn)=>{const _a=Gr.x2-Gr.x1,Gl=Gr.y2-Gr.y1,Ka=oi.textBoxScale,fA=It&&Bt==="never"?Yn:null;let Ga={box:[],offscreen:!1},Xr=Ye==="never"?1:2,sl="never";hs&&Xr++;for(let El=0;El<Xr;El++){for(let jn=Cs;jn<po;jn++){const ya=X.textAnchorOffsets.get(jn);if(hs&&ya.textAnchor!==hs)continue;const go=this.attemptAnchorPlacement(ya,Gr,_a,Gl,Ka,gt,St,ve,Ae,$e,sl,oi,X,wn,fA,Bi);if(go&&(Ga=go.placedGlyphBoxes,Ga&&Ga.box&&Ga.box.length))return or=!0,Kr=go.shift,Ga}hs?hs=null:sl=Ye}return Ga};cs(()=>as(fo,ki.iconBox,D.WritingMode.horizontal),()=>{const Gr=ki.verticalTextBox;return X.allowVerticalPlacement&&!(kr&&kr.box&&kr.box.length)&&oi.numVerticalGlyphVertices>0&&Gr?as(Gr,ki.verticalIconBox,D.WritingMode.vertical):{box:null,offscreen:null}}),kr&&(or=kr.box,lr=kr.offscreen);const Es=is(kr&&kr.box);if(!or&&this.prevPlacement){const Gr=this.prevPlacement.variableOffsets[oi.crossTileID];Gr&&(this.variableOffsets[oi.crossTileID]=Gr,this.markUsedJustification(X,Gr.anchor,oi,Es))}}}if(ws=kr,or=ws&&ws.box&&ws.box.length>0,lr=ws&&ws.offscreen,oi.useRuntimeCollisionCircles){const is=X.text.placedSymbolArray.get(oi.centerJustifiedTextSymbolIndex),cs=D.evaluateSizeForFeature(X.textSizeData,Qe,is),Cs=te.get("text-padding");Zr=this.collisionIndex.placeCollisionCircles(Ye,is,X.lineVertexArray,X.glyphOffsetArray,cs,Ae,he,pe,G,St,$e.predicate,oi.collisionCircleDiameter,Cs,Bi),Zr.circles.length&&Zr.collisionDetected&&!G&&D.warnOnce("Collisions detected, but collision boxes are not shown"),or=dt||Zr.circles.length>0&&!Zr.collisionDetected,lr=lr&&Zr.offscreen}if(ki.iconFeatureIndex&&(Mn=ki.iconFeatureIndex),ki.iconBox){const is=cs=>{const Cs=It&&Kr?ni(cs,Kr.x,Kr.y,gt,St,this.transform.angle):cs;return this.collisionIndex.placeCollisionBox(Cs,Bt,ve,Ae,$e.predicate,Bi)};rn&&rn.box&&rn.box.length&&ki.verticalIconBox?(Vs=is(ki.verticalIconBox),Mi=Vs.box.length>0):(Vs=is(ki.iconBox),Mi=Vs.box.length>0),lr=lr&&Vs.offscreen}const ma=Ze||oi.numHorizontalGlyphVertices===0&&oi.numVerticalGlyphVertices===0,Xn=rt||oi.numIconVertices===0;if(ma||Xn?Xn?ma||(Mi=Mi&&or):or=Mi&&or:Mi=or=Mi&&or,or&&ws&&ws.box&&this.collisionIndex.insertCollisionBox(ws.box,Ye,te.get("text-ignore-placement"),X.bucketInstanceId,rn&&rn.box&&bn?bn:Un,$e.ID),Mi&&Vs&&this.collisionIndex.insertCollisionBox(Vs.box,Bt,te.get("icon-ignore-placement"),X.bucketInstanceId,Mn,$e.ID),Zr&&(or&&this.collisionIndex.insertCollisionCircles(Zr.circles,Ye,te.get("text-ignore-placement"),X.bucketInstanceId,Un,$e.ID),G)){const is=X.bucketInstanceId;let cs=this.collisionCircleArrays[is];cs===void 0&&(cs=this.collisionCircleArrays[is]=new xt);for(let Cs=0;Cs<Zr.circles.length;Cs+=4)cs.circles.push(Zr.circles[Cs+0]),cs.circles.push(Zr.circles[Cs+1]),cs.circles.push(Zr.circles[Cs+2]),cs.circles.push(Zr.collisionDetected?1:0)}if(oi.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(X.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[oi.crossTileID]=new _t(or||Kt,Mi||Rt,lr||X.justReloaded),Q[oi.crossTileID]=!0};if(Lt){if(x.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const oi=X.getSortedSymbolIndexes(this.transform.angle);for(let ki=oi.length-1;ki>=0;--ki){const xi=oi[ki];ar(X.symbolInstances.get(xi),X.collisionArrays[xi])}}else for(let oi=x.symbolInstanceStart;oi<x.symbolInstanceEnd;oi++)ar(X.symbolInstances.get(oi),X.collisionArrays[oi]);if(G&&X.bucketInstanceId in this.collisionCircleArrays){const oi=this.collisionCircleArrays[X.bucketInstanceId];D.invert(oi.invProjMatrix,Ae),oi.viewportMatrix=this.collisionIndex.getViewportMatrix()}X.justReloaded=!1}markUsedJustification(x,Q,G,X){let te;te=X===D.WritingMode.vertical?G.verticalPlacedTextSymbolIndex:{left:G.leftJustifiedTextSymbolIndex,center:G.centerJustifiedTextSymbolIndex,right:G.rightJustifiedTextSymbolIndex}[D.getAnchorJustification(Q)];const Ae=[G.leftJustifiedTextSymbolIndex,G.centerJustifiedTextSymbolIndex,G.rightJustifiedTextSymbolIndex,G.verticalPlacedTextSymbolIndex];for(const he of Ae)he>=0&&(x.text.placedSymbolArray.get(he).crossTileID=te>=0&&he!==te?0:G.crossTileID)}markUsedOrientation(x,Q,G){const X=Q===D.WritingMode.horizontal||Q===D.WritingMode.horizontalOnly?Q:0,te=Q===D.WritingMode.vertical?Q:0,Ae=[G.leftJustifiedTextSymbolIndex,G.centerJustifiedTextSymbolIndex,G.rightJustifiedTextSymbolIndex];for(const he of Ae)x.text.placedSymbolArray.get(he).placedOrientation=X;G.verticalPlacedTextSymbolIndex&&(x.text.placedSymbolArray.get(G.verticalPlacedTextSymbolIndex).placedOrientation=te)}commit(x){this.commitTime=x,this.zoomAtLastRecencyCheck=this.transform.zoom;const Q=this.prevPlacement;let G=!1;this.prevZoomAdjustment=Q?Q.zoomAdjustment(this.transform.zoom):0;const X=Q?Q.symbolFadeChange(x):1,te=Q?Q.opacities:{},Ae=Q?Q.variableOffsets:{},he=Q?Q.placedOrientations:{};for(const pe in this.placements){const ve=this.placements[pe],Ce=te[pe];Ce?(this.opacities[pe]=new st(Ce,X,ve.text,ve.icon),G=G||ve.text!==Ce.text.placed||ve.icon!==Ce.icon.placed):(this.opacities[pe]=new st(null,X,ve.text,ve.icon,ve.skipFade),G=G||ve.text||ve.icon)}for(const pe in te){const ve=te[pe];if(!this.opacities[pe]){const Ce=new st(ve,X,!1,!1);Ce.isHidden()||(this.opacities[pe]=Ce,G=G||ve.text.placed||ve.icon.placed)}}for(const pe in Ae)this.variableOffsets[pe]||!this.opacities[pe]||this.opacities[pe].isHidden()||(this.variableOffsets[pe]=Ae[pe]);for(const pe in he)this.placedOrientations[pe]||!this.opacities[pe]||this.opacities[pe].isHidden()||(this.placedOrientations[pe]=he[pe]);if(Q&&Q.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");G?this.lastPlacementChangeTime=x:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=Q?Q.lastPlacementChangeTime:x)}updateLayerOpacities(x,Q){const G={};for(const X of Q){const te=X.getBucket(x);te&&X.latestFeatureIndex&&x.id===te.layerIds[0]&&this.updateBucketOpacities(te,G,X.collisionBoxArray)}}updateBucketOpacities(x,Q,G){x.hasTextData()&&(x.text.opacityVertexArray.clear(),x.text.hasVisibleVertices=!1),x.hasIconData()&&(x.icon.opacityVertexArray.clear(),x.icon.hasVisibleVertices=!1),x.hasIconCollisionBoxData()&&x.iconCollisionBox.collisionVertexArray.clear(),x.hasTextCollisionBoxData()&&x.textCollisionBox.collisionVertexArray.clear();const X=x.layers[0],te=X.layout,Ae=new st(null,0,!1,!1,!0),he=te.get("text-allow-overlap"),pe=te.get("icon-allow-overlap"),ve=X._unevaluatedLayout.hasValue("text-variable-anchor")||X._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ce=te.get("text-rotation-alignment")==="map",Se=te.get("text-pitch-alignment")==="map",Qe=te.get("icon-text-fit")!=="none",$e=new st(null,0,he&&(pe||!x.hasIconData()||te.get("icon-optional")),pe&&(he||!x.hasTextData()||te.get("text-optional")),!0);!x.collisionArrays&&G&&(x.hasIconCollisionBoxData()||x.hasTextCollisionBoxData())&&x.deserializeCollisionBoxes(G);const Ze=(rt,Ye,dt)=>{for(let Bt=0;Bt<Ye/4;Bt++)rt.opacityVertexArray.emplaceBack(dt);rt.hasVisibleVertices=rt.hasVisibleVertices||dt!==Zi};for(let rt=0;rt<x.symbolInstances.length;rt++){const Ye=x.symbolInstances.get(rt),{numHorizontalGlyphVertices:dt,numVerticalGlyphVertices:Bt,crossTileID:ot}=Ye;let gt=this.opacities[ot];Q[ot]?gt=Ae:gt||(gt=$e,this.opacities[ot]=gt),Q[ot]=!0;const St=Ye.numIconVertices>0,It=this.placedOrientations[Ye.crossTileID],Lt=It===D.WritingMode.vertical,Kt=It===D.WritingMode.horizontal||It===D.WritingMode.horizontalOnly;if(dt>0||Bt>0){const Rt=Pr(gt.text);Ze(x.text,dt,Lt?Zi:Rt),Ze(x.text,Bt,Kt?Zi:Rt);const Jt=gt.text.isHidden();[Ye.rightJustifiedTextSymbolIndex,Ye.centerJustifiedTextSymbolIndex,Ye.leftJustifiedTextSymbolIndex].forEach(oi=>{oi>=0&&(x.text.placedSymbolArray.get(oi).hidden=Jt||Lt?1:0)}),Ye.verticalPlacedTextSymbolIndex>=0&&(x.text.placedSymbolArray.get(Ye.verticalPlacedTextSymbolIndex).hidden=Jt||Kt?1:0);const Bi=this.variableOffsets[Ye.crossTileID];Bi&&this.markUsedJustification(x,Bi.anchor,Ye,It);const ar=this.placedOrientations[Ye.crossTileID];ar&&(this.markUsedJustification(x,"left",Ye,ar),this.markUsedOrientation(x,ar,Ye))}if(St){const Rt=Pr(gt.icon),Jt=!(Qe&&Ye.verticalPlacedIconSymbolIndex&&Lt);Ye.placedIconSymbolIndex>=0&&(Ze(x.icon,Ye.numIconVertices,Jt?Rt:Zi),x.icon.placedSymbolArray.get(Ye.placedIconSymbolIndex).hidden=gt.icon.isHidden()),Ye.verticalPlacedIconSymbolIndex>=0&&(Ze(x.icon,Ye.numVerticalIconVertices,Jt?Zi:Rt),x.icon.placedSymbolArray.get(Ye.verticalPlacedIconSymbolIndex).hidden=gt.icon.isHidden())}if(x.hasIconCollisionBoxData()||x.hasTextCollisionBoxData()){const Rt=x.collisionArrays[rt];if(Rt){let Jt=new D.Point(0,0);if(Rt.textBox||Rt.verticalTextBox){let ar=!0;if(ve){const oi=this.variableOffsets[ot];oi?(Jt=Di(oi.anchor,oi.width,oi.height,oi.textOffset,oi.textBoxScale),Ce&&Jt._rotate(Se?this.transform.angle:-this.transform.angle)):ar=!1}Rt.textBox&&Ui(x.textCollisionBox.collisionVertexArray,gt.text.placed,!ar||Lt,Jt.x,Jt.y),Rt.verticalTextBox&&Ui(x.textCollisionBox.collisionVertexArray,gt.text.placed,!ar||Kt,Jt.x,Jt.y)}const Bi=!!(!Kt&&Rt.verticalIconBox);Rt.iconBox&&Ui(x.iconCollisionBox.collisionVertexArray,gt.icon.placed,Bi,Qe?Jt.x:0,Qe?Jt.y:0),Rt.verticalIconBox&&Ui(x.iconCollisionBox.collisionVertexArray,gt.icon.placed,!Bi,Qe?Jt.x:0,Qe?Jt.y:0)}}}if(x.sortFeatures(this.transform.angle),this.retainedQueryData[x.bucketInstanceId]&&(this.retainedQueryData[x.bucketInstanceId].featureSortOrder=x.featureSortOrder),x.hasTextData()&&x.text.opacityVertexBuffer&&x.text.opacityVertexBuffer.updateData(x.text.opacityVertexArray),x.hasIconData()&&x.icon.opacityVertexBuffer&&x.icon.opacityVertexBuffer.updateData(x.icon.opacityVertexArray),x.hasIconCollisionBoxData()&&x.iconCollisionBox.collisionVertexBuffer&&x.iconCollisionBox.collisionVertexBuffer.updateData(x.iconCollisionBox.collisionVertexArray),x.hasTextCollisionBoxData()&&x.textCollisionBox.collisionVertexBuffer&&x.textCollisionBox.collisionVertexBuffer.updateData(x.textCollisionBox.collisionVertexArray),x.text.opacityVertexArray.length!==x.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${x.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${x.text.layoutVertexArray.length}) / 4`);if(x.icon.opacityVertexArray.length!==x.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${x.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${x.icon.layoutVertexArray.length}) / 4`);if(x.bucketInstanceId in this.collisionCircleArrays){const rt=this.collisionCircleArrays[x.bucketInstanceId];x.placementInvProjMatrix=rt.invProjMatrix,x.placementViewportMatrix=rt.viewportMatrix,x.collisionCircleArray=rt.circles,delete this.collisionCircleArrays[x.bucketInstanceId]}}symbolFadeChange(x){return this.fadeDuration===0?1:(x-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(x){return Math.max(0,(this.transform.zoom-x)/1.5)}hasTransitions(x){return this.stale||x-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(x,Q){const G=this.zoomAtLastRecencyCheck===Q?1-this.zoomAdjustment(Q):1;return this.zoomAtLastRecencyCheck=Q,this.commitTime+this.fadeDuration*G>x}setStale(){this.stale=!0}}function Ui(J,x,Q,G,X){J.emplaceBack(x?1:0,Q?1:0,G||0,X||0),J.emplaceBack(x?1:0,Q?1:0,G||0,X||0),J.emplaceBack(x?1:0,Q?1:0,G||0,X||0),J.emplaceBack(x?1:0,Q?1:0,G||0,X||0)}const Qi=Math.pow(2,25),hr=Math.pow(2,24),Ki=Math.pow(2,17),Xt=Math.pow(2,16),br=Math.pow(2,9),wi=Math.pow(2,8),Ir=Math.pow(2,1);function Pr(J){if(J.opacity===0&&!J.placed)return 0;if(J.opacity===1&&J.placed)return 4294967295;const x=J.placed?1:0,Q=Math.floor(127*J.opacity);return Q*Qi+x*hr+Q*Ki+x*Xt+Q*br+x*wi+Q*Ir+x}const Zi=0;class pi{constructor(x){this._sortAcrossTiles=x.layout.get("symbol-z-order")!=="viewport-y"&&!x.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(x,Q,G,X,te){const Ae=this._bucketParts;for(;this._currentTileIndex<x.length;)if(Q.getBucketParts(Ae,X,x[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,te())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,Ae.sort((he,pe)=>he.sortKey-pe.sortKey));this._currentPartIndex<Ae.length;)if(Q.placeLayerBucketPart(Ae[this._currentPartIndex],this._seenCrossTileIDs,G),this._currentPartIndex++,te())return!0;return!1}}class _s{constructor(x,Q,G,X,te,Ae,he,pe){this.placement=new ei(x,Q,Ae,he,pe),this._currentPlacementIndex=G.length-1,this._forceFullPlacement=X,this._showCollisionBoxes=te,this._done=!1}isDone(){return this._done}continuePlacement(x,Q,G){const X=D.browser.now(),te=()=>!this._forceFullPlacement&&D.browser.now()-X>2;for(;this._currentPlacementIndex>=0;){const Ae=Q[x[this._currentPlacementIndex]],he=this.placement.collisionIndex.transform.zoom;if(Ae.type==="symbol"&&(!Ae.minzoom||Ae.minzoom<=he)&&(!Ae.maxzoom||Ae.maxzoom>he)){if(this._inProgressLayer||(this._inProgressLayer=new pi(Ae)),this._inProgressLayer.continuePlacement(G[Ae.source],this.placement,this._showCollisionBoxes,Ae,te))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(x){return this.placement.commit(x),this.placement}}const dr=512/D.EXTENT/2;class Dt{constructor(x,Q,G){this.tileID=x,this.bucketInstanceId=G,this._symbolsByKey={};const X=new Map;for(let te=0;te<Q.length;te++){const Ae=Q.get(te),he=Ae.key,pe=X.get(he);pe?pe.push(Ae):X.set(he,[Ae])}for(const[te,Ae]of X){const he={positions:Ae.map(pe=>({x:Math.floor(pe.anchorX*dr),y:Math.floor(pe.anchorY*dr)})),crossTileIDs:Ae.map(pe=>pe.crossTileID)};if(he.positions.length>128){const pe=new D.KDBush(he.positions.length,16,Uint16Array);for(const{x:ve,y:Ce}of he.positions)pe.add(ve,Ce);pe.finish(),delete he.positions,he.index=pe}this._symbolsByKey[te]=he}}getScaledCoordinates(x,Q){const{x:G,y:X,z:te}=this.tileID.canonical,{x:Ae,y:he,z:pe}=Q.canonical,ve=dr/Math.pow(2,pe-te),Ce=(he*D.EXTENT+x.anchorY)*ve,Se=X*D.EXTENT*dr;return{x:Math.floor((Ae*D.EXTENT+x.anchorX)*ve-G*D.EXTENT*dr),y:Math.floor(Ce-Se)}}findMatches(x,Q,G){const X=this.tileID.canonical.z<Q.canonical.z?1:Math.pow(2,this.tileID.canonical.z-Q.canonical.z);for(let te=0;te<x.length;te++){const Ae=x.get(te);if(Ae.crossTileID)continue;const he=this._symbolsByKey[Ae.key];if(!he)continue;const pe=this.getScaledCoordinates(Ae,Q);if(he.index){const ve=he.index.range(pe.x-X,pe.y-X,pe.x+X,pe.y+X).sort();for(const Ce of ve){const Se=he.crossTileIDs[Ce];if(!G[Se]){G[Se]=!0,Ae.crossTileID=Se;break}}}else if(he.positions)for(let ve=0;ve<he.positions.length;ve++){const Ce=he.positions[ve],Se=he.crossTileIDs[ve];if(Math.abs(Ce.x-pe.x)<=X&&Math.abs(Ce.y-pe.y)<=X&&!G[Se]){G[Se]=!0,Ae.crossTileID=Se;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:x})=>x)}}class Yr{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ys{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(x){const Q=Math.round((x-this.lng)/360);if(Q!==0)for(const G in this.indexes){const X=this.indexes[G],te={};for(const Ae in X){const he=X[Ae];he.tileID=he.tileID.unwrapTo(he.tileID.wrap+Q),te[he.tileID.key]=he}this.indexes[G]=te}this.lng=x}addBucket(x,Q,G){if(this.indexes[x.overscaledZ]&&this.indexes[x.overscaledZ][x.key]){if(this.indexes[x.overscaledZ][x.key].bucketInstanceId===Q.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(x.overscaledZ,this.indexes[x.overscaledZ][x.key])}for(let te=0;te<Q.symbolInstances.length;te++)Q.symbolInstances.get(te).crossTileID=0;this.usedCrossTileIDs[x.overscaledZ]||(this.usedCrossTileIDs[x.overscaledZ]={});const X=this.usedCrossTileIDs[x.overscaledZ];for(const te in this.indexes){const Ae=this.indexes[te];if(Number(te)>x.overscaledZ)for(const he in Ae){const pe=Ae[he];pe.tileID.isChildOf(x)&&pe.findMatches(Q.symbolInstances,x,X)}else{const he=Ae[x.scaledTo(Number(te)).key];he&&he.findMatches(Q.symbolInstances,x,X)}}for(let te=0;te<Q.symbolInstances.length;te++){const Ae=Q.symbolInstances.get(te);Ae.crossTileID||(Ae.crossTileID=G.generate(),X[Ae.crossTileID]=!0)}return this.indexes[x.overscaledZ]===void 0&&(this.indexes[x.overscaledZ]={}),this.indexes[x.overscaledZ][x.key]=new Dt(x,Q.symbolInstances,Q.bucketInstanceId),!0}removeBucketCrossTileIDs(x,Q){for(const G of Q.getCrossTileIDsLists())for(const X of G)delete this.usedCrossTileIDs[x][X]}removeStaleBuckets(x){let Q=!1;for(const G in this.indexes){const X=this.indexes[G];for(const te in X)x[X[te].bucketInstanceId]||(this.removeBucketCrossTileIDs(G,X[te]),delete X[te],Q=!0)}return Q}}class _r{constructor(){this.layerIndexes={},this.crossTileIDs=new Yr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(x,Q,G){let X=this.layerIndexes[x.id];X===void 0&&(X=this.layerIndexes[x.id]=new Ys);let te=!1;const Ae={};X.handleWrapJump(G);for(const he of Q){const pe=he.getBucket(x);pe&&x.id===pe.layerIds[0]&&(pe.bucketInstanceId||(pe.bucketInstanceId=++this.maxBucketInstanceId),X.addBucket(he.tileID,pe,this.crossTileIDs)&&(te=!0),Ae[pe.bucketInstanceId]=!0)}return X.removeStaleBuckets(Ae)&&(te=!0),te}pruneUnusedLayers(x){const Q={};x.forEach(G=>{Q[G]=!0});for(const G in this.layerIndexes)Q[G]||delete this.layerIndexes[G]}}const Br=(J,x)=>D.emitValidationErrors(J,x&&x.filter(Q=>Q.identifier!=="source.canvas")),Cr=D.pick(D.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),rr=D.pick(D.operations,["setCenter","setZoom","setBearing","setPitch"]),Lr=D.emptyStyle();class sr extends D.Evented{constructor(x,Q={}){super(),this.map=x,this.dispatcher=new S(Vi(),this,x._getMapId()),this.imageManager=new Pt,this.imageManager.setEventedParent(this),this.glyphManager=new Ei(x._requestManager,Q.localIdeographFontFamily),this.lineAtlas=new b(256,512),this.crossTileSymbolIndex=new _r,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new D.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",D.getReferrer());const G=this;this._rtlTextPluginCallback=sr.registerForPluginStateChange(X=>{G.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:X.pluginStatus,pluginURL:X.pluginURL},(te,Ae)=>{if(D.triggerPluginCompletionEvent(te),Ae&&Ae.every(he=>he))for(const he in G.sourceCaches){const pe=G.sourceCaches[he].getSource().type;pe!=="vector"&&pe!=="geojson"||G.sourceCaches[he].reload()}})}),this.on("data",X=>{if(X.dataType!=="source"||X.sourceDataType!=="metadata")return;const te=this.sourceCaches[X.sourceId];if(!te)return;const Ae=te.getSource();if(Ae&&Ae.vectorLayerIds)for(const he in this._layers){const pe=this._layers[he];pe.source===Ae.id&&this._validateLayer(pe)}})}loadURL(x,Q={},G){this.fire(new D.Event("dataloading",{dataType:"style"})),Q.validate=typeof Q.validate!="boolean"||Q.validate;const X=this.map._requestManager.transformRequest(x,We.Style);this._request=D.getJSON(X,(te,Ae)=>{this._request=null,te?this.fire(new D.ErrorEvent(te)):Ae&&this._load(Ae,Q,G)})}loadJSON(x,Q={},G){this.fire(new D.Event("dataloading",{dataType:"style"})),this._request=D.browser.frame(()=>{this._request=null,Q.validate=Q.validate!==!1,this._load(x,Q,G)})}loadEmpty(){this.fire(new D.Event("dataloading",{dataType:"style"})),this._load(Lr,{validate:!1})}_load(x,Q,G){var X;const te=Q.transformStyle?Q.transformStyle(G,x):x;if(!Q.validate||!Br(this,D.validateStyle(te))){this._loaded=!0,this.stylesheet=te;for(const Ae in te.sources)this.addSource(Ae,te.sources[Ae],{validate:!1});te.sprite?this._loadSprite(te.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(te.glyphs),this._createLayers(),this.light=new d(this.stylesheet.light),this.map.setTerrain((X=this.stylesheet.terrain)!==null&&X!==void 0?X:null),this.fire(new D.Event("data",{dataType:"style"})),this.fire(new D.Event("style.load"))}}_createLayers(){const x=D.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",x),this._order=x.map(Q=>Q.id),this._layers={},this._serializedLayers=null;for(const Q of x){const G=D.createStyleLayer(Q);G.setEventedParent(this,{layer:{id:Q.id}}),this._layers[Q.id]=G}}_loadSprite(x,Q=!1,G=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(X,te,Ae,he){const pe=qt(X),ve=pe.length,Ce=Ae>1?"@2x":"",Se={},Qe={},$e={};for(const{id:Ze,url:rt}of pe){const Ye=te.transformRequest(te.normalizeSpriteURL(rt,Ce,".json"),We.SpriteJSON),dt=`${Ze}_${Ye.url}`;Se[dt]=D.getJSON(Ye,(gt,St)=>{delete Se[dt],Qe[Ze]=St,Vt(he,Qe,$e,gt,ve)});const Bt=te.transformRequest(te.normalizeSpriteURL(rt,Ce,".png"),We.SpriteImage),ot=`${Ze}_${Bt.url}`;Se[ot]=Je.getImage(Bt,(gt,St)=>{delete Se[ot],$e[Ze]=St,Vt(he,Qe,$e,gt,ve)})}return{cancel(){for(const Ze of Object.values(Se))Ze.cancel()}}}(x,this.map._requestManager,this.map.getPixelRatio(),(X,te)=>{if(this._spriteRequest=null,X)this.fire(new D.ErrorEvent(X));else if(te)for(const Ae in te){this._spritesImagesIds[Ae]=[];const he=this._spritesImagesIds[Ae]?this._spritesImagesIds[Ae].filter(pe=>!(pe in te)):[];for(const pe of he)this.imageManager.removeImage(pe),this._changedImages[pe]=!0;for(const pe in te[Ae]){const ve=Ae==="default"?pe:`${Ae}:${pe}`;this._spritesImagesIds[Ae].push(ve),ve in this.imageManager.images?this.imageManager.updateImage(ve,te[Ae][pe],!1):this.imageManager.addImage(ve,te[Ae][pe]),Q&&(this._changedImages[ve]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),Q&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new D.Event("data",{dataType:"style"})),G&&G(X)})}_unloadSprite(){for(const x of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(x),this._changedImages[x]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new D.Event("data",{dataType:"style"}))}_validateLayer(x){const Q=this.sourceCaches[x.source];if(!Q)return;const G=x.sourceLayer;if(!G)return;const X=Q.getSource();(X.type==="geojson"||X.vectorLayerIds&&X.vectorLayerIds.indexOf(G)===-1)&&this.fire(new D.ErrorEvent(new Error(`Source layer "${G}" does not exist on source "${X.id}" as specified by style layer "${x.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const x in this.sourceCaches)if(!this.sourceCaches[x].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(x){const Q=this._serializedAllLayers();if(!x||x.length===0)return Object.values(Q);const G=[];for(const X of x)Q[X]&&G.push(Q[X]);return G}_serializedAllLayers(){let x=this._serializedLayers;if(x)return x;x=this._serializedLayers={};const Q=Object.keys(this._layers);for(const G of Q){const X=this._layers[G];X.type!=="custom"&&(x[G]=X.serialize())}return x}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const x in this.sourceCaches)if(this.sourceCaches[x].hasTransition())return!0;for(const x in this._layers)if(this._layers[x].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(x){if(!this._loaded)return;const Q=this._changed;if(this._changed){const X=Object.keys(this._updatedLayers),te=Object.keys(this._removedLayers);(X.length||te.length)&&this._updateWorkerLayers(X,te);for(const Ae in this._updatedSources){const he=this._updatedSources[Ae];if(he==="reload")this._reloadSource(Ae);else{if(he!=="clear")throw new Error(`Invalid action ${he}`);this._clearSource(Ae)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const Ae in this._updatedPaintProps)this._layers[Ae].updateTransitions(x);this.light.updateTransitions(x),this._resetUpdates()}const G={};for(const X in this.sourceCaches){const te=this.sourceCaches[X];G[X]=te.used,te.used=!1}for(const X of this._order){const te=this._layers[X];te.recalculate(x,this._availableImages),!te.isHidden(x.zoom)&&te.source&&(this.sourceCaches[te.source].used=!0)}for(const X in G){const te=this.sourceCaches[X];G[X]!==te.used&&te.fire(new D.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:X}))}this.light.recalculate(x),this.z=x.zoom,Q&&this.fire(new D.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const x=Object.keys(this._changedImages);if(x.length){for(const Q in this.sourceCaches)this.sourceCaches[Q].reloadTilesForDependencies(["icons","patterns"],x);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const x in this.sourceCaches)this.sourceCaches[x].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(x,Q){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(x),removedIds:Q})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(x,Q={}){this._checkLoaded();const G=this.serialize();if(x=Q.transformStyle?Q.transformStyle(G,x):x,Br(this,D.validateStyle(x)))return!1;(x=D.clone$1(x)).layers=D.derefLayers(x.layers);const X=D.diffStyles(G,x).filter(Ae=>!(Ae.command in rr));if(X.length===0)return!1;const te=X.filter(Ae=>!(Ae.command in Cr));if(te.length>0)throw new Error(`Unimplemented: ${te.map(Ae=>Ae.command).join(", ")}.`);for(const Ae of X)Ae.command!=="setTransition"&&this[Ae.command].apply(this,Ae.args);return this.stylesheet=x,!0}addImage(x,Q){if(this.getImage(x))return this.fire(new D.ErrorEvent(new Error(`An image named "${x}" already exists.`)));this.imageManager.addImage(x,Q),this._afterImageUpdated(x)}updateImage(x,Q){this.imageManager.updateImage(x,Q)}getImage(x){return this.imageManager.getImage(x)}removeImage(x){if(!this.getImage(x))return this.fire(new D.ErrorEvent(new Error(`An image named "${x}" does not exist.`)));this.imageManager.removeImage(x),this._afterImageUpdated(x)}_afterImageUpdated(x){this._availableImages=this.imageManager.listImages(),this._changedImages[x]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new D.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(x,Q,G={}){if(this._checkLoaded(),this.sourceCaches[x]!==void 0)throw new Error(`Source "${x}" already exists.`);if(!Q.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(Q).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(Q.type)>=0&&this._validate(D.validateStyle.source,`sources.${x}`,Q,null,G))return;this.map&&this.map._collectResourceTiming&&(Q.collectResourceTiming=!0);const X=this.sourceCaches[x]=new $t(x,Q,this.dispatcher);X.style=this,X.setEventedParent(this,()=>({isSourceLoaded:X.loaded(),source:X.serialize(),sourceId:x})),X.onAdd(this.map),this._changed=!0}removeSource(x){if(this._checkLoaded(),this.sourceCaches[x]===void 0)throw new Error("There is no source with this ID");for(const G in this._layers)if(this._layers[G].source===x)return this.fire(new D.ErrorEvent(new Error(`Source "${x}" cannot be removed while layer "${G}" is using it.`)));const Q=this.sourceCaches[x];delete this.sourceCaches[x],delete this._updatedSources[x],Q.fire(new D.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:x})),Q.setEventedParent(null),Q.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(x,Q){if(this._checkLoaded(),this.sourceCaches[x]===void 0)throw new Error(`There is no source with this ID=${x}`);const G=this.sourceCaches[x].getSource();if(G.type!=="geojson")throw new Error(`geojsonSource.type is ${G.type}, which is !== 'geojson`);G.setData(Q),this._changed=!0}getSource(x){return this.sourceCaches[x]&&this.sourceCaches[x].getSource()}addLayer(x,Q,G={}){this._checkLoaded();const X=x.id;if(this.getLayer(X))return void this.fire(new D.ErrorEvent(new Error(`Layer "${X}" already exists on this map.`)));let te;if(x.type==="custom"){if(Br(this,D.validateCustomStyleLayer(x)))return;te=D.createStyleLayer(x)}else{if("source"in x&&typeof x.source=="object"&&(this.addSource(X,x.source),x=D.clone$1(x),x=D.extend(x,{source:X})),this._validate(D.validateStyle.layer,`layers.${X}`,x,{arrayIndex:-1},G))return;te=D.createStyleLayer(x),this._validateLayer(te),te.setEventedParent(this,{layer:{id:X}})}const Ae=Q?this._order.indexOf(Q):this._order.length;if(Q&&Ae===-1)this.fire(new D.ErrorEvent(new Error(`Cannot add layer "${X}" before non-existing layer "${Q}".`)));else{if(this._order.splice(Ae,0,X),this._layerOrderChanged=!0,this._layers[X]=te,this._removedLayers[X]&&te.source&&te.type!=="custom"){const he=this._removedLayers[X];delete this._removedLayers[X],he.type!==te.type?this._updatedSources[te.source]="clear":(this._updatedSources[te.source]="reload",this.sourceCaches[te.source].pause())}this._updateLayer(te),te.onAdd&&te.onAdd(this.map)}}moveLayer(x,Q){if(this._checkLoaded(),this._changed=!0,!this._layers[x])return void this.fire(new D.ErrorEvent(new Error(`The layer '${x}' does not exist in the map's style and cannot be moved.`)));if(x===Q)return;const G=this._order.indexOf(x);this._order.splice(G,1);const X=Q?this._order.indexOf(Q):this._order.length;Q&&X===-1?this.fire(new D.ErrorEvent(new Error(`Cannot move layer "${x}" before non-existing layer "${Q}".`))):(this._order.splice(X,0,x),this._layerOrderChanged=!0)}removeLayer(x){this._checkLoaded();const Q=this._layers[x];if(!Q)return void this.fire(new D.ErrorEvent(new Error(`Cannot remove non-existing layer "${x}".`)));Q.setEventedParent(null);const G=this._order.indexOf(x);this._order.splice(G,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[x]=Q,delete this._layers[x],this._serializedLayers&&delete this._serializedLayers[x],delete this._updatedLayers[x],delete this._updatedPaintProps[x],Q.onRemove&&Q.onRemove(this.map)}getLayer(x){return this._layers[x]}hasLayer(x){return x in this._layers}setLayerZoomRange(x,Q,G){this._checkLoaded();const X=this.getLayer(x);X?X.minzoom===Q&&X.maxzoom===G||(Q!=null&&(X.minzoom=Q),G!=null&&(X.maxzoom=G),this._updateLayer(X)):this.fire(new D.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${x}".`)))}setFilter(x,Q,G={}){this._checkLoaded();const X=this.getLayer(x);if(X){if(!D.deepEqual(X.filter,Q))return Q==null?(X.filter=void 0,void this._updateLayer(X)):void(this._validate(D.validateStyle.filter,`layers.${X.id}.filter`,Q,null,G)||(X.filter=D.clone$1(Q),this._updateLayer(X)))}else this.fire(new D.ErrorEvent(new Error(`Cannot filter non-existing layer "${x}".`)))}getFilter(x){return D.clone$1(this.getLayer(x).filter)}setLayoutProperty(x,Q,G,X={}){this._checkLoaded();const te=this.getLayer(x);te?D.deepEqual(te.getLayoutProperty(Q),G)||(te.setLayoutProperty(Q,G,X),this._updateLayer(te)):this.fire(new D.ErrorEvent(new Error(`Cannot style non-existing layer "${x}".`)))}getLayoutProperty(x,Q){const G=this.getLayer(x);if(G)return G.getLayoutProperty(Q);this.fire(new D.ErrorEvent(new Error(`Cannot get style of non-existing layer "${x}".`)))}setPaintProperty(x,Q,G,X={}){this._checkLoaded();const te=this.getLayer(x);te?D.deepEqual(te.getPaintProperty(Q),G)||(te.setPaintProperty(Q,G,X)&&this._updateLayer(te),this._changed=!0,this._updatedPaintProps[x]=!0):this.fire(new D.ErrorEvent(new Error(`Cannot style non-existing layer "${x}".`)))}getPaintProperty(x,Q){return this.getLayer(x).getPaintProperty(Q)}setFeatureState(x,Q){this._checkLoaded();const G=x.source,X=x.sourceLayer,te=this.sourceCaches[G];if(te===void 0)return void this.fire(new D.ErrorEvent(new Error(`The source '${G}' does not exist in the map's style.`)));const Ae=te.getSource().type;Ae==="geojson"&&X?this.fire(new D.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):Ae!=="vector"||X?(x.id===void 0&&this.fire(new D.ErrorEvent(new Error("The feature id parameter must be provided."))),te.setFeatureState(X,x.id,Q)):this.fire(new D.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(x,Q){this._checkLoaded();const G=x.source,X=this.sourceCaches[G];if(X===void 0)return void this.fire(new D.ErrorEvent(new Error(`The source '${G}' does not exist in the map's style.`)));const te=X.getSource().type,Ae=te==="vector"?x.sourceLayer:void 0;te!=="vector"||Ae?Q&&typeof x.id!="string"&&typeof x.id!="number"?this.fire(new D.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):X.removeFeatureState(Ae,x.id,Q):this.fire(new D.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(x){this._checkLoaded();const Q=x.source,G=x.sourceLayer,X=this.sourceCaches[Q];if(X!==void 0)return X.getSource().type!=="vector"||G?(x.id===void 0&&this.fire(new D.ErrorEvent(new Error("The feature id parameter must be provided."))),X.getFeatureState(G,x.id)):void this.fire(new D.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new D.ErrorEvent(new Error(`The source '${Q}' does not exist in the map's style.`)))}getTransition(){return D.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const x=D.mapObject(this.sourceCaches,X=>X.serialize()),Q=this._serializeByIds(this._order),G=this.stylesheet;return D.filterObject({version:G.version,name:G.name,metadata:G.metadata,light:G.light,center:G.center,zoom:G.zoom,bearing:G.bearing,pitch:G.pitch,sprite:G.sprite,glyphs:G.glyphs,transition:G.transition,sources:x,layers:Q},X=>X!==void 0)}_updateLayer(x){this._updatedLayers[x.id]=!0,x.source&&!this._updatedSources[x.source]&&this.sourceCaches[x.source].getSource().type!=="raster"&&(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(x){const Q=Ae=>this._layers[Ae].type==="fill-extrusion",G={},X=[];for(let Ae=this._order.length-1;Ae>=0;Ae--){const he=this._order[Ae];if(Q(he)){G[he]=Ae;for(const pe of x){const ve=pe[he];if(ve)for(const Ce of ve)X.push(Ce)}}}X.sort((Ae,he)=>he.intersectionZ-Ae.intersectionZ);const te=[];for(let Ae=this._order.length-1;Ae>=0;Ae--){const he=this._order[Ae];if(Q(he))for(let pe=X.length-1;pe>=0;pe--){const ve=X[pe].feature;if(G[ve.layer.id]<Ae)break;te.push(ve),X.pop()}else for(const pe of x){const ve=pe[he];if(ve)for(const Ce of ve)te.push(Ce.feature)}}return te}queryRenderedFeatures(x,Q,G){Q&&Q.filter&&this._validate(D.validateStyle.filter,"queryRenderedFeatures.filter",Q.filter,null,Q);const X={};if(Q&&Q.layers){if(!Array.isArray(Q.layers))return this.fire(new D.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const he of Q.layers){const pe=this._layers[he];if(!pe)return this.fire(new D.ErrorEvent(new Error(`The layer '${he}' does not exist in the map's style and cannot be queried for features.`))),[];X[pe.source]=!0}}const te=[];Q.availableImages=this._availableImages;const Ae=this._serializedAllLayers();for(const he in this.sourceCaches)Q.layers&&!X[he]||te.push(pt(this.sourceCaches[he],this._layers,Ae,x,Q,G));return this.placement&&te.push(function(he,pe,ve,Ce,Se,Qe,$e){const Ze={},rt=Qe.queryRenderedSymbols(Ce),Ye=[];for(const dt of Object.keys(rt).map(Number))Ye.push($e[dt]);Ye.sort(Ft);for(const dt of Ye){const Bt=dt.featureIndex.lookupSymbolFeatures(rt[dt.bucketInstanceId],pe,dt.bucketIndex,dt.sourceLayerIndex,Se.filter,Se.layers,Se.availableImages,he);for(const ot in Bt){const gt=Ze[ot]=Ze[ot]||[],St=Bt[ot];St.sort((It,Lt)=>{const Kt=dt.featureSortOrder;if(Kt){const Rt=Kt.indexOf(It.featureIndex);return Kt.indexOf(Lt.featureIndex)-Rt}return Lt.featureIndex-It.featureIndex});for(const It of St)gt.push(It)}}for(const dt in Ze)Ze[dt].forEach(Bt=>{const ot=Bt.feature,gt=ve[he[dt].source].getFeatureState(ot.layer["source-layer"],ot.id);ot.source=ot.layer.source,ot.layer["source-layer"]&&(ot.sourceLayer=ot.layer["source-layer"]),ot.state=gt});return Ze}(this._layers,Ae,this.sourceCaches,x,Q,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(te)}querySourceFeatures(x,Q){Q&&Q.filter&&this._validate(D.validateStyle.filter,"querySourceFeatures.filter",Q.filter,null,Q);const G=this.sourceCaches[x];return G?function(X,te){const Ae=X.getRenderableIds().map(ve=>X.getTileByID(ve)),he=[],pe={};for(let ve=0;ve<Ae.length;ve++){const Ce=Ae[ve],Se=Ce.tileID.canonical.key;pe[Se]||(pe[Se]=!0,Ce.querySourceFeatures(he,te))}return he}(G,Q):[]}addSourceType(x,Q,G){return qe(x)?G(new Error(`A source type called "${x}" already exists.`)):(((X,te)=>{ke[X]=te})(x,Q),Q.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:x,url:Q.workerSourceURL},G):G(null,null))}getLight(){return this.light.getLight()}setLight(x,Q={}){this._checkLoaded();const G=this.light.getLight();let X=!1;for(const Ae in x)if(!D.deepEqual(x[Ae],G[Ae])){X=!0;break}if(!X)return;const te={now:D.browser.now(),transition:D.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(x,Q),this.light.updateTransitions(te)}_validate(x,Q,G,X,te={}){return(!te||te.validate!==!1)&&Br(this,x.call(D.validateStyle,D.extend({key:Q,style:this.serialize(),value:G,styleSpec:D.v8Spec},X)))}_remove(x=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),D.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const Q in this._layers)this._layers[Q].setEventedParent(null);for(const Q in this.sourceCaches){const G=this.sourceCaches[Q];G.setEventedParent(null),G.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(x)}_clearSource(x){this.sourceCaches[x].clearTiles()}_reloadSource(x){this.sourceCaches[x].resume(),this.sourceCaches[x].reload()}_updateSources(x){for(const Q in this.sourceCaches)this.sourceCaches[Q].update(x,this.map.terrain)}_generateCollisionBoxes(){for(const x in this.sourceCaches)this._reloadSource(x)}_updatePlacement(x,Q,G,X,te=!1){let Ae=!1,he=!1;const pe={};for(const ve of this._order){const Ce=this._layers[ve];if(Ce.type!=="symbol")continue;if(!pe[Ce.source]){const Qe=this.sourceCaches[Ce.source];pe[Ce.source]=Qe.getRenderableIds(!0).map($e=>Qe.getTileByID($e)).sort(($e,Ze)=>Ze.tileID.overscaledZ-$e.tileID.overscaledZ||($e.tileID.isLessThan(Ze.tileID)?-1:1))}const Se=this.crossTileSymbolIndex.addLayer(Ce,pe[Ce.source],x.center.lng);Ae=Ae||Se}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((te=te||this._layerOrderChanged||G===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(D.browser.now(),x.zoom))&&(this.pauseablePlacement=new _s(x,this.map.terrain,this._order,te,Q,G,X,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,pe),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(D.browser.now()),he=!0),Ae&&this.pauseablePlacement.placement.setStale()),he||Ae)for(const ve of this._order){const Ce=this._layers[ve];Ce.type==="symbol"&&this.placement.updateLayerOpacities(Ce,pe[Ce.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(D.browser.now())}_releaseSymbolFadeTiles(){for(const x in this.sourceCaches)this.sourceCaches[x].releaseSymbolFadeTiles()}getImages(x,Q,G){this.imageManager.getImages(Q.icons,G),this._updateTilesForChangedImages();const X=this.sourceCaches[Q.source];X&&X.setDependencies(Q.tileID.key,Q.type,Q.icons)}getGlyphs(x,Q,G){this.glyphManager.getGlyphs(Q.stacks,G);const X=this.sourceCaches[Q.source];X&&X.setDependencies(Q.tileID.key,Q.type,[""])}getResource(x,Q,G){return D.makeRequest(Q,G)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(x,Q={}){this._checkLoaded(),x&&this._validate(D.validateStyle.glyphs,"glyphs",x,null,Q)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=x,this.glyphManager.entries={},this.glyphManager.setURL(x))}addSprite(x,Q,G={},X){this._checkLoaded();const te=[{id:x,url:Q}],Ae=[...qt(this.stylesheet.sprite),...te];this._validate(D.validateStyle.sprite,"sprite",Ae,null,G)||(this.stylesheet.sprite=Ae,this._loadSprite(te,!0,X))}removeSprite(x){this._checkLoaded();const Q=qt(this.stylesheet.sprite);if(Q.find(G=>G.id===x)){if(this._spritesImagesIds[x])for(const G of this._spritesImagesIds[x])this.imageManager.removeImage(G),this._changedImages[G]=!0;Q.splice(Q.findIndex(G=>G.id===x),1),this.stylesheet.sprite=Q.length>0?Q:void 0,delete this._spritesImagesIds[x],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new D.Event("data",{dataType:"style"}))}else this.fire(new D.ErrorEvent(new Error(`Sprite "${x}" doesn't exists on this map.`)))}getSprite(){return qt(this.stylesheet.sprite)}setSprite(x,Q={},G){this._checkLoaded(),x&&this._validate(D.validateStyle.sprite,"sprite",x,null,Q)||(this.stylesheet.sprite=x,x?this._loadSprite(x,!0,G):(this._unloadSprite(),G&&G(null)))}}sr.registerForPluginStateChange=D.registerForPluginStateChange;var jr=D.createLayout([{name:"a_pos",type:"Int16",components:2}]),ss="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const ps={prelude:cr(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:cr(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:cr(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:cr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:cr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:cr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:cr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:cr("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:cr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:cr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:cr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:cr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:cr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:cr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:cr(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:cr(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:cr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:cr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:cr(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:cr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:cr(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:cr(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:cr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:cr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:cr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:cr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:cr("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",ss),terrainDepth:cr("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",ss),terrainCoords:cr("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",ss)};function cr(J,x){const Q=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,G=x.match(/attribute ([\w]+) ([\w]+)/g),X=J.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),te=x.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),Ae=te?te.concat(X):X,he={};return{fragmentSource:J=J.replace(Q,(pe,ve,Ce,Se,Qe)=>(he[Qe]=!0,ve==="define"?`
#ifndef HAS_UNIFORM_u_${Qe}
varying ${Ce} ${Se} ${Qe};
#else
uniform ${Ce} ${Se} u_${Qe};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Qe}
    ${Ce} ${Se} ${Qe} = u_${Qe};
#endif
`)),vertexSource:x=x.replace(Q,(pe,ve,Ce,Se,Qe)=>{const $e=Se==="float"?"vec2":"vec4",Ze=Qe.match(/color/)?"color":$e;return he[Qe]?ve==="define"?`
#ifndef HAS_UNIFORM_u_${Qe}
uniform lowp float u_${Qe}_t;
attribute ${Ce} ${$e} a_${Qe};
varying ${Ce} ${Se} ${Qe};
#else
uniform ${Ce} ${Se} u_${Qe};
#endif
`:Ze==="vec4"?`
#ifndef HAS_UNIFORM_u_${Qe}
    ${Qe} = a_${Qe};
#else
    ${Ce} ${Se} ${Qe} = u_${Qe};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Qe}
    ${Qe} = unpack_mix_${Ze}(a_${Qe}, u_${Qe}_t);
#else
    ${Ce} ${Se} ${Qe} = u_${Qe};
#endif
`:ve==="define"?`
#ifndef HAS_UNIFORM_u_${Qe}
uniform lowp float u_${Qe}_t;
attribute ${Ce} ${$e} a_${Qe};
#else
uniform ${Ce} ${Se} u_${Qe};
#endif
`:Ze==="vec4"?`
#ifndef HAS_UNIFORM_u_${Qe}
    ${Ce} ${Se} ${Qe} = a_${Qe};
#else
    ${Ce} ${Se} ${Qe} = u_${Qe};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Qe}
    ${Ce} ${Se} ${Qe} = unpack_mix_${Ze}(a_${Qe}, u_${Qe}_t);
#else
    ${Ce} ${Se} ${Qe} = u_${Qe};
#endif
`}),staticAttributes:G,staticUniforms:Ae}}class js{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(x,Q,G,X,te,Ae,he,pe,ve){this.context=x;let Ce=this.boundPaintVertexBuffers.length!==X.length;for(let Se=0;!Ce&&Se<X.length;Se++)this.boundPaintVertexBuffers[Se]!==X[Se]&&(Ce=!0);!this.vao||this.boundProgram!==Q||this.boundLayoutVertexBuffer!==G||Ce||this.boundIndexBuffer!==te||this.boundVertexOffset!==Ae||this.boundDynamicVertexBuffer!==he||this.boundDynamicVertexBuffer2!==pe||this.boundDynamicVertexBuffer3!==ve?this.freshBind(Q,G,X,te,Ae,he,pe,ve):(x.bindVertexArray.set(this.vao),he&&he.bind(),te&&te.dynamicDraw&&te.bind(),pe&&pe.bind(),ve&&ve.bind())}freshBind(x,Q,G,X,te,Ae,he,pe){const ve=x.numAttributes,Ce=this.context,Se=Ce.gl;this.vao&&this.destroy(),this.vao=Ce.createVertexArray(),Ce.bindVertexArray.set(this.vao),this.boundProgram=x,this.boundLayoutVertexBuffer=Q,this.boundPaintVertexBuffers=G,this.boundIndexBuffer=X,this.boundVertexOffset=te,this.boundDynamicVertexBuffer=Ae,this.boundDynamicVertexBuffer2=he,this.boundDynamicVertexBuffer3=pe,Q.enableAttributes(Se,x);for(const Qe of G)Qe.enableAttributes(Se,x);Ae&&Ae.enableAttributes(Se,x),he&&he.enableAttributes(Se,x),pe&&pe.enableAttributes(Se,x),Q.bind(),Q.setVertexAttribPointers(Se,x,te);for(const Qe of G)Qe.bind(),Qe.setVertexAttribPointers(Se,x,te);Ae&&(Ae.bind(),Ae.setVertexAttribPointers(Se,x,te)),X&&X.bind(),he&&(he.bind(),he.setVertexAttribPointers(Se,x,te)),pe&&(pe.bind(),pe.setVertexAttribPointers(Se,x,te)),Ce.currentNumAttributes=ve}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function ys(J){const x=[];for(let Q=0;Q<J.length;Q++){if(J[Q]===null)continue;const G=J[Q].split(" ");x.push(G.pop())}return x}class Os{constructor(x,Q,G,X,te,Ae){const he=x.gl;this.program=he.createProgram();const pe=ys(Q.staticAttributes),ve=G?G.getBinderAttributes():[],Ce=pe.concat(ve),Se=ps.prelude.staticUniforms?ys(ps.prelude.staticUniforms):[],Qe=Q.staticUniforms?ys(Q.staticUniforms):[],$e=G?G.getBinderUniforms():[],Ze=Se.concat(Qe).concat($e),rt=[];for(const It of Ze)rt.indexOf(It)<0&&rt.push(It);const Ye=G?G.defines():[];te&&Ye.push("#define OVERDRAW_INSPECTOR;"),Ae&&Ye.push("#define TERRAIN3D;");const dt=Ye.concat(ps.prelude.fragmentSource,Q.fragmentSource).join(`
`),Bt=Ye.concat(ps.prelude.vertexSource,Q.vertexSource).join(`
`),ot=he.createShader(he.FRAGMENT_SHADER);if(he.isContextLost())return void(this.failedToCreate=!0);if(he.shaderSource(ot,dt),he.compileShader(ot),!he.getShaderParameter(ot,he.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${he.getShaderInfoLog(ot)}`);he.attachShader(this.program,ot);const gt=he.createShader(he.VERTEX_SHADER);if(he.isContextLost())return void(this.failedToCreate=!0);if(he.shaderSource(gt,Bt),he.compileShader(gt),!he.getShaderParameter(gt,he.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${he.getShaderInfoLog(gt)}`);he.attachShader(this.program,gt),this.attributes={};const St={};this.numAttributes=Ce.length;for(let It=0;It<this.numAttributes;It++)Ce[It]&&(he.bindAttribLocation(this.program,It,Ce[It]),this.attributes[Ce[It]]=It);if(he.linkProgram(this.program),!he.getProgramParameter(this.program,he.LINK_STATUS))throw new Error(`Program failed to link: ${he.getProgramInfoLog(this.program)}`);he.deleteShader(gt),he.deleteShader(ot);for(let It=0;It<rt.length;It++){const Lt=rt[It];if(Lt&&!St[Lt]){const Kt=he.getUniformLocation(this.program,Lt);Kt&&(St[Lt]=Kt)}}this.fixedUniforms=X(x,St),this.terrainUniforms=((It,Lt)=>({u_depth:new D.Uniform1i(It,Lt.u_depth),u_terrain:new D.Uniform1i(It,Lt.u_terrain),u_terrain_dim:new D.Uniform1f(It,Lt.u_terrain_dim),u_terrain_matrix:new D.UniformMatrix4f(It,Lt.u_terrain_matrix),u_terrain_unpack:new D.Uniform4f(It,Lt.u_terrain_unpack),u_terrain_exaggeration:new D.Uniform1f(It,Lt.u_terrain_exaggeration)}))(x,St),this.binderUniforms=G?G.getUniforms(x,St):[]}draw(x,Q,G,X,te,Ae,he,pe,ve,Ce,Se,Qe,$e,Ze,rt,Ye,dt,Bt){const ot=x.gl;if(this.failedToCreate)return;if(x.program.set(this.program),x.setDepthMode(G),x.setStencilMode(X),x.setColorMode(te),x.setCullFace(Ae),pe){x.activeTexture.set(ot.TEXTURE2),ot.bindTexture(ot.TEXTURE_2D,pe.depthTexture),x.activeTexture.set(ot.TEXTURE3),ot.bindTexture(ot.TEXTURE_2D,pe.texture);for(const St in this.terrainUniforms)this.terrainUniforms[St].set(pe[St])}for(const St in this.fixedUniforms)this.fixedUniforms[St].set(he[St]);rt&&rt.setUniforms(x,this.binderUniforms,$e,{zoom:Ze});let gt=0;switch(Q){case ot.LINES:gt=2;break;case ot.TRIANGLES:gt=3;break;case ot.LINE_STRIP:gt=1}for(const St of Qe.get()){const It=St.vaos||(St.vaos={});(It[ve]||(It[ve]=new js)).bind(x,this,Ce,rt?rt.getPaintVertexBuffers():[],Se,St.vertexOffset,Ye,dt,Bt),ot.drawElements(Q,St.primitiveLength*gt,ot.UNSIGNED_SHORT,St.primitiveOffset*gt*2)}}}function pn(J,x,Q){const G=1/Le(Q,1,x.transform.tileZoom),X=Math.pow(2,Q.tileID.overscaledZ),te=Q.tileSize*Math.pow(2,x.transform.tileZoom)/X,Ae=te*(Q.tileID.canonical.x+Q.tileID.wrap*X),he=te*Q.tileID.canonical.y;return{u_image:0,u_texsize:Q.imageAtlasTexture.size,u_scale:[G,J.fromScale,J.toScale],u_fade:J.t,u_pixel_coord_upper:[Ae>>16,he>>16],u_pixel_coord_lower:[65535&Ae,65535&he]}}const Qr=(J,x,Q,G)=>{const X=x.style.light,te=X.properties.get("position"),Ae=[te.x,te.y,te.z],he=function(){var ve=new D.ARRAY_TYPE(9);return D.ARRAY_TYPE!=Float32Array&&(ve[1]=0,ve[2]=0,ve[3]=0,ve[5]=0,ve[6]=0,ve[7]=0),ve[0]=1,ve[4]=1,ve[8]=1,ve}();X.properties.get("anchor")==="viewport"&&function(ve,Ce){var Se=Math.sin(Ce),Qe=Math.cos(Ce);ve[0]=Qe,ve[1]=Se,ve[2]=0,ve[3]=-Se,ve[4]=Qe,ve[5]=0,ve[6]=0,ve[7]=0,ve[8]=1}(he,-x.transform.angle),function(ve,Ce,Se){var Qe=Ce[0],$e=Ce[1],Ze=Ce[2];ve[0]=Qe*Se[0]+$e*Se[3]+Ze*Se[6],ve[1]=Qe*Se[1]+$e*Se[4]+Ze*Se[7],ve[2]=Qe*Se[2]+$e*Se[5]+Ze*Se[8]}(Ae,Ae,he);const pe=X.properties.get("color");return{u_matrix:J,u_lightpos:Ae,u_lightintensity:X.properties.get("intensity"),u_lightcolor:[pe.r,pe.g,pe.b],u_vertical_gradient:+Q,u_opacity:G}},es=(J,x,Q,G,X,te,Ae)=>D.extend(Qr(J,x,Q,G),pn(te,x,Ae),{u_height_factor:-Math.pow(2,X.overscaledZ)/Ae.tileSize/8}),xo=J=>({u_matrix:J}),Zs=(J,x,Q,G)=>D.extend(xo(J),pn(Q,x,G)),An=(J,x)=>({u_matrix:J,u_world:x}),ta=(J,x,Q,G,X)=>D.extend(Zs(J,x,Q,G),{u_world:X}),ja=(J,x,Q,G)=>{const X=J.transform;let te,Ae;if(G.paint.get("circle-pitch-alignment")==="map"){const he=Le(Q,1,X.zoom);te=!0,Ae=[he,he]}else te=!1,Ae=X.pixelsToGLUnits;return{u_camera_to_center_distance:X.cameraToCenterDistance,u_scale_with_map:+(G.paint.get("circle-pitch-scale")==="map"),u_matrix:J.translatePosMatrix(x.posMatrix,Q,G.paint.get("circle-translate"),G.paint.get("circle-translate-anchor")),u_pitch_with_map:+te,u_device_pixel_ratio:J.pixelRatio,u_extrude_scale:Ae}},Qn=(J,x,Q)=>{const G=Le(Q,1,x.zoom),X=Math.pow(2,x.zoom-Q.tileID.overscaledZ),te=Q.tileID.overscaleFactor();return{u_matrix:J,u_camera_to_center_distance:x.cameraToCenterDistance,u_pixels_to_tile_units:G,u_extrude_scale:[x.pixelsToGLUnits[0]/(G*X),x.pixelsToGLUnits[1]/(G*X)],u_overscale_factor:te}},wa=(J,x,Q=1)=>({u_matrix:J,u_color:x,u_overlay:0,u_overlay_scale:Q}),Nr=J=>({u_matrix:J}),Vo=(J,x,Q,G)=>({u_matrix:J,u_extrude_scale:Le(x,1,Q),u_intensity:G});function Bo(J,x){const Q=Math.pow(2,x.canonical.z),G=x.canonical.y;return[new D.MercatorCoordinate(0,G/Q).toLngLat().lat,new D.MercatorCoordinate(0,(G+1)/Q).toLngLat().lat]}const xa=(J,x,Q,G)=>{const X=J.transform;return{u_matrix:ia(J,x,Q,G),u_ratio:1/Le(x,1,X.zoom),u_device_pixel_ratio:J.pixelRatio,u_units_to_pixels:[1/X.pixelsToGLUnits[0],1/X.pixelsToGLUnits[1]]}},Tn=(J,x,Q,G,X)=>D.extend(xa(J,x,Q,X),{u_image:0,u_image_height:G}),wr=(J,x,Q,G,X)=>{const te=J.transform,Ae=As(x,te);return{u_matrix:ia(J,x,Q,X),u_texsize:x.imageAtlasTexture.size,u_ratio:1/Le(x,1,te.zoom),u_device_pixel_ratio:J.pixelRatio,u_image:0,u_scale:[Ae,G.fromScale,G.toScale],u_fade:G.t,u_units_to_pixels:[1/te.pixelsToGLUnits[0],1/te.pixelsToGLUnits[1]]}},er=(J,x,Q,G,X,te)=>{const Ae=J.lineAtlas,he=As(x,J.transform),pe=Q.layout.get("line-cap")==="round",ve=Ae.getDash(G.from,pe),Ce=Ae.getDash(G.to,pe),Se=ve.width*X.fromScale,Qe=Ce.width*X.toScale;return D.extend(xa(J,x,Q,te),{u_patternscale_a:[he/Se,-ve.height/2],u_patternscale_b:[he/Qe,-Ce.height/2],u_sdfgamma:Ae.width/(256*Math.min(Se,Qe)*J.pixelRatio)/2,u_image:0,u_tex_y_a:ve.y,u_tex_y_b:Ce.y,u_mix:X.t})};function As(J,x){return 1/Le(J,1,x.tileZoom)}function ia(J,x,Q,G){return J.translatePosMatrix(G?G.posMatrix:x.tileID.posMatrix,x,Q.paint.get("line-translate"),Q.paint.get("line-translate-anchor"))}const Ba=(J,x,Q,G,X)=>{return{u_matrix:J,u_tl_parent:x,u_scale_parent:Q,u_buffer_scale:1,u_fade_t:G.mix,u_opacity:G.opacity*X.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:X.paint.get("raster-brightness-min"),u_brightness_high:X.paint.get("raster-brightness-max"),u_saturation_factor:(Ae=X.paint.get("raster-saturation"),Ae>0?1-1/(1.001-Ae):-Ae),u_contrast_factor:(te=X.paint.get("raster-contrast"),te>0?1/(1-te):1+te),u_spin_weights:Ca(X.paint.get("raster-hue-rotate"))};var te,Ae};function Ca(J){J*=Math.PI/180;const x=Math.sin(J),Q=Math.cos(J);return[(2*Q+1)/3,(-Math.sqrt(3)*x-Q+1)/3,(Math.sqrt(3)*x-Q+1)/3]}const Ea=(J,x,Q,G,X,te,Ae,he,pe,ve)=>{const Ce=X.transform;return{u_is_size_zoom_constant:+(J==="constant"||J==="source"),u_is_size_feature_constant:+(J==="constant"||J==="camera"),u_size_t:x?x.uSizeT:0,u_size:x?x.uSize:0,u_camera_to_center_distance:Ce.cameraToCenterDistance,u_pitch:Ce.pitch/360*2*Math.PI,u_rotate_symbol:+Q,u_aspect_ratio:Ce.width/Ce.height,u_fade_change:X.options.fadeDuration?X.symbolFadeChange:1,u_matrix:te,u_label_plane_matrix:Ae,u_coord_matrix:he,u_is_text:+pe,u_pitch_with_map:+G,u_texsize:ve,u_texture:0}},Ta=(J,x,Q,G,X,te,Ae,he,pe,ve,Ce)=>{const Se=X.transform;return D.extend(Ea(J,x,Q,G,X,te,Ae,he,pe,ve),{u_gamma_scale:G?Math.cos(Se._pitch)*Se.cameraToCenterDistance:1,u_device_pixel_ratio:X.pixelRatio,u_is_halo:+Ce})},Sa=(J,x,Q,G,X,te,Ae,he,pe,ve)=>D.extend(Ta(J,x,Q,G,X,te,Ae,he,!0,pe,!0),{u_texsize_icon:ve,u_texture_icon:1}),On=(J,x,Q)=>({u_matrix:J,u_opacity:x,u_color:Q}),Za=(J,x,Q,G,X,te)=>D.extend(function(Ae,he,pe,ve){const Ce=pe.imageManager.getPattern(Ae.from.toString()),Se=pe.imageManager.getPattern(Ae.to.toString()),{width:Qe,height:$e}=pe.imageManager.getPixelSize(),Ze=Math.pow(2,ve.tileID.overscaledZ),rt=ve.tileSize*Math.pow(2,pe.transform.tileZoom)/Ze,Ye=rt*(ve.tileID.canonical.x+ve.tileID.wrap*Ze),dt=rt*ve.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:Ce.tl,u_pattern_br_a:Ce.br,u_pattern_tl_b:Se.tl,u_pattern_br_b:Se.br,u_texsize:[Qe,$e],u_mix:he.t,u_pattern_size_a:Ce.displaySize,u_pattern_size_b:Se.displaySize,u_scale_a:he.fromScale,u_scale_b:he.toScale,u_tile_units_to_pixels:1/Le(ve,1,pe.transform.tileZoom),u_pixel_coord_upper:[Ye>>16,dt>>16],u_pixel_coord_lower:[65535&Ye,65535&dt]}}(G,te,Q,X),{u_matrix:J,u_opacity:x}),ks={fillExtrusion:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_lightpos:new D.Uniform3f(J,x.u_lightpos),u_lightintensity:new D.Uniform1f(J,x.u_lightintensity),u_lightcolor:new D.Uniform3f(J,x.u_lightcolor),u_vertical_gradient:new D.Uniform1f(J,x.u_vertical_gradient),u_opacity:new D.Uniform1f(J,x.u_opacity)}),fillExtrusionPattern:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_lightpos:new D.Uniform3f(J,x.u_lightpos),u_lightintensity:new D.Uniform1f(J,x.u_lightintensity),u_lightcolor:new D.Uniform3f(J,x.u_lightcolor),u_vertical_gradient:new D.Uniform1f(J,x.u_vertical_gradient),u_height_factor:new D.Uniform1f(J,x.u_height_factor),u_image:new D.Uniform1i(J,x.u_image),u_texsize:new D.Uniform2f(J,x.u_texsize),u_pixel_coord_upper:new D.Uniform2f(J,x.u_pixel_coord_upper),u_pixel_coord_lower:new D.Uniform2f(J,x.u_pixel_coord_lower),u_scale:new D.Uniform3f(J,x.u_scale),u_fade:new D.Uniform1f(J,x.u_fade),u_opacity:new D.Uniform1f(J,x.u_opacity)}),fill:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix)}),fillPattern:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_image:new D.Uniform1i(J,x.u_image),u_texsize:new D.Uniform2f(J,x.u_texsize),u_pixel_coord_upper:new D.Uniform2f(J,x.u_pixel_coord_upper),u_pixel_coord_lower:new D.Uniform2f(J,x.u_pixel_coord_lower),u_scale:new D.Uniform3f(J,x.u_scale),u_fade:new D.Uniform1f(J,x.u_fade)}),fillOutline:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_world:new D.Uniform2f(J,x.u_world)}),fillOutlinePattern:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_world:new D.Uniform2f(J,x.u_world),u_image:new D.Uniform1i(J,x.u_image),u_texsize:new D.Uniform2f(J,x.u_texsize),u_pixel_coord_upper:new D.Uniform2f(J,x.u_pixel_coord_upper),u_pixel_coord_lower:new D.Uniform2f(J,x.u_pixel_coord_lower),u_scale:new D.Uniform3f(J,x.u_scale),u_fade:new D.Uniform1f(J,x.u_fade)}),circle:(J,x)=>({u_camera_to_center_distance:new D.Uniform1f(J,x.u_camera_to_center_distance),u_scale_with_map:new D.Uniform1i(J,x.u_scale_with_map),u_pitch_with_map:new D.Uniform1i(J,x.u_pitch_with_map),u_extrude_scale:new D.Uniform2f(J,x.u_extrude_scale),u_device_pixel_ratio:new D.Uniform1f(J,x.u_device_pixel_ratio),u_matrix:new D.UniformMatrix4f(J,x.u_matrix)}),collisionBox:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_camera_to_center_distance:new D.Uniform1f(J,x.u_camera_to_center_distance),u_pixels_to_tile_units:new D.Uniform1f(J,x.u_pixels_to_tile_units),u_extrude_scale:new D.Uniform2f(J,x.u_extrude_scale),u_overscale_factor:new D.Uniform1f(J,x.u_overscale_factor)}),collisionCircle:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_inv_matrix:new D.UniformMatrix4f(J,x.u_inv_matrix),u_camera_to_center_distance:new D.Uniform1f(J,x.u_camera_to_center_distance),u_viewport_size:new D.Uniform2f(J,x.u_viewport_size)}),debug:(J,x)=>({u_color:new D.UniformColor(J,x.u_color),u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_overlay:new D.Uniform1i(J,x.u_overlay),u_overlay_scale:new D.Uniform1f(J,x.u_overlay_scale)}),clippingMask:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix)}),heatmap:(J,x)=>({u_extrude_scale:new D.Uniform1f(J,x.u_extrude_scale),u_intensity:new D.Uniform1f(J,x.u_intensity),u_matrix:new D.UniformMatrix4f(J,x.u_matrix)}),heatmapTexture:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_world:new D.Uniform2f(J,x.u_world),u_image:new D.Uniform1i(J,x.u_image),u_color_ramp:new D.Uniform1i(J,x.u_color_ramp),u_opacity:new D.Uniform1f(J,x.u_opacity)}),hillshade:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_image:new D.Uniform1i(J,x.u_image),u_latrange:new D.Uniform2f(J,x.u_latrange),u_light:new D.Uniform2f(J,x.u_light),u_shadow:new D.UniformColor(J,x.u_shadow),u_highlight:new D.UniformColor(J,x.u_highlight),u_accent:new D.UniformColor(J,x.u_accent)}),hillshadePrepare:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_image:new D.Uniform1i(J,x.u_image),u_dimension:new D.Uniform2f(J,x.u_dimension),u_zoom:new D.Uniform1f(J,x.u_zoom),u_unpack:new D.Uniform4f(J,x.u_unpack)}),line:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_ratio:new D.Uniform1f(J,x.u_ratio),u_device_pixel_ratio:new D.Uniform1f(J,x.u_device_pixel_ratio),u_units_to_pixels:new D.Uniform2f(J,x.u_units_to_pixels)}),lineGradient:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_ratio:new D.Uniform1f(J,x.u_ratio),u_device_pixel_ratio:new D.Uniform1f(J,x.u_device_pixel_ratio),u_units_to_pixels:new D.Uniform2f(J,x.u_units_to_pixels),u_image:new D.Uniform1i(J,x.u_image),u_image_height:new D.Uniform1f(J,x.u_image_height)}),linePattern:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_texsize:new D.Uniform2f(J,x.u_texsize),u_ratio:new D.Uniform1f(J,x.u_ratio),u_device_pixel_ratio:new D.Uniform1f(J,x.u_device_pixel_ratio),u_image:new D.Uniform1i(J,x.u_image),u_units_to_pixels:new D.Uniform2f(J,x.u_units_to_pixels),u_scale:new D.Uniform3f(J,x.u_scale),u_fade:new D.Uniform1f(J,x.u_fade)}),lineSDF:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_ratio:new D.Uniform1f(J,x.u_ratio),u_device_pixel_ratio:new D.Uniform1f(J,x.u_device_pixel_ratio),u_units_to_pixels:new D.Uniform2f(J,x.u_units_to_pixels),u_patternscale_a:new D.Uniform2f(J,x.u_patternscale_a),u_patternscale_b:new D.Uniform2f(J,x.u_patternscale_b),u_sdfgamma:new D.Uniform1f(J,x.u_sdfgamma),u_image:new D.Uniform1i(J,x.u_image),u_tex_y_a:new D.Uniform1f(J,x.u_tex_y_a),u_tex_y_b:new D.Uniform1f(J,x.u_tex_y_b),u_mix:new D.Uniform1f(J,x.u_mix)}),raster:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_tl_parent:new D.Uniform2f(J,x.u_tl_parent),u_scale_parent:new D.Uniform1f(J,x.u_scale_parent),u_buffer_scale:new D.Uniform1f(J,x.u_buffer_scale),u_fade_t:new D.Uniform1f(J,x.u_fade_t),u_opacity:new D.Uniform1f(J,x.u_opacity),u_image0:new D.Uniform1i(J,x.u_image0),u_image1:new D.Uniform1i(J,x.u_image1),u_brightness_low:new D.Uniform1f(J,x.u_brightness_low),u_brightness_high:new D.Uniform1f(J,x.u_brightness_high),u_saturation_factor:new D.Uniform1f(J,x.u_saturation_factor),u_contrast_factor:new D.Uniform1f(J,x.u_contrast_factor),u_spin_weights:new D.Uniform3f(J,x.u_spin_weights)}),symbolIcon:(J,x)=>({u_is_size_zoom_constant:new D.Uniform1i(J,x.u_is_size_zoom_constant),u_is_size_feature_constant:new D.Uniform1i(J,x.u_is_size_feature_constant),u_size_t:new D.Uniform1f(J,x.u_size_t),u_size:new D.Uniform1f(J,x.u_size),u_camera_to_center_distance:new D.Uniform1f(J,x.u_camera_to_center_distance),u_pitch:new D.Uniform1f(J,x.u_pitch),u_rotate_symbol:new D.Uniform1i(J,x.u_rotate_symbol),u_aspect_ratio:new D.Uniform1f(J,x.u_aspect_ratio),u_fade_change:new D.Uniform1f(J,x.u_fade_change),u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_label_plane_matrix:new D.UniformMatrix4f(J,x.u_label_plane_matrix),u_coord_matrix:new D.UniformMatrix4f(J,x.u_coord_matrix),u_is_text:new D.Uniform1i(J,x.u_is_text),u_pitch_with_map:new D.Uniform1i(J,x.u_pitch_with_map),u_texsize:new D.Uniform2f(J,x.u_texsize),u_texture:new D.Uniform1i(J,x.u_texture)}),symbolSDF:(J,x)=>({u_is_size_zoom_constant:new D.Uniform1i(J,x.u_is_size_zoom_constant),u_is_size_feature_constant:new D.Uniform1i(J,x.u_is_size_feature_constant),u_size_t:new D.Uniform1f(J,x.u_size_t),u_size:new D.Uniform1f(J,x.u_size),u_camera_to_center_distance:new D.Uniform1f(J,x.u_camera_to_center_distance),u_pitch:new D.Uniform1f(J,x.u_pitch),u_rotate_symbol:new D.Uniform1i(J,x.u_rotate_symbol),u_aspect_ratio:new D.Uniform1f(J,x.u_aspect_ratio),u_fade_change:new D.Uniform1f(J,x.u_fade_change),u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_label_plane_matrix:new D.UniformMatrix4f(J,x.u_label_plane_matrix),u_coord_matrix:new D.UniformMatrix4f(J,x.u_coord_matrix),u_is_text:new D.Uniform1i(J,x.u_is_text),u_pitch_with_map:new D.Uniform1i(J,x.u_pitch_with_map),u_texsize:new D.Uniform2f(J,x.u_texsize),u_texture:new D.Uniform1i(J,x.u_texture),u_gamma_scale:new D.Uniform1f(J,x.u_gamma_scale),u_device_pixel_ratio:new D.Uniform1f(J,x.u_device_pixel_ratio),u_is_halo:new D.Uniform1i(J,x.u_is_halo)}),symbolTextAndIcon:(J,x)=>({u_is_size_zoom_constant:new D.Uniform1i(J,x.u_is_size_zoom_constant),u_is_size_feature_constant:new D.Uniform1i(J,x.u_is_size_feature_constant),u_size_t:new D.Uniform1f(J,x.u_size_t),u_size:new D.Uniform1f(J,x.u_size),u_camera_to_center_distance:new D.Uniform1f(J,x.u_camera_to_center_distance),u_pitch:new D.Uniform1f(J,x.u_pitch),u_rotate_symbol:new D.Uniform1i(J,x.u_rotate_symbol),u_aspect_ratio:new D.Uniform1f(J,x.u_aspect_ratio),u_fade_change:new D.Uniform1f(J,x.u_fade_change),u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_label_plane_matrix:new D.UniformMatrix4f(J,x.u_label_plane_matrix),u_coord_matrix:new D.UniformMatrix4f(J,x.u_coord_matrix),u_is_text:new D.Uniform1i(J,x.u_is_text),u_pitch_with_map:new D.Uniform1i(J,x.u_pitch_with_map),u_texsize:new D.Uniform2f(J,x.u_texsize),u_texsize_icon:new D.Uniform2f(J,x.u_texsize_icon),u_texture:new D.Uniform1i(J,x.u_texture),u_texture_icon:new D.Uniform1i(J,x.u_texture_icon),u_gamma_scale:new D.Uniform1f(J,x.u_gamma_scale),u_device_pixel_ratio:new D.Uniform1f(J,x.u_device_pixel_ratio),u_is_halo:new D.Uniform1i(J,x.u_is_halo)}),background:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_opacity:new D.Uniform1f(J,x.u_opacity),u_color:new D.UniformColor(J,x.u_color)}),backgroundPattern:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_opacity:new D.Uniform1f(J,x.u_opacity),u_image:new D.Uniform1i(J,x.u_image),u_pattern_tl_a:new D.Uniform2f(J,x.u_pattern_tl_a),u_pattern_br_a:new D.Uniform2f(J,x.u_pattern_br_a),u_pattern_tl_b:new D.Uniform2f(J,x.u_pattern_tl_b),u_pattern_br_b:new D.Uniform2f(J,x.u_pattern_br_b),u_texsize:new D.Uniform2f(J,x.u_texsize),u_mix:new D.Uniform1f(J,x.u_mix),u_pattern_size_a:new D.Uniform2f(J,x.u_pattern_size_a),u_pattern_size_b:new D.Uniform2f(J,x.u_pattern_size_b),u_scale_a:new D.Uniform1f(J,x.u_scale_a),u_scale_b:new D.Uniform1f(J,x.u_scale_b),u_pixel_coord_upper:new D.Uniform2f(J,x.u_pixel_coord_upper),u_pixel_coord_lower:new D.Uniform2f(J,x.u_pixel_coord_lower),u_tile_units_to_pixels:new D.Uniform1f(J,x.u_tile_units_to_pixels)}),terrain:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_texture:new D.Uniform1i(J,x.u_texture),u_ele_delta:new D.Uniform1f(J,x.u_ele_delta)}),terrainDepth:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_ele_delta:new D.Uniform1f(J,x.u_ele_delta)}),terrainCoords:(J,x)=>({u_matrix:new D.UniformMatrix4f(J,x.u_matrix),u_texture:new D.Uniform1i(J,x.u_texture),u_terrain_coords_id:new D.Uniform1f(J,x.u_terrain_coords_id),u_ele_delta:new D.Uniform1f(J,x.u_ele_delta)})};class gs{constructor(x,Q,G){this.context=x;const X=x.gl;this.buffer=X.createBuffer(),this.dynamicDraw=!!G,this.context.unbindVAO(),x.bindElementBuffer.set(this.buffer),X.bufferData(X.ELEMENT_ARRAY_BUFFER,Q.arrayBuffer,this.dynamicDraw?X.DYNAMIC_DRAW:X.STATIC_DRAW),this.dynamicDraw||delete Q.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(x){const Q=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),Q.bufferSubData(Q.ELEMENT_ARRAY_BUFFER,0,x.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ja={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Ia{constructor(x,Q,G,X){this.length=Q.length,this.attributes=G,this.itemSize=Q.bytesPerElement,this.dynamicDraw=X,this.context=x;const te=x.gl;this.buffer=te.createBuffer(),x.bindVertexBuffer.set(this.buffer),te.bufferData(te.ARRAY_BUFFER,Q.arrayBuffer,this.dynamicDraw?te.DYNAMIC_DRAW:te.STATIC_DRAW),this.dynamicDraw||delete Q.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(x){if(x.length!==this.length)throw new Error(`Length of new data is ${x.length}, which doesn't match current length of ${this.length}`);const Q=this.context.gl;this.bind(),Q.bufferSubData(Q.ARRAY_BUFFER,0,x.arrayBuffer)}enableAttributes(x,Q){for(let G=0;G<this.attributes.length;G++){const X=Q.attributes[this.attributes[G].name];X!==void 0&&x.enableVertexAttribArray(X)}}setVertexAttribPointers(x,Q,G){for(let X=0;X<this.attributes.length;X++){const te=this.attributes[X],Ae=Q.attributes[te.name];Ae!==void 0&&x.vertexAttribPointer(Ae,te.components,x[Ja[te.type]],!1,this.itemSize,te.offset+this.itemSize*(G||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ra=new WeakMap;function Sn(J){if(ra.has(J))return ra.get(J);{const x=J.getParameter(J.VERSION).startsWith("WebGL 2.0");return ra.set(J,x),x}}class pr{constructor(x){this.gl=x.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(x){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class $a extends pr{getDefault(){return D.Color.transparent}set(x){const Q=this.current;(x.r!==Q.r||x.g!==Q.g||x.b!==Q.b||x.a!==Q.a||this.dirty)&&(this.gl.clearColor(x.r,x.g,x.b,x.a),this.current=x,this.dirty=!1)}}class Co extends pr{getDefault(){return 1}set(x){(x!==this.current||this.dirty)&&(this.gl.clearDepth(x),this.current=x,this.dirty=!1)}}class In extends pr{getDefault(){return 0}set(x){(x!==this.current||this.dirty)&&(this.gl.clearStencil(x),this.current=x,this.dirty=!1)}}class sa extends pr{getDefault(){return[!0,!0,!0,!0]}set(x){const Q=this.current;(x[0]!==Q[0]||x[1]!==Q[1]||x[2]!==Q[2]||x[3]!==Q[3]||this.dirty)&&(this.gl.colorMask(x[0],x[1],x[2],x[3]),this.current=x,this.dirty=!1)}}class Eo extends pr{getDefault(){return!0}set(x){(x!==this.current||this.dirty)&&(this.gl.depthMask(x),this.current=x,this.dirty=!1)}}class To extends pr{getDefault(){return 255}set(x){(x!==this.current||this.dirty)&&(this.gl.stencilMask(x),this.current=x,this.dirty=!1)}}class na extends pr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(x){const Q=this.current;(x.func!==Q.func||x.ref!==Q.ref||x.mask!==Q.mask||this.dirty)&&(this.gl.stencilFunc(x.func,x.ref,x.mask),this.current=x,this.dirty=!1)}}class pl extends pr{getDefault(){const x=this.gl;return[x.KEEP,x.KEEP,x.KEEP]}set(x){const Q=this.current;(x[0]!==Q[0]||x[1]!==Q[1]||x[2]!==Q[2]||this.dirty)&&(this.gl.stencilOp(x[0],x[1],x[2]),this.current=x,this.dirty=!1)}}class Ko extends pr{getDefault(){return!1}set(x){if(x===this.current&&!this.dirty)return;const Q=this.gl;x?Q.enable(Q.STENCIL_TEST):Q.disable(Q.STENCIL_TEST),this.current=x,this.dirty=!1}}class Go extends pr{getDefault(){return[0,1]}set(x){const Q=this.current;(x[0]!==Q[0]||x[1]!==Q[1]||this.dirty)&&(this.gl.depthRange(x[0],x[1]),this.current=x,this.dirty=!1)}}class So extends pr{getDefault(){return!1}set(x){if(x===this.current&&!this.dirty)return;const Q=this.gl;x?Q.enable(Q.DEPTH_TEST):Q.disable(Q.DEPTH_TEST),this.current=x,this.dirty=!1}}class Wo extends pr{getDefault(){return this.gl.LESS}set(x){(x!==this.current||this.dirty)&&(this.gl.depthFunc(x),this.current=x,this.dirty=!1)}}class cn extends pr{getDefault(){return!1}set(x){if(x===this.current&&!this.dirty)return;const Q=this.gl;x?Q.enable(Q.BLEND):Q.disable(Q.BLEND),this.current=x,this.dirty=!1}}class Rn extends pr{getDefault(){const x=this.gl;return[x.ONE,x.ZERO]}set(x){const Q=this.current;(x[0]!==Q[0]||x[1]!==Q[1]||this.dirty)&&(this.gl.blendFunc(x[0],x[1]),this.current=x,this.dirty=!1)}}class Fa extends pr{getDefault(){return D.Color.transparent}set(x){const Q=this.current;(x.r!==Q.r||x.g!==Q.g||x.b!==Q.b||x.a!==Q.a||this.dirty)&&(this.gl.blendColor(x.r,x.g,x.b,x.a),this.current=x,this.dirty=!1)}}class eo extends pr{getDefault(){return this.gl.FUNC_ADD}set(x){(x!==this.current||this.dirty)&&(this.gl.blendEquation(x),this.current=x,this.dirty=!1)}}class ka extends pr{getDefault(){return!1}set(x){if(x===this.current&&!this.dirty)return;const Q=this.gl;x?Q.enable(Q.CULL_FACE):Q.disable(Q.CULL_FACE),this.current=x,this.dirty=!1}}class gn extends pr{getDefault(){return this.gl.BACK}set(x){(x!==this.current||this.dirty)&&(this.gl.cullFace(x),this.current=x,this.dirty=!1)}}class aa extends pr{getDefault(){return this.gl.CCW}set(x){(x!==this.current||this.dirty)&&(this.gl.frontFace(x),this.current=x,this.dirty=!1)}}class Ds extends pr{getDefault(){return null}set(x){(x!==this.current||this.dirty)&&(this.gl.useProgram(x),this.current=x,this.dirty=!1)}}class oa extends pr{getDefault(){return this.gl.TEXTURE0}set(x){(x!==this.current||this.dirty)&&(this.gl.activeTexture(x),this.current=x,this.dirty=!1)}}class hn extends pr{getDefault(){const x=this.gl;return[0,0,x.drawingBufferWidth,x.drawingBufferHeight]}set(x){const Q=this.current;(x[0]!==Q[0]||x[1]!==Q[1]||x[2]!==Q[2]||x[3]!==Q[3]||this.dirty)&&(this.gl.viewport(x[0],x[1],x[2],x[3]),this.current=x,this.dirty=!1)}}class Rs extends pr{getDefault(){return null}set(x){if(x===this.current&&!this.dirty)return;const Q=this.gl;Q.bindFramebuffer(Q.FRAMEBUFFER,x),this.current=x,this.dirty=!1}}class la extends pr{getDefault(){return null}set(x){if(x===this.current&&!this.dirty)return;const Q=this.gl;Q.bindRenderbuffer(Q.RENDERBUFFER,x),this.current=x,this.dirty=!1}}class Hn extends pr{getDefault(){return null}set(x){if(x===this.current&&!this.dirty)return;const Q=this.gl;Q.bindTexture(Q.TEXTURE_2D,x),this.current=x,this.dirty=!1}}class to extends pr{getDefault(){return null}set(x){if(x===this.current&&!this.dirty)return;const Q=this.gl;Q.bindBuffer(Q.ARRAY_BUFFER,x),this.current=x,this.dirty=!1}}class io extends pr{getDefault(){return null}set(x){const Q=this.gl;Q.bindBuffer(Q.ELEMENT_ARRAY_BUFFER,x),this.current=x,this.dirty=!1}}class gr extends pr{getDefault(){return null}set(x){var Q;if(x===this.current&&!this.dirty)return;const G=this.gl;Sn(G)?G.bindVertexArray(x):(Q=G.getExtension("OES_vertex_array_object"))===null||Q===void 0||Q.bindVertexArrayOES(x),this.current=x,this.dirty=!1}}class Js extends pr{getDefault(){return 4}set(x){if(x===this.current&&!this.dirty)return;const Q=this.gl;Q.pixelStorei(Q.UNPACK_ALIGNMENT,x),this.current=x,this.dirty=!1}}class gl extends pr{getDefault(){return!1}set(x){if(x===this.current&&!this.dirty)return;const Q=this.gl;Q.pixelStorei(Q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,x),this.current=x,this.dirty=!1}}class qo extends pr{getDefault(){return!1}set(x){if(x===this.current&&!this.dirty)return;const Q=this.gl;Q.pixelStorei(Q.UNPACK_FLIP_Y_WEBGL,x),this.current=x,this.dirty=!1}}class mn extends pr{constructor(x,Q){super(x),this.context=x,this.parent=Q}getDefault(){return null}}class Io extends mn{setDirty(){this.dirty=!0}set(x){if(x===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const Q=this.gl;Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_2D,x,0),this.current=x,this.dirty=!1}}class Xo extends mn{set(x){if(x===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const Q=this.gl;Q.framebufferRenderbuffer(Q.FRAMEBUFFER,Q.DEPTH_ATTACHMENT,Q.RENDERBUFFER,x),this.current=x,this.dirty=!1}}class Hs extends mn{set(x){if(x===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const Q=this.gl;Q.framebufferRenderbuffer(Q.FRAMEBUFFER,Q.DEPTH_STENCIL_ATTACHMENT,Q.RENDERBUFFER,x),this.current=x,this.dirty=!1}}class Da{constructor(x,Q,G,X,te){this.context=x,this.width=Q,this.height=G;const Ae=x.gl,he=this.framebuffer=Ae.createFramebuffer();if(this.colorAttachment=new Io(x,he),X)this.depthAttachment=te?new Hs(x,he):new Xo(x,he);else if(te)throw new Error("Stencil cannot be setted without depth");if(Ae.checkFramebufferStatus(Ae.FRAMEBUFFER)!==Ae.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const x=this.context.gl,Q=this.colorAttachment.get();if(Q&&x.deleteTexture(Q),this.depthAttachment){const G=this.depthAttachment.get();G&&x.deleteRenderbuffer(G)}x.deleteFramebuffer(this.framebuffer)}}class Ur{constructor(x,Q,G){this.blendFunction=x,this.blendColor=Q,this.mask=G}}Ur.Replace=[1,0],Ur.disabled=new Ur(Ur.Replace,D.Color.transparent,[!1,!1,!1,!1]),Ur.unblended=new Ur(Ur.Replace,D.Color.transparent,[!0,!0,!0,!0]),Ur.alphaBlended=new Ur([1,771],D.Color.transparent,[!0,!0,!0,!0]);class $s{constructor(x){var Q,G;if(this.gl=x,this.clearColor=new $a(this),this.clearDepth=new Co(this),this.clearStencil=new In(this),this.colorMask=new sa(this),this.depthMask=new Eo(this),this.stencilMask=new To(this),this.stencilFunc=new na(this),this.stencilOp=new pl(this),this.stencilTest=new Ko(this),this.depthRange=new Go(this),this.depthTest=new So(this),this.depthFunc=new Wo(this),this.blend=new cn(this),this.blendFunc=new Rn(this),this.blendColor=new Fa(this),this.blendEquation=new eo(this),this.cullFace=new ka(this),this.cullFaceSide=new gn(this),this.frontFace=new aa(this),this.program=new Ds(this),this.activeTexture=new oa(this),this.viewport=new hn(this),this.bindFramebuffer=new Rs(this),this.bindRenderbuffer=new la(this),this.bindTexture=new Hn(this),this.bindVertexBuffer=new to(this),this.bindElementBuffer=new io(this),this.bindVertexArray=new gr(this),this.pixelStoreUnpack=new Js(this),this.pixelStoreUnpackPremultiplyAlpha=new gl(this),this.pixelStoreUnpackFlipY=new qo(this),this.extTextureFilterAnisotropic=x.getExtension("EXT_texture_filter_anisotropic")||x.getExtension("MOZ_EXT_texture_filter_anisotropic")||x.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=x.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=x.getParameter(x.MAX_TEXTURE_SIZE),Sn(x)){this.HALF_FLOAT=x.HALF_FLOAT;const X=x.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(Q=x.RGBA16F)!==null&&Q!==void 0?Q:X==null?void 0:X.RGBA16F_EXT,this.RGB16F=(G=x.RGB16F)!==null&&G!==void 0?G:X==null?void 0:X.RGB16F_EXT,x.getExtension("EXT_color_buffer_float")}else{x.getExtension("EXT_color_buffer_half_float"),x.getExtension("OES_texture_half_float_linear");const X=x.getExtension("OES_texture_half_float");this.HALF_FLOAT=X==null?void 0:X.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(x,Q){return new gs(this,x,Q)}createVertexBuffer(x,Q,G){return new Ia(this,x,Q,G)}createRenderbuffer(x,Q,G){const X=this.gl,te=X.createRenderbuffer();return this.bindRenderbuffer.set(te),X.renderbufferStorage(X.RENDERBUFFER,x,Q,G),this.bindRenderbuffer.set(null),te}createFramebuffer(x,Q,G,X){return new Da(this,x,Q,G,X)}clear({color:x,depth:Q,stencil:G}){const X=this.gl;let te=0;x&&(te|=X.COLOR_BUFFER_BIT,this.clearColor.set(x),this.colorMask.set([!0,!0,!0,!0])),Q!==void 0&&(te|=X.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(Q),this.depthMask.set(!0)),G!==void 0&&(te|=X.STENCIL_BUFFER_BIT,this.clearStencil.set(G),this.stencilMask.set(255)),X.clear(te)}setCullFace(x){x.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(x.mode),this.frontFace.set(x.frontFace))}setDepthMode(x){x.func!==this.gl.ALWAYS||x.mask?(this.depthTest.set(!0),this.depthFunc.set(x.func),this.depthMask.set(x.mask),this.depthRange.set(x.range)):this.depthTest.set(!1)}setStencilMode(x){x.test.func!==this.gl.ALWAYS||x.mask?(this.stencilTest.set(!0),this.stencilMask.set(x.mask),this.stencilOp.set([x.fail,x.depthFail,x.pass]),this.stencilFunc.set({func:x.test.func,ref:x.ref,mask:x.test.mask})):this.stencilTest.set(!1)}setColorMode(x){D.deepEqual(x.blendFunction,Ur.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(x.blendFunction),this.blendColor.set(x.blendColor)),this.colorMask.set(x.mask)}createVertexArray(){var x;return Sn(this.gl)?this.gl.createVertexArray():(x=this.gl.getExtension("OES_vertex_array_object"))===null||x===void 0?void 0:x.createVertexArrayOES()}deleteVertexArray(x){var Q;return Sn(this.gl)?this.gl.deleteVertexArray(x):(Q=this.gl.getExtension("OES_vertex_array_object"))===null||Q===void 0?void 0:Q.deleteVertexArrayOES(x)}unbindVAO(){this.bindVertexArray.set(null)}}class Ji{constructor(x,Q,G){this.func=x,this.mask=Q,this.range=G}}Ji.ReadOnly=!1,Ji.ReadWrite=!0,Ji.disabled=new Ji(519,Ji.ReadOnly,[0,1]);const yr=7680;class Fr{constructor(x,Q,G,X,te,Ae){this.test=x,this.ref=Q,this.mask=G,this.fail=X,this.depthFail=te,this.pass=Ae}}Fr.disabled=new Fr({func:519,mask:0},0,0,yr,yr,yr);class Mr{constructor(x,Q,G){this.enable=x,this.mode=Q,this.frontFace=G}}let zn;function Ua(J,x,Q,G,X,te,Ae){const he=J.context,pe=he.gl,ve=J.useProgram("collisionBox"),Ce=[];let Se=0,Qe=0;for(let ot=0;ot<G.length;ot++){const gt=G[ot],St=x.getTile(gt),It=St.getBucket(Q);if(!It)continue;let Lt=gt.posMatrix;X[0]===0&&X[1]===0||(Lt=J.translatePosMatrix(gt.posMatrix,St,X,te));const Kt=Ae?It.textCollisionBox:It.iconCollisionBox,Rt=It.collisionCircleArray;if(Rt.length>0){const Jt=D.create(),Bi=Lt;D.mul(Jt,It.placementInvProjMatrix,J.transform.glCoordMatrix),D.mul(Jt,Jt,It.placementViewportMatrix),Ce.push({circleArray:Rt,circleOffset:Qe,transform:Bi,invTransform:Jt,coord:gt}),Se+=Rt.length/4,Qe=Se}Kt&&ve.draw(he,pe.LINES,Ji.disabled,Fr.disabled,J.colorModeForRenderPass(),Mr.disabled,Qn(Lt,J.transform,St),J.style.map.terrain&&J.style.map.terrain.getTerrainData(gt),Q.id,Kt.layoutVertexBuffer,Kt.indexBuffer,Kt.segments,null,J.transform.zoom,null,null,Kt.collisionVertexBuffer)}if(!Ae||!Ce.length)return;const $e=J.useProgram("collisionCircle"),Ze=new D.CollisionCircleLayoutArray;Ze.resize(4*Se),Ze._trim();let rt=0;for(const ot of Ce)for(let gt=0;gt<ot.circleArray.length/4;gt++){const St=4*gt,It=ot.circleArray[St+0],Lt=ot.circleArray[St+1],Kt=ot.circleArray[St+2],Rt=ot.circleArray[St+3];Ze.emplace(rt++,It,Lt,Kt,Rt,0),Ze.emplace(rt++,It,Lt,Kt,Rt,1),Ze.emplace(rt++,It,Lt,Kt,Rt,2),Ze.emplace(rt++,It,Lt,Kt,Rt,3)}(!zn||zn.length<2*Se)&&(zn=function(ot){const gt=2*ot,St=new D.QuadTriangleArray;St.resize(gt),St._trim();for(let It=0;It<gt;It++){const Lt=6*It;St.uint16[Lt+0]=4*It+0,St.uint16[Lt+1]=4*It+1,St.uint16[Lt+2]=4*It+2,St.uint16[Lt+3]=4*It+2,St.uint16[Lt+4]=4*It+3,St.uint16[Lt+5]=4*It+0}return St}(Se));const Ye=he.createIndexBuffer(zn,!0),dt=he.createVertexBuffer(Ze,D.collisionCircleLayout.members,!0);for(const ot of Ce){const gt={u_matrix:ot.transform,u_inv_matrix:ot.invTransform,u_camera_to_center_distance:(Bt=J.transform).cameraToCenterDistance,u_viewport_size:[Bt.width,Bt.height]};$e.draw(he,pe.TRIANGLES,Ji.disabled,Fr.disabled,J.colorModeForRenderPass(),Mr.disabled,gt,J.style.map.terrain&&J.style.map.terrain.getTerrainData(ot.coord),Q.id,dt,Ye,D.SegmentVector.simpleSegment(0,2*ot.circleOffset,ot.circleArray.length,ot.circleArray.length/2),null,J.transform.zoom,null,null,null)}var Bt;dt.destroy(),Ye.destroy()}Mr.disabled=new Mr(!1,1029,2305),Mr.backCCW=new Mr(!0,1029,2305);const ro=D.identity(new Float32Array(16));function ml(J,x,Q,G,X,te){const{horizontalAlign:Ae,verticalAlign:he}=D.getAnchorAlignment(J);return new D.Point((-(Ae-.5)*x/X+G[0])*te,(-(he-.5)*Q/X+G[1])*te)}function Fo(J,x,Q,G,X,te,Ae,he,pe,ve,Ce){const Se=J.text.placedSymbolArray,Qe=J.text.dynamicLayoutVertexArray,$e=J.icon.dynamicLayoutVertexArray,Ze={};Qe.clear();for(let rt=0;rt<Se.length;rt++){const Ye=Se.get(rt),dt=Ye.hidden||!Ye.crossTileID||J.allowVerticalPlacement&&!Ye.placedOrientation?null:G[Ye.crossTileID];if(dt){const Bt=new D.Point(Ye.anchorX,Ye.anchorY),ot=mi(Bt,Q?Ae:te,Ce),gt=bi(X.cameraToCenterDistance,ot.signedDistanceFromCamera);let St=D.evaluateSizeForFeature(J.textSizeData,pe,Ye)*gt/D.ONE_EM;Q&&(St*=J.tilePixelRatio/he);const{width:It,height:Lt,anchor:Kt,textOffset:Rt,textBoxScale:Jt}=dt,Bi=ml(Kt,It,Lt,Rt,Jt,St),ar=Q?mi(Bt.add(Bi),te,Ce).point:ot.point.add(x?Bi.rotate(-X.angle):Bi),oi=J.allowVerticalPlacement&&Ye.placedOrientation===D.WritingMode.vertical?Math.PI/2:0;for(let ki=0;ki<Ye.numGlyphs;ki++)D.addDynamicAttributes(Qe,ar,oi);ve&&Ye.associatedIconIndex>=0&&(Ze[Ye.associatedIconIndex]={shiftedAnchor:ar,angle:oi})}else ye(Ye.numGlyphs,Qe)}if(ve){$e.clear();const rt=J.icon.placedSymbolArray;for(let Ye=0;Ye<rt.length;Ye++){const dt=rt.get(Ye);if(dt.hidden)ye(dt.numGlyphs,$e);else{const Bt=Ze[Ye];if(Bt)for(let ot=0;ot<dt.numGlyphs;ot++)D.addDynamicAttributes($e,Bt.shiftedAnchor,Bt.angle);else ye(dt.numGlyphs,$e)}}J.icon.dynamicLayoutVertexBuffer.updateData($e)}J.text.dynamicLayoutVertexBuffer.updateData(Qe)}function so(J,x,Q){return Q.iconsInText&&x?"symbolTextAndIcon":J?"symbolSDF":"symbolIcon"}function no(J,x,Q,G,X,te,Ae,he,pe,ve,Ce,Se){const Qe=J.context,$e=Qe.gl,Ze=J.transform,rt=he==="map",Ye=pe==="map",dt=he!=="viewport"&&Q.layout.get("symbol-placement")!=="point",Bt=rt&&!Ye&&!dt,ot=!Q.layout.get("symbol-sort-key").isConstant();let gt=!1;const St=J.depthModeForSublayer(0,Ji.ReadOnly),It=Q._unevaluatedLayout.hasValue("text-variable-anchor")||Q._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Lt=[];for(const Kt of G){const Rt=x.getTile(Kt),Jt=Rt.getBucket(Q);if(!Jt)continue;const Bi=X?Jt.text:Jt.icon;if(!Bi||!Bi.segments.get().length||!Bi.hasVisibleVertices)continue;const ar=Bi.programConfigurations.get(Q.id),oi=X||Jt.sdfIcons,ki=X?Jt.textSizeData:Jt.iconSizeData,xi=Ye||Ze.pitch!==0,Hr=J.useProgram(so(oi,X,Jt),ar),or=D.evaluateSizeForZoom(ki,Ze.zoom),Mi=J.style.map.terrain&&J.style.map.terrain.getTerrainData(Kt);let lr,Kr,kr,rn,ws=[0,0],Zr=null;if(X)Kr=Rt.glyphAtlasTexture,kr=$e.LINEAR,lr=Rt.glyphAtlasTexture.size,Jt.iconsInText&&(ws=Rt.imageAtlasTexture.size,Zr=Rt.imageAtlasTexture,rn=xi||J.options.rotating||J.options.zooming||ki.kind==="composite"||ki.kind==="camera"?$e.LINEAR:$e.NEAREST);else{const hs=Q.layout.get("icon-size").constantOr(0)!==1||Jt.iconsNeedLinear;Kr=Rt.imageAtlasTexture,kr=oi||J.options.rotating||J.options.zooming||hs||xi?$e.LINEAR:$e.NEAREST,lr=Rt.imageAtlasTexture.size}const Vs=Le(Rt,1,J.transform.zoom),Un=Wi(Kt.posMatrix,Ye,rt,J.transform,Vs),bn=Zt(Kt.posMatrix,Ye,rt,J.transform,Vs),Mn=It&&Jt.hasTextData(),fo=Q.layout.get("icon-text-fit")!=="none"&&Mn&&Jt.hasIconData();if(dt){const hs=J.style.map.terrain?(Es,Gr)=>J.style.map.terrain.getElevation(Kt,Es,Gr):null,as=Q.layout.get("text-rotation-alignment")==="map";tr(Jt,Kt.posMatrix,J,X,Un,bn,Ye,ve,as,hs)}const ma=J.translatePosMatrix(Kt.posMatrix,Rt,te,Ae),Xn=dt||X&&It||fo?ro:Un,is=J.translatePosMatrix(bn,Rt,te,Ae,!0),cs=oi&&Q.paint.get(X?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Cs;Cs=oi?Jt.iconsInText?Sa(ki.kind,or,Bt,Ye,J,ma,Xn,is,lr,ws):Ta(ki.kind,or,Bt,Ye,J,ma,Xn,is,X,lr,!0):Ea(ki.kind,or,Bt,Ye,J,ma,Xn,is,X,lr);const po={program:Hr,buffers:Bi,uniformValues:Cs,atlasTexture:Kr,atlasTextureIcon:Zr,atlasInterpolation:kr,atlasInterpolationIcon:rn,isSDF:oi,hasHalo:cs};if(ot&&Jt.canOverlap){gt=!0;const hs=Bi.segments.get();for(const as of hs)Lt.push({segments:new D.SegmentVector([as]),sortKey:as.sortKey,state:po,terrainData:Mi})}else Lt.push({segments:Bi.segments,sortKey:0,state:po,terrainData:Mi})}gt&&Lt.sort((Kt,Rt)=>Kt.sortKey-Rt.sortKey);for(const Kt of Lt){const Rt=Kt.state;if(Qe.activeTexture.set($e.TEXTURE0),Rt.atlasTexture.bind(Rt.atlasInterpolation,$e.CLAMP_TO_EDGE),Rt.atlasTextureIcon&&(Qe.activeTexture.set($e.TEXTURE1),Rt.atlasTextureIcon&&Rt.atlasTextureIcon.bind(Rt.atlasInterpolationIcon,$e.CLAMP_TO_EDGE)),Rt.isSDF){const Jt=Rt.uniformValues;Rt.hasHalo&&(Jt.u_is_halo=1,Ma(Rt.buffers,Kt.segments,Q,J,Rt.program,St,Ce,Se,Jt,Kt.terrainData)),Jt.u_is_halo=0}Ma(Rt.buffers,Kt.segments,Q,J,Rt.program,St,Ce,Se,Rt.uniformValues,Kt.terrainData)}}function Ma(J,x,Q,G,X,te,Ae,he,pe,ve){const Ce=G.context;X.draw(Ce,Ce.gl.TRIANGLES,te,Ae,he,Mr.disabled,pe,ve,Q.id,J.layoutVertexBuffer,J.indexBuffer,x,Q.paint,G.transform.zoom,J.programConfigurations.get(Q.id),J.dynamicLayoutVertexBuffer,J.opacityVertexBuffer)}function ao(J,x,Q,G,X){if(!Q||!G||!G.imageAtlas)return;const te=G.imageAtlas.patternPositions;let Ae=te[Q.to.toString()],he=te[Q.from.toString()];if(!Ae||!he){const pe=X.getPaintProperty(x);Ae=te[pe],he=te[pe]}Ae&&he&&J.setConstantPatternPositions(Ae,he)}function oo(J,x,Q,G,X,te,Ae){const he=J.context.gl,pe="fill-pattern",ve=Q.paint.get(pe),Ce=ve&&ve.constantOr(1),Se=Q.getCrossfadeParameters();let Qe,$e,Ze,rt,Ye;Ae?($e=Ce&&!Q.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Qe=he.LINES):($e=Ce?"fillPattern":"fill",Qe=he.TRIANGLES);const dt=ve.constantOr(null);for(const Bt of G){const ot=x.getTile(Bt);if(Ce&&!ot.patternsLoaded())continue;const gt=ot.getBucket(Q);if(!gt)continue;const St=gt.programConfigurations.get(Q.id),It=J.useProgram($e,St),Lt=J.style.map.terrain&&J.style.map.terrain.getTerrainData(Bt);Ce&&(J.context.activeTexture.set(he.TEXTURE0),ot.imageAtlasTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE),St.updatePaintBuffers(Se)),ao(St,pe,dt,ot,Q);const Kt=Lt?Bt:null,Rt=J.translatePosMatrix(Kt?Kt.posMatrix:Bt.posMatrix,ot,Q.paint.get("fill-translate"),Q.paint.get("fill-translate-anchor"));if(Ae){rt=gt.indexBuffer2,Ye=gt.segments2;const Jt=[he.drawingBufferWidth,he.drawingBufferHeight];Ze=$e==="fillOutlinePattern"&&Ce?ta(Rt,J,Se,ot,Jt):An(Rt,Jt)}else rt=gt.indexBuffer,Ye=gt.segments,Ze=Ce?Zs(Rt,J,Se,ot):xo(Rt);It.draw(J.context,Qe,X,J.stencilModeForClipping(Bt),te,Mr.disabled,Ze,Lt,Q.id,gt.layoutVertexBuffer,rt,Ye,Q.paint,J.transform.zoom,St)}}function Pa(J,x,Q,G,X,te,Ae){const he=J.context,pe=he.gl,ve="fill-extrusion-pattern",Ce=Q.paint.get(ve),Se=Ce.constantOr(1),Qe=Q.getCrossfadeParameters(),$e=Q.paint.get("fill-extrusion-opacity"),Ze=Ce.constantOr(null);for(const rt of G){const Ye=x.getTile(rt),dt=Ye.getBucket(Q);if(!dt)continue;const Bt=J.style.map.terrain&&J.style.map.terrain.getTerrainData(rt),ot=dt.programConfigurations.get(Q.id),gt=J.useProgram(Se?"fillExtrusionPattern":"fillExtrusion",ot);Se&&(J.context.activeTexture.set(pe.TEXTURE0),Ye.imageAtlasTexture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE),ot.updatePaintBuffers(Qe)),ao(ot,ve,Ze,Ye,Q);const St=J.translatePosMatrix(rt.posMatrix,Ye,Q.paint.get("fill-extrusion-translate"),Q.paint.get("fill-extrusion-translate-anchor")),It=Q.paint.get("fill-extrusion-vertical-gradient"),Lt=Se?es(St,J,It,$e,rt,Qe,Ye):Qr(St,J,It,$e);gt.draw(he,he.gl.TRIANGLES,X,te,Ae,Mr.backCCW,Lt,Bt,Q.id,dt.layoutVertexBuffer,dt.indexBuffer,dt.segments,Q.paint,J.transform.zoom,ot,J.style.map.terrain&&dt.centroidVertexBuffer)}}function Nn(J,x,Q,G,X,te,Ae){const he=J.context,pe=he.gl,ve=Q.fbo;if(!ve)return;const Ce=J.useProgram("hillshade"),Se=J.style.map.terrain&&J.style.map.terrain.getTerrainData(x);he.activeTexture.set(pe.TEXTURE0),pe.bindTexture(pe.TEXTURE_2D,ve.colorAttachment.get()),Ce.draw(he,pe.TRIANGLES,X,te,Ae,Mr.disabled,((Qe,$e,Ze,rt)=>{const Ye=Ze.paint.get("hillshade-shadow-color"),dt=Ze.paint.get("hillshade-highlight-color"),Bt=Ze.paint.get("hillshade-accent-color");let ot=Ze.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ze.paint.get("hillshade-illumination-anchor")==="viewport"&&(ot-=Qe.transform.angle);const gt=!Qe.options.moving;return{u_matrix:rt?rt.posMatrix:Qe.transform.calculatePosMatrix($e.tileID.toUnwrapped(),gt),u_image:0,u_latrange:Bo(0,$e.tileID),u_light:[Ze.paint.get("hillshade-exaggeration"),ot],u_shadow:Ye,u_highlight:dt,u_accent:Bt}})(J,Q,G,Se?x:null),Se,G.id,J.rasterBoundsBuffer,J.quadTriangleIndexBuffer,J.rasterBoundsSegments)}function La(J,x,Q,G,X,te){const Ae=J.context,he=Ae.gl,pe=x.dem;if(pe&&pe.data){const ve=pe.dim,Ce=pe.stride,Se=pe.getPixels();if(Ae.activeTexture.set(he.TEXTURE1),Ae.pixelStoreUnpackPremultiplyAlpha.set(!1),x.demTexture=x.demTexture||J.getTileTexture(Ce),x.demTexture){const $e=x.demTexture;$e.update(Se,{premultiply:!1}),$e.bind(he.NEAREST,he.CLAMP_TO_EDGE)}else x.demTexture=new vt(Ae,Se,he.RGBA,{premultiply:!1}),x.demTexture.bind(he.NEAREST,he.CLAMP_TO_EDGE);Ae.activeTexture.set(he.TEXTURE0);let Qe=x.fbo;if(!Qe){const $e=new vt(Ae,{width:ve,height:ve,data:null},he.RGBA);$e.bind(he.LINEAR,he.CLAMP_TO_EDGE),Qe=x.fbo=Ae.createFramebuffer(ve,ve,!0,!1),Qe.colorAttachment.set($e.texture)}Ae.bindFramebuffer.set(Qe.framebuffer),Ae.viewport.set([0,0,ve,ve]),J.useProgram("hillshadePrepare").draw(Ae,he.TRIANGLES,G,X,te,Mr.disabled,(($e,Ze)=>{const rt=Ze.stride,Ye=D.create();return D.ortho(Ye,0,D.EXTENT,-D.EXTENT,0,0,1),D.translate(Ye,Ye,[0,-D.EXTENT,0]),{u_matrix:Ye,u_image:1,u_dimension:[rt,rt],u_zoom:$e.overscaledZ,u_unpack:Ze.getUnpackVector()}})(x.tileID,pe),null,Q.id,J.rasterBoundsBuffer,J.quadTriangleIndexBuffer,J.rasterBoundsSegments),x.needsHillshadePrepare=!1}}function _l(J,x,Q,G,X,te){const Ae=G.paint.get("raster-fade-duration");if(!te&&Ae>0){const he=D.browser.now(),pe=(he-J.timeAdded)/Ae,ve=x?(he-x.timeAdded)/Ae:-1,Ce=Q.getSource(),Se=X.coveringZoomLevel({tileSize:Ce.tileSize,roundZoom:Ce.roundZoom}),Qe=!x||Math.abs(x.tileID.overscaledZ-Se)>Math.abs(J.tileID.overscaledZ-Se),$e=Qe&&J.refreshedUponExpiration?1:D.clamp(Qe?pe:1-ve,0,1);return J.refreshedUponExpiration&&pe>=1&&(J.refreshedUponExpiration=!1),x?{opacity:1,mix:1-$e}:{opacity:$e,mix:0}}return{opacity:1,mix:0}}const Yo=new D.Color(1,0,0,1),Wr=new D.Color(0,1,0,1),Vn=new D.Color(0,0,1,1),Us=new D.Color(1,0,1,1),ko=new D.Color(0,1,1,1);function Aa(J,x,Q,G){en(J,0,x+Q/2,J.transform.width,Q,G)}function Do(J,x,Q,G){en(J,x-Q/2,0,Q,J.transform.height,G)}function en(J,x,Q,G,X,te){const Ae=J.context,he=Ae.gl;he.enable(he.SCISSOR_TEST),he.scissor(x*J.pixelRatio,Q*J.pixelRatio,G*J.pixelRatio,X*J.pixelRatio),Ae.clear({color:te}),he.disable(he.SCISSOR_TEST)}function xs(J,x,Q){const G=J.context,X=G.gl,te=Q.posMatrix,Ae=J.useProgram("debug"),he=Ji.disabled,pe=Fr.disabled,ve=J.colorModeForRenderPass(),Ce="$debug",Se=J.style.map.terrain&&J.style.map.terrain.getTerrainData(Q);G.activeTexture.set(X.TEXTURE0);const Qe=x.getTileByID(Q.key).latestRawTileData,$e=Math.floor((Qe&&Qe.byteLength||0)/1024),Ze=x.getTile(Q).tileSize,rt=512/Math.min(Ze,512)*(Q.overscaledZ/J.transform.zoom)*.5;let Ye=Q.canonical.toString();Q.overscaledZ!==Q.canonical.z&&(Ye+=` => ${Q.overscaledZ}`),function(dt,Bt){dt.initDebugOverlayCanvas();const ot=dt.debugOverlayCanvas,gt=dt.context.gl,St=dt.debugOverlayCanvas.getContext("2d");St.clearRect(0,0,ot.width,ot.height),St.shadowColor="white",St.shadowBlur=2,St.lineWidth=1.5,St.strokeStyle="white",St.textBaseline="top",St.font="bold 36px Open Sans, sans-serif",St.fillText(Bt,5,5),St.strokeText(Bt,5,5),dt.debugOverlayTexture.update(ot),dt.debugOverlayTexture.bind(gt.LINEAR,gt.CLAMP_TO_EDGE)}(J,`${Ye} ${$e}kB`),Ae.draw(G,X.TRIANGLES,he,pe,Ur.alphaBlended,Mr.disabled,wa(te,D.Color.transparent,rt),null,Ce,J.debugBuffer,J.quadTriangleIndexBuffer,J.debugSegments),Ae.draw(G,X.LINE_STRIP,he,pe,ve,Mr.disabled,wa(te,D.Color.red),Se,Ce,J.debugBuffer,J.tileBorderIndexBuffer,J.debugSegments)}function Kn(J,x,Q){const G=J.context,X=G.gl,te=J.colorModeForRenderPass(),Ae=new Ji(X.LEQUAL,Ji.ReadWrite,J.depthRangeFor3D),he=J.useProgram("terrain"),pe=x.getTerrainMesh();G.bindFramebuffer.set(null),G.viewport.set([0,0,J.width,J.height]);for(const ve of Q){const Ce=J.renderToTexture.getTexture(ve),Se=x.getTerrainData(ve.tileID);G.activeTexture.set(X.TEXTURE0),X.bindTexture(X.TEXTURE_2D,Ce.texture);const Qe={u_matrix:J.transform.calculatePosMatrix(ve.tileID.toUnwrapped()),u_texture:0,u_ele_delta:x.getMeshFrameDelta(J.transform.zoom)};he.draw(G,X.TRIANGLES,Ae,Fr.disabled,te,Mr.backCCW,Qe,Se,"terrain",pe.vertexBuffer,pe.indexBuffer,pe.segments)}}class jo{constructor(x,Q){this.context=new $s(x),this.transform=Q,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:D.create(),renderTime:0},this.setup(),this.numSublayers=$t.maxUnderzooming+$t.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new _r}resize(x,Q,G){if(this.width=Math.floor(x*G),this.height=Math.floor(Q*G),this.pixelRatio=G,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const X of this.style._order)this.style._layers[X].resize()}setup(){const x=this.context,Q=new D.PosArray;Q.emplaceBack(0,0),Q.emplaceBack(D.EXTENT,0),Q.emplaceBack(0,D.EXTENT),Q.emplaceBack(D.EXTENT,D.EXTENT),this.tileExtentBuffer=x.createVertexBuffer(Q,jr.members),this.tileExtentSegments=D.SegmentVector.simpleSegment(0,0,4,2);const G=new D.PosArray;G.emplaceBack(0,0),G.emplaceBack(D.EXTENT,0),G.emplaceBack(0,D.EXTENT),G.emplaceBack(D.EXTENT,D.EXTENT),this.debugBuffer=x.createVertexBuffer(G,jr.members),this.debugSegments=D.SegmentVector.simpleSegment(0,0,4,5);const X=new D.RasterBoundsArray;X.emplaceBack(0,0,0,0),X.emplaceBack(D.EXTENT,0,D.EXTENT,0),X.emplaceBack(0,D.EXTENT,0,D.EXTENT),X.emplaceBack(D.EXTENT,D.EXTENT,D.EXTENT,D.EXTENT),this.rasterBoundsBuffer=x.createVertexBuffer(X,Te.members),this.rasterBoundsSegments=D.SegmentVector.simpleSegment(0,0,4,2);const te=new D.PosArray;te.emplaceBack(0,0),te.emplaceBack(1,0),te.emplaceBack(0,1),te.emplaceBack(1,1),this.viewportBuffer=x.createVertexBuffer(te,jr.members),this.viewportSegments=D.SegmentVector.simpleSegment(0,0,4,2);const Ae=new D.LineStripIndexArray;Ae.emplaceBack(0),Ae.emplaceBack(1),Ae.emplaceBack(3),Ae.emplaceBack(2),Ae.emplaceBack(0),this.tileBorderIndexBuffer=x.createIndexBuffer(Ae);const he=new D.TriangleIndexArray;he.emplaceBack(0,1,2),he.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=x.createIndexBuffer(he);const pe=this.context.gl;this.stencilClearMode=new Fr({func:pe.ALWAYS,mask:0},0,255,pe.ZERO,pe.ZERO,pe.ZERO)}clearStencil(){const x=this.context,Q=x.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const G=D.create();D.ortho(G,0,this.width,this.height,0,0,1),D.scale(G,G,[Q.drawingBufferWidth,Q.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(x,Q.TRIANGLES,Ji.disabled,this.stencilClearMode,Ur.disabled,Mr.disabled,Nr(G),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(x,Q){if(this.currentStencilSource===x.source||!x.isTileClipped()||!Q||!Q.length)return;this.currentStencilSource=x.source;const G=this.context,X=G.gl;this.nextStencilID+Q.length>256&&this.clearStencil(),G.setColorMode(Ur.disabled),G.setDepthMode(Ji.disabled);const te=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const Ae of Q){const he=this._tileClippingMaskIDs[Ae.key]=this.nextStencilID++,pe=this.style.map.terrain&&this.style.map.terrain.getTerrainData(Ae);te.draw(G,X.TRIANGLES,Ji.disabled,new Fr({func:X.ALWAYS,mask:0},he,255,X.KEEP,X.KEEP,X.REPLACE),Ur.disabled,Mr.disabled,Nr(Ae.posMatrix),pe,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const x=this.nextStencilID++,Q=this.context.gl;return new Fr({func:Q.NOTEQUAL,mask:255},x,255,Q.KEEP,Q.KEEP,Q.REPLACE)}stencilModeForClipping(x){const Q=this.context.gl;return new Fr({func:Q.EQUAL,mask:255},this._tileClippingMaskIDs[x.key],0,Q.KEEP,Q.KEEP,Q.REPLACE)}stencilConfigForOverlap(x){const Q=this.context.gl,G=x.sort((Ae,he)=>he.overscaledZ-Ae.overscaledZ),X=G[G.length-1].overscaledZ,te=G[0].overscaledZ-X+1;if(te>1){this.currentStencilSource=void 0,this.nextStencilID+te>256&&this.clearStencil();const Ae={};for(let he=0;he<te;he++)Ae[he+X]=new Fr({func:Q.GEQUAL,mask:255},he+this.nextStencilID,255,Q.KEEP,Q.KEEP,Q.REPLACE);return this.nextStencilID+=te,[Ae,G]}return[{[X]:Fr.disabled},G]}colorModeForRenderPass(){const x=this.context.gl;return this._showOverdrawInspector?new Ur([x.CONSTANT_COLOR,x.ONE],new D.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ur.unblended:Ur.alphaBlended}depthModeForSublayer(x,Q,G){if(!this.opaquePassEnabledForLayer())return Ji.disabled;const X=1-((1+this.currentLayer)*this.numSublayers+x)*this.depthEpsilon;return new Ji(G||this.context.gl.LEQUAL,Q,[X,X])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(x,Q){this.style=x,this.options=Q,this.lineAtlas=x.lineAtlas,this.imageManager=x.imageManager,this.glyphManager=x.glyphManager,this.symbolFadeChange=x.placement.symbolFadeChange(D.browser.now()),this.imageManager.beginFrame();const G=this.style._order,X=this.style.sourceCaches,te={},Ae={},he={};for(const pe in X){const ve=X[pe];ve.used&&ve.prepare(this.context),te[pe]=ve.getVisibleCoordinates(),Ae[pe]=te[pe].slice().reverse(),he[pe]=ve.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let pe=0;pe<G.length;pe++)if(this.style._layers[G[pe]].is3D()){this.opaquePassCutoff=pe;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const pe=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!D.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||pe.length)&&(D.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(ve,Ce){const Se=ve.context,Qe=Se.gl,$e=Ur.unblended,Ze=new Ji(Qe.LEQUAL,Ji.ReadWrite,[0,1]),rt=Ce.getTerrainMesh(),Ye=Ce.sourceCache.getRenderableTiles(),dt=ve.useProgram("terrainDepth");Se.bindFramebuffer.set(Ce.getFramebuffer("depth").framebuffer),Se.viewport.set([0,0,ve.width/devicePixelRatio,ve.height/devicePixelRatio]),Se.clear({color:D.Color.transparent,depth:1});for(const Bt of Ye){const ot=Ce.getTerrainData(Bt.tileID),gt={u_matrix:ve.transform.calculatePosMatrix(Bt.tileID.toUnwrapped()),u_ele_delta:Ce.getMeshFrameDelta(ve.transform.zoom)};dt.draw(Se,Qe.TRIANGLES,Ze,Fr.disabled,$e,Mr.backCCW,gt,ot,"terrain",rt.vertexBuffer,rt.indexBuffer,rt.segments)}Se.bindFramebuffer.set(null),Se.viewport.set([0,0,ve.width,ve.height])}(this,this.style.map.terrain),function(ve,Ce){const Se=ve.context,Qe=Se.gl,$e=Ur.unblended,Ze=new Ji(Qe.LEQUAL,Ji.ReadWrite,[0,1]),rt=Ce.getTerrainMesh(),Ye=Ce.getCoordsTexture(),dt=Ce.sourceCache.getRenderableTiles(),Bt=ve.useProgram("terrainCoords");Se.bindFramebuffer.set(Ce.getFramebuffer("coords").framebuffer),Se.viewport.set([0,0,ve.width/devicePixelRatio,ve.height/devicePixelRatio]),Se.clear({color:D.Color.transparent,depth:1}),Ce.coordsIndex=[];for(const ot of dt){const gt=Ce.getTerrainData(ot.tileID);Se.activeTexture.set(Qe.TEXTURE0),Qe.bindTexture(Qe.TEXTURE_2D,Ye.texture);const St={u_matrix:ve.transform.calculatePosMatrix(ot.tileID.toUnwrapped()),u_terrain_coords_id:(255-Ce.coordsIndex.length)/255,u_texture:0,u_ele_delta:Ce.getMeshFrameDelta(ve.transform.zoom)};Bt.draw(Se,Qe.TRIANGLES,Ze,Fr.disabled,$e,Mr.backCCW,St,gt,"terrain",rt.vertexBuffer,rt.indexBuffer,rt.segments),Ce.coordsIndex.push(ot.tileID.key)}Se.bindFramebuffer.set(null),Se.viewport.set([0,0,ve.width,ve.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const pe of G){const ve=this.style._layers[pe];if(!ve.hasOffscreenPass()||ve.isHidden(this.transform.zoom))continue;const Ce=Ae[ve.source];(ve.type==="custom"||Ce.length)&&this.renderLayer(this,X[ve.source],ve,Ce)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:Q.showOverdrawInspector?D.Color.black:D.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=Q.showOverdrawInspector,this.depthRangeFor3D=[0,1-(x._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=G.length-1;this.currentLayer>=0;this.currentLayer--){const pe=this.style._layers[G[this.currentLayer]],ve=X[pe.source],Ce=te[pe.source];this._renderTileClippingMasks(pe,Ce),this.renderLayer(this,ve,pe,Ce)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<G.length;this.currentLayer++){const pe=this.style._layers[G[this.currentLayer]],ve=X[pe.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(pe))continue;const Ce=(pe.type==="symbol"?he:Ae)[pe.source];this._renderTileClippingMasks(pe,te[pe.source]),this.renderLayer(this,ve,pe,Ce)}if(this.options.showTileBoundaries){const pe=function(ve,Ce){let Se=null;const Qe=Object.values(ve._layers).flatMap(Ye=>Ye.source&&!Ye.isHidden(Ce)?[ve.sourceCaches[Ye.source]]:[]),$e=Qe.filter(Ye=>Ye.getSource().type==="vector"),Ze=Qe.filter(Ye=>Ye.getSource().type!=="vector"),rt=Ye=>{(!Se||Se.getSource().maxzoom<Ye.getSource().maxzoom)&&(Se=Ye)};return $e.forEach(Ye=>rt(Ye)),Se||Ze.forEach(Ye=>rt(Ye)),Se}(this.style,this.transform.zoom);pe&&function(ve,Ce,Se){for(let Qe=0;Qe<Se.length;Qe++)xs(ve,Ce,Se[Qe])}(this,pe,pe.getVisibleCoordinates())}this.options.showPadding&&function(pe){const ve=pe.transform.padding;Aa(pe,pe.transform.height-(ve.top||0),3,Yo),Aa(pe,ve.bottom||0,3,Wr),Do(pe,ve.left||0,3,Vn),Do(pe,pe.transform.width-(ve.right||0),3,Us);const Ce=pe.transform.centerPoint;(function(Se,Qe,$e,Ze){en(Se,Qe-1,$e-10,2,20,Ze),en(Se,Qe-10,$e-1,20,2,Ze)})(pe,Ce.x,pe.transform.height-Ce.y,ko)}(this),this.context.setDefault()}renderLayer(x,Q,G,X){if(!G.isHidden(this.transform.zoom)&&(G.type==="background"||G.type==="custom"||(X||[]).length))switch(this.id=G.id,G.type){case"symbol":(function(te,Ae,he,pe,ve){if(te.renderPass!=="translucent")return;const Ce=Fr.disabled,Se=te.colorModeForRenderPass();(he._unevaluatedLayout.hasValue("text-variable-anchor")||he._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(Qe,$e,Ze,rt,Ye,dt,Bt){const ot=$e.transform,gt=Ye==="map",St=dt==="map";for(const It of Qe){const Lt=rt.getTile(It),Kt=Lt.getBucket(Ze);if(!Kt||!Kt.text||!Kt.text.segments.get().length)continue;const Rt=D.evaluateSizeForZoom(Kt.textSizeData,ot.zoom),Jt=Le(Lt,1,$e.transform.zoom),Bi=Wi(It.posMatrix,St,gt,$e.transform,Jt),ar=Ze.layout.get("icon-text-fit")!=="none"&&Kt.hasIconData();if(Rt){const oi=Math.pow(2,ot.zoom-Lt.tileID.overscaledZ);Fo(Kt,gt,St,Bt,ot,Bi,It.posMatrix,oi,Rt,ar,$e.style.map.terrain?(ki,xi)=>$e.style.map.terrain.getElevation(It,ki,xi):null)}}}(pe,te,he,Ae,he.layout.get("text-rotation-alignment"),he.layout.get("text-pitch-alignment"),ve),he.paint.get("icon-opacity").constantOr(1)!==0&&no(te,Ae,he,pe,!1,he.paint.get("icon-translate"),he.paint.get("icon-translate-anchor"),he.layout.get("icon-rotation-alignment"),he.layout.get("icon-pitch-alignment"),he.layout.get("icon-keep-upright"),Ce,Se),he.paint.get("text-opacity").constantOr(1)!==0&&no(te,Ae,he,pe,!0,he.paint.get("text-translate"),he.paint.get("text-translate-anchor"),he.layout.get("text-rotation-alignment"),he.layout.get("text-pitch-alignment"),he.layout.get("text-keep-upright"),Ce,Se),Ae.map.showCollisionBoxes&&(Ua(te,Ae,he,pe,he.paint.get("text-translate"),he.paint.get("text-translate-anchor"),!0),Ua(te,Ae,he,pe,he.paint.get("icon-translate"),he.paint.get("icon-translate-anchor"),!1))})(x,Q,G,X,this.style.placement.variableOffsets);break;case"circle":(function(te,Ae,he,pe){if(te.renderPass!=="translucent")return;const ve=he.paint.get("circle-opacity"),Ce=he.paint.get("circle-stroke-width"),Se=he.paint.get("circle-stroke-opacity"),Qe=!he.layout.get("circle-sort-key").isConstant();if(ve.constantOr(1)===0&&(Ce.constantOr(1)===0||Se.constantOr(1)===0))return;const $e=te.context,Ze=$e.gl,rt=te.depthModeForSublayer(0,Ji.ReadOnly),Ye=Fr.disabled,dt=te.colorModeForRenderPass(),Bt=[];for(let ot=0;ot<pe.length;ot++){const gt=pe[ot],St=Ae.getTile(gt),It=St.getBucket(he);if(!It)continue;const Lt=It.programConfigurations.get(he.id),Kt=te.useProgram("circle",Lt),Rt=It.layoutVertexBuffer,Jt=It.indexBuffer,Bi=te.style.map.terrain&&te.style.map.terrain.getTerrainData(gt),ar={programConfiguration:Lt,program:Kt,layoutVertexBuffer:Rt,indexBuffer:Jt,uniformValues:ja(te,gt,St,he),terrainData:Bi};if(Qe){const oi=It.segments.get();for(const ki of oi)Bt.push({segments:new D.SegmentVector([ki]),sortKey:ki.sortKey,state:ar})}else Bt.push({segments:It.segments,sortKey:0,state:ar})}Qe&&Bt.sort((ot,gt)=>ot.sortKey-gt.sortKey);for(const ot of Bt){const{programConfiguration:gt,program:St,layoutVertexBuffer:It,indexBuffer:Lt,uniformValues:Kt,terrainData:Rt}=ot.state;St.draw($e,Ze.TRIANGLES,rt,Ye,dt,Mr.disabled,Kt,Rt,he.id,It,Lt,ot.segments,he.paint,te.transform.zoom,gt)}})(x,Q,G,X);break;case"heatmap":(function(te,Ae,he,pe){if(he.paint.get("heatmap-opacity")!==0)if(te.renderPass==="offscreen"){const ve=te.context,Ce=ve.gl,Se=Fr.disabled,Qe=new Ur([Ce.ONE,Ce.ONE],D.Color.transparent,[!0,!0,!0,!0]);(function($e,Ze,rt){const Ye=$e.gl;$e.activeTexture.set(Ye.TEXTURE1),$e.viewport.set([0,0,Ze.width/4,Ze.height/4]);let dt=rt.heatmapFbo;if(dt)Ye.bindTexture(Ye.TEXTURE_2D,dt.colorAttachment.get()),$e.bindFramebuffer.set(dt.framebuffer);else{const Bt=Ye.createTexture();Ye.bindTexture(Ye.TEXTURE_2D,Bt),Ye.texParameteri(Ye.TEXTURE_2D,Ye.TEXTURE_WRAP_S,Ye.CLAMP_TO_EDGE),Ye.texParameteri(Ye.TEXTURE_2D,Ye.TEXTURE_WRAP_T,Ye.CLAMP_TO_EDGE),Ye.texParameteri(Ye.TEXTURE_2D,Ye.TEXTURE_MIN_FILTER,Ye.LINEAR),Ye.texParameteri(Ye.TEXTURE_2D,Ye.TEXTURE_MAG_FILTER,Ye.LINEAR),dt=rt.heatmapFbo=$e.createFramebuffer(Ze.width/4,Ze.height/4,!1,!1),function(ot,gt,St,It){var Lt,Kt;const Rt=ot.gl,Jt=(Lt=ot.HALF_FLOAT)!==null&&Lt!==void 0?Lt:Rt.UNSIGNED_BYTE,Bi=(Kt=ot.RGBA16F)!==null&&Kt!==void 0?Kt:Rt.RGBA;Rt.texImage2D(Rt.TEXTURE_2D,0,Bi,gt.width/4,gt.height/4,0,Rt.RGBA,Jt,null),It.colorAttachment.set(St)}($e,Ze,Bt,dt)}})(ve,te,he),ve.clear({color:D.Color.transparent});for(let $e=0;$e<pe.length;$e++){const Ze=pe[$e];if(Ae.hasRenderableParent(Ze))continue;const rt=Ae.getTile(Ze),Ye=rt.getBucket(he);if(!Ye)continue;const dt=Ye.programConfigurations.get(he.id),Bt=te.useProgram("heatmap",dt),{zoom:ot}=te.transform;Bt.draw(ve,Ce.TRIANGLES,Ji.disabled,Se,Qe,Mr.disabled,Vo(Ze.posMatrix,rt,ot,he.paint.get("heatmap-intensity")),null,he.id,Ye.layoutVertexBuffer,Ye.indexBuffer,Ye.segments,he.paint,te.transform.zoom,dt)}ve.viewport.set([0,0,te.width,te.height])}else te.renderPass==="translucent"&&(te.context.setColorMode(te.colorModeForRenderPass()),function(ve,Ce){const Se=ve.context,Qe=Se.gl,$e=Ce.heatmapFbo;if(!$e)return;Se.activeTexture.set(Qe.TEXTURE0),Qe.bindTexture(Qe.TEXTURE_2D,$e.colorAttachment.get()),Se.activeTexture.set(Qe.TEXTURE1);let Ze=Ce.colorRampTexture;Ze||(Ze=Ce.colorRampTexture=new vt(Se,Ce.colorRamp,Qe.RGBA)),Ze.bind(Qe.LINEAR,Qe.CLAMP_TO_EDGE),ve.useProgram("heatmapTexture").draw(Se,Qe.TRIANGLES,Ji.disabled,Fr.disabled,ve.colorModeForRenderPass(),Mr.disabled,((rt,Ye,dt,Bt)=>{const ot=D.create();D.ortho(ot,0,rt.width,rt.height,0,0,1);const gt=rt.context.gl;return{u_matrix:ot,u_world:[gt.drawingBufferWidth,gt.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Ye.paint.get("heatmap-opacity")}})(ve,Ce),null,Ce.id,ve.viewportBuffer,ve.quadTriangleIndexBuffer,ve.viewportSegments,Ce.paint,ve.transform.zoom)}(te,he))})(x,Q,G,X);break;case"line":(function(te,Ae,he,pe){if(te.renderPass!=="translucent")return;const ve=he.paint.get("line-opacity"),Ce=he.paint.get("line-width");if(ve.constantOr(1)===0||Ce.constantOr(1)===0)return;const Se=te.depthModeForSublayer(0,Ji.ReadOnly),Qe=te.colorModeForRenderPass(),$e=he.paint.get("line-dasharray"),Ze=he.paint.get("line-pattern"),rt=Ze.constantOr(1),Ye=he.paint.get("line-gradient"),dt=he.getCrossfadeParameters(),Bt=rt?"linePattern":$e?"lineSDF":Ye?"lineGradient":"line",ot=te.context,gt=ot.gl;let St=!0;for(const It of pe){const Lt=Ae.getTile(It);if(rt&&!Lt.patternsLoaded())continue;const Kt=Lt.getBucket(he);if(!Kt)continue;const Rt=Kt.programConfigurations.get(he.id),Jt=te.context.program.get(),Bi=te.useProgram(Bt,Rt),ar=St||Bi.program!==Jt,oi=te.style.map.terrain&&te.style.map.terrain.getTerrainData(It),ki=Ze.constantOr(null);if(ki&&Lt.imageAtlas){const or=Lt.imageAtlas,Mi=or.patternPositions[ki.to.toString()],lr=or.patternPositions[ki.from.toString()];Mi&&lr&&Rt.setConstantPatternPositions(Mi,lr)}const xi=oi?It:null,Hr=rt?wr(te,Lt,he,dt,xi):$e?er(te,Lt,he,$e,dt,xi):Ye?Tn(te,Lt,he,Kt.lineClipsArray.length,xi):xa(te,Lt,he,xi);if(rt)ot.activeTexture.set(gt.TEXTURE0),Lt.imageAtlasTexture.bind(gt.LINEAR,gt.CLAMP_TO_EDGE),Rt.updatePaintBuffers(dt);else if($e&&(ar||te.lineAtlas.dirty))ot.activeTexture.set(gt.TEXTURE0),te.lineAtlas.bind(ot);else if(Ye){const or=Kt.gradients[he.id];let Mi=or.texture;if(he.gradientVersion!==or.version){let lr=256;if(he.stepInterpolant){const Kr=Ae.getSource().maxzoom,kr=It.canonical.z===Kr?Math.ceil(1<<te.transform.maxZoom-It.canonical.z):1;lr=D.clamp(D.nextPowerOfTwo(Kt.maxLineLength/D.EXTENT*1024*kr),256,ot.maxTextureSize)}or.gradient=D.renderColorRamp({expression:he.gradientExpression(),evaluationKey:"lineProgress",resolution:lr,image:or.gradient||void 0,clips:Kt.lineClipsArray}),or.texture?or.texture.update(or.gradient):or.texture=new vt(ot,or.gradient,gt.RGBA),or.version=he.gradientVersion,Mi=or.texture}ot.activeTexture.set(gt.TEXTURE0),Mi.bind(he.stepInterpolant?gt.NEAREST:gt.LINEAR,gt.CLAMP_TO_EDGE)}Bi.draw(ot,gt.TRIANGLES,Se,te.stencilModeForClipping(It),Qe,Mr.disabled,Hr,oi,he.id,Kt.layoutVertexBuffer,Kt.indexBuffer,Kt.segments,he.paint,te.transform.zoom,Rt,Kt.layoutVertexBuffer2),St=!1}})(x,Q,G,X);break;case"fill":(function(te,Ae,he,pe){const ve=he.paint.get("fill-color"),Ce=he.paint.get("fill-opacity");if(Ce.constantOr(1)===0)return;const Se=te.colorModeForRenderPass(),Qe=he.paint.get("fill-pattern"),$e=te.opaquePassEnabledForLayer()&&!Qe.constantOr(1)&&ve.constantOr(D.Color.transparent).a===1&&Ce.constantOr(0)===1?"opaque":"translucent";if(te.renderPass===$e){const Ze=te.depthModeForSublayer(1,te.renderPass==="opaque"?Ji.ReadWrite:Ji.ReadOnly);oo(te,Ae,he,pe,Ze,Se,!1)}if(te.renderPass==="translucent"&&he.paint.get("fill-antialias")){const Ze=te.depthModeForSublayer(he.getPaintProperty("fill-outline-color")?2:0,Ji.ReadOnly);oo(te,Ae,he,pe,Ze,Se,!0)}})(x,Q,G,X);break;case"fill-extrusion":(function(te,Ae,he,pe){const ve=he.paint.get("fill-extrusion-opacity");if(ve!==0&&te.renderPass==="translucent"){const Ce=new Ji(te.context.gl.LEQUAL,Ji.ReadWrite,te.depthRangeFor3D);if(ve!==1||he.paint.get("fill-extrusion-pattern").constantOr(1))Pa(te,Ae,he,pe,Ce,Fr.disabled,Ur.disabled),Pa(te,Ae,he,pe,Ce,te.stencilModeFor3D(),te.colorModeForRenderPass());else{const Se=te.colorModeForRenderPass();Pa(te,Ae,he,pe,Ce,Fr.disabled,Se)}}})(x,Q,G,X);break;case"hillshade":(function(te,Ae,he,pe){if(te.renderPass!=="offscreen"&&te.renderPass!=="translucent")return;const ve=te.context,Ce=te.depthModeForSublayer(0,Ji.ReadOnly),Se=te.colorModeForRenderPass(),[Qe,$e]=te.renderPass==="translucent"?te.stencilConfigForOverlap(pe):[{},pe];for(const Ze of $e){const rt=Ae.getTile(Ze);rt.needsHillshadePrepare!==void 0&&rt.needsHillshadePrepare&&te.renderPass==="offscreen"?La(te,rt,he,Ce,Fr.disabled,Se):te.renderPass==="translucent"&&Nn(te,Ze,rt,he,Ce,Qe[Ze.overscaledZ],Se)}ve.viewport.set([0,0,te.width,te.height])})(x,Q,G,X);break;case"raster":(function(te,Ae,he,pe){if(te.renderPass!=="translucent"||he.paint.get("raster-opacity")===0||!pe.length)return;const ve=te.context,Ce=ve.gl,Se=Ae.getSource(),Qe=te.useProgram("raster"),$e=te.colorModeForRenderPass(),[Ze,rt]=Se instanceof Ve?[{},pe]:te.stencilConfigForOverlap(pe),Ye=rt[rt.length-1].overscaledZ,dt=!te.options.moving;for(const Bt of rt){const ot=te.depthModeForSublayer(Bt.overscaledZ-Ye,he.paint.get("raster-opacity")===1?Ji.ReadWrite:Ji.ReadOnly,Ce.LESS),gt=Ae.getTile(Bt);gt.registerFadeDuration(he.paint.get("raster-fade-duration"));const St=Ae.findLoadedParent(Bt,0),It=_l(gt,St,Ae,he,te.transform,te.style.map.terrain);let Lt,Kt;const Rt=he.paint.get("raster-resampling")==="nearest"?Ce.NEAREST:Ce.LINEAR;ve.activeTexture.set(Ce.TEXTURE0),gt.texture.bind(Rt,Ce.CLAMP_TO_EDGE,Ce.LINEAR_MIPMAP_NEAREST),ve.activeTexture.set(Ce.TEXTURE1),St?(St.texture.bind(Rt,Ce.CLAMP_TO_EDGE,Ce.LINEAR_MIPMAP_NEAREST),Lt=Math.pow(2,St.tileID.overscaledZ-gt.tileID.overscaledZ),Kt=[gt.tileID.canonical.x*Lt%1,gt.tileID.canonical.y*Lt%1]):gt.texture.bind(Rt,Ce.CLAMP_TO_EDGE,Ce.LINEAR_MIPMAP_NEAREST);const Jt=te.style.map.terrain&&te.style.map.terrain.getTerrainData(Bt),Bi=Jt?Bt:null,ar=Bi?Bi.posMatrix:te.transform.calculatePosMatrix(Bt.toUnwrapped(),dt),oi=Ba(ar,Kt||[0,0],Lt||1,It,he);Se instanceof Ve?Qe.draw(ve,Ce.TRIANGLES,ot,Fr.disabled,$e,Mr.disabled,oi,Jt,he.id,Se.boundsBuffer,te.quadTriangleIndexBuffer,Se.boundsSegments):Qe.draw(ve,Ce.TRIANGLES,ot,Ze[Bt.overscaledZ],$e,Mr.disabled,oi,Jt,he.id,te.rasterBoundsBuffer,te.quadTriangleIndexBuffer,te.rasterBoundsSegments)}})(x,Q,G,X);break;case"background":(function(te,Ae,he,pe){const ve=he.paint.get("background-color"),Ce=he.paint.get("background-opacity");if(Ce===0)return;const Se=te.context,Qe=Se.gl,$e=te.transform,Ze=$e.tileSize,rt=he.paint.get("background-pattern");if(te.isPatternMissing(rt))return;const Ye=!rt&&ve.a===1&&Ce===1&&te.opaquePassEnabledForLayer()?"opaque":"translucent";if(te.renderPass!==Ye)return;const dt=Fr.disabled,Bt=te.depthModeForSublayer(0,Ye==="opaque"?Ji.ReadWrite:Ji.ReadOnly),ot=te.colorModeForRenderPass(),gt=te.useProgram(rt?"backgroundPattern":"background"),St=pe||$e.coveringTiles({tileSize:Ze,terrain:te.style.map.terrain});rt&&(Se.activeTexture.set(Qe.TEXTURE0),te.imageManager.bind(te.context));const It=he.getCrossfadeParameters();for(const Lt of St){const Kt=pe?Lt.posMatrix:te.transform.calculatePosMatrix(Lt.toUnwrapped()),Rt=rt?Za(Kt,Ce,te,rt,{tileID:Lt,tileSize:Ze},It):On(Kt,Ce,ve),Jt=te.style.map.terrain&&te.style.map.terrain.getTerrainData(Lt);gt.draw(Se,Qe.TRIANGLES,Bt,dt,ot,Mr.disabled,Rt,Jt,he.id,te.tileExtentBuffer,te.quadTriangleIndexBuffer,te.tileExtentSegments)}})(x,0,G,X);break;case"custom":(function(te,Ae,he){const pe=te.context,ve=he.implementation;if(te.renderPass==="offscreen"){const Ce=ve.prerender;Ce&&(te.setCustomLayerDefaults(),pe.setColorMode(te.colorModeForRenderPass()),Ce.call(ve,pe.gl,te.transform.customLayerMatrix()),pe.setDirty(),te.setBaseState())}else if(te.renderPass==="translucent"){te.setCustomLayerDefaults(),pe.setColorMode(te.colorModeForRenderPass()),pe.setStencilMode(Fr.disabled);const Ce=ve.renderingMode==="3d"?new Ji(te.context.gl.LEQUAL,Ji.ReadWrite,te.depthRangeFor3D):te.depthModeForSublayer(0,Ji.ReadOnly);pe.setDepthMode(Ce),ve.render(pe.gl,te.transform.customLayerMatrix()),pe.setDirty(),te.setBaseState(),pe.bindFramebuffer.set(null)}})(x,0,G)}}translatePosMatrix(x,Q,G,X,te){if(!G[0]&&!G[1])return x;const Ae=te?X==="map"?this.transform.angle:0:X==="viewport"?-this.transform.angle:0;if(Ae){const ve=Math.sin(Ae),Ce=Math.cos(Ae);G=[G[0]*Ce-G[1]*ve,G[0]*ve+G[1]*Ce]}const he=[te?G[0]:Le(Q,G[0],this.transform.zoom),te?G[1]:Le(Q,G[1],this.transform.zoom),0],pe=new Float32Array(16);return D.translate(pe,x,he),pe}saveTileTexture(x){const Q=this._tileTextures[x.size[0]];Q?Q.push(x):this._tileTextures[x.size[0]]=[x]}getTileTexture(x){const Q=this._tileTextures[x];return Q&&Q.length>0?Q.pop():null}isPatternMissing(x){if(!x)return!1;if(!x.from||!x.to)return!0;const Q=this.imageManager.getPattern(x.from.toString()),G=this.imageManager.getPattern(x.to.toString());return!Q||!G}useProgram(x,Q){this.cache=this.cache||{};const G=x+(Q?Q.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[G]||(this.cache[G]=new Os(this.context,ps[x],Q,ks[x],this._showOverdrawInspector,this.style.map.terrain)),this.cache[G]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const x=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(x.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new vt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:x,drawingBufferHeight:Q}=this.context.gl;return this.width!==x||this.height!==Q}}class ca{constructor(x,Q){this.points=x,this.planes=Q}static fromInvProjectionMatrix(x,Q,G){const X=Math.pow(2,G),te=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(he=>{const pe=1/(he=D.transformMat4([],he,x))[3]/Q*X;return D.mul$1(he,he,[pe,pe,1/he[3],pe])}),Ae=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(he=>{const pe=function(Qe,$e){var Ze=$e[0],rt=$e[1],Ye=$e[2],dt=Ze*Ze+rt*rt+Ye*Ye;return dt>0&&(dt=1/Math.sqrt(dt)),Qe[0]=$e[0]*dt,Qe[1]=$e[1]*dt,Qe[2]=$e[2]*dt,Qe}([],function(Qe,$e,Ze){var rt=$e[0],Ye=$e[1],dt=$e[2],Bt=Ze[0],ot=Ze[1],gt=Ze[2];return Qe[0]=Ye*gt-dt*ot,Qe[1]=dt*Bt-rt*gt,Qe[2]=rt*ot-Ye*Bt,Qe}([],ft([],te[he[0]],te[he[1]]),ft([],te[he[2]],te[he[1]]))),ve=-((Ce=pe)[0]*(Se=te[he[1]])[0]+Ce[1]*Se[1]+Ce[2]*Se[2]);var Ce,Se;return pe.concat(ve)});return new ca(te,Ae)}}class ha{constructor(x,Q){this.min=x,this.max=Q,this.center=function(G,X,te){return G[0]=.5*X[0],G[1]=.5*X[1],G[2]=.5*X[2],G}([],function(G,X,te){return G[0]=X[0]+te[0],G[1]=X[1]+te[1],G[2]=X[2]+te[2],G}([],this.min,this.max))}quadrant(x){const Q=[x%2==0,x<2],G=At(this.min),X=At(this.max);for(let te=0;te<Q.length;te++)G[te]=Q[te]?this.min[te]:this.center[te],X[te]=Q[te]?this.center[te]:this.max[te];return X[2]=this.max[2],new ha(G,X)}distanceX(x){return Math.max(Math.min(this.max[0],x[0]),this.min[0])-x[0]}distanceY(x){return Math.max(Math.min(this.max[1],x[1]),this.min[1])-x[1]}intersects(x){const Q=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let G=!0;for(let X=0;X<x.planes.length;X++){const te=x.planes[X];let Ae=0;for(let he=0;he<Q.length;he++)D.dot(te,Q[he])>=0&&Ae++;if(Ae===0)return 0;Ae!==Q.length&&(G=!1)}if(G)return 2;for(let X=0;X<3;X++){let te=Number.MAX_VALUE,Ae=-Number.MAX_VALUE;for(let he=0;he<x.points.length;he++){const pe=x.points[he][X]-this.min[X];te=Math.min(te,pe),Ae=Math.max(Ae,pe)}if(Ae<0||te>this.max[X]-this.min[X])return 0}return 1}}class _n{constructor(x=0,Q=0,G=0,X=0){if(isNaN(x)||x<0||isNaN(Q)||Q<0||isNaN(G)||G<0||isNaN(X)||X<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=x,this.bottom=Q,this.left=G,this.right=X}interpolate(x,Q,G){return Q.top!=null&&x.top!=null&&(this.top=D.interpolate.number(x.top,Q.top,G)),Q.bottom!=null&&x.bottom!=null&&(this.bottom=D.interpolate.number(x.bottom,Q.bottom,G)),Q.left!=null&&x.left!=null&&(this.left=D.interpolate.number(x.left,Q.left,G)),Q.right!=null&&x.right!=null&&(this.right=D.interpolate.number(x.right,Q.right,G)),this}getCenter(x,Q){const G=D.clamp((this.left+x-this.right)/2,0,x),X=D.clamp((this.top+Q-this.bottom)/2,0,Q);return new D.Point(G,X)}equals(x){return this.top===x.top&&this.bottom===x.bottom&&this.left===x.left&&this.right===x.right}clone(){return new _n(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Bs{constructor(x,Q,G,X,te){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=te===void 0||!!te,this._minZoom=x||0,this._maxZoom=Q||22,this._minPitch=G??0,this._maxPitch=X??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new D.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new _n,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const x=new Bs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return x.apply(this),x}apply(x){this.tileSize=x.tileSize,this.latRange=x.latRange,this.width=x.width,this.height=x.height,this._center=x._center,this._elevation=x._elevation,this._minEleveationForCurrentTile=x._minEleveationForCurrentTile,this.zoom=x.zoom,this.angle=x.angle,this._fov=x._fov,this._pitch=x._pitch,this._unmodified=x._unmodified,this._edgeInsets=x._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(x){this._minZoom!==x&&(this._minZoom=x,this.zoom=Math.max(this.zoom,x))}get maxZoom(){return this._maxZoom}set maxZoom(x){this._maxZoom!==x&&(this._maxZoom=x,this.zoom=Math.min(this.zoom,x))}get minPitch(){return this._minPitch}set minPitch(x){this._minPitch!==x&&(this._minPitch=x,this.pitch=Math.max(this.pitch,x))}get maxPitch(){return this._maxPitch}set maxPitch(x){this._maxPitch!==x&&(this._maxPitch=x,this.pitch=Math.min(this.pitch,x))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(x){x===void 0?x=!0:x===null&&(x=!1),this._renderWorldCopies=x}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new D.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(x){const Q=-D.wrap(x,-180,180)*Math.PI/180;this.angle!==Q&&(this._unmodified=!1,this.angle=Q,this._calcMatrices(),this.rotationMatrix=function(){var G=new D.ARRAY_TYPE(4);return D.ARRAY_TYPE!=Float32Array&&(G[1]=0,G[2]=0),G[0]=1,G[3]=1,G}(),function(G,X,te){var Ae=X[0],he=X[1],pe=X[2],ve=X[3],Ce=Math.sin(te),Se=Math.cos(te);G[0]=Ae*Se+pe*Ce,G[1]=he*Se+ve*Ce,G[2]=Ae*-Ce+pe*Se,G[3]=he*-Ce+ve*Se}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(x){const Q=D.clamp(x,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==Q&&(this._unmodified=!1,this._pitch=Q,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(x){x=Math.max(.01,Math.min(60,x)),this._fov!==x&&(this._unmodified=!1,this._fov=x/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(x){const Q=Math.min(Math.max(x,this.minZoom),this.maxZoom);this._zoom!==Q&&(this._unmodified=!1,this._zoom=Q,this.tileZoom=Math.max(0,Math.floor(Q)),this.scale=this.zoomScale(Q),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(x){x.lat===this._center.lat&&x.lng===this._center.lng||(this._unmodified=!1,this._center=x,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(x){x!==this._elevation&&(this._elevation=x,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(x){this._edgeInsets.equals(x)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,x,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(x){return this._edgeInsets.equals(x)}interpolatePadding(x,Q,G){this._unmodified=!1,this._edgeInsets.interpolate(x,Q,G),this._constrain(),this._calcMatrices()}coveringZoomLevel(x){const Q=(x.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/x.tileSize));return Math.max(0,Q)}getVisibleUnwrappedCoordinates(x){const Q=[new D.UnwrappedTileID(0,x)];if(this._renderWorldCopies){const G=this.pointCoordinate(new D.Point(0,0)),X=this.pointCoordinate(new D.Point(this.width,0)),te=this.pointCoordinate(new D.Point(this.width,this.height)),Ae=this.pointCoordinate(new D.Point(0,this.height)),he=Math.floor(Math.min(G.x,X.x,te.x,Ae.x)),pe=Math.floor(Math.max(G.x,X.x,te.x,Ae.x)),ve=1;for(let Ce=he-ve;Ce<=pe+ve;Ce++)Ce!==0&&Q.push(new D.UnwrappedTileID(Ce,x))}return Q}coveringTiles(x){var Q,G;let X=this.coveringZoomLevel(x);const te=X;if(x.minzoom!==void 0&&X<x.minzoom)return[];x.maxzoom!==void 0&&X>x.maxzoom&&(X=x.maxzoom);const Ae=this.pointCoordinate(this.getCameraPoint()),he=D.MercatorCoordinate.fromLngLat(this.center),pe=Math.pow(2,X),ve=[pe*Ae.x,pe*Ae.y,0],Ce=[pe*he.x,pe*he.y,0],Se=ca.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,X);let Qe=x.minzoom||0;!x.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(Qe=X);const $e=x.terrain?2/Math.min(this.tileSize,x.tileSize)*this.tileSize:3,Ze=ot=>({aabb:new ha([ot*pe,0,0],[(ot+1)*pe,pe,0]),zoom:0,x:0,y:0,wrap:ot,fullyVisible:!1}),rt=[],Ye=[],dt=X,Bt=x.reparseOverscaled?te:X;if(this._renderWorldCopies)for(let ot=1;ot<=3;ot++)rt.push(Ze(-ot)),rt.push(Ze(ot));for(rt.push(Ze(0));rt.length>0;){const ot=rt.pop(),gt=ot.x,St=ot.y;let It=ot.fullyVisible;if(!It){const Bi=ot.aabb.intersects(Se);if(Bi===0)continue;It=Bi===2}const Lt=x.terrain?ve:Ce,Kt=ot.aabb.distanceX(Lt),Rt=ot.aabb.distanceY(Lt),Jt=Math.max(Math.abs(Kt),Math.abs(Rt));if(ot.zoom===dt||Jt>$e+(1<<dt-ot.zoom)-2&&ot.zoom>=Qe){const Bi=dt-ot.zoom,ar=ve[0]-.5-(gt<<Bi),oi=ve[1]-.5-(St<<Bi);Ye.push({tileID:new D.OverscaledTileID(ot.zoom===dt?Bt:ot.zoom,ot.wrap,ot.zoom,gt,St),distanceSq:Tt([Ce[0]-.5-gt,Ce[1]-.5-St]),tileDistanceToCamera:Math.sqrt(ar*ar+oi*oi)})}else for(let Bi=0;Bi<4;Bi++){const ar=(gt<<1)+Bi%2,oi=(St<<1)+(Bi>>1),ki=ot.zoom+1;let xi=ot.aabb.quadrant(Bi);if(x.terrain){const Hr=new D.OverscaledTileID(ki,ot.wrap,ki,ar,oi),or=x.terrain.getMinMaxElevation(Hr),Mi=(Q=or.minElevation)!==null&&Q!==void 0?Q:this.elevation,lr=(G=or.maxElevation)!==null&&G!==void 0?G:this.elevation;xi=new ha([xi.min[0],xi.min[1],Mi],[xi.max[0],xi.max[1],lr])}rt.push({aabb:xi,zoom:ki,x:ar,y:oi,wrap:ot.wrap,fullyVisible:It})}}return Ye.sort((ot,gt)=>ot.distanceSq-gt.distanceSq).map(ot=>ot.tileID)}resize(x,Q){this.width=x,this.height=Q,this.pixelsToGLUnits=[2/x,-2/Q],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(x){return Math.pow(2,x)}scaleZoom(x){return Math.log(x)/Math.LN2}project(x){const Q=D.clamp(x.lat,-this.maxValidLatitude,this.maxValidLatitude);return new D.Point(D.mercatorXfromLng(x.lng)*this.worldSize,D.mercatorYfromLat(Q)*this.worldSize)}unproject(x){return new D.MercatorCoordinate(x.x/this.worldSize,x.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(x){const Q=this.pointLocation(this.centerPoint,x),G=x.getElevationForLngLatZoom(Q,this.tileZoom);if(!(this.elevation-G))return;const X=this.getCameraPosition(),te=D.MercatorCoordinate.fromLngLat(X.lngLat,X.altitude),Ae=D.MercatorCoordinate.fromLngLat(Q,G),he=te.x-Ae.x,pe=te.y-Ae.y,ve=te.z-Ae.z,Ce=Math.sqrt(he*he+pe*pe+ve*ve),Se=this.scaleZoom(this.cameraToCenterDistance/Ce/this.tileSize);this._elevation=G,this._center=Q,this.zoom=Se}setLocationAtPoint(x,Q){const G=this.pointCoordinate(Q),X=this.pointCoordinate(this.centerPoint),te=this.locationCoordinate(x),Ae=new D.MercatorCoordinate(te.x-(G.x-X.x),te.y-(G.y-X.y));this.center=this.coordinateLocation(Ae),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(x,Q){return Q?this.coordinatePoint(this.locationCoordinate(x),Q.getElevationForLngLatZoom(x,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(x))}pointLocation(x,Q){return this.coordinateLocation(this.pointCoordinate(x,Q))}locationCoordinate(x){return D.MercatorCoordinate.fromLngLat(x)}coordinateLocation(x){return x&&x.toLngLat()}pointCoordinate(x,Q){if(Q){const Qe=Q.pointCoordinate(x);if(Qe!=null)return Qe}const G=[x.x,x.y,0,1],X=[x.x,x.y,1,1];D.transformMat4(G,G,this.pixelMatrixInverse),D.transformMat4(X,X,this.pixelMatrixInverse);const te=G[3],Ae=X[3],he=G[1]/te,pe=X[1]/Ae,ve=G[2]/te,Ce=X[2]/Ae,Se=ve===Ce?0:(0-ve)/(Ce-ve);return new D.MercatorCoordinate(D.interpolate.number(G[0]/te,X[0]/Ae,Se)/this.worldSize,D.interpolate.number(he,pe,Se)/this.worldSize)}coordinatePoint(x,Q=0,G=this.pixelMatrix){const X=[x.x*this.worldSize,x.y*this.worldSize,Q,1];return D.transformMat4(X,X,G),new D.Point(X[0]/X[3],X[1]/X[3])}getBounds(){const x=Math.max(0,this.height/2-this.getHorizon());return new R().extend(this.pointLocation(new D.Point(0,x))).extend(this.pointLocation(new D.Point(this.width,x))).extend(this.pointLocation(new D.Point(this.width,this.height))).extend(this.pointLocation(new D.Point(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new R([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(x){x?(this.lngRange=[x.getWest(),x.getEast()],this.latRange=[x.getSouth(),x.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(x,Q=!1){const G=x.key,X=Q?this._alignedPosMatrixCache:this._posMatrixCache;if(X[G])return X[G];const te=x.canonical,Ae=this.worldSize/this.zoomScale(te.z),he=te.x+Math.pow(2,te.z)*x.wrap,pe=D.identity(new Float64Array(16));return D.translate(pe,pe,[he*Ae,te.y*Ae,0]),D.scale(pe,pe,[Ae/D.EXTENT,Ae/D.EXTENT,1]),D.multiply(pe,Q?this.alignedProjMatrix:this.projMatrix,pe),X[G]=new Float32Array(pe),X[G]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let x,Q,G,X,te=-90,Ae=90,he=-180,pe=180;const ve=this.size,Ce=this._unmodified;if(this.latRange){const $e=this.latRange;te=D.mercatorYfromLat($e[1])*this.worldSize,Ae=D.mercatorYfromLat($e[0])*this.worldSize,x=Ae-te<ve.y?ve.y/(Ae-te):0}if(this.lngRange){const $e=this.lngRange;he=D.wrap(D.mercatorXfromLng($e[0])*this.worldSize,0,this.worldSize),pe=D.wrap(D.mercatorXfromLng($e[1])*this.worldSize,0,this.worldSize),pe<he&&(pe+=this.worldSize),Q=pe-he<ve.x?ve.x/(pe-he):0}const Se=this.point,Qe=Math.max(Q||0,x||0);if(Qe)return this.center=this.unproject(new D.Point(Q?(pe+he)/2:Se.x,x?(Ae+te)/2:Se.y)),this.zoom+=this.scaleZoom(Qe),this._unmodified=Ce,void(this._constraining=!1);if(this.latRange){const $e=Se.y,Ze=ve.y/2;$e-Ze<te&&(X=te+Ze),$e+Ze>Ae&&(X=Ae-Ze)}if(this.lngRange){const $e=(he+pe)/2,Ze=D.wrap(Se.x,$e-this.worldSize/2,$e+this.worldSize/2),rt=ve.x/2;Ze-rt<he&&(G=he+rt),Ze+rt>pe&&(G=pe-rt)}G===void 0&&X===void 0||(this.center=this.unproject(new D.Point(G!==void 0?G:Se.x,X!==void 0?X:Se.y)).wrap()),this._unmodified=Ce,this._constraining=!1}_calcMatrices(){if(!this.height)return;const x=this.centerOffset,Q=this.point.x,G=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=D.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let X=D.identity(new Float64Array(16));D.scale(X,X,[this.width/2,-this.height/2,1]),D.translate(X,X,[1,-1,0]),this.labelPlaneMatrix=X,X=D.identity(new Float64Array(16)),D.scale(X,X,[1,-1,1]),D.translate(X,X,[-1,-1,0]),D.scale(X,X,[2/this.width,2/this.height,1]),this.glCoordMatrix=X;const te=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),Ae=Math.min(this.elevation,this._minEleveationForCurrentTile),he=te-Ae*this._pixelPerMeter/Math.cos(this._pitch),pe=Ae<0?he:te,ve=Math.PI/2+this._pitch,Ce=this._fov*(.5+x.y/this.height),Se=Math.sin(Ce)*pe/Math.sin(D.clamp(Math.PI-ve-Ce,.01,Math.PI-.01)),Qe=this.getHorizon(),$e=2*Math.atan(Qe/this.cameraToCenterDistance)*(.5+x.y/(2*Qe)),Ze=Math.sin($e)*pe/Math.sin(D.clamp(Math.PI-ve-$e,.01,Math.PI-.01)),rt=Math.min(Se,Ze),Ye=1.01*(Math.cos(Math.PI/2-this._pitch)*rt+pe),dt=this.height/50;X=new Float64Array(16),D.perspective(X,this._fov,this.width/this.height,dt,Ye),X[8]=2*-x.x/this.width,X[9]=2*x.y/this.height,D.scale(X,X,[1,-1,1]),D.translate(X,X,[0,0,-this.cameraToCenterDistance]),D.rotateX(X,X,this._pitch),D.rotateZ(X,X,this.angle),D.translate(X,X,[-Q,-G,0]),this.mercatorMatrix=D.scale([],X,[this.worldSize,this.worldSize,this.worldSize]),D.scale(X,X,[1,1,this._pixelPerMeter]),this.pixelMatrix=D.multiply(new Float64Array(16),this.labelPlaneMatrix,X),D.translate(X,X,[0,0,-this.elevation]),this.projMatrix=X,this.invProjMatrix=D.invert([],X),this.pixelMatrix3D=D.multiply(new Float64Array(16),this.labelPlaneMatrix,X);const Bt=this.width%2/2,ot=this.height%2/2,gt=Math.cos(this.angle),St=Math.sin(this.angle),It=Q-Math.round(Q)+gt*Bt+St*ot,Lt=G-Math.round(G)+gt*ot+St*Bt,Kt=new Float64Array(X);if(D.translate(Kt,Kt,[It>.5?It-1:It,Lt>.5?Lt-1:Lt,0]),this.alignedProjMatrix=Kt,X=D.invert(new Float64Array(16),this.pixelMatrix),!X)throw new Error("failed to invert matrix");this.pixelMatrixInverse=X,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const x=this.pointCoordinate(new D.Point(0,0)),Q=[x.x*this.worldSize,x.y*this.worldSize,0,1];return D.transformMat4(Q,Q,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const x=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new D.Point(0,x))}getCameraQueryGeometry(x){const Q=this.getCameraPoint();if(x.length===1)return[x[0],Q];{let G=Q.x,X=Q.y,te=Q.x,Ae=Q.y;for(const he of x)G=Math.min(G,he.x),X=Math.min(X,he.y),te=Math.max(te,he.x),Ae=Math.max(Ae,he.y);return[new D.Point(G,X),new D.Point(te,X),new D.Point(te,Ae),new D.Point(G,Ae),new D.Point(G,X)]}}}function yn(J,x){let Q,G=!1,X=null,te=null;const Ae=()=>{X=null,G&&(J.apply(te,Q),X=setTimeout(Ae,x),G=!1)};return(...he)=>(G=!0,te=this,Q=he,X||Ae(),X)}class Uo{constructor(x){this._getCurrentHash=()=>{const Q=window.location.hash.replace("#","");if(this._hashName){let G;return Q.split("&").map(X=>X.split("=")).forEach(X=>{X[0]===this._hashName&&(G=X)}),(G&&G[1]||"").split("/")}return Q.split("/")},this._onHashChange=()=>{const Q=this._getCurrentHash();if(Q.length>=3&&!Q.some(G=>isNaN(G))){const G=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(Q[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+Q[2],+Q[1]],zoom:+Q[0],bearing:G,pitch:+(Q[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const Q=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,Q)}catch{}},this._updateHash=yn(this._updateHashUnthrottled,300),this._hashName=x&&encodeURIComponent(x)}addTo(x){return this._map=x,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(x){const Q=this._map.getCenter(),G=Math.round(100*this._map.getZoom())/100,X=Math.ceil((G*Math.LN2+Math.log(512/360/.5))/Math.LN10),te=Math.pow(10,X),Ae=Math.round(Q.lng*te)/te,he=Math.round(Q.lat*te)/te,pe=this._map.getBearing(),ve=this._map.getPitch();let Ce="";if(Ce+=x?`/${Ae}/${he}/${G}`:`${G}/${he}/${Ae}`,(pe||ve)&&(Ce+="/"+Math.round(10*pe)/10),ve&&(Ce+=`/${Math.round(ve)}`),this._hashName){const Se=this._hashName;let Qe=!1;const $e=window.location.hash.slice(1).split("&").map(Ze=>{const rt=Ze.split("=")[0];return rt===Se?(Qe=!0,`${rt}=${Ce}`):Ze}).filter(Ze=>Ze);return Qe||$e.push(`${Se}=${Ce}`),`#${$e.join("&")}`}return`#${Ce}`}}const Gn={linearity:.3,easing:D.bezier(0,0,.3,1)},Qa=D.extend({deceleration:2500,maxSpeed:1400},Gn),lo=D.extend({deceleration:20,maxSpeed:1400},Gn),ua=D.extend({deceleration:1e3,maxSpeed:360},Gn),Ao=D.extend({deceleration:1e3,maxSpeed:90},Gn);class fa{constructor(x){this._map=x,this.clear()}clear(){this._inertiaBuffer=[]}record(x){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:D.browser.now(),settings:x})}_drainInertiaBuffer(){const x=this._inertiaBuffer,Q=D.browser.now();for(;x.length>0&&Q-x[0].time>160;)x.shift()}_onMoveEnd(x){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const Q={zoom:0,bearing:0,pitch:0,pan:new D.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:te}of this._inertiaBuffer)Q.zoom+=te.zoomDelta||0,Q.bearing+=te.bearingDelta||0,Q.pitch+=te.pitchDelta||0,te.panDelta&&Q.pan._add(te.panDelta),te.around&&(Q.around=te.around),te.pinchAround&&(Q.pinchAround=te.pinchAround);const G=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,X={};if(Q.pan.mag()){const te=vs(Q.pan.mag(),G,D.extend({},Qa,x||{}));X.offset=Q.pan.mult(te.amount/Q.pan.mag()),X.center=this._map.transform.center,Fn(X,te)}if(Q.zoom){const te=vs(Q.zoom,G,lo);X.zoom=this._map.transform.zoom+te.amount,Fn(X,te)}if(Q.bearing){const te=vs(Q.bearing,G,ua);X.bearing=this._map.transform.bearing+D.clamp(te.amount,-179,179),Fn(X,te)}if(Q.pitch){const te=vs(Q.pitch,G,Ao);X.pitch=this._map.transform.pitch+te.amount,Fn(X,te)}if(X.zoom||X.bearing){const te=Q.pinchAround===void 0?Q.around:Q.pinchAround;X.around=te?this._map.unproject(te):this._map.getCenter()}return this.clear(),D.extend(X,{noMoveStart:!0})}}function Fn(J,x){(!J.duration||J.duration<x.duration)&&(J.duration=x.duration,J.easing=x.easing)}function vs(J,x,Q){const{maxSpeed:G,linearity:X,deceleration:te}=Q,Ae=D.clamp(J*X/(x/1e3),-G,G),he=Math.abs(Ae)/(te*X);return{easing:Q.easing,duration:1e3*he,amount:Ae*(he/2)}}class qr extends D.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(x,Q,G,X={}){const te=ae.mousePos(Q.getCanvasContainer(),G),Ae=Q.unproject(te);super(x,D.extend({point:te,lngLat:Ae,originalEvent:G},X)),this._defaultPrevented=!1,this.target=Q}}class Oa extends D.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(x,Q,G){const X=x==="touchend"?G.changedTouches:G.touches,te=ae.touchPos(Q.getCanvasContainer(),X),Ae=te.map(pe=>Q.unproject(pe)),he=te.reduce((pe,ve,Ce,Se)=>pe.add(ve.div(Se.length)),new D.Point(0,0));super(x,{points:te,point:he,lngLats:Ae,lngLat:Q.unproject(he),originalEvent:G}),this._defaultPrevented=!1}}class Ms extends D.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(x,Q,G){super(x,{originalEvent:G}),this._defaultPrevented=!1}}class Ra{constructor(x,Q){this._map=x,this._clickTolerance=Q.clickTolerance}reset(){delete this._mousedownPos}wheel(x){return this._firePreventable(new Ms(x.type,this._map,x))}mousedown(x,Q){return this._mousedownPos=Q,this._firePreventable(new qr(x.type,this._map,x))}mouseup(x){this._map.fire(new qr(x.type,this._map,x))}click(x,Q){this._mousedownPos&&this._mousedownPos.dist(Q)>=this._clickTolerance||this._map.fire(new qr(x.type,this._map,x))}dblclick(x){return this._firePreventable(new qr(x.type,this._map,x))}mouseover(x){this._map.fire(new qr(x.type,this._map,x))}mouseout(x){this._map.fire(new qr(x.type,this._map,x))}touchstart(x){return this._firePreventable(new Oa(x.type,this._map,x))}touchmove(x){this._map.fire(new Oa(x.type,this._map,x))}touchend(x){this._map.fire(new Oa(x.type,this._map,x))}touchcancel(x){this._map.fire(new Oa(x.type,this._map,x))}_firePreventable(x){if(this._map.fire(x),x.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class co{constructor(x){this._map=x}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(x){this._map.fire(new qr(x.type,this._map,x))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new qr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(x){this._delayContextMenu?this._contextMenuEvent=x:this._ignoreContextMenu||this._map.fire(new qr(x.type,this._map,x)),this._map.listens("contextmenu")&&x.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class da{constructor(x){this._map=x}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(x){return this.transform.pointLocation(D.Point.convert(x),this._map.terrain)}}class Zo{constructor(x,Q){this._map=x,this._tr=new da(x),this._el=x.getCanvasContainer(),this._container=x.getContainer(),this._clickTolerance=Q.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(x,Q){this.isEnabled()&&x.shiftKey&&x.button===0&&(ae.disableDrag(),this._startPos=this._lastPos=Q,this._active=!0)}mousemoveWindow(x,Q){if(!this._active)return;const G=Q;if(this._lastPos.equals(G)||!this._box&&G.dist(this._startPos)<this._clickTolerance)return;const X=this._startPos;this._lastPos=G,this._box||(this._box=ae.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",x));const te=Math.min(X.x,G.x),Ae=Math.max(X.x,G.x),he=Math.min(X.y,G.y),pe=Math.max(X.y,G.y);ae.setTransform(this._box,`translate(${te}px,${he}px)`),this._box.style.width=Ae-te+"px",this._box.style.height=pe-he+"px"}mouseupWindow(x,Q){if(!this._active||x.button!==0)return;const G=this._startPos,X=Q;if(this.reset(),ae.suppressClick(),G.x!==X.x||G.y!==X.y)return this._map.fire(new D.Event("boxzoomend",{originalEvent:x})),{cameraAnimation:te=>te.fitScreenCoordinates(G,X,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",x)}keydown(x){this._active&&x.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",x))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(ae.remove(this._box),this._box=null),ae.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(x,Q){return this._map.fire(new D.Event(x,{originalEvent:Q}))}}function Wn(J,x){if(J.length!==x.length)throw new Error(`The number of touches and points are not equal - touches ${J.length}, points ${x.length}`);const Q={};for(let G=0;G<J.length;G++)Q[J[G].identifier]=x[G];return Q}class qi{constructor(x){this.reset(),this.numTouches=x.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(x,Q,G){(this.centroid||G.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=x.timeStamp),G.length===this.numTouches&&(this.centroid=function(X){const te=new D.Point(0,0);for(const Ae of X)te._add(Ae);return te.div(X.length)}(Q),this.touches=Wn(G,Q)))}touchmove(x,Q,G){if(this.aborted||!this.centroid)return;const X=Wn(G,Q);for(const te in this.touches){const Ae=X[te];(!Ae||Ae.dist(this.touches[te])>30)&&(this.aborted=!0)}}touchend(x,Q,G){if((!this.centroid||x.timeStamp-this.startTime>500)&&(this.aborted=!0),G.length===0){const X=!this.aborted&&this.centroid;if(this.reset(),X)return X}}}class tn{constructor(x){this.singleTap=new qi(x),this.numTaps=x.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(x,Q,G){this.singleTap.touchstart(x,Q,G)}touchmove(x,Q,G){this.singleTap.touchmove(x,Q,G)}touchend(x,Q,G){const X=this.singleTap.touchend(x,Q,G);if(X){const te=x.timeStamp-this.lastTime<500,Ae=!this.lastTap||this.lastTap.dist(X)<30;if(te&&Ae||this.reset(),this.count++,this.lastTime=x.timeStamp,this.lastTap=X,this.count===this.numTaps)return this.reset(),X}}}class gi{constructor(x){this._tr=new da(x),this._zoomIn=new tn({numTouches:1,numTaps:2}),this._zoomOut=new tn({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(x,Q,G){this._zoomIn.touchstart(x,Q,G),this._zoomOut.touchstart(x,Q,G)}touchmove(x,Q,G){this._zoomIn.touchmove(x,Q,G),this._zoomOut.touchmove(x,Q,G)}touchend(x,Q,G){const X=this._zoomIn.touchend(x,Q,G),te=this._zoomOut.touchend(x,Q,G),Ae=this._tr;return X?(this._active=!0,x.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:he=>he.easeTo({duration:300,zoom:Ae.zoom+1,around:Ae.unproject(X)},{originalEvent:x})}):te?(this._active=!0,x.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:he=>he.easeTo({duration:300,zoom:Ae.zoom-1,around:Ae.unproject(te)},{originalEvent:x})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kn{constructor(x){this._enabled=!!x.enable,this._moveStateManager=x.moveStateManager,this._clickTolerance=x.clickTolerance||1,this._moveFunction=x.move,this._activateOnStart=!!x.activateOnStart,x.assignEvents(this),this.reset()}reset(x){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(x)}_move(...x){const Q=this._moveFunction(...x);if(Q.bearingDelta||Q.pitchDelta||Q.around||Q.panDelta)return this._active=!0,Q}dragStart(x,Q){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(x)&&(this._moveStateManager.startMove(x),this._lastPoint=Q.length?Q[0]:Q,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(x,Q){if(!this.isEnabled())return;const G=this._lastPoint;if(!G)return;if(x.preventDefault(),!this._moveStateManager.isValidMoveEvent(x))return void this.reset(x);const X=Q.length?Q[0]:Q;return!this._moved&&X.dist(G)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=X,this._move(G,X))}dragEnd(x){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(x)&&(this._moved&&ae.suppressClick(),this.reset(x))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const we={0:1,2:2};class Re{constructor(x){this._correctEvent=x.checkCorrectEvent}startMove(x){const Q=ae.mouseButton(x);this._eventButton=Q}endMove(x){delete this._eventButton}isValidStartEvent(x){return this._correctEvent(x)}isValidMoveEvent(x){return!function(Q,G){const X=we[G];return Q.buttons===void 0||(Q.buttons&X)!==X}(x,this._eventButton)}isValidEndEvent(x){return ae.mouseButton(x)===this._eventButton}}class Xe{constructor(){this._firstTouch=void 0}_isOneFingerTouch(x){return x.targetTouches.length===1}_isSameTouchEvent(x){return x.targetTouches[0].identifier===this._firstTouch}startMove(x){this._firstTouch=x.targetTouches[0].identifier}endMove(x){delete this._firstTouch}isValidStartEvent(x){return this._isOneFingerTouch(x)}isValidMoveEvent(x){return this._isOneFingerTouch(x)&&this._isSameTouchEvent(x)}isValidEndEvent(x){return this._isOneFingerTouch(x)&&this._isSameTouchEvent(x)}}const je=J=>{J.mousedown=J.dragStart,J.mousemoveWindow=J.dragMove,J.mouseup=J.dragEnd,J.contextmenu=function(x){x.preventDefault()}},yt=({enable:J,clickTolerance:x,bearingDegreesPerPixelMoved:Q=.8})=>{const G=new Re({checkCorrectEvent:X=>ae.mouseButton(X)===0&&X.ctrlKey||ae.mouseButton(X)===2});return new kn({clickTolerance:x,move:(X,te)=>({bearingDelta:(te.x-X.x)*Q}),moveStateManager:G,enable:J,assignEvents:je})},Et=({enable:J,clickTolerance:x,pitchDegreesPerPixelMoved:Q=-.5})=>{const G=new Re({checkCorrectEvent:X=>ae.mouseButton(X)===0&&X.ctrlKey||ae.mouseButton(X)===2});return new kn({clickTolerance:x,move:(X,te)=>({pitchDelta:(te.y-X.y)*Q}),moveStateManager:G,enable:J,assignEvents:je})};class Ht{constructor(x,Q){this._minTouches=x.cooperativeGestures?2:1,this._clickTolerance=x.clickTolerance||1,this._map=Q,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new D.Point(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(x,Q,G){return this._calculateTransform(x,Q,G)}touchmove(x,Q,G){if(this._map._cooperativeGestures&&(this._minTouches===2&&G.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(x,!1,G.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(G.length<this._minTouches))return x.preventDefault(),this._calculateTransform(x,Q,G)}touchend(x,Q,G){this._calculateTransform(x,Q,G),this._active&&G.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(x,Q,G){G.length>0&&(this._active=!0);const X=Wn(G,Q),te=new D.Point(0,0),Ae=new D.Point(0,0);let he=0;for(const ve in X){const Ce=X[ve],Se=this._touches[ve];Se&&(te._add(Ce),Ae._add(Ce.sub(Se)),he++,X[ve]=Ce)}if(this._touches=X,he<this._minTouches||!Ae.mag())return;const pe=Ae.div(he);return this._sum._add(pe),this._sum.mag()<this._clickTolerance?void 0:{around:te.div(he),panDelta:pe}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jt{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(x,Q,G){this._firstTwoTouches||G.length<2||(this._firstTwoTouches=[G[0].identifier,G[1].identifier],this._start([Q[0],Q[1]]))}touchmove(x,Q,G){if(!this._firstTwoTouches)return;x.preventDefault();const[X,te]=this._firstTwoTouches,Ae=hi(G,Q,X),he=hi(G,Q,te);if(!Ae||!he)return;const pe=this._aroundCenter?null:Ae.add(he).div(2);return this._move([Ae,he],pe,x)}touchend(x,Q,G){if(!this._firstTwoTouches)return;const[X,te]=this._firstTwoTouches,Ae=hi(G,Q,X),he=hi(G,Q,te);Ae&&he||(this._active&&ae.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(x){this._enabled=!0,this._aroundCenter=!!x&&x.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function hi(J,x,Q){for(let G=0;G<J.length;G++)if(J[G].identifier===Q)return x[G]}function Wt(J,x){return Math.log(J/x)/Math.LN2}class Gi extends jt{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(x){this._startDistance=this._distance=x[0].dist(x[1])}_move(x,Q){const G=this._distance;if(this._distance=x[0].dist(x[1]),this._active||!(Math.abs(Wt(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Wt(this._distance,G),pinchAround:Q}}}function zi(J,x){return 180*J.angleWith(x)/Math.PI}class Oi extends jt{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(x){this._startVector=this._vector=x[0].sub(x[1]),this._minDiameter=x[0].dist(x[1])}_move(x,Q){const G=this._vector;if(this._vector=x[0].sub(x[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:zi(this._vector,G),pinchAround:Q}}_isBelowThreshold(x){this._minDiameter=Math.min(this._minDiameter,x.mag());const Q=25/(Math.PI*this._minDiameter)*360,G=zi(x,this._startVector);return Math.abs(G)<Q}}function mr(J){return Math.abs(J.y)>Math.abs(J.x)}class ur extends jt{constructor(x){super(),this._map=x}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(x,Q,G){super.touchstart(x,Q,G),this._currentTouchCount=G.length}_start(x){this._lastPoints=x,mr(x[0].sub(x[1]))&&(this._valid=!1)}_move(x,Q,G){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const X=x[0].sub(this._lastPoints[0]),te=x[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(X,te,G.timeStamp),this._valid?(this._lastPoints=x,this._active=!0,{pitchDelta:(X.y+te.y)/2*-.5}):void 0}gestureBeginsVertically(x,Q,G){if(this._valid!==void 0)return this._valid;const X=x.mag()>=2,te=Q.mag()>=2;if(!X&&!te)return;if(!X||!te)return this._firstMove===void 0&&(this._firstMove=G),G-this._firstMove<100&&void 0;const Ae=x.y>0==Q.y>0;return mr(x)&&mr(Q)&&Ae}}const vr={panStep:100,bearingStep:15,pitchStep:10};class nr{constructor(x){this._tr=new da(x);const Q=vr;this._panStep=Q.panStep,this._bearingStep=Q.bearingStep,this._pitchStep=Q.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(x){if(x.altKey||x.ctrlKey||x.metaKey)return;let Q=0,G=0,X=0,te=0,Ae=0;switch(x.keyCode){case 61:case 107:case 171:case 187:Q=1;break;case 189:case 109:case 173:Q=-1;break;case 37:x.shiftKey?G=-1:(x.preventDefault(),te=-1);break;case 39:x.shiftKey?G=1:(x.preventDefault(),te=1);break;case 38:x.shiftKey?X=1:(x.preventDefault(),Ae=-1);break;case 40:x.shiftKey?X=-1:(x.preventDefault(),Ae=1);break;default:return}return this._rotationDisabled&&(G=0,X=0),{cameraAnimation:he=>{const pe=this._tr;he.easeTo({duration:300,easeId:"keyboardHandler",easing:Xi,zoom:Q?Math.round(pe.zoom)+Q*(x.shiftKey?2:1):pe.zoom,bearing:pe.bearing+G*this._bearingStep,pitch:pe.pitch+X*this._pitchStep,offset:[-te*this._panStep,-Ae*this._panStep],center:pe.center},{originalEvent:x})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Xi(J){return J*(2-J)}const Or=4.000244140625;class Sr{constructor(x,Q){this._onTimeout=G=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(G)},this._map=x,this._tr=new da(x),this._el=x.getCanvasContainer(),this._triggerRenderFrame=Q,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(x){this._defaultZoomRate=x}setWheelZoomRate(x){this._wheelZoomRate=x}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(x){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!x&&x.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(x){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!x[this._map._metaKey])return;x.preventDefault()}let Q=x.deltaMode===WheelEvent.DOM_DELTA_LINE?40*x.deltaY:x.deltaY;const G=D.browser.now(),X=G-(this._lastWheelEventTime||0);this._lastWheelEventTime=G,Q!==0&&Q%Or==0?this._type="wheel":Q!==0&&Math.abs(Q)<4?this._type="trackpad":X>400?(this._type=null,this._lastValue=Q,this._timeout=setTimeout(this._onTimeout,40,x)):this._type||(this._type=Math.abs(X*Q)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,Q+=this._lastValue)),x.shiftKey&&Q&&(Q/=4),this._type&&(this._lastWheelEvent=x,this._delta-=Q,this._active||this._start(x)),x.preventDefault()}_start(x){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const Q=ae.mousePos(this._el,x),G=this._tr;this._around=D.LngLat.convert(this._aroundCenter?G.center:G.unproject(Q)),this._aroundPoint=G.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const x=this._tr.transform;if(this._delta!==0){const he=this._type==="wheel"&&Math.abs(this._delta)>Or?this._wheelZoomRate:this._defaultZoomRate;let pe=2/(1+Math.exp(-Math.abs(this._delta*he)));this._delta<0&&pe!==0&&(pe=1/pe);const ve=typeof this._targetZoom=="number"?x.zoomScale(this._targetZoom):x.scale;this._targetZoom=Math.min(x.maxZoom,Math.max(x.minZoom,x.scaleZoom(ve*pe))),this._type==="wheel"&&(this._startZoom=x.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const Q=typeof this._targetZoom=="number"?this._targetZoom:x.zoom,G=this._startZoom,X=this._easing;let te,Ae=!1;if(this._type==="wheel"&&G&&X){const he=Math.min((D.browser.now()-this._lastWheelEventTime)/200,1),pe=X(he);te=D.interpolate.number(G,Q,pe),he<1?this._frameId||(this._frameId=!0):Ae=!0}else te=Q,Ae=!0;return this._active=!0,Ae&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Ae,zoomDelta:te-x.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(x){let Q=D.defaultEasing;if(this._prevEase){const G=this._prevEase,X=(D.browser.now()-G.start)/G.duration,te=G.easing(X+.01)-G.easing(X),Ae=.27/Math.sqrt(te*te+1e-4)*.01,he=Math.sqrt(.0729-Ae*Ae);Q=D.bezier(Ae,he,.25,1)}return this._prevEase={start:D.browser.now(),duration:x,easing:Q},Q}reset(){this._active=!1}}class bs{constructor(x,Q){this._clickZoom=x,this._tapZoom=Q}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ha{constructor(x){this._tr=new da(x),this.reset()}reset(){this._active=!1}dblclick(x,Q){return x.preventDefault(),{cameraAnimation:G=>{G.easeTo({duration:300,zoom:this._tr.zoom+(x.shiftKey?-1:1),around:this._tr.unproject(Q)},{originalEvent:x})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class pa{constructor(){this._tap=new tn({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(x,Q,G){if(!this._swipePoint)if(this._tapTime){const X=Q[0],te=x.timeStamp-this._tapTime<500,Ae=this._tapPoint.dist(X)<30;te&&Ae?G.length>0&&(this._swipePoint=X,this._swipeTouch=G[0].identifier):this.reset()}else this._tap.touchstart(x,Q,G)}touchmove(x,Q,G){if(this._tapTime){if(this._swipePoint){if(G[0].identifier!==this._swipeTouch)return;const X=Q[0],te=X.y-this._swipePoint.y;return this._swipePoint=X,x.preventDefault(),this._active=!0,{zoomDelta:te/128}}}else this._tap.touchmove(x,Q,G)}touchend(x,Q,G){if(this._tapTime)this._swipePoint&&G.length===0&&this.reset();else{const X=this._tap.touchend(x,Q,G);X&&(this._tapTime=x.timeStamp,this._tapPoint=X)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ns{constructor(x,Q,G){this._el=x,this._mousePan=Q,this._touchPan=G}enable(x){this._inertiaOptions=x||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Er{constructor(x,Q,G){this._pitchWithRotate=x.pitchWithRotate,this._mouseRotate=Q,this._mousePitch=G}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ga{constructor(x,Q,G,X){this._el=x,this._touchZoom=Q,this._touchRotate=G,this._tapDragZoom=X,this._rotationDisabled=!1,this._enabled=!0}enable(x){this._touchZoom.enable(x),this._rotationDisabled||this._touchRotate.enable(x),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const vn=J=>J.zoom||J.drag||J.pitch||J.rotate;class Jo extends D.Event{}function qn(J){return J.panDelta&&J.panDelta.mag()||J.zoomDelta||J.bearingDelta||J.pitchDelta}class ho{constructor(x,Q){this.handleWindowEvent=X=>{this.handleEvent(X,`${X.type}Window`)},this.handleEvent=(X,te)=>{if(X.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const Ae=X.type==="renderFrame"?void 0:X,he={needsRenderFrame:!1},pe={},ve={},Ce=X.touches,Se=Ce?this._getMapTouches(Ce):void 0,Qe=Se?ae.touchPos(this._el,Se):ae.mousePos(this._el,X);for(const{handlerName:rt,handler:Ye,allowed:dt}of this._handlers){if(!Ye.isEnabled())continue;let Bt;this._blockedByActive(ve,dt,rt)?Ye.reset():Ye[te||X.type]&&(Bt=Ye[te||X.type](X,Qe,Se),this.mergeHandlerResult(he,pe,Bt,rt,Ae),Bt&&Bt.needsRenderFrame&&this._triggerRenderFrame()),(Bt||Ye.isActive())&&(ve[rt]=Ye)}const $e={};for(const rt in this._previousActiveHandlers)ve[rt]||($e[rt]=Ae);this._previousActiveHandlers=ve,(Object.keys($e).length||qn(he))&&(this._changes.push([he,pe,$e]),this._triggerRenderFrame()),(Object.keys(ve).length||qn(he))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Ze}=he;Ze&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Ze(this._map))},this._map=x,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new fa(x),this._bearingSnap=Q.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(Q);const G=this._el;this._listeners=[[G,"touchstart",{passive:!0}],[G,"touchmove",{passive:!1}],[G,"touchend",void 0],[G,"touchcancel",void 0],[G,"mousedown",void 0],[G,"mousemove",void 0],[G,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[G,"mouseover",void 0],[G,"mouseout",void 0],[G,"dblclick",void 0],[G,"click",void 0],[G,"keydown",{capture:!1}],[G,"keyup",void 0],[G,"wheel",{passive:!1}],[G,"contextmenu",void 0],[window,"blur",void 0]];for(const[X,te,Ae]of this._listeners)ae.addEventListener(X,te,X===document?this.handleWindowEvent:this.handleEvent,Ae)}destroy(){for(const[x,Q,G]of this._listeners)ae.removeEventListener(x,Q,x===document?this.handleWindowEvent:this.handleEvent,G)}_addDefaultHandlers(x){const Q=this._map,G=Q.getCanvasContainer();this._add("mapEvent",new Ra(Q,x));const X=Q.boxZoom=new Zo(Q,x);this._add("boxZoom",X),x.interactive&&x.boxZoom&&X.enable();const te=new gi(Q),Ae=new Ha(Q);Q.doubleClickZoom=new bs(Ae,te),this._add("tapZoom",te),this._add("clickZoom",Ae),x.interactive&&x.doubleClickZoom&&Q.doubleClickZoom.enable();const he=new pa;this._add("tapDragZoom",he);const pe=Q.touchPitch=new ur(Q);this._add("touchPitch",pe),x.interactive&&x.touchPitch&&Q.touchPitch.enable(x.touchPitch);const ve=yt(x),Ce=Et(x);Q.dragRotate=new Er(x,ve,Ce),this._add("mouseRotate",ve,["mousePitch"]),this._add("mousePitch",Ce,["mouseRotate"]),x.interactive&&x.dragRotate&&Q.dragRotate.enable();const Se=(({enable:dt,clickTolerance:Bt})=>{const ot=new Re({checkCorrectEvent:gt=>ae.mouseButton(gt)===0&&!gt.ctrlKey});return new kn({clickTolerance:Bt,move:(gt,St)=>({around:St,panDelta:St.sub(gt)}),activateOnStart:!0,moveStateManager:ot,enable:dt,assignEvents:je})})(x),Qe=new Ht(x,Q);Q.dragPan=new ns(G,Se,Qe),this._add("mousePan",Se),this._add("touchPan",Qe,["touchZoom","touchRotate"]),x.interactive&&x.dragPan&&Q.dragPan.enable(x.dragPan);const $e=new Oi,Ze=new Gi;Q.touchZoomRotate=new ga(G,Ze,$e,he),this._add("touchRotate",$e,["touchPan","touchZoom"]),this._add("touchZoom",Ze,["touchPan","touchRotate"]),x.interactive&&x.touchZoomRotate&&Q.touchZoomRotate.enable(x.touchZoomRotate);const rt=Q.scrollZoom=new Sr(Q,()=>this._triggerRenderFrame());this._add("scrollZoom",rt,["mousePan"]),x.interactive&&x.scrollZoom&&Q.scrollZoom.enable(x.scrollZoom);const Ye=Q.keyboard=new nr(Q);this._add("keyboard",Ye),x.interactive&&x.keyboard&&Q.keyboard.enable(),this._add("blockableMapEvent",new co(Q))}_add(x,Q,G){this._handlers.push({handlerName:x,handler:Q,allowed:G}),this._handlersById[x]=Q}stop(x){if(!this._updatingCamera){for(const{handler:Q}of this._handlers)Q.reset();this._inertia.clear(),this._fireEvents({},{},x),this._changes=[]}}isActive(){for(const{handler:x}of this._handlers)if(x.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!vn(this._eventsInProgress)||this.isZooming()}_blockedByActive(x,Q,G){for(const X in x)if(X!==G&&(!Q||Q.indexOf(X)<0))return!0;return!1}_getMapTouches(x){const Q=[];for(const G of x)this._el.contains(G.target)&&Q.push(G);return Q}mergeHandlerResult(x,Q,G,X,te){if(!G)return;D.extend(x,G);const Ae={handlerName:X,originalEvent:G.originalEvent||te};G.zoomDelta!==void 0&&(Q.zoom=Ae),G.panDelta!==void 0&&(Q.drag=Ae),G.pitchDelta!==void 0&&(Q.pitch=Ae),G.bearingDelta!==void 0&&(Q.rotate=Ae)}_applyChanges(){const x={},Q={},G={};for(const[X,te,Ae]of this._changes)X.panDelta&&(x.panDelta=(x.panDelta||new D.Point(0,0))._add(X.panDelta)),X.zoomDelta&&(x.zoomDelta=(x.zoomDelta||0)+X.zoomDelta),X.bearingDelta&&(x.bearingDelta=(x.bearingDelta||0)+X.bearingDelta),X.pitchDelta&&(x.pitchDelta=(x.pitchDelta||0)+X.pitchDelta),X.around!==void 0&&(x.around=X.around),X.pinchAround!==void 0&&(x.pinchAround=X.pinchAround),X.noInertia&&(x.noInertia=X.noInertia),D.extend(Q,te),D.extend(G,Ae);this._updateMapTransform(x,Q,G),this._changes=[]}_updateMapTransform(x,Q,G){const X=this._map,te=X._getTransformForUpdate(),Ae=X.terrain;if(!(qn(x)||Ae&&this._terrainMovement))return this._fireEvents(Q,G,!0);let{panDelta:he,zoomDelta:pe,bearingDelta:ve,pitchDelta:Ce,around:Se,pinchAround:Qe}=x;Qe!==void 0&&(Se=Qe),X._stop(!0),Se=Se||X.transform.centerPoint;const $e=te.pointLocation(he?Se.sub(he):Se);ve&&(te.bearing+=ve),Ce&&(te.pitch+=Ce),pe&&(te.zoom+=pe),Ae?this._terrainMovement||!Q.drag&&!Q.zoom?Q.drag&&this._terrainMovement?te.center=te.pointLocation(te.centerPoint.sub(he)):te.setLocationAtPoint($e,Se):(this._terrainMovement=!0,this._map._elevationFreeze=!0,te.setLocationAtPoint($e,Se),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,te.recalculateZoom(X.terrain)})):te.setLocationAtPoint($e,Se),X._applyUpdatedTransform(te),this._map._update(),x.noInertia||this._inertia.record(x),this._fireEvents(Q,G,!0)}_fireEvents(x,Q,G){const X=vn(this._eventsInProgress),te=vn(x),Ae={};for(const Ce in x){const{originalEvent:Se}=x[Ce];this._eventsInProgress[Ce]||(Ae[`${Ce}start`]=Se),this._eventsInProgress[Ce]=x[Ce]}!X&&te&&this._fireEvent("movestart",te.originalEvent);for(const Ce in Ae)this._fireEvent(Ce,Ae[Ce]);te&&this._fireEvent("move",te.originalEvent);for(const Ce in x){const{originalEvent:Se}=x[Ce];this._fireEvent(Ce,Se)}const he={};let pe;for(const Ce in this._eventsInProgress){const{handlerName:Se,originalEvent:Qe}=this._eventsInProgress[Ce];this._handlersById[Se].isActive()||(delete this._eventsInProgress[Ce],pe=Q[Se]||Qe,he[`${Ce}end`]=pe)}for(const Ce in he)this._fireEvent(Ce,he[Ce]);const ve=vn(this._eventsInProgress);if(G&&(X||te)&&!ve){this._updatingCamera=!0;const Ce=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Se=Qe=>Qe!==0&&-this._bearingSnap<Qe&&Qe<this._bearingSnap;Ce?(Se(Ce.bearing||this._map.getBearing())&&(Ce.bearing=0),Ce.freezeElevation=!0,this._map.easeTo(Ce,{originalEvent:pe})):(this._map.fire(new D.Event("moveend",{originalEvent:pe})),Se(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(x,Q){this._map.fire(new D.Event(x,Q?{originalEvent:Q}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(x=>{delete this._frameId,this.handleEvent(new Jo("renderFrame",{timeStamp:x})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class yl extends D.Evented{constructor(x,Q){super(),this._renderFrameCallback=()=>{const G=Math.min((D.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(G)),G<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=x,this._bearingSnap=Q.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new D.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(x,Q){return this.jumpTo({center:x},Q)}panBy(x,Q,G){return x=D.Point.convert(x).mult(-1),this.panTo(this.transform.center,D.extend({offset:x},Q),G)}panTo(x,Q,G){return this.easeTo(D.extend({center:x},Q),G)}getZoom(){return this.transform.zoom}setZoom(x,Q){return this.jumpTo({zoom:x},Q),this}zoomTo(x,Q,G){return this.easeTo(D.extend({zoom:x},Q),G)}zoomIn(x,Q){return this.zoomTo(this.getZoom()+1,x,Q),this}zoomOut(x,Q){return this.zoomTo(this.getZoom()-1,x,Q),this}getBearing(){return this.transform.bearing}setBearing(x,Q){return this.jumpTo({bearing:x},Q),this}getPadding(){return this.transform.padding}setPadding(x,Q){return this.jumpTo({padding:x},Q),this}rotateTo(x,Q,G){return this.easeTo(D.extend({bearing:x},Q),G)}resetNorth(x,Q){return this.rotateTo(0,D.extend({duration:1e3},x),Q),this}resetNorthPitch(x,Q){return this.easeTo(D.extend({bearing:0,pitch:0,duration:1e3},x),Q),this}snapToNorth(x,Q){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(x,Q):this}getPitch(){return this.transform.pitch}setPitch(x,Q){return this.jumpTo({pitch:x},Q),this}cameraForBounds(x,Q){x=R.convert(x);const G=Q&&Q.bearing||0;return this._cameraForBoxAndBearing(x.getNorthWest(),x.getSouthEast(),G,Q)}_cameraForBoxAndBearing(x,Q,G,X){const te={top:0,bottom:0,right:0,left:0};if(typeof(X=D.extend({padding:te,offset:[0,0],maxZoom:this.transform.maxZoom},X)).padding=="number"){const St=X.padding;X.padding={top:St,bottom:St,right:St,left:St}}X.padding=D.extend(te,X.padding);const Ae=this.transform,he=Ae.padding,pe=Ae.project(D.LngLat.convert(x)),ve=Ae.project(D.LngLat.convert(Q)),Ce=pe.rotate(-G*Math.PI/180),Se=ve.rotate(-G*Math.PI/180),Qe=new D.Point(Math.max(Ce.x,Se.x),Math.max(Ce.y,Se.y)),$e=new D.Point(Math.min(Ce.x,Se.x),Math.min(Ce.y,Se.y)),Ze=Qe.sub($e),rt=(Ae.width-(he.left+he.right+X.padding.left+X.padding.right))/Ze.x,Ye=(Ae.height-(he.top+he.bottom+X.padding.top+X.padding.bottom))/Ze.y;if(Ye<0||rt<0)return void D.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const dt=Math.min(Ae.scaleZoom(Ae.scale*Math.min(rt,Ye)),X.maxZoom),Bt=D.Point.convert(X.offset),ot=new D.Point((X.padding.left-X.padding.right)/2,(X.padding.top-X.padding.bottom)/2).rotate(G*Math.PI/180),gt=Bt.add(ot).mult(Ae.scale/Ae.zoomScale(dt));return{center:Ae.unproject(pe.add(ve).div(2).sub(gt)),zoom:dt,bearing:G}}fitBounds(x,Q,G){return this._fitInternal(this.cameraForBounds(x,Q),Q,G)}fitScreenCoordinates(x,Q,G,X,te){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(D.Point.convert(x)),this.transform.pointLocation(D.Point.convert(Q)),G,X),X,te)}_fitInternal(x,Q,G){return x?(delete(Q=D.extend(x,Q)).padding,Q.linear?this.easeTo(Q,G):this.flyTo(Q,G)):this}jumpTo(x,Q){this.stop();const G=this._getTransformForUpdate();let X=!1,te=!1,Ae=!1;return"zoom"in x&&G.zoom!==+x.zoom&&(X=!0,G.zoom=+x.zoom),x.center!==void 0&&(G.center=D.LngLat.convert(x.center)),"bearing"in x&&G.bearing!==+x.bearing&&(te=!0,G.bearing=+x.bearing),"pitch"in x&&G.pitch!==+x.pitch&&(Ae=!0,G.pitch=+x.pitch),x.padding==null||G.isPaddingEqual(x.padding)||(G.padding=x.padding),this._applyUpdatedTransform(G),this.fire(new D.Event("movestart",Q)).fire(new D.Event("move",Q)),X&&this.fire(new D.Event("zoomstart",Q)).fire(new D.Event("zoom",Q)).fire(new D.Event("zoomend",Q)),te&&this.fire(new D.Event("rotatestart",Q)).fire(new D.Event("rotate",Q)).fire(new D.Event("rotateend",Q)),Ae&&this.fire(new D.Event("pitchstart",Q)).fire(new D.Event("pitch",Q)).fire(new D.Event("pitchend",Q)),this.fire(new D.Event("moveend",Q))}calculateCameraOptionsFromTo(x,Q,G,X=0){const te=D.MercatorCoordinate.fromLngLat(x,Q),Ae=D.MercatorCoordinate.fromLngLat(G,X),he=Ae.x-te.x,pe=Ae.y-te.y,ve=Ae.z-te.z,Ce=Math.hypot(he,pe,ve);if(Ce===0)throw new Error("Can't calculate camera options with same From and To");const Se=Math.hypot(he,pe),Qe=this.transform.scaleZoom(this.transform.cameraToCenterDistance/Ce/this.transform.tileSize),$e=180*Math.atan2(he,-pe)/Math.PI;let Ze=180*Math.acos(Se/Ce)/Math.PI;return Ze=ve<0?90-Ze:90+Ze,{center:Ae.toLngLat(),zoom:Qe,pitch:Ze,bearing:$e}}easeTo(x,Q){this._stop(!1,x.easeId),((x=D.extend({offset:[0,0],duration:500,easing:D.defaultEasing},x)).animate===!1||!x.essential&&D.browser.prefersReducedMotion)&&(x.duration=0);const G=this._getTransformForUpdate(),X=this.getZoom(),te=this.getBearing(),Ae=this.getPitch(),he=this.getPadding(),pe="zoom"in x?+x.zoom:X,ve="bearing"in x?this._normalizeBearing(x.bearing,te):te,Ce="pitch"in x?+x.pitch:Ae,Se="padding"in x?x.padding:G.padding,Qe=D.Point.convert(x.offset);let $e=G.centerPoint.add(Qe);const Ze=G.pointLocation($e),rt=D.LngLat.convert(x.center||Ze);this._normalizeCenter(rt);const Ye=G.project(Ze),dt=G.project(rt).sub(Ye),Bt=G.zoomScale(pe-X);let ot,gt;x.around&&(ot=D.LngLat.convert(x.around),gt=G.locationPoint(ot));const St={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||pe!==X,this._rotating=this._rotating||te!==ve,this._pitching=this._pitching||Ce!==Ae,this._padding=!G.isPaddingEqual(Se),this._easeId=x.easeId,this._prepareEase(Q,x.noMoveStart,St),this.terrain&&this._prepareElevation(rt),this._ease(It=>{if(this._zooming&&(G.zoom=D.interpolate.number(X,pe,It)),this._rotating&&(G.bearing=D.interpolate.number(te,ve,It)),this._pitching&&(G.pitch=D.interpolate.number(Ae,Ce,It)),this._padding&&(G.interpolatePadding(he,Se,It),$e=G.centerPoint.add(Qe)),this.terrain&&!x.freezeElevation&&this._updateElevation(It),ot)G.setLocationAtPoint(ot,gt);else{const Lt=G.zoomScale(G.zoom-X),Kt=pe>X?Math.min(2,Bt):Math.max(.5,Bt),Rt=Math.pow(Kt,1-It),Jt=G.unproject(Ye.add(dt.mult(It*Rt)).mult(Lt));G.setLocationAtPoint(G.renderWorldCopies?Jt.wrap():Jt,$e)}this._applyUpdatedTransform(G),this._fireMoveEvents(Q)},It=>{this.terrain&&this._finalizeElevation(),this._afterEase(Q,It)},x),this}_prepareEase(x,Q,G={}){this._moving=!0,Q||G.moving||this.fire(new D.Event("movestart",x)),this._zooming&&!G.zooming&&this.fire(new D.Event("zoomstart",x)),this._rotating&&!G.rotating&&this.fire(new D.Event("rotatestart",x)),this._pitching&&!G.pitching&&this.fire(new D.Event("pitchstart",x))}_prepareElevation(x){this._elevationCenter=x,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(x,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(x){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const Q=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(x<1&&Q!==this._elevationTarget){const G=this._elevationTarget-this._elevationStart;this._elevationStart+=x*(G-(Q-(G*x+this._elevationStart))/(1-x)),this._elevationTarget=Q}this.transform.elevation=D.interpolate.number(this._elevationStart,this._elevationTarget,x)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(x){if(!this.transformCameraUpdate)return;const Q=x.clone(),{center:G,zoom:X,pitch:te,bearing:Ae,elevation:he}=this.transformCameraUpdate(Q);G&&(Q.center=G),X!==void 0&&(Q.zoom=X),te!==void 0&&(Q.pitch=te),Ae!==void 0&&(Q.bearing=Ae),he!==void 0&&(Q.elevation=he),this.transform.apply(Q)}_fireMoveEvents(x){this.fire(new D.Event("move",x)),this._zooming&&this.fire(new D.Event("zoom",x)),this._rotating&&this.fire(new D.Event("rotate",x)),this._pitching&&this.fire(new D.Event("pitch",x))}_afterEase(x,Q){if(this._easeId&&Q&&this._easeId===Q)return;delete this._easeId;const G=this._zooming,X=this._rotating,te=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,G&&this.fire(new D.Event("zoomend",x)),X&&this.fire(new D.Event("rotateend",x)),te&&this.fire(new D.Event("pitchend",x)),this.fire(new D.Event("moveend",x))}flyTo(x,Q){if(!x.essential&&D.browser.prefersReducedMotion){const xi=D.pick(x,["center","zoom","bearing","pitch","around"]);return this.jumpTo(xi,Q)}this.stop(),x=D.extend({offset:[0,0],speed:1.2,curve:1.42,easing:D.defaultEasing},x);const G=this._getTransformForUpdate(),X=this.getZoom(),te=this.getBearing(),Ae=this.getPitch(),he=this.getPadding(),pe="zoom"in x?D.clamp(+x.zoom,G.minZoom,G.maxZoom):X,ve="bearing"in x?this._normalizeBearing(x.bearing,te):te,Ce="pitch"in x?+x.pitch:Ae,Se="padding"in x?x.padding:G.padding,Qe=G.zoomScale(pe-X),$e=D.Point.convert(x.offset);let Ze=G.centerPoint.add($e);const rt=G.pointLocation(Ze),Ye=D.LngLat.convert(x.center||rt);this._normalizeCenter(Ye);const dt=G.project(rt),Bt=G.project(Ye).sub(dt);let ot=x.curve;const gt=Math.max(G.width,G.height),St=gt/Qe,It=Bt.mag();if("minZoom"in x){const xi=D.clamp(Math.min(x.minZoom,X,pe),G.minZoom,G.maxZoom),Hr=gt/G.zoomScale(xi-X);ot=Math.sqrt(Hr/It*2)}const Lt=ot*ot;function Kt(xi){const Hr=(St*St-gt*gt+(xi?-1:1)*Lt*Lt*It*It)/(2*(xi?St:gt)*Lt*It);return Math.log(Math.sqrt(Hr*Hr+1)-Hr)}function Rt(xi){return(Math.exp(xi)-Math.exp(-xi))/2}function Jt(xi){return(Math.exp(xi)+Math.exp(-xi))/2}const Bi=Kt(!1);let ar=function(xi){return Jt(Bi)/Jt(Bi+ot*xi)},oi=function(xi){return gt*((Jt(Bi)*(Rt(Hr=Bi+ot*xi)/Jt(Hr))-Rt(Bi))/Lt)/It;var Hr},ki=(Kt(!0)-Bi)/ot;if(Math.abs(It)<1e-6||!isFinite(ki)){if(Math.abs(gt-St)<1e-6)return this.easeTo(x,Q);const xi=St<gt?-1:1;ki=Math.abs(Math.log(St/gt))/ot,oi=function(){return 0},ar=function(Hr){return Math.exp(xi*ot*Hr)}}return x.duration="duration"in x?+x.duration:1e3*ki/("screenSpeed"in x?+x.screenSpeed/ot:+x.speed),x.maxDuration&&x.duration>x.maxDuration&&(x.duration=0),this._zooming=!0,this._rotating=te!==ve,this._pitching=Ce!==Ae,this._padding=!G.isPaddingEqual(Se),this._prepareEase(Q,!1),this.terrain&&this._prepareElevation(Ye),this._ease(xi=>{const Hr=xi*ki,or=1/ar(Hr);G.zoom=xi===1?pe:X+G.scaleZoom(or),this._rotating&&(G.bearing=D.interpolate.number(te,ve,xi)),this._pitching&&(G.pitch=D.interpolate.number(Ae,Ce,xi)),this._padding&&(G.interpolatePadding(he,Se,xi),Ze=G.centerPoint.add($e)),this.terrain&&!x.freezeElevation&&this._updateElevation(xi);const Mi=xi===1?Ye:G.unproject(dt.add(Bt.mult(oi(Hr))).mult(or));G.setLocationAtPoint(G.renderWorldCopies?Mi.wrap():Mi,Ze),this._applyUpdatedTransform(G),this._fireMoveEvents(Q)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(Q)},x),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(x,Q){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const G=this._onEaseEnd;delete this._onEaseEnd,G.call(this,Q)}if(!x){const G=this.handlers;G&&G.stop(!1)}return this}_ease(x,Q,G){G.animate===!1||G.duration===0?(x(1),Q()):(this._easeStart=D.browser.now(),this._easeOptions=G,this._onEaseFrame=x,this._onEaseEnd=Q,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(x,Q){x=D.wrap(x,-180,180);const G=Math.abs(x-Q);return Math.abs(x-360-Q)<G&&(x-=360),Math.abs(x+360-Q)<G&&(x+=360),x}_normalizeCenter(x){const Q=this.transform;if(!Q.renderWorldCopies||Q.lngRange)return;const G=x.lng-Q.center.lng;x.lng+=G>180?-360:G<-180?360:0}queryTerrainElevation(x){return this.terrain?this.terrain.getElevationForLngLatZoom(D.LngLat.convert(x),this.transform.tileZoom)-this.transform.elevation:null}}class zs{constructor(x={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=Q=>{!Q||Q.sourceDataType!=="metadata"&&Q.sourceDataType!=="visibility"&&Q.dataType!=="style"&&Q.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=x}getDefaultPosition(){return"bottom-right"}onAdd(x){return this._map=x,this._compact=this.options&&this.options.compact,this._container=ae.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=ae.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=ae.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){ae.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(x,Q){const G=this._map._getUIString(`AttributionControl.${Q}`);x.title=G,x.setAttribute("aria-label",G)}_updateAttributions(){if(!this._map.style)return;let x=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?x=x.concat(this.options.customAttribution.map(X=>typeof X!="string"?"":X)):typeof this.options.customAttribution=="string"&&x.push(this.options.customAttribution)),this._map.style.stylesheet){const X=this._map.style.stylesheet;this.styleOwner=X.owner,this.styleId=X.id}const Q=this._map.style.sourceCaches;for(const X in Q){const te=Q[X];if(te.used||te.usedForTerrain){const Ae=te.getSource();Ae.attribution&&x.indexOf(Ae.attribution)<0&&x.push(Ae.attribution)}}x=x.filter(X=>String(X).trim()),x.sort((X,te)=>X.length-te.length),x=x.filter((X,te)=>{for(let Ae=te+1;Ae<x.length;Ae++)if(x[Ae].indexOf(X)>=0)return!1;return!0});const G=x.join(" | ");G!==this._attribHTML&&(this._attribHTML=G,x.length?(this._innerContainer.innerHTML=G,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Mo{constructor(x={}){this._updateCompact=()=>{const Q=this._container.children;if(Q.length){const G=Q[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&G.classList.add("maplibregl-compact"):G.classList.remove("maplibregl-compact")}},this.options=x}getDefaultPosition(){return"bottom-left"}onAdd(x){this._map=x,this._compact=this.options&&this.options.compact,this._container=ae.create("div","maplibregl-ctrl");const Q=ae.create("a","maplibregl-ctrl-logo");return Q.target="_blank",Q.rel="noopener nofollow",Q.href="https://maplibre.org/",Q.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),Q.setAttribute("rel","noopener nofollow"),this._container.appendChild(Q),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){ae.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Fi{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(x){const Q=++this._id;return this._queue.push({callback:x,id:Q,cancelled:!1}),Q}remove(x){const Q=this._currentlyRunning,G=Q?this._queue.concat(Q):this._queue;for(const X of G)if(X.id===x)return void(X.cancelled=!0)}run(x=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const Q=this._currentlyRunning=this._queue;this._queue=[];for(const G of Q)if(!G.cancelled&&(G.callback(x),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Ni={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var $o=D.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class vl extends D.Evented{constructor(x){super(),this.sourceCache=x,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,x.usedForTerrain=!0,x.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(x,Q){this.sourceCache.update(x,Q),this._renderableTilesKeys=[];const G={};for(const X of x.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:Q}))G[X.key]=!0,this._renderableTilesKeys.push(X.key),this._tiles[X.key]||(X.posMatrix=new Float64Array(16),D.ortho(X.posMatrix,0,D.EXTENT,0,D.EXTENT,0,1),this._tiles[X.key]=new zt(X,this.tileSize));for(const X in this._tiles)G[X]||delete this._tiles[X]}freeRtt(x){for(const Q in this._tiles){const G=this._tiles[Q];(!x||G.tileID.equals(x)||G.tileID.isChildOf(x)||x.isChildOf(G.tileID))&&(G.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(x=>this.getTileByID(x))}getTileByID(x){return this._tiles[x]}getTerrainCoords(x){const Q={};for(const G of this._renderableTilesKeys){const X=this._tiles[G].tileID;if(X.canonical.equals(x.canonical)){const te=x.clone();te.posMatrix=new Float64Array(16),D.ortho(te.posMatrix,0,D.EXTENT,0,D.EXTENT,0,1),Q[G]=te}else if(X.canonical.isChildOf(x.canonical)){const te=x.clone();te.posMatrix=new Float64Array(16);const Ae=X.canonical.z-x.canonical.z,he=X.canonical.x-(X.canonical.x>>Ae<<Ae),pe=X.canonical.y-(X.canonical.y>>Ae<<Ae),ve=D.EXTENT>>Ae;D.ortho(te.posMatrix,0,ve,0,ve,0,1),D.translate(te.posMatrix,te.posMatrix,[-he*ve,-pe*ve,0]),Q[G]=te}else if(x.canonical.isChildOf(X.canonical)){const te=x.clone();te.posMatrix=new Float64Array(16);const Ae=x.canonical.z-X.canonical.z,he=x.canonical.x-(x.canonical.x>>Ae<<Ae),pe=x.canonical.y-(x.canonical.y>>Ae<<Ae),ve=D.EXTENT>>Ae;D.ortho(te.posMatrix,0,D.EXTENT,0,D.EXTENT,0,1),D.translate(te.posMatrix,te.posMatrix,[he*ve,pe*ve,0]),D.scale(te.posMatrix,te.posMatrix,[1/2**Ae,1/2**Ae,0]),Q[G]=te}}return Q}getSourceTile(x,Q){const G=this.sourceCache._source;let X=x.overscaledZ-this.deltaZoom;if(X>G.maxzoom&&(X=G.maxzoom),X<G.minzoom)return null;this._sourceTileCache[x.key]||(this._sourceTileCache[x.key]=x.scaledTo(X).key);let te=this.sourceCache.getTileByID(this._sourceTileCache[x.key]);if((!te||!te.dem)&&Q)for(;X>=G.minzoom&&(!te||!te.dem);)te=this.sourceCache.getTileByID(x.scaledTo(X--).key);return te}tilesAfterTime(x=Date.now()){return Object.values(this._tiles).filter(Q=>Q.timeAdded>=x)}}class bl{constructor(x,Q,G){this.painter=x,this.sourceCache=new vl(Q),this.options=G,this.exaggeration=typeof G.exaggeration=="number"?G.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(x,Q,G,X=D.EXTENT){var te;if(!(Q>=0&&Q<X&&G>=0&&G<X))return 0;const Ae=this.getTerrainData(x),he=(te=Ae.tile)===null||te===void 0?void 0:te.dem;if(!he)return 0;const pe=function(Ze,rt,Ye){var dt=rt[0],Bt=rt[1];return Ze[0]=Ye[0]*dt+Ye[4]*Bt+Ye[12],Ze[1]=Ye[1]*dt+Ye[5]*Bt+Ye[13],Ze}([],[Q/X*D.EXTENT,G/X*D.EXTENT],Ae.u_terrain_matrix),ve=[pe[0]*he.dim,pe[1]*he.dim],Ce=Math.floor(ve[0]),Se=Math.floor(ve[1]),Qe=ve[0]-Ce,$e=ve[1]-Se;return he.get(Ce,Se)*(1-Qe)*(1-$e)+he.get(Ce+1,Se)*Qe*(1-$e)+he.get(Ce,Se+1)*(1-Qe)*$e+he.get(Ce+1,Se+1)*Qe*$e}getElevationForLngLatZoom(x,Q){const{tileID:G,mercatorX:X,mercatorY:te}=this._getOverscaledTileIDFromLngLatZoom(x,Q);return this.getElevation(G,X%D.EXTENT,te%D.EXTENT,D.EXTENT)}getElevation(x,Q,G,X=D.EXTENT){return this.getDEMElevation(x,Q,G,X)*this.exaggeration}getTerrainData(x){if(!this._emptyDemTexture){const X=this.painter.context,te=new D.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new vt(X,te,X.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new vt(X,new D.RGBAImage({width:1,height:1}),X.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(X.gl.NEAREST,X.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=D.identity([])}const Q=this.sourceCache.getSourceTile(x,!0);if(Q&&Q.dem&&(!Q.demTexture||Q.needsTerrainPrepare)){const X=this.painter.context;Q.demTexture=this.painter.getTileTexture(Q.dem.stride),Q.demTexture?Q.demTexture.update(Q.dem.getPixels(),{premultiply:!1}):Q.demTexture=new vt(X,Q.dem.getPixels(),X.gl.RGBA,{premultiply:!1}),Q.demTexture.bind(X.gl.NEAREST,X.gl.CLAMP_TO_EDGE),Q.needsTerrainPrepare=!1}const G=Q&&Q+Q.tileID.key+x.key;if(G&&!this._demMatrixCache[G]){const X=this.sourceCache.sourceCache._source.maxzoom;let te=x.canonical.z-Q.tileID.canonical.z;x.overscaledZ>x.canonical.z&&(x.canonical.z>=X?te=x.canonical.z-X:D.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const Ae=x.canonical.x-(x.canonical.x>>te<<te),he=x.canonical.y-(x.canonical.y>>te<<te),pe=D.fromScaling(new Float64Array(16),[1/(D.EXTENT<<te),1/(D.EXTENT<<te),0]);D.translate(pe,pe,[Ae*D.EXTENT,he*D.EXTENT,0]),this._demMatrixCache[x.key]={matrix:pe,coord:x}}return{u_depth:2,u_terrain:3,u_terrain_dim:Q&&Q.dem&&Q.dem.dim||1,u_terrain_matrix:G?this._demMatrixCache[x.key].matrix:this._emptyDemMatrix,u_terrain_unpack:Q&&Q.dem&&Q.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(Q&&Q.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:Q}}getFramebuffer(x){const Q=this.painter,G=Q.width/devicePixelRatio,X=Q.height/devicePixelRatio;return!this._fbo||this._fbo.width===G&&this._fbo.height===X||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new vt(Q.context,{width:G,height:X,data:null},Q.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(Q.context.gl.NEAREST,Q.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new vt(Q.context,{width:G,height:X,data:null},Q.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(Q.context.gl.NEAREST,Q.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=Q.context.createFramebuffer(G,X,!0,!1),this._fbo.depthAttachment.set(Q.context.createRenderbuffer(Q.context.gl.DEPTH_COMPONENT16,G,X))),this._fbo.colorAttachment.set(x==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const x=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const Q=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let te=0,Ae=0;te<this._coordsTextureSize;te++)for(let he=0;he<this._coordsTextureSize;he++,Ae+=4)Q[Ae+0]=255&he,Q[Ae+1]=255&te,Q[Ae+2]=he>>8<<4|te>>8,Q[Ae+3]=0;const G=new D.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(Q.buffer)),X=new vt(x,G,x.gl.RGBA,{premultiply:!1});return X.bind(x.gl.NEAREST,x.gl.CLAMP_TO_EDGE),this._coordsTexture=X,X}pointCoordinate(x){const Q=new Uint8Array(4),G=this.painter.context,X=G.gl;G.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),X.readPixels(x.x,this.painter.height/devicePixelRatio-x.y-1,1,1,X.RGBA,X.UNSIGNED_BYTE,Q),G.bindFramebuffer.set(null);const te=Q[0]+(Q[2]>>4<<8),Ae=Q[1]+((15&Q[2])<<8),he=this.coordsIndex[255-Q[3]],pe=he&&this.sourceCache.getTileByID(he);if(!pe)return null;const ve=this._coordsTextureSize,Ce=(1<<pe.tileID.canonical.z)*ve;return new D.MercatorCoordinate((pe.tileID.canonical.x*ve+te)/Ce,(pe.tileID.canonical.y*ve+Ae)/Ce,this.getElevation(pe.tileID,te,Ae,ve))}getTerrainMesh(){if(this._mesh)return this._mesh;const x=this.painter.context,Q=new D.Pos3dArray,G=new D.TriangleIndexArray,X=this.meshSize,te=D.EXTENT/X,Ae=X*X;for(let Se=0;Se<=X;Se++)for(let Qe=0;Qe<=X;Qe++)Q.emplaceBack(Qe*te,Se*te,0);for(let Se=0;Se<Ae;Se+=X+1)for(let Qe=0;Qe<X;Qe++)G.emplaceBack(Qe+Se,X+Qe+Se+1,X+Qe+Se+2),G.emplaceBack(Qe+Se,X+Qe+Se+2,Qe+Se+1);const he=Q.length,pe=he+2*(X+1);for(const Se of[0,1])for(let Qe=0;Qe<=X;Qe++)for(const $e of[0,1])Q.emplaceBack(Qe*te,Se*D.EXTENT,$e);for(let Se=0;Se<2*X;Se+=2)G.emplaceBack(pe+Se,pe+Se+1,pe+Se+3),G.emplaceBack(pe+Se,pe+Se+3,pe+Se+2),G.emplaceBack(he+Se,he+Se+3,he+Se+1),G.emplaceBack(he+Se,he+Se+2,he+Se+3);const ve=Q.length,Ce=ve+2*(X+1);for(const Se of[0,1])for(let Qe=0;Qe<=X;Qe++)for(const $e of[0,1])Q.emplaceBack(Se*D.EXTENT,Qe*te,$e);for(let Se=0;Se<2*X;Se+=2)G.emplaceBack(ve+Se,ve+Se+1,ve+Se+3),G.emplaceBack(ve+Se,ve+Se+3,ve+Se+2),G.emplaceBack(Ce+Se,Ce+Se+3,Ce+Se+1),G.emplaceBack(Ce+Se,Ce+Se+2,Ce+Se+3);return this._mesh={indexBuffer:x.createIndexBuffer(G),vertexBuffer:x.createVertexBuffer(Q,$o.members),segments:D.SegmentVector.simpleSegment(0,0,Q.length,G.length)},this._mesh}getMeshFrameDelta(x){return 2*Math.PI*D.earthRadius/Math.pow(2,x)/5}getMinTileElevationForLngLatZoom(x,Q){var G;const{tileID:X}=this._getOverscaledTileIDFromLngLatZoom(x,Q);return(G=this.getMinMaxElevation(X).minElevation)!==null&&G!==void 0?G:0}getMinMaxElevation(x){const Q=this.getTerrainData(x).tile,G={minElevation:null,maxElevation:null};return Q&&Q.dem&&(G.minElevation=Q.dem.min*this.exaggeration,G.maxElevation=Q.dem.max*this.exaggeration),G}_getOverscaledTileIDFromLngLatZoom(x,Q){const G=D.MercatorCoordinate.fromLngLat(x.wrap()),X=(1<<Q)*D.EXTENT,te=G.x*X,Ae=G.y*X,he=Math.floor(te/D.EXTENT),pe=Math.floor(Ae/D.EXTENT);return{tileID:new D.OverscaledTileID(Q,0,Q,he,pe),mercatorX:te,mercatorY:Ae}}}class Ns{constructor(x,Q,G){this._context=x,this._size=Q,this._tileSize=G,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const x of this._objects)x.texture.destroy(),x.fbo.destroy()}_createObject(x){const Q=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),G=new vt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return G.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),Q.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),Q.colorAttachment.set(G.texture),{id:x,fbo:Q,texture:G,stamp:-1,inUse:!1}}getObjectForId(x){return this._objects[x]}useObject(x){x.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(Q=>x.id!==Q),this._recentlyUsed.push(x.id)}stampObject(x){x.stamp=++this._stamp}getOrCreateFreeObject(){for(const Q of this._recentlyUsed)if(!this._objects[Q].inUse)return this._objects[Q];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const x=this._createObject(this._objects.length);return this._objects.push(x),x}freeObject(x){x.inUse=!1}freeAllObjects(){for(const x of this._objects)this.freeObject(x)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(x=>!x.inUse)===!1}}const za={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Dn{constructor(x,Q){this.painter=x,this.terrain=Q,this.pool=new Ns(x.context,30,Q.sourceCache.tileSize*Q.qualityFactor)}destruct(){this.pool.destruct()}getTexture(x){return this.pool.getObjectForId(x.rtt[this._stacks.length-1].id).texture}prepareForRender(x,Q){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=x._order.filter(G=>!x._layers[G].isHidden(Q)),this._coordsDescendingInv={};for(const G in x.sourceCaches){this._coordsDescendingInv[G]={};const X=x.sourceCaches[G].getVisibleCoordinates();for(const te of X){const Ae=this.terrain.sourceCache.getTerrainCoords(te);for(const he in Ae)this._coordsDescendingInv[G][he]||(this._coordsDescendingInv[G][he]=[]),this._coordsDescendingInv[G][he].push(Ae[he])}}this._coordsDescendingInvStr={};for(const G of x._order){const X=x._layers[G],te=X.source;if(za[X.type]&&!this._coordsDescendingInvStr[te]){this._coordsDescendingInvStr[te]={};for(const Ae in this._coordsDescendingInv[te])this._coordsDescendingInvStr[te][Ae]=this._coordsDescendingInv[te][Ae].map(he=>he.key).sort().join()}}for(const G of this._renderableTiles)for(const X in this._coordsDescendingInvStr){const te=this._coordsDescendingInvStr[X][G.tileID.key];te&&te!==G.rttCoords[X]&&(G.rtt=[])}}renderLayer(x){if(x.isHidden(this.painter.transform.zoom))return!1;const Q=x.type,G=this.painter,X=this._renderableLayerIds[this._renderableLayerIds.length-1]===x.id;if(za[Q]&&(this._prevType&&za[this._prevType]||this._stacks.push([]),this._prevType=Q,this._stacks[this._stacks.length-1].push(x.id),!X))return!0;if(za[this._prevType]||za[Q]&&X){this._prevType=Q;const te=this._stacks.length-1,Ae=this._stacks[te]||[];for(const he of this._renderableTiles){if(this.pool.isFull()&&(Kn(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(he),he.rtt[te]){const ve=this.pool.getObjectForId(he.rtt[te].id);if(ve.stamp===he.rtt[te].stamp){this.pool.useObject(ve);continue}}const pe=this.pool.getOrCreateFreeObject();this.pool.useObject(pe),this.pool.stampObject(pe),he.rtt[te]={id:pe.id,stamp:pe.stamp},G.context.bindFramebuffer.set(pe.fbo.framebuffer),G.context.clear({color:D.Color.transparent,stencil:0}),G.currentStencilSource=void 0;for(let ve=0;ve<Ae.length;ve++){const Ce=G.style._layers[Ae[ve]],Se=Ce.source?this._coordsDescendingInv[Ce.source][he.tileID.key]:[he.tileID];G.context.viewport.set([0,0,pe.fbo.width,pe.fbo.height]),G._renderTileClippingMasks(Ce,Se),G.renderLayer(G,G.style.sourceCaches[Ce.source],Ce,Se),Ce.source&&(he.rttCoords[Ce.source]=this._coordsDescendingInvStr[Ce.source][he.tileID.key])}}return Kn(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),za[Q]}return!1}}const uA=ne,Po={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:D.config.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Vr=J=>{J.touchstart=J.dragStart,J.touchmoveWindow=J.dragMove,J.touchend=J.dragEnd},ts={showCompass:!0,showZoom:!0,visualizePitch:!1};class Kl{constructor(x,Q,G=!1){this.mousedown=Ae=>{this.startMouse(D.extend({},Ae,{ctrlKey:!0,preventDefault:()=>Ae.preventDefault()}),ae.mousePos(this.element,Ae)),ae.addEventListener(window,"mousemove",this.mousemove),ae.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=Ae=>{this.moveMouse(Ae,ae.mousePos(this.element,Ae))},this.mouseup=Ae=>{this.mouseRotate.dragEnd(Ae),this.mousePitch&&this.mousePitch.dragEnd(Ae),this.offTemp()},this.touchstart=Ae=>{Ae.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ae.touchPos(this.element,Ae.targetTouches)[0],this.startTouch(Ae,this._startPos),ae.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),ae.addEventListener(window,"touchend",this.touchend))},this.touchmove=Ae=>{Ae.targetTouches.length!==1?this.reset():(this._lastPos=ae.touchPos(this.element,Ae.targetTouches)[0],this.moveTouch(Ae,this._lastPos))},this.touchend=Ae=>{Ae.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const X=x.dragRotate._mouseRotate.getClickTolerance(),te=x.dragRotate._mousePitch.getClickTolerance();this.element=Q,this.mouseRotate=yt({clickTolerance:X,enable:!0}),this.touchRotate=(({enable:Ae,clickTolerance:he,bearingDegreesPerPixelMoved:pe=.8})=>{const ve=new Xe;return new kn({clickTolerance:he,move:(Ce,Se)=>({bearingDelta:(Se.x-Ce.x)*pe}),moveStateManager:ve,enable:Ae,assignEvents:Vr})})({clickTolerance:X,enable:!0}),this.map=x,G&&(this.mousePitch=Et({clickTolerance:te,enable:!0}),this.touchPitch=(({enable:Ae,clickTolerance:he,pitchDegreesPerPixelMoved:pe=-.5})=>{const ve=new Xe;return new kn({clickTolerance:he,move:(Ce,Se)=>({pitchDelta:(Se.y-Ce.y)*pe}),moveStateManager:ve,enable:Ae,assignEvents:Vr})})({clickTolerance:te,enable:!0})),ae.addEventListener(Q,"mousedown",this.mousedown),ae.addEventListener(Q,"touchstart",this.touchstart,{passive:!1}),ae.addEventListener(Q,"touchcancel",this.reset)}startMouse(x,Q){this.mouseRotate.dragStart(x,Q),this.mousePitch&&this.mousePitch.dragStart(x,Q),ae.disableDrag()}startTouch(x,Q){this.touchRotate.dragStart(x,Q),this.touchPitch&&this.touchPitch.dragStart(x,Q),ae.disableDrag()}moveMouse(x,Q){const G=this.map,{bearingDelta:X}=this.mouseRotate.dragMove(x,Q)||{};if(X&&G.setBearing(G.getBearing()+X),this.mousePitch){const{pitchDelta:te}=this.mousePitch.dragMove(x,Q)||{};te&&G.setPitch(G.getPitch()+te)}}moveTouch(x,Q){const G=this.map,{bearingDelta:X}=this.touchRotate.dragMove(x,Q)||{};if(X&&G.setBearing(G.getBearing()+X),this.touchPitch){const{pitchDelta:te}=this.touchPitch.dragMove(x,Q)||{};te&&G.setPitch(G.getPitch()+te)}}off(){const x=this.element;ae.removeEventListener(x,"mousedown",this.mousedown),ae.removeEventListener(x,"touchstart",this.touchstart,{passive:!1}),ae.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ae.removeEventListener(window,"touchend",this.touchend),ae.removeEventListener(x,"touchcancel",this.reset),this.offTemp()}offTemp(){ae.enableDrag(),ae.removeEventListener(window,"mousemove",this.mousemove),ae.removeEventListener(window,"mouseup",this.mouseup),ae.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),ae.removeEventListener(window,"touchend",this.touchend)}}let un;function Lo(J,x,Q){if(J=new D.LngLat(J.lng,J.lat),x){const G=new D.LngLat(J.lng-360,J.lat),X=new D.LngLat(J.lng+360,J.lat),te=Q.locationPoint(J).distSqr(x);Q.locationPoint(G).distSqr(x)<te?J=G:Q.locationPoint(X).distSqr(x)<te&&(J=X)}for(;Math.abs(J.lng-Q.center.lng)>180;){const G=Q.locationPoint(J);if(G.x>=0&&G.y>=0&&G.x<=Q.width&&G.y<=Q.height)break;J.lng>Q.center.lng?J.lng-=360:J.lng+=360}return J}const Qo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function el(J,x,Q){const G=J.classList;for(const X in Qo)G.remove(`maplibregl-${Q}-anchor-${X}`);G.add(`maplibregl-${Q}-anchor-${x}`)}class Oo extends D.Evented{constructor(x){if(super(),this._onKeyPress=Q=>{const G=Q.code,X=Q.charCode||Q.keyCode;G!=="Space"&&G!=="Enter"&&X!==32&&X!==13||this.togglePopup()},this._onMapClick=Q=>{const G=Q.originalEvent.target,X=this._element;this._popup&&(G===X||X.contains(G))&&this.togglePopup()},this._update=Q=>{if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Lo(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let G="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?G=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(G=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let X="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?X="rotateX(0deg)":this._pitchAlignment==="map"&&(X=`rotateX(${this._map.getPitch()}deg)`),Q&&Q.type!=="moveend"||(this._pos=this._pos.round()),ae.setTransform(this._element,`${Qo[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${X} ${G}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const te=this._map.unproject(this._pos),Ae=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=te.distanceTo(this._lngLat)>20*Ae?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=Q=>{if(!this._isDragging){const G=this._clickTolerance||this._map._clickTolerance;this._isDragging=Q.point.dist(this._pointerdownPos)>=G}this._isDragging&&(this._pos=Q.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new D.Event("dragstart"))),this.fire(new D.Event("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new D.Event("dragend")),this._state="inactive"},this._addDragHandler=Q=>{this._element.contains(Q.originalEvent.target)&&(Q.preventDefault(),this._positionDelta=Q.point.sub(this._pos).add(this._offset),this._pointerdownPos=Q.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=x&&x.anchor||"center",this._color=x&&x.color||"#3FB1CE",this._scale=x&&x.scale||1,this._draggable=x&&x.draggable||!1,this._clickTolerance=x&&x.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=x&&x.rotation||0,this._rotationAlignment=x&&x.rotationAlignment||"auto",this._pitchAlignment=x&&x.pitchAlignment&&x.pitchAlignment!=="auto"?x.pitchAlignment:this._rotationAlignment,x&&x.element)this._element=x.element,this._offset=D.Point.convert(x&&x.offset||[0,0]);else{this._defaultMarker=!0,this._element=ae.create("div"),this._element.setAttribute("aria-label","Map marker");const Q=ae.createNS("http://www.w3.org/2000/svg","svg"),G=41,X=27;Q.setAttributeNS(null,"display","block"),Q.setAttributeNS(null,"height",`${G}px`),Q.setAttributeNS(null,"width",`${X}px`),Q.setAttributeNS(null,"viewBox",`0 0 ${X} ${G}`);const te=ae.createNS("http://www.w3.org/2000/svg","g");te.setAttributeNS(null,"stroke","none"),te.setAttributeNS(null,"stroke-width","1"),te.setAttributeNS(null,"fill","none"),te.setAttributeNS(null,"fill-rule","evenodd");const Ae=ae.createNS("http://www.w3.org/2000/svg","g");Ae.setAttributeNS(null,"fill-rule","nonzero");const he=ae.createNS("http://www.w3.org/2000/svg","g");he.setAttributeNS(null,"transform","translate(3.0, 29.0)"),he.setAttributeNS(null,"fill","#000000");const pe=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const dt of pe){const Bt=ae.createNS("http://www.w3.org/2000/svg","ellipse");Bt.setAttributeNS(null,"opacity","0.04"),Bt.setAttributeNS(null,"cx","10.5"),Bt.setAttributeNS(null,"cy","5.80029008"),Bt.setAttributeNS(null,"rx",dt.rx),Bt.setAttributeNS(null,"ry",dt.ry),he.appendChild(Bt)}const ve=ae.createNS("http://www.w3.org/2000/svg","g");ve.setAttributeNS(null,"fill",this._color);const Ce=ae.createNS("http://www.w3.org/2000/svg","path");Ce.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),ve.appendChild(Ce);const Se=ae.createNS("http://www.w3.org/2000/svg","g");Se.setAttributeNS(null,"opacity","0.25"),Se.setAttributeNS(null,"fill","#000000");const Qe=ae.createNS("http://www.w3.org/2000/svg","path");Qe.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Se.appendChild(Qe);const $e=ae.createNS("http://www.w3.org/2000/svg","g");$e.setAttributeNS(null,"transform","translate(6.0, 7.0)"),$e.setAttributeNS(null,"fill","#FFFFFF");const Ze=ae.createNS("http://www.w3.org/2000/svg","g");Ze.setAttributeNS(null,"transform","translate(8.0, 8.0)");const rt=ae.createNS("http://www.w3.org/2000/svg","circle");rt.setAttributeNS(null,"fill","#000000"),rt.setAttributeNS(null,"opacity","0.25"),rt.setAttributeNS(null,"cx","5.5"),rt.setAttributeNS(null,"cy","5.5"),rt.setAttributeNS(null,"r","5.4999962");const Ye=ae.createNS("http://www.w3.org/2000/svg","circle");Ye.setAttributeNS(null,"fill","#FFFFFF"),Ye.setAttributeNS(null,"cx","5.5"),Ye.setAttributeNS(null,"cy","5.5"),Ye.setAttributeNS(null,"r","5.4999962"),Ze.appendChild(rt),Ze.appendChild(Ye),Ae.appendChild(he),Ae.appendChild(ve),Ae.appendChild(Se),Ae.appendChild($e),Ae.appendChild(Ze),Q.appendChild(Ae),Q.setAttributeNS(null,"height",G*this._scale+"px"),Q.setAttributeNS(null,"width",X*this._scale+"px"),this._element.appendChild(Q),this._offset=D.Point.convert(x&&x.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",Q=>{Q.preventDefault()}),this._element.addEventListener("mousedown",Q=>{Q.preventDefault()}),el(this._element,this._anchor,"marker"),x&&x.className)for(const Q of x.className.split(" "))this._element.classList.add(Q);this._popup=null}addTo(x){return this.remove(),this._map=x,x.getCanvasContainer().appendChild(this._element),x.on("move",this._update),x.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),ae.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(x){return this._lngLat=D.LngLat.convert(x),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(x){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),x){if(!("offset"in x.options)){const X=Math.abs(13.5)/Math.SQRT2;x.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[X,-1*(38.1-13.5+X)],"bottom-right":[-X,-1*(38.1-13.5+X)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=x,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const x=this._popup;return x?(x.isOpen()?x.remove():x.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(x){return this._offset=D.Point.convert(x),this._update(),this}addClassName(x){this._element.classList.add(x)}removeClassName(x){this._element.classList.remove(x)}toggleClassName(x){return this._element.classList.toggle(x)}setDraggable(x){return this._draggable=!!x,this._map&&(x?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(x){return this._rotation=x||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(x){return this._rotationAlignment=x||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(x){return this._pitchAlignment=x&&x!=="auto"?x:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const Ro={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let uo=0,Na=!1;const wl={maxWidth:100,unit:"metric"};function tl(J,x,Q){const G=Q&&Q.maxWidth||100,X=J._container.clientHeight/2,te=J.unproject([0,X]),Ae=J.unproject([G,X]),he=te.distanceTo(Ae);if(Q&&Q.unit==="imperial"){const pe=3.2808*he;pe>5280?Va(x,G,pe/5280,J._getUIString("ScaleControl.Miles")):Va(x,G,pe,J._getUIString("ScaleControl.Feet"))}else Q&&Q.unit==="nautical"?Va(x,G,he/1852,J._getUIString("ScaleControl.NauticalMiles")):he>=1e3?Va(x,G,he/1e3,J._getUIString("ScaleControl.Kilometers")):Va(x,G,he,J._getUIString("ScaleControl.Meters"))}function Va(J,x,Q,G){const X=function(te){const Ae=Math.pow(10,`${Math.floor(te)}`.length-1);let he=te/Ae;return he=he>=10?10:he>=5?5:he>=3?3:he>=2?2:he>=1?1:function(pe){const ve=Math.pow(10,Math.ceil(-Math.log(pe)/Math.LN10));return Math.round(pe*ve)/ve}(he),Ae*he}(Q);J.style.width=x*(X/Q)+"px",J.innerHTML=`${X}&nbsp;${G}`}const xl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Bl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function il(J){if(J){if(typeof J=="number"){const x=Math.round(Math.abs(J)/Math.SQRT2);return{center:new D.Point(0,0),top:new D.Point(0,J),"top-left":new D.Point(x,x),"top-right":new D.Point(-x,x),bottom:new D.Point(0,-J),"bottom-left":new D.Point(x,-x),"bottom-right":new D.Point(-x,-x),left:new D.Point(J,0),right:new D.Point(-J,0)}}if(J instanceof D.Point||Array.isArray(J)){const x=D.Point.convert(J);return{center:x,top:x,"top-left":x,"top-right":x,bottom:x,"bottom-left":x,"bottom-right":x,left:x,right:x}}return{center:D.Point.convert(J.center||[0,0]),top:D.Point.convert(J.top||[0,0]),"top-left":D.Point.convert(J["top-left"]||[0,0]),"top-right":D.Point.convert(J["top-right"]||[0,0]),bottom:D.Point.convert(J.bottom||[0,0]),"bottom-left":D.Point.convert(J["bottom-left"]||[0,0]),"bottom-right":D.Point.convert(J["bottom-right"]||[0,0]),left:D.Point.convert(J.left||[0,0]),right:D.Point.convert(J.right||[0,0])}}return il(new D.Point(0,0))}const rl={extend:(J,...x)=>D.extend(J,...x),run(J){J()},logToElement(J,x=!1,Q="log"){const G=window.document.getElementById(Q);G&&(x&&(G.innerHTML=""),G.innerHTML+=`<br>${J}`)}},Cl=ne;class xr{static get version(){return Cl}static get workerCount(){return di.workerCount}static set workerCount(x){di.workerCount=x}static get maxParallelImageRequests(){return D.config.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(x){D.config.MAX_PARALLEL_IMAGE_REQUESTS=x}static get workerUrl(){return D.config.WORKER_URL}static set workerUrl(x){D.config.WORKER_URL=x}static addProtocol(x,Q){D.config.REGISTERED_PROTOCOLS[x]=Q}static removeProtocol(x){delete D.config.REGISTERED_PROTOCOLS[x]}}return xr.Map=class extends yl{constructor(J){if(D.PerformanceUtils.mark(D.PerformanceMarkers.create),(J=D.extend({},Po,J)).minZoom!=null&&J.maxZoom!=null&&J.minZoom>J.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(J.minPitch!=null&&J.maxPitch!=null&&J.minPitch>J.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(J.minPitch!=null&&J.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(J.maxPitch!=null&&J.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Bs(J.minZoom,J.maxZoom,J.minPitch,J.maxPitch,J.renderWorldCopies),{bearingSnap:J.bearingSnap}),this._cooperativeGesturesOnWheel=x=>{this._onCooperativeGesture(x,x[this._metaKey],1)},this._contextLost=x=>{x.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new D.Event("webglcontextlost",{originalEvent:x}))},this._contextRestored=x=>{this._setupPainter(),this.resize(),this._update(),this.fire(new D.Event("webglcontextrestored",{originalEvent:x}))},this._onMapScroll=x=>{if(x.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=J.interactive,this._cooperativeGestures=J.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=J.maxTileCacheSize,this._maxTileCacheZoomLevels=J.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=J.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=J.preserveDrawingBuffer,this._antialias=J.antialias,this._trackResize=J.trackResize,this._bearingSnap=J.bearingSnap,this._refreshExpiredTiles=J.refreshExpiredTiles,this._fadeDuration=J.fadeDuration,this._crossSourceCollisions=J.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=J.collectResourceTiming,this._renderTaskQueue=new Fi,this._controls=[],this._mapId=D.uniqueId(),this._locale=D.extend({},Ni,J.locale),this._clickTolerance=J.clickTolerance,this._overridePixelRatio=J.pixelRatio,this._maxCanvasSize=J.maxCanvasSize,this.transformCameraUpdate=J.transformCameraUpdate,this._imageQueueHandle=Je.addThrottleControl(()=>this.isMoving()),this._requestManager=new ut(J.transformRequest),typeof J.container=="string"){if(this._container=document.getElementById(J.container),!this._container)throw new Error(`Container '${J.container}' not found.`)}else{if(!(J.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=J.container}if(J.maxBounds&&this.setMaxBounds(J.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let x=!1;const Q=yn(G=>{this._trackResize&&!this._removed&&this.resize(G)._update()},50);this._resizeObserver=new ResizeObserver(G=>{x?Q(G):x=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ho(this,J),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=J.hash&&new Uo(typeof J.hash=="string"&&J.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:J.center,zoom:J.zoom,bearing:J.bearing,pitch:J.pitch}),J.bounds&&(this.resize(),this.fitBounds(J.bounds,D.extend({},J.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=J.localIdeographFontFamily,this._validateStyle=J.validateStyle,J.style&&this.setStyle(J.style,{localIdeographFontFamily:J.localIdeographFontFamily}),J.attributionControl&&this.addControl(new zs({customAttribution:J.customAttribution})),J.maplibreLogo&&this.addControl(new Mo,J.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",x=>{this._update(x.dataType==="style"),this.fire(new D.Event(`${x.dataType}data`,x))}),this.on("dataloading",x=>{this.fire(new D.Event(`${x.dataType}dataloading`,x))}),this.on("dataabort",x=>{this.fire(new D.Event("sourcedataabort",x))})}_getMapId(){return this._mapId}addControl(J,x){if(x===void 0&&(x=J.getDefaultPosition?J.getDefaultPosition():"top-right"),!J||!J.onAdd)return this.fire(new D.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const Q=J.onAdd(this);this._controls.push(J);const G=this._controlPositions[x];return x.indexOf("bottom")!==-1?G.insertBefore(Q,G.firstChild):G.appendChild(Q),this}removeControl(J){if(!J||!J.onRemove)return this.fire(new D.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const x=this._controls.indexOf(J);return x>-1&&this._controls.splice(x,1),J.onRemove(this),this}hasControl(J){return this._controls.indexOf(J)>-1}calculateCameraOptionsFromTo(J,x,Q,G){return G==null&&this.terrain&&(G=this.terrain.getElevationForLngLatZoom(Q,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(J,x,Q,G)}resize(J){var x;const Q=this._containerDimensions(),G=Q[0],X=Q[1],te=this._getClampedPixelRatio(G,X);if(this._resizeCanvas(G,X,te),this.painter.resize(G,X,te),this.painter.overLimit()){const he=this.painter.context.gl;this._maxCanvasSize=[he.drawingBufferWidth,he.drawingBufferHeight];const pe=this._getClampedPixelRatio(G,X);this._resizeCanvas(G,X,pe),this.painter.resize(G,X,pe)}this.transform.resize(G,X),(x=this._requestedCameraState)===null||x===void 0||x.resize(G,X);const Ae=!this._moving;return Ae&&(this.stop(),this.fire(new D.Event("movestart",J)).fire(new D.Event("move",J))),this.fire(new D.Event("resize",J)),Ae&&this.fire(new D.Event("moveend",J)),this}_getClampedPixelRatio(J,x){const{0:Q,1:G}=this._maxCanvasSize,X=this.getPixelRatio(),te=J*X,Ae=x*X;return Math.min(te>Q?Q/te:1,Ae>G?G/Ae:1)*X}getPixelRatio(){var J;return(J=this._overridePixelRatio)!==null&&J!==void 0?J:devicePixelRatio}setPixelRatio(J){this._overridePixelRatio=J,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(J){return this.transform.setMaxBounds(R.convert(J)),this._update()}setMinZoom(J){if((J=J??-2)>=-2&&J<=this.transform.maxZoom)return this.transform.minZoom=J,this._update(),this.getZoom()<J&&this.setZoom(J),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(J){if((J=J??22)>=this.transform.minZoom)return this.transform.maxZoom=J,this._update(),this.getZoom()>J&&this.setZoom(J),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(J){if((J=J??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(J>=0&&J<=this.transform.maxPitch)return this.transform.minPitch=J,this._update(),this.getPitch()<J&&this.setPitch(J),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(J){if((J=J??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(J>=this.transform.minPitch)return this.transform.maxPitch=J,this._update(),this.getPitch()>J&&this.setPitch(J),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(J){return this.transform.renderWorldCopies=J,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(J){return this._cooperativeGestures=J,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(J){return this.transform.locationPoint(D.LngLat.convert(J),this.style&&this.terrain)}unproject(J){return this.transform.pointLocation(D.Point.convert(J),this.terrain)}isMoving(){var J;return this._moving||((J=this.handlers)===null||J===void 0?void 0:J.isMoving())}isZooming(){var J;return this._zooming||((J=this.handlers)===null||J===void 0?void 0:J.isZooming())}isRotating(){var J;return this._rotating||((J=this.handlers)===null||J===void 0?void 0:J.isRotating())}_createDelegatedListener(J,x,Q){if(J==="mouseenter"||J==="mouseover"){let G=!1;return{layer:x,listener:Q,delegates:{mousemove:te=>{const Ae=this.getLayer(x)?this.queryRenderedFeatures(te.point,{layers:[x]}):[];Ae.length?G||(G=!0,Q.call(this,new qr(J,this,te.originalEvent,{features:Ae}))):G=!1},mouseout:()=>{G=!1}}}}if(J==="mouseleave"||J==="mouseout"){let G=!1;return{layer:x,listener:Q,delegates:{mousemove:Ae=>{(this.getLayer(x)?this.queryRenderedFeatures(Ae.point,{layers:[x]}):[]).length?G=!0:G&&(G=!1,Q.call(this,new qr(J,this,Ae.originalEvent)))},mouseout:Ae=>{G&&(G=!1,Q.call(this,new qr(J,this,Ae.originalEvent)))}}}}{const G=X=>{const te=this.getLayer(x)?this.queryRenderedFeatures(X.point,{layers:[x]}):[];te.length&&(X.features=te,Q.call(this,X),delete X.features)};return{layer:x,listener:Q,delegates:{[J]:G}}}}on(J,x,Q){if(Q===void 0)return super.on(J,x);const G=this._createDelegatedListener(J,x,Q);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[J]=this._delegatedListeners[J]||[],this._delegatedListeners[J].push(G);for(const X in G.delegates)this.on(X,G.delegates[X]);return this}once(J,x,Q){if(Q===void 0)return super.once(J,x);const G=this._createDelegatedListener(J,x,Q);for(const X in G.delegates)this.once(X,G.delegates[X]);return this}off(J,x,Q){return Q===void 0?super.off(J,x):(this._delegatedListeners&&this._delegatedListeners[J]&&(G=>{const X=this._delegatedListeners[J];for(let te=0;te<X.length;te++){const Ae=X[te];if(Ae.layer===x&&Ae.listener===Q){for(const he in Ae.delegates)this.off(he,Ae.delegates[he]);return X.splice(te,1),this}}})(),this)}queryRenderedFeatures(J,x){if(!this.style)return[];let Q;const G=J instanceof D.Point||Array.isArray(J),X=G?J:[[0,0],[this.transform.width,this.transform.height]];if(x=x||(G?{}:J)||{},X instanceof D.Point||typeof X[0]=="number")Q=[D.Point.convert(X)];else{const te=D.Point.convert(X[0]),Ae=D.Point.convert(X[1]);Q=[te,new D.Point(Ae.x,te.y),Ae,new D.Point(te.x,Ae.y),te]}return this.style.queryRenderedFeatures(Q,x,this.transform)}querySourceFeatures(J,x){return this.style.querySourceFeatures(J,x)}setStyle(J,x){return(x=D.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},x)).diff!==!1&&x.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&J?(this._diffStyle(J,x),this):(this._localIdeographFontFamily=x.localIdeographFontFamily,this._updateStyle(J,x))}setTransformRequest(J){return this._requestManager.setTransformRequest(J),this}_getUIString(J){const x=this._locale[J];if(x==null)throw new Error(`Missing UI string '${J}'`);return x}_updateStyle(J,x){if(x.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(J,x));const Q=this.style&&x.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!J)),J?(this.style=new sr(this,x||{}),this.style.setEventedParent(this,{style:this.style}),typeof J=="string"?this.style.loadURL(J,x,Q):this.style.loadJSON(J,x,Q),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new sr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(J,x){if(typeof J=="string"){const Q=this._requestManager.transformRequest(J,We.Style);D.getJSON(Q,(G,X)=>{G?this.fire(new D.ErrorEvent(G)):X&&this._updateDiff(X,x)})}else typeof J=="object"&&this._updateDiff(J,x)}_updateDiff(J,x){try{this.style.setState(J,x)&&this._update(!0)}catch(Q){D.warnOnce(`Unable to perform style diff: ${Q.message||Q.error||Q}.  Rebuilding the style from scratch.`),this._updateStyle(J,x)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():D.warnOnce("There is no style added to the map.")}addSource(J,x){return this._lazyInitEmptyStyle(),this.style.addSource(J,x),this._update(!0)}isSourceLoaded(J){const x=this.style&&this.style.sourceCaches[J];if(x!==void 0)return x.loaded();this.fire(new D.ErrorEvent(new Error(`There is no source with ID '${J}'`)))}setTerrain(J){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),J){const x=this.style.sourceCaches[J.source];if(!x)throw new Error(`cannot load terrain, because there exists no source with ID: ${J.source}`);for(const Q in this.style._layers){const G=this.style._layers[Q];G.type==="hillshade"&&G.source===J.source&&D.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new bl(this.painter,x,J),this.painter.renderToTexture=new Dn(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=Q=>{Q.dataType==="style"?this.terrain.sourceCache.freeRtt():Q.dataType==="source"&&Q.tile&&(Q.sourceId!==J.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(Q.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new D.Event("terrain",{terrain:J})),this}getTerrain(){var J,x;return(x=(J=this.terrain)===null||J===void 0?void 0:J.options)!==null&&x!==void 0?x:null}areTilesLoaded(){const J=this.style&&this.style.sourceCaches;for(const x in J){const Q=J[x]._tiles;for(const G in Q){const X=Q[G];if(X.state!=="loaded"&&X.state!=="errored")return!1}}return!0}addSourceType(J,x,Q){return this._lazyInitEmptyStyle(),this.style.addSourceType(J,x,Q)}removeSource(J){return this.style.removeSource(J),this._update(!0)}getSource(J){return this.style.getSource(J)}addImage(J,x,Q={}){const{pixelRatio:G=1,sdf:X=!1,stretchX:te,stretchY:Ae,content:he}=Q;if(this._lazyInitEmptyStyle(),!(x instanceof HTMLImageElement||D.isImageBitmap(x))){if(x.width===void 0||x.height===void 0)return this.fire(new D.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:pe,height:ve,data:Ce}=x,Se=x;return this.style.addImage(J,{data:new D.RGBAImage({width:pe,height:ve},new Uint8Array(Ce)),pixelRatio:G,stretchX:te,stretchY:Ae,content:he,sdf:X,version:0,userImage:Se}),Se.onAdd&&Se.onAdd(this,J),this}}{const{width:pe,height:ve,data:Ce}=D.browser.getImageData(x);this.style.addImage(J,{data:new D.RGBAImage({width:pe,height:ve},Ce),pixelRatio:G,stretchX:te,stretchY:Ae,content:he,sdf:X,version:0})}}updateImage(J,x){const Q=this.style.getImage(J);if(!Q)return this.fire(new D.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const G=x instanceof HTMLImageElement||D.isImageBitmap(x)?D.browser.getImageData(x):x,{width:X,height:te,data:Ae}=G;if(X===void 0||te===void 0)return this.fire(new D.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(X!==Q.data.width||te!==Q.data.height)return this.fire(new D.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const he=!(x instanceof HTMLImageElement||D.isImageBitmap(x));return Q.data.replace(Ae,he),this.style.updateImage(J,Q),this}getImage(J){return this.style.getImage(J)}hasImage(J){return J?!!this.style.getImage(J):(this.fire(new D.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(J){this.style.removeImage(J)}loadImage(J,x){Je.getImage(this._requestManager.transformRequest(J,We.Image),x)}listImages(){return this.style.listImages()}addLayer(J,x){return this._lazyInitEmptyStyle(),this.style.addLayer(J,x),this._update(!0)}moveLayer(J,x){return this.style.moveLayer(J,x),this._update(!0)}removeLayer(J){return this.style.removeLayer(J),this._update(!0)}getLayer(J){return this.style.getLayer(J)}setLayerZoomRange(J,x,Q){return this.style.setLayerZoomRange(J,x,Q),this._update(!0)}setFilter(J,x,Q={}){return this.style.setFilter(J,x,Q),this._update(!0)}getFilter(J){return this.style.getFilter(J)}setPaintProperty(J,x,Q,G={}){return this.style.setPaintProperty(J,x,Q,G),this._update(!0)}getPaintProperty(J,x){return this.style.getPaintProperty(J,x)}setLayoutProperty(J,x,Q,G={}){return this.style.setLayoutProperty(J,x,Q,G),this._update(!0)}getLayoutProperty(J,x){return this.style.getLayoutProperty(J,x)}setGlyphs(J,x={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(J,x),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(J,x,Q={}){return this._lazyInitEmptyStyle(),this.style.addSprite(J,x,Q,G=>{G||this._update(!0)}),this}removeSprite(J){return this._lazyInitEmptyStyle(),this.style.removeSprite(J),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(J,x={}){return this._lazyInitEmptyStyle(),this.style.setSprite(J,x,Q=>{Q||this._update(!0)}),this}setLight(J,x={}){return this._lazyInitEmptyStyle(),this.style.setLight(J,x),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(J,x){return this.style.setFeatureState(J,x),this._update()}removeFeatureState(J,x){return this.style.removeFeatureState(J,x),this._update()}getFeatureState(J){return this.style.getFeatureState(J)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let J=0,x=0;return this._container&&(J=this._container.clientWidth||400,x=this._container.clientHeight||300),[J,x]}_setupContainer(){const J=this._container;J.classList.add("maplibregl-map");const x=this._canvasContainer=ae.create("div","maplibregl-canvas-container",J);this._interactive&&x.classList.add("maplibregl-interactive"),this._canvas=ae.create("canvas","maplibregl-canvas",x),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const Q=this._containerDimensions(),G=this._getClampedPixelRatio(Q[0],Q[1]);this._resizeCanvas(Q[0],Q[1],G);const X=this._controlContainer=ae.create("div","maplibregl-control-container",J),te=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(Ae=>{te[Ae]=ae.create("div",`maplibregl-ctrl-${Ae} `,X)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=ae.create("div","maplibregl-cooperative-gesture-screen",this._container);let J=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(J=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use â + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${J}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){ae.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(J,x,Q){this._canvas.width=Math.floor(Q*J),this._canvas.height=Math.floor(Q*x),this._canvas.style.width=`${J}px`,this._canvas.style.height=`${x}px`}_setupPainter(){const J={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let x=null;this._canvas.addEventListener("webglcontextcreationerror",G=>{x={requestedAttributes:J},G&&(x.statusMessage=G.statusMessage,x.type=G.type)},{once:!0});const Q=this._canvas.getContext("webgl2",J)||this._canvas.getContext("webgl",J);if(!Q){const G="Failed to initialize WebGL";throw x?(x.message=G,new Error(JSON.stringify(x))):new Error(G)}this.painter=new jo(Q,this.transform),ue.testSupport(Q)}_onCooperativeGesture(J,x,Q){return!x&&Q<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(J){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||J,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(J){return this._update(),this._renderTaskQueue.add(J)}_cancelRenderFrame(J){this._renderTaskQueue.remove(J)}_render(J){const x=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(J),this._removed)return;let Q=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const X=this.transform.zoom,te=D.browser.now();this.style.zoomHistory.update(X,te);const Ae=new D.EvaluationParameters(X,{now:te,fadeDuration:x,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),he=Ae.crossFadingFactor();he===1&&he===this._crossFadingFactor||(Q=!0,this._crossFadingFactor=he),this.style.update(Ae)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,x,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,showPadding:this.showPadding}),this.fire(new D.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,D.PerformanceUtils.mark(D.PerformanceMarkers.load),this.fire(new D.Event("load"))),this.style&&(this.style.hasTransitions()||Q)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const G=this._sourcesDirty||this._styleDirty||this._placementDirty;return G||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new D.Event("idle")),!this._loaded||this._fullyLoaded||G||(this._fullyLoaded=!0,D.PerformanceUtils.mark(D.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var J;this._hash&&this._hash.remove();for(const Q of this._controls)Q.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Je.removeThrottleControl(this._imageQueueHandle),(J=this._resizeObserver)===null||J===void 0||J.disconnect();const x=this.painter.context.gl.getExtension("WEBGL_lose_context");x&&x.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),ae.remove(this._canvasContainer),ae.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),D.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new D.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=D.browser.frame(J=>{D.PerformanceUtils.frame(J),this._frame=null,this._render(J)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(J){this._showTileBoundaries!==J&&(this._showTileBoundaries=J,this._update())}get showPadding(){return!!this._showPadding}set showPadding(J){this._showPadding!==J&&(this._showPadding=J,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(J){this._showCollisionBoxes!==J&&(this._showCollisionBoxes=J,J?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(J){this._showOverdrawInspector!==J&&(this._showOverdrawInspector=J,this._update())}get repaint(){return!!this._repaint}set repaint(J){this._repaint!==J&&(this._repaint=J,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(J){this._vertices=J,this._update()}get version(){return uA}getCameraTargetElevation(){return this.transform.elevation}},xr.NavigationControl=class{constructor(J){this._updateZoomButtons=()=>{const x=this._map.getZoom(),Q=x===this._map.getMaxZoom(),G=x===this._map.getMinZoom();this._zoomInButton.disabled=Q,this._zoomOutButton.disabled=G,this._zoomInButton.setAttribute("aria-disabled",Q.toString()),this._zoomOutButton.setAttribute("aria-disabled",G.toString())},this._rotateCompassArrow=()=>{const x=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=x},this._setButtonTitle=(x,Q)=>{const G=this._map._getUIString(`NavigationControl.${Q}`);x.title=G,x.setAttribute("aria-label",G)},this.options=D.extend({},ts,J),this._container=ae.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",x=>x.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",x=>this._map.zoomIn({},{originalEvent:x})),ae.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",x=>this._map.zoomOut({},{originalEvent:x})),ae.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",x=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:x}):this._map.resetNorth({},{originalEvent:x})}),this._compassIcon=ae.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(J){return this._map=J,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Kl(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){ae.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(J,x){const Q=ae.create("button",J,this._container);return Q.type="button",Q.addEventListener("click",x),Q}},xr.GeolocateControl=class extends D.Evented{constructor(J){super(),this._onSuccess=x=>{if(this._map){if(this._isOutOfMapMaxBounds(x))return this._setErrorState(),this.fire(new D.Event("outofmaxbounds",x)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=x,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(x),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(x),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new D.Event("geolocate",x)),this._finish()}},this._updateCamera=x=>{const Q=new D.LngLat(x.coords.longitude,x.coords.latitude),G=x.coords.accuracy,X=this._map.getBearing(),te=D.extend({bearing:X},this.options.fitBoundsOptions),Ae=R.fromLngLat(Q,G);this._map.fitBounds(Ae,te,{geolocateSource:!0})},this._updateMarker=x=>{if(x){const Q=new D.LngLat(x.coords.longitude,x.coords.latitude);this._accuracyCircleMarker.setLngLat(Q).addTo(this._map),this._userLocationDotMarker.setLngLat(Q).addTo(this._map),this._accuracy=x.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=x=>{if(this._map){if(this.options.trackUserLocation)if(x.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const Q=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=Q,this._geolocateButton.setAttribute("aria-label",Q),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(x.code===3&&Na)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new D.Event("error",x)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=x=>{if(this._map){if(this._container.addEventListener("contextmenu",Q=>Q.preventDefault()),this._geolocateButton=ae.create("button","maplibregl-ctrl-geolocate",this._container),ae.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",x===!1){D.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const Q=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=Q,this._geolocateButton.setAttribute("aria-label",Q)}else{const Q=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=Q,this._geolocateButton.setAttribute("aria-label",Q)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ae.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Oo({element:this._dotElement}),this._circleElement=ae.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Oo({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",Q=>{Q.geolocateSource||this._watchState!=="ACTIVE_LOCK"||Q.originalEvent&&Q.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new D.Event("trackuserlocationend")))})}},this.options=D.extend({},Ro,J)}onAdd(J){return this._map=J,this._container=ae.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(x,Q=!1){un===void 0||Q?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(G=>{un=G.state!=="denied",x(un)}).catch(()=>{un=!!window.navigator.geolocation,x(un)}):(un=!!window.navigator.geolocation,x(un)):x(un)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),ae.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,uo=0,Na=!1}_isOutOfMapMaxBounds(J){const x=this._map.getMaxBounds(),Q=J.coords;return x&&(Q.longitude<x.getWest()||Q.longitude>x.getEast()||Q.latitude<x.getSouth()||Q.latitude>x.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const J=this._map.getBounds(),x=J.getSouthEast(),Q=J.getNorthEast(),G=x.distanceTo(Q),X=Math.ceil(this._accuracy/(G/this._map._container.clientHeight)*2);this._circleElement.style.width=`${X}px`,this._circleElement.style.height=`${X}px`}trigger(){if(!this._setup)return D.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new D.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":uo--,Na=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new D.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new D.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let J;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),uo++,uo>1?(J={maximumAge:6e5,timeout:0},Na=!0):(J=this.options.positionOptions,Na=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,J)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},xr.AttributionControl=zs,xr.LogoControl=Mo,xr.ScaleControl=class{constructor(J){this._onMove=()=>{tl(this._map,this._container,this.options)},this.setUnit=x=>{this.options.unit=x,tl(this._map,this._container,this.options)},this.options=D.extend({},wl,J)}getDefaultPosition(){return"bottom-left"}onAdd(J){return this._map=J,this._container=ae.create("div","maplibregl-ctrl maplibregl-ctrl-scale",J.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){ae.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},xr.FullscreenControl=class extends D.Evented{constructor(J={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,J&&J.container&&(J.container instanceof HTMLElement?this._container=J.container:D.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(J){return this._map=J,this._container||(this._container=this._map.getContainer()),this._controlContainer=ae.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){ae.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const J=this._fullscreenButton=ae.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);ae.create("span","maplibregl-ctrl-icon",J).setAttribute("aria-hidden","true"),J.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const J=this._getTitle();this._fullscreenButton.setAttribute("aria-label",J),this._fullscreenButton.title=J}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new D.Event("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new D.Event("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},xr.TerrainControl=class{constructor(J){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=J}onAdd(J){return this._map=J,this._container=ae.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=ae.create("button","maplibregl-ctrl-terrain",this._container),ae.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){ae.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},xr.Popup=class extends D.Evented{constructor(J){super(),this.remove=()=>(this._content&&ae.remove(this._content),this._container&&(ae.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new D.Event("close")),this),this._onMouseUp=x=>{this._update(x.point)},this._onMouseMove=x=>{this._update(x.point)},this._onDrag=x=>{this._update(x.point)},this._update=x=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=ae.create("div","maplibregl-popup",this._map.getContainer()),this._tip=ae.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const Ae of this.options.className.split(" "))this._container.classList.add(Ae);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Lo(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!x)return;const Q=this._pos=this._trackPointer&&x?x:this._map.project(this._lngLat);let G=this.options.anchor;const X=il(this.options.offset);if(!G){const Ae=this._container.offsetWidth,he=this._container.offsetHeight;let pe;pe=Q.y+X.bottom.y<he?["top"]:Q.y>this._map.transform.height-he?["bottom"]:[],Q.x<Ae/2?pe.push("left"):Q.x>this._map.transform.width-Ae/2&&pe.push("right"),G=pe.length===0?"bottom":pe.join("-")}const te=Q.add(X[G]).round();ae.setTransform(this._container,`${Qo[G]} translate(${te.x}px,${te.y}px)`),el(this._container,G,"popup")},this._onClose=()=>{this.remove()},this.options=D.extend(Object.create(xl),J)}addTo(J){return this._map&&this.remove(),this._map=J,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new D.Event("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(J){return this._lngLat=D.LngLat.convert(J),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(J){return this.setDOMContent(document.createTextNode(J))}setHTML(J){const x=document.createDocumentFragment(),Q=document.createElement("body");let G;for(Q.innerHTML=J;G=Q.firstChild,G;)x.appendChild(G);return this.setDOMContent(x)}getMaxWidth(){var J;return(J=this._container)===null||J===void 0?void 0:J.style.maxWidth}setMaxWidth(J){return this.options.maxWidth=J,this._update(),this}setDOMContent(J){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=ae.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(J),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(J){this._container&&this._container.classList.add(J)}removeClassName(J){this._container&&this._container.classList.remove(J)}setOffset(J){return this.options.offset=J,this._update(),this}toggleClassName(J){if(this._container)return this._container.classList.toggle(J)}_createCloseButton(){this.options.closeButton&&(this._closeButton=ae.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const J=this._container.querySelector(Bl);J&&J.focus()}},xr.Marker=Oo,xr.Style=sr,xr.LngLat=D.LngLat,xr.LngLatBounds=R,xr.Point=D.Point,xr.MercatorCoordinate=D.MercatorCoordinate,xr.Evented=D.Evented,xr.AJAXError=D.AJAXError,xr.config=D.config,xr.CanvasSource=me,xr.GeoJSONSource=be,xr.ImageSource=Ve,xr.RasterDEMTileSource=fe,xr.RasterTileSource=le,xr.VectorTileSource=se,xr.VideoSource=Ue,xr.setRTLTextPlugin=D.setRTLTextPlugin,xr.getRTLTextPluginStatus=D.getRTLTextPluginStatus,xr.prewarm=function(){Vi().acquire(wt)},xr.clearPrewarmedResources=function(){const J=Hi;J&&(J.isPreloaded()&&J.numActive()===1?(J.release(wt),Hi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},rl.extend(xr,{isSafari:D.isSafari,getPerformanceMetrics:D.PerformanceUtils.getPerformanceMetrics}),xr});var re=K;return re})})(maplibreGl);var maplibreGlExports=maplibreGl.exports;const mapLibre=getDefaultExportFromCjs(maplibreGlExports),MaplibreLayer=L.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,pane:"tilePane"},initialize:function(g){L.setOptions(this,g),this._throttledUpdate=L.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(g){this._container||this._initContainer();const B=this.getPaneName();g.getPane(B).appendChild(this._container),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),g.options.zoomAnimation&&L.DomEvent.on(g._proxy,L.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove:function(g){this._map._proxy&&this._map.options.zoomAnimation&&L.DomEvent.off(this._map._proxy,L.DomUtil.TRANSITION_END,this._transitionEnd,this);const B=this.getPaneName();g.getPane(B).removeChild(this._container),this._glMap.remove(),this._glMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd,resize:this._resize}},getMaplibreMap:function(){return this._glMap},getCanvas:function(){return this._glMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getBounds:function(){const g=this.getSize().multiplyBy(.5),B=this._map.latLngToContainerPoint(this._map.getCenter());return latLngBounds(this._map.containerPointToLatLng(B.subtract(g)),this._map.containerPointToLatLng(B.add(g)))},getContainer:function(){return this._container},getPaneName:function(){return this._map.getPane(this.options.pane)?this.options.pane:"tilePane"},_roundPoint:function(g){return{x:Math.round(g.x),y:Math.round(g.y)}},_initContainer:function(){const g=this._container=L.DomUtil.create("div","leaflet-gl-layer"),B=this.getSize(),M=this._map.getSize().multiplyBy(this.options.padding);g.style.width=`${B.x}px`,g.style.height=`${B.y}px`;const P=this._map.containerPointToLayerPoint([0,0]).subtract(M);L.DomUtil.setPosition(g,this._roundPoint(P))},_initGL:function(){const g=this._map.getCenter(),B=L.extend({},this.options,{container:this._container,center:[g.lng,g.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new mapLibre.Map(B),this._glMap.transform.latRange=null,this._glMap.transform.maxValidLatitude=1/0,this._transformGL(this._glMap),this._glMap._canvas.canvas?this._glMap._actualCanvas=this._glMap._canvas.canvas:this._glMap._actualCanvas=this._glMap._canvas;const M=this._glMap._actualCanvas;L.DomUtil.addClass(M,"leaflet-image-layer"),L.DomUtil.addClass(M,"leaflet-zoom-animated"),this.options.interactive&&L.DomUtil.addClass(M,"leaflet-interactive"),this.options.className&&L.DomUtil.addClass(M,this.options.className)},_update:function(g){if(this._offset=this._map.containerPointToLayerPoint([0,0]),this._zooming)return;const B=this.getSize(),M=this._container,P=this._glMap,K=this._map.getSize().multiplyBy(this.options.padding),Y=this._map.containerPointToLayerPoint([0,0]).subtract(K);L.DomUtil.setPosition(M,this._roundPoint(Y)),this._transformGL(P),P.transform.width!==B.x||P.transform.height!==B.y?(M.style.width=`${B.x}px`,M.style.height=`${B.y}px`,P._resize!==null&&P._resize!==void 0?P._resize():P.resize()):P._update!==null&&P._update!==void 0?P._update():P.update()},_transformGL:function(g){const B=this._map.getCenter(),M=g.transform;M.center=mapLibre.LngLat.convert([B.lng,B.lat]),M.zoom=this._map.getZoom()-1},_pinchZoom:function(g){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(g){const B=this._map.getZoomScale(g.zoom),M=this._map.getSize().multiplyBy(this.options.padding*B),P=this.getSize()._divideBy(2),K=this._map.project(g.center,g.zoom)._subtract(P)._add(this._map._getMapPanePos().add(M))._round(),Y=this._map.project(this._map.getBounds().getNorthWest(),g.zoom)._subtract(K);L.DomUtil.setTransform(this._glMap._actualCanvas,Y.subtract(this._offset),B)},_zoomStart:function(g){this._zooming=!0},_zoomEnd:function(){const g=this._map.getZoomScale(this._map.getZoom());L.DomUtil.setTransform(this._glMap._actualCanvas,new L.Point(0,0),g),this._zooming=!1,this._update()},_transitionEnd:function(g){L.Util.requestAnimFrame(function(){const B=this._map.getZoom(),M=this._map.getCenter(),P=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());L.DomUtil.setTransform(this._glMap._actualCanvas,P,1),this._glMap.once("moveend",L.Util.bind(function(){this._zoomEnd()},this)),this._glMap.jumpTo({center:M,zoom:B-1})},this)},_resize:function(g){this._transitionEnd(g)}});function maplibreLayer(g){return new MaplibreLayer(g)}let copyData;$(document).on("copy",g=>{copyData&&g.originalEvent&&g.originalEvent.clipboardData?(Object.keys(copyData).forEach(B=>{g.originalEvent.clipboardData.setData(B,copyData[B])}),g.originalEvent.preventDefault(),copyData=void 0):copyData&&copyData["text/plain"]&&(prompt(i18n.t("export.copy_to_clipboard"),copyData["text/plain"]),copyData=null)});function make_combobox(g,B,M,P){if(g[0].is_combobox){g.autocomplete("option",{source:B});return}const K=g.wrap("<span>").parent().addClass("ui-combobox");g.autocomplete({source:B,minLength:0}).addClass("ui-widget ui-widget-content ui-corner-left ui-state-default").autocomplete("instance")._renderItem=(Y,re)=>$("<li>").append(M&&M.indexOf(re.value)!==-1?`<div title="shift-click to remove from list" style="font-style:italic;">${re.label}</div>`:`<div>${re.label}</div>`).on("click",function(D){if(D.shiftKey&&M.indexOf(re.value)!==-1){P(re.value),$(this).remove();const ne=g.autocomplete("option","source");return ne.splice(ne.indexOf(re),1),g.autocomplete("option","source",ne),!1}}).appendTo(Y),$("<a>").attr("tabIndex",-1).attr("title","show all items").appendTo(K).button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).removeClass("ui-corner-all").addClass("ui-corner-right ui-combobox-toggle").click(()=>{if(g.autocomplete("widget").is(":visible")){g.autocomplete("close");return}g.autocomplete("search",""),g.focus()}),g[0].is_combobox=!0}function showDialog(g,B,M){const P=`      <div class="modal is-active">        <div class="modal-background"></div>        <div class="modal-card">          <header class="modal-card-head">            <p class="modal-card-title">${g}</p>            <button class="delete" aria-label="close"></button>          </header>          <section class="modal-card-body">            ${B}          </section>          <footer class="modal-card-foot">            <div class="level">              <div class="level-right">                <div class="level-item">                </div>              </div>            </div>          </footer>        </div>      </div>    `,K=$(P);$(".delete",K).click(()=>$(K).remove());for(const Y in M){const re=M[Y];$(`<button class="button">${re.name}</button>`).click(()=>{var D;(D=re.callback)==null||D.call(re),$(K).remove()}).appendTo($("footer .level-item",K))}K.appendTo("body")}class IDE{constructor(){this.attribControl=null,this.scaleControl=null,this.queryParser=new parser,this.run_query_on_startup=!1,this.codeEditor=null,this.dataViewer=null,this.map=null,this.waiter=new class{constructor(){this.opened=!0,this.frames=["â´","â·","â¶","âµ"],this.frameDelay=250,this.onAbort=void 0,this.interval=0,this._initialTitle=document.title}open(M){M?($(".modal .wait-info h4").text(M),$(".wait-info").show()):$(".wait-info").hide(),$("#loading-dialog").addClass("is-active"),document.title=`${this.frames[0]} ${this._initialTitle}`;let P=0;this.interval=setInterval(()=>{const K=this.isAlert?this.alertFrame:this.frames[++P%this.frames.length];document.title=`${K} ${this._initialTitle}`},this.frameDelay),this.opened=!0}close(M=""){this.opened&&(clearInterval(this.interval),document.title=`${M}${this._initialTitle}`,$("#loading-dialog").removeClass("is-active"),$(".wait-info ul li").remove(),delete this.onAbort,this.opened=!1)}addInfo(M,P){$("#aborter").remove(),$(".wait-info ul li:nth-child(n+1)").css("opacity",.5),$(".wait-info ul li span.fas").removeClass("fa-spinner").removeClass("fa-spin").addClass("fa-check"),$(".wait-info ul li:nth-child(n+4)").hide();const K=$(`<li><span class="fas fa-spinner fa-spin" style="display:inline-block; margin-bottom:-2px; margin-right:3px;"></span>${M}</li>`);if(typeof P=="function"){this.onAbort=P;const Y=$('<span id="aborter">&nbsp;(<a href="#">abort</a>)</span>').on("click",()=>(this.abort(),!1));K.append(Y)}$(".wait-info ul").prepend(K)}abort(){typeof this.onAbort=="function"&&(this.addInfo("aborting"),this.onAbort(this.close))}}}init(){this.waiter.addInfo("ide starting up"),$("#overpass-turbo-version").html("overpass-turbo <code>2024-11-18/ac9201e</code>"),$("#overpass-turbo-dependencies").html('<a href="https://www.npmjs.com/package/@fortawesome/fontawesome-free/v/5.15.4">@fortawesome/fontawesome-free</a> 5.15.4 ((CC-BY-4.0 AND OFL-1.1 AND MIT)), <a href="https://www.npmjs.com/package/@maplibre/maplibre-gl-leaflet/v/0.0.20">@maplibre/maplibre-gl-leaflet</a> 0.0.20 (ISC), <a href="https://www.npmjs.com/package/@openstreetmap/id-tagging-schema/v/3.5.1">@openstreetmap/id-tagging-schema</a> 3.5.1 (ISC), <a href="https://www.npmjs.com/package/bulma/v/0.9.4">bulma</a> 0.9.4 (MIT), <a href="https://www.npmjs.com/package/canvg/v/4.0.1">canvg</a> 4.0.1 (MIT), <a href="https://www.npmjs.com/package/codemirror/v/2.38.00">codemirror</a> 2.38.00 (undefined), <a href="https://www.npmjs.com/package/colorbrewer/v/1.5.7">colorbrewer</a> 1.5.7 ([object Object]), <a href="https://www.npmjs.com/package/colormap/v/2.3.2">colormap</a> 2.3.2 (MIT), <a href="https://www.npmjs.com/package/html2canvas/v/1.4.1">html2canvas</a> 1.4.1 (MIT), <a href="https://www.npmjs.com/package/jquery/v/3.7.1">jquery</a> 3.7.1 (MIT), <a href="https://www.npmjs.com/package/jquery-ui/v/1.13.2">jquery-ui</a> 1.13.2 (MIT), <a href="https://www.npmjs.com/package/jquery-ui-dist/v/1.13.2">jquery-ui-dist</a> 1.13.2 (MIT), <a href="https://www.npmjs.com/package/leaflet/v/1.9.4">leaflet</a> 1.9.4 (BSD-2-Clause), <a href="https://www.npmjs.com/package/leaflet-polylineoffset/v/1.1.1">leaflet-polylineoffset</a> 1.1.1 (MIT), <a href="https://www.npmjs.com/package/leaflet-locationfilter/v/0.1.3">leaflet-locationfilter</a> 0.1.3 (MIT), <a href="https://www.npmjs.com/package/lodash/v/4.17.21">lodash</a> 4.17.21 (MIT), <a href="https://www.npmjs.com/package/maplibre-gl/v/3.3.1">maplibre-gl</a> 3.3.1 (BSD-3-Clause), <a href="https://www.npmjs.com/package/osm-auth/v/2.2.0">osm-auth</a> 2.2.0 (ISC), <a href="https://www.npmjs.com/package/osmtogeojson/v/3.0.0-beta.5">osmtogeojson</a> 3.0.0-beta.5 (MIT), <a href="https://www.npmjs.com/package/rgbcolor/v/1.0.1">rgbcolor</a> 1.0.1 (MIT OR SEE LICENSE IN FEEL-FREE.md), <a href="https://www.npmjs.com/package/stackblur/v/1.0.0">stackblur</a> 1.0.0 (BSD-2-Clause), <a href="https://www.npmjs.com/package/tag2link/v/2024.05.21">tag2link</a> 2024.05.21 (ISC), <a href="https://www.npmjs.com/package/togpx/v/0.5.4">togpx</a> 0.5.4 (MIT), <a href="https://www.npmjs.com/package/tokml/v/0.4.0">tokml</a> 0.4.0 (BSD-2-Clause)'),($.support.cors!=!0||typeof function(){let B;try{localStorage.setItem("startup_localstorage_quota_test",123),localStorage.removeItem("startup_localstorage_quota_test"),B=localStorage}catch{}return B}()!="object")&&(this.not_supported=!0,$("#warning-unsupported-browser").addClass("is-active")),this.waiter.addInfo("load settings"),settings.load(),this.waiter.addInfo("translate ui"),i18n.translate().then(()=>this.initAfterI18n()),sync.enabled&&($("#load-dialog .osm").show(),sync.authenticated()&&($("#logout").show(),$("#logout").appendTo($("#logout").parent())))}initAfterI18n(){const B=this;B.waiter.addInfo("parse url parameters");const M=urlParameters();M.has_coords&&(settings.coords_lat=M.coords.lat,settings.coords_lon=M.coords.lng),M.has_zoom&&(settings.coords_zoom=M.zoom),M.run_query&&(B.run_query_on_startup=!0),settings.save(),B.waiter.addInfo("initialize page");const P=$(window).width()/$(window).height()<.8;if(settings.editor_width!=""&&!P&&($("#editor").css("width",settings.editor_width),$("#dataviewer").css("left",settings.editor_width)),P&&$("#editor, #dataviewer").addClass("portrait"),$("#editor").resizable({handles:P?"s":"e",minWidth:P?void 0:"200",resize(){if(!P)$(this).next().css("left",`${$(this).outerWidth()}px`);else{const ue=$(this).offset().top+$(this).outerHeight();$(this).next().css("top",`${ue}px`)}B.map.invalidateSize(!1)},stop(){P||(settings.editor_width=$("#editor").css("width"),settings.save())}}),$("#editor").prepend("<span class='ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se'/>"),$("#editor textarea")[0].value=settings.code.overpass,settings.use_rich_editor){let ue=0;CodeMirror.defineMIME("text/x-overpassQL",{name:"clike",keywords:function(ge){const Be={},De=ge.split(" ");for(const ze of De)Be[ze]=!0;return Be}("out json xml custom popup timeout maxsize bbox date diff adiff foreach relation rel way node is_in area around user uid newer changed poly pivot nwr nw nr wr derived out meta body skel tags ids count qt asc center bb geom")}),CodeMirror.defineMIME("text/x-overpassXML","xml"),CodeMirror.defineMode("xml+mustache",ge=>CodeMirror.multiplexingMode(CodeMirror.multiplexingMode(CodeMirror.getMode(ge,"xml"),{open:"{{",close:"}}",mode:CodeMirror.getMode(ge,"text/plain"),delimStyle:"mustache"}),{open:"{{style:",close:"}}",mode:CodeMirror.getMode(ge,"text/css"),delimStyle:"mustache"})),CodeMirror.defineMode("ql+mustache",ge=>CodeMirror.multiplexingMode(CodeMirror.multiplexingMode(CodeMirror.getMode(ge,"text/x-overpassQL"),{open:"{{",close:"}}",mode:CodeMirror.getMode(ge,"text/plain"),delimStyle:"mustache"}),{open:"{{style:",close:"}}",mode:CodeMirror.getMode(ge,"text/css"),delimStyle:"mustache"})),B.codeEditor=CodeMirror.fromTextArea($("#editor textarea")[0],{lineNumbers:!0,lineWrapping:!0,mode:"text/plain",onChange(ge){clearTimeout(ue),ue=setTimeout(()=>{B.getQueryLang()=="xml"?ge.getOption("mode")!="xml+mustache"&&(ge.closeTagEnabled=!0,ge.setOption("matchBrackets",!1),ge.setOption("mode","xml+mustache")):ge.getOption("mode")!="ql+mustache"&&(ge.closeTagEnabled=!1,ge.setOption("matchBrackets",!0),ge.setOption("mode","ql+mustache"));const Be=$(".leaflet-control-buttons-bboxfilter");B.getRawQuery().match(/\{\{bbox\}\}/)?Be.hasClass("disabled")&&(Be.removeClass("disabled"),Be.attr("data-t","[title]map_controlls.select_bbox"),i18n.translate_ui(Be[0])):Be.hasClass("disabled")||(Be.addClass("disabled"),Be.attr("data-t","[title]map_controlls.select_bbox_disabled"),i18n.translate_ui(Be[0]))},500),settings.code.overpass=ge.getValue(),settings.save()},closeTagEnabled:!0,closeTagIndent:["osm-script","query","union","foreach","difference"],extraKeys:{"'>'"(ge){ge.closeTag(ge,">")},"'/'"(ge){ge.closeTag(ge,"/")}}}),B.codeEditor.getOption("onChange")(B.codeEditor)}else B.codeEditor=$("#editor textarea")[0],B.codeEditor.getValue=function(){return this.value},B.codeEditor.setValue=function(ue){this.value=ue},B.codeEditor.lineCount=function(){return this.value.split(/\r\n|\r|\n/).length},B.codeEditor.setLineClass=function(){},$("#editor textarea").bind("input change",ue=>{settings.code.overpass=ue.target.getValue(),settings.save()});M.has_query&&B.codeEditor.setValue(M.query),B.dataViewer=CodeMirror($("#data")[0],{value:"no data loaded yet",lineNumbers:!0,readOnly:!0,mode:"javascript"}),B.map=new L.Map("map",{attributionControl:!1,minZoom:0,maxZoom:configs.maxMapZoom,worldCopyJump:!1});const K=settings.tile_server,Y=configs.vectorTileAttribution;new L.TileLayer(K,{attribution:Y,noWrap:!0,maxNativeZoom:19,maxZoom:B.map.options.maxZoom});const re=new L.Control.Attribution({position:"bottomright"});re.addAttribution(Y),re.addTo(B.map);const D=new L.LatLng(settings.coords_lat,settings.coords_lon);B.map.setView(D,settings.coords_zoom),B.map.createPane("ohm_vectortiles"),B.map.getPane("ohm_vectortiles").style.zIndex="210",B.map.getPane("ohm_vectortiles").style.pointerEvents="none",maplibreLayer({style:configs.vectorTileStyleUrl,pane:"ohm_vectortiles"}).addTo(B.map),B.map.inv_opacity_layer=L.tileLayer("data:image/gif;base64,R0lGODlhAQABAIAAAP7//wAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==").setOpacity(1-settings.background_opacity),settings.background_opacity!=1&&B.map.inv_opacity_layer.addTo(B.map),B.scaleControl=new L.Control.Scale({metric:!0,imperial:!1}),B.scaleControl.addTo(B.map),B.map.on("moveend",()=>{settings.coords_lat=B.map.getCenter().lat,settings.coords_lon=B.map.getCenter().lng,settings.coords_zoom=B.map.getZoom(),settings.save()}),$("#dataviewer > div#data")[0].style.zIndex=-1001,$(".tabs li").bind("click",ue=>{$(ue.target).hasClass("is-active")||($("#dataviewer > div#data")[0].style.zIndex=-1*$("#dataviewer > div#data")[0].style.zIndex,$(".tabs li").toggleClass("is-active"))}),$(document).keydown(ue=>B.onKeyPress(ue));const ne=L.Control.extend({options:{position:"topleft"},onAdd(){const ue=L.DomUtil.create("div","leaflet-control-buttons leaflet-bar");let ge=L.DomUtil.create("a","leaflet-control-buttons-fitdata leaflet-bar-part leaflet-bar-part-top",ue);return $('<span class="fas fa-search"/>').appendTo($(ge)),ge.href="#",ge.className+=" t",ge.setAttribute("data-t","[title]map_controlls.zoom_to_data"),i18n.translate_ui(ge),L.DomEvent.addListener(ge,"click",()=>{try{B.map.fitBounds(overpass.osmLayer.getBaseLayer().getBounds(),{maxZoom:18})}catch{}return!1},B.map),ge=L.DomUtil.create("a","leaflet-control-buttons-myloc leaflet-bar-part",ue),$('<span class="fas fa-crosshairs"/>').appendTo($(ge)),ge.href="#",ge.className+=" t",ge.setAttribute("data-t","[title]map_controlls.localize_user"),window.isSecureContext||(ge.className+=" disabled",ge.setAttribute("data-t","[title]map_controlls.localize_user_disabled")),i18n.translate_ui(ge),L.DomEvent.addListener(ge,"click",()=>{try{navigator.geolocation.getCurrentPosition(Be=>{const De=new L.LatLng(Be.coords.latitude,Be.coords.longitude);B.map.setView(De,settings.coords_zoom)})}catch{}return!1},B.map),ge=L.DomUtil.create("a","leaflet-control-buttons-bboxfilter leaflet-bar-part",ue),$('<span class="fas fa-image"/>').appendTo($(ge)),ge.href="#",ge.className+=" t",ge.setAttribute("data-t","[title]map_controlls.select_bbox"),i18n.translate_ui(ge),L.DomEvent.addListener(ge,"click",Be=>($(Be.target).parent().hasClass("disabled")||(B.map.bboxfilter.isEnabled()?B.map.bboxfilter.disable():(B.map.bboxfilter.setBounds(B.map.getBounds().pad(-.2)),B.map.bboxfilter.enable()),$(Be.target).toggleClass("fa-times-circle").toggleClass("fa-image")),!1),B.map),ge=L.DomUtil.create("a","leaflet-control-buttons-fullscreen leaflet-bar-part",ue),$('<span class="fas fa-step-backward"/>').appendTo($(ge)),ge.href="#",ge.className+=" t",ge.setAttribute("data-t","[title]map_controlls.toggle_wide_map"),i18n.translate_ui(ge),L.DomEvent.addListener(ge,"click",Be=>($("#dataviewer").toggleClass("fullscreen"),B.map.invalidateSize(),$(Be.target).toggleClass("fa-step-forward").toggleClass("fa-step-backward"),$("#editor").toggleClass("hidden"),$("#editor").resizable("option","disabled")?$("#editor").resizable("enable"):$("#editor").resizable("disable"),!1),B.map),ge=L.DomUtil.create("a","leaflet-control-buttons-clearoverlay leaflet-bar-part leaflet-bar-part-bottom",ue),$('<span class="fas fa-ban"/>').appendTo($(ge)),ge.href="#",ge.className+=" t",ge.setAttribute("data-t","[title]map_controlls.toggle_data"),i18n.translate_ui(ge),L.DomEvent.addListener(ge,"click",Be=>(Be.preventDefault(),B.map.hasLayer(overpass.osmLayer)?B.map.removeLayer(overpass.osmLayer):B.map.addLayer(overpass.osmLayer),!1),B.map),ue}});B.map.addControl(new ne),$(".leaflet-control-buttons > a").bind("dblclick",ue=>ue.stopPropagation()),$(".leaflet-control-buttons > a").tooltip({items:"a[title]",hide:{effect:"fadeOut",duration:100},position:{my:"left+5 center",at:"right center"}});const ae=L.Control.extend({options:{position:"topright"},onAdd(){const ue=L.DomUtil.create("div","leaflet-control-search control has-icons-left");ue.style.position="absolute",ue.style.right="0";const ge=L.DomUtil.create("input","input is-rounded",ue);return $('<span class="icon is-left"><span class="fas fa-search"/></span>').click(function(){$(this).prev().autocomplete("search")}).insertAfter(ge),ge.id="search",ge.type="search",ge.onclick=function(){this.focus()},ue.ondblclick=function(Be){Be.stopPropagation()},$(ge).autocomplete({source(Be,De){$.ajax(`https://search.osmnames.org/q/${encodeURIComponent(Be.term)}.js?key=${configs.osmnamesApiKey}`,{success(ze){if(typeof ze=="string")try{ze=$.parseJSON(ze)}catch{}De($.map(ze.results.slice(0,10),Oe=>({label:Oe.display_name,value:Oe.display_name,lat:Oe.lat,lon:Oe.lon,boundingbox:Oe.boundingbox})))},error(){console.error("An error occurred while contacting the search server osmnames.org :(")}})},minLength:2,autoFocus:!0,select(Be,De){return De.item.boundingbox&&De.item.boundingbox instanceof Array?B.map.fitBounds(L.latLngBounds([[De.item.boundingbox[1],De.item.boundingbox[0]],[De.item.boundingbox[3],De.item.boundingbox[2]]]),{maxZoom:18}):B.map.panTo(new L.LatLng(De.item.lat,De.item.lon)),this.value="",!1},open(){$(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close(){$(this).addClass("ui-corner-all").removeClass("ui-corner-top")}}),$(ge).autocomplete("option","delay",20),ue}});B.map.addControl(new ae),$('<span class="fas fa-plus" />').addClass("crosshairs").hide().appendTo("#map"),settings.enable_crosshairs&&$(".crosshairs").show(),B.map.bboxfilter=new L.LocationFilter({enable:!1,adjustButton:!1,enableButton:!1}).addTo(B.map),B.map.on("popupopen popupclose",ue=>{if(typeof ue.popup.layer<"u"){const ge=ue.popup.layer.placeholder||ue.popup.layer,Be=overpass.osmLayer._baseLayer.options.style(ge.feature,ue.type=="popupopen");typeof ge.eachLayer!="function"?typeof ge.setStyle=="function"&&ge.setStyle(Be):ge.eachLayer(De=>{typeof De.setStyle=="function"&&De.setStyle(Be)})}}),overpass.init(),overpass.handlers.onProgress=function(ue,ge){B.waiter.addInfo(ue,ge)},overpass.handlers.onDone=function(){const ue=B.getRawQuery().match(/@name ([^\n]+)/),ge=ue?`${ue[1]} | `:"";B.waiter.close(ge);const Be=B.map.getBounds(),De=overpass.osmLayer.getBaseLayer().getBounds();if(De.isValid()&&!Be.intersects(De)){const ze=$(".leaflet-control-buttons-fitdata").tooltip("option","content");$(".leaflet-control-buttons-fitdata").tooltip("option","content",`â ${i18n.t("map_controlls.suggest_zoom_to_data")}`),$(".leaflet-control-buttons-fitdata").tooltip("open"),$(".leaflet-control-buttons-fitdata").tooltip("option","hide",{effect:"fadeOut",duration:1e3}),setTimeout(()=>{$(".leaflet-control-buttons-fitdata").tooltip("option","content",ze),$(".leaflet-control-buttons-fitdata").tooltip("close"),$(".leaflet-control-buttons-fitdata").tooltip("option","hide",{effect:"fadeOut",duration:100})},2600)}},overpass.handlers.onEmptyMap=function(ue,ge){const Be=B.getRawQuery(),De=/out[^;]+?count/.test(Be);if(ue=="no visible data")if(!De&&!settings.no_autorepair){const ze=`<p>${i18n.t("warning.incomplete.expl.1")}</p><p>${i18n.t("warning.incomplete.expl.2")}</p><p><input type="checkbox" name="hide_incomplete_data_warning"/>&nbsp;${i18n.t("warning.incomplete.not_again")}</p>`,Oe=[{name:i18n.t("dialog.repair_query"),callback(){B.repairQuery("no visible data")}},{name:i18n.t("dialog.show_data"),callback(){var Je,We;(We=(Je=$("input[name=hide_incomplete_data_warning]"))==null?void 0:Je[0])!=null&&We.checked&&(settings.no_autorepair=!0,settings.save()),B.switchTab("Data")}}];showDialog(i18n.t("warning.incomplete.title"),ze,Oe)}else De&&B.switchTab("Data");ue=="only areas returned"&&B.switchTab("Data"),ue=="no coordinates returned"&&B.switchTab("Data"),ge=="unknown"&&B.switchTab("Data"),$(`<div id="map_blank" style="z-index:700; display:block; position:relative; top:50px; width:100%; text-align:center; background-color:#eee; opacity: 0.8;">${i18n.t("map.intentionally_blank")} <small>(${ue})</small></div>`).appendTo("#map")},overpass.handlers.onDataReceived=function(ue,ge,Be,De){if(ue>1e6){B.waiter.close();const ze=document.title;document.title=`â ${ze}`;const Oe=[{name:i18n.t("dialog.abort"),callback(){document.title=ze,Be()}},{name:i18n.t("dialog.continue_anyway"),callback(){document.title=ze,De()}}],Je=`<p>${i18n.t("warning.huge_data.expl.1").replace("{{amount_txt}}",ge)}</p><p>${i18n.t("warning.huge_data.expl.2")}</p>`;showDialog(i18n.t("warning.huge_data.title"),Je,Oe)}else De()},overpass.handlers.onAbort=function(){B.waiter.close()},overpass.handlers.onAjaxError=function(ue){B.waiter.close();const ge=document.title;document.title=`â ${ge}`;const Be=[{name:i18n.t("dialog.dismiss"),callback(){document.title=ge}}],De=`<p style="color:red;">${i18n.t("error.ajax.expl")}</p>${ue}`;showDialog(i18n.t("error.ajax.title"),De,Be),overpass.resultText&&B.dataViewer.setValue(overpass.resultText)},overpass.handlers.onQueryError=function(ue){B.waiter.close();const ge=document.title;document.title=`â ${ge}`;const Be=[{name:i18n.t("dialog.dismiss"),callback(){document.title=ge}}],De=`<div class="notification is-danger is-light">${i18n.t("error.query.expl")}<br>${ue}</div>`;showDialog(i18n.t("error.query.title"),De,Be)},overpass.handlers.onStyleError=function(ue){const ge=[{name:i18n.t("dialog.dismiss")}],Be=`<p style="color:red;">${i18n.t("error.mapcss.expl")}</p>${ue}`;showDialog(i18n.t("error.mapcss.title"),Be,ge)},overpass.handlers.onQueryErrorLine=function(ue){B.highlightError(ue)},overpass.handlers.onRawDataPresent=function(){B.dataViewer.setOption("mode",overpass.resultType),B.dataViewer.setValue(overpass.resultText)},overpass.handlers.onGeoJsonReady=function(){if(B.map.addLayer(overpass.osmLayer),typeof B.run_query_on_startup=="function"&&B.run_query_on_startup(),$("#styler-button").show(),settings.show_data_stats){const ue=overpass.stats,ge=`<small>${i18n.t("data_stats.loaded")}</small>&nbsp;&ndash;&nbsp;${i18n.t("data_stats.nodes")}:&nbsp;${ue.data.nodes}, ${i18n.t("data_stats.ways")}:&nbsp;${ue.data.ways}, ${i18n.t("data_stats.relations")}:&nbsp;${ue.data.relations}${ue.data.areas>0?`, ${i18n.t("data_stats.areas")}:&nbsp;${ue.data.areas}`:""}<br/><small>${i18n.t("data_stats.displayed")}</small>&nbsp;&ndash;&nbsp;${i18n.t("data_stats.pois")}:&nbsp;${ue.geojson.pois}, ${i18n.t("data_stats.lines")}:&nbsp;${ue.geojson.lines}, ${i18n.t("data_stats.polygons")}:&nbsp;${ue.geojson.polys}</small>`;$(`<div id="data_stats" class="stats leaflet-control">${ge}</div>`).insertAfter("#map .leaflet-control-attribution");const Be=overpass.timestamp&&Date.now()-Date.parse(overpass.timestamp),De=overpass.timestampAreas&&Date.now()-Date.parse(overpass.timestampAreas);$("#data_stats").tooltip({items:"div",tooltipClass:"stats",content(){let ze="<div>";if(overpass.ajax_request_duration){let Oe=overpass.ajax_request_duration;Oe.toLocaleString&&(Oe=Oe.toLocaleString()),ze+=`${i18n.t("data_stats.request_duration")}: ${Oe}ms<br>`}return overpass.timestamp&&(ze+=`${i18n.t("data_stats.lag")}: ${Math.floor(Be/1e3)}s <small>${i18n.t("data_stats.lag.expl")}</small>`),overpass.timestampAreas&&(ze+=`<br>${i18n.t("data_stats.lag_areas")}: ${Math.floor(De/1e3)}s <small>${i18n.t("data_stats.lag.expl")}</small>`),ze+="</div>",ze},hide:{effect:"fadeOut",duration:100},position:{my:"right bottom-5",at:"right top"}}),(Be>24*60*60*1e3||De>96*60*60*1e3)&&$("#data_stats").css("background-color","yellow")}},overpass.handlers.onPopupReady=function(ue){ue.openOn(B.map)},B.waiter.close(),B.run_query_on_startup===!0&&(B.update_map(),!M.has_coords&&M.has_query&&M.query.match(/\{\{(bbox|center)\}\}/)===null&&(B.run_query_on_startup=function(){B.run_query_on_startup=null;try{B.map.fitBounds(overpass.osmLayer.getBaseLayer().getBounds(),{maxZoom:18})}catch{}}))}onNominatimError(B,M){this.waiter.close();let P=this.getRawQuery();P=P.split(`
`),P.forEach((re,D)=>{re.indexOf(`{{geocode${M}:${B}}}`)!==-1&&this.highlightError(D+1)});const K=[{name:i18n.t("dialog.dismiss")}],Y=`<p style="color:red;">${i18n.t("error.nominatim.expl")}</p><p><i>${htmlentities(B)}</i></p>`;showDialog(i18n.t("error.nominatim.title"),Y,K)}getRawQuery(){return this.codeEditor.getValue()}async getQuery(){let B=this.getRawQuery();B=B.replace(/(<osm-script[^>]+bbox[^=]*=[^"'']*["'])({{bbox}})(["'])/,"$1{{__bbox__global_bbox_xml__ezs4K8__}}$3"),B=await this.queryParser.parse(B,shortcuts());let M="";this.queryParser.hasStatement("style")&&(M=this.queryParser.getStatement("style")),this.mapcss=M;let P=null;if(this.queryParser.hasStatement("data")){P=this.queryParser.getStatement("data"),P=P.split(",");const K=P[0].toLowerCase();P=P.slice(1);const Y={};for(const re of P){const D=re.split("=");Y[D[0]]=D[1]}P={mode:K,options:Y}}return this.data_source=P,B}setQuery(B){this.codeEditor.setValue(B)}getQueryLang(){return $.trim(this.getRawQuery().replace(/{{.*?}}/g,"")).match(/^</)?"xml":"OverpassQL"}repairQuery(B){const M=this.getRawQuery(),P=this.getQueryLang(),K=autorepair(M,P);B=="no visible data"?K.recurse():B=="xml+metadata"&&K.editors(),this.setQuery(K.getQuery())}highlightError(B){this.codeEditor.setLineClass(B-1,null,"errorline")}resetErrors(){for(let B=0;B<this.codeEditor.lineCount();B++)this.codeEditor.setLineClass(B,null,null)}switchTab(B){$(`.tabs li.${B}`).click()}loadExample(B){if(typeof settings.saves[B]<"u"){let M=settings.saves[B].overpass;/@name/.test(M)||(M=`// @name ${B}

${M}`),this.setQuery(M)}}removeExample(B){const M=[{name:i18n.t("dialog.delete"),callback:()=>{delete settings.saves[B],settings.save(),this.onLoadClick()}},{name:i18n.t("dialog.cancel")}],P=`<p><span class="fas fa-exclamation-triangle" style="float:left; margin:1px 7px 20px 0;"></span>${i18n.t("dialog.delete_query.expl")}: &quot;<i>${B}</i>&quot;?</p>`;showDialog(i18n.t("dialog.delete_query.title"),P,M)}removeExampleSync(B,M){const P=[{name:i18n.t("dialog.delete"),callback(){sync.delete(B.name,Y=>{if(Y)return console.error(Y);$(M).parent().remove()})}},{name:i18n.t("dialog.cancel")}],K=`<p><span class="fas fa-exclamation-triangle" style="float:left; margin:1px 7px 20px 0;"></span>${i18n.t("dialog.delete_query.expl-osm")}: &quot;<i>${B.name}</i>&quot;?</p>`;showDialog(i18n.t("dialog.delete_query.title"),K,P)}onLoadClick(){const B=this;$("#load-dialog .panel.saved_query .panel-block").remove(),$("#load-dialog .panel.example .panel-block").remove();let M=!1;for(const P in settings.saves){const K=settings.saves[P].type;K!="template"&&($('<a class="panel-block">').attr("href","#").text(P).on("click",()=>(B.loadExample(P),$("#load-dialog").removeClass("is-active"),!1)).append($('<button class="ml-auto">').attr("title",`${i18n.t("load.delete_query")}: ${P}`).addClass("delete").on("click",()=>(B.removeExample(P),!1))).appendTo(`#load-dialog .panel.${K}`),K=="saved_query"&&(M=!0))}if(M||$('<div class="panel-block">').text(i18n.t("load.no_saved_query")).appendTo("#load-dialog .panel.saved_query"),$("#load-dialog").addClass("is-active"),sync.authenticated())B.loadOsmQueries();else{const P=$("#load-dialog .panel.osm-queries");location.protocol==="https:"||location.hostname==="127.0.0.1"?(P.show(),P.find(".panel-block").remove(),$('<div class="panel-block">').append($(`<button class='button is-link is-outlined t' title='load.title'>${i18n.t("load.title")}</button>`).on("click",()=>{B.loadOsmQueries()})).appendTo(P)):P.hide()}}loadOsmQueries(){const B=this,M=$("#load-dialog .panel.osm-queries");M.show(),M.find(".panel-block").remove(),$('<div class="panel-block">').text(i18n.t("load.saved_queries-osm-loading")).appendTo(M),sync.load((P,K)=>{if(P)return M.find(".panel-block").remove(),$('<div class="panel-block">').text(i18n.t("load.saved_queries-osm-error")).appendTo(M),console.error(P);M.find(".panel-block").remove(),$("#logout").show(),$("#logout").appendTo($("#logout").parent()),K.forEach(Y=>{$('<a class="panel-block">').attr("href","#").text(Y.name).on("click",()=>(B.setQuery(lzw_decode(Base64.decode(Y.query))),$("#load-dialog").removeClass("is-active"),!1)).append($('<button class="ml-auto">').attr("title",`${i18n.t("load.delete_query")}: ${Y.name}`).addClass("delete").on("click",()=>(B.removeExampleSync(Y,this),!1))).appendTo(M)})})}onLoadClose(){$("#load-dialog").removeClass("is-active")}onSaveClick(){const B=[];for(const M in settings.saves)settings.saves[M].type!="template"&&B.push(M);make_combobox($("#save-dialog input[name=save]"),B),sync.enabled&&(location.protocol==="https:"||location.hostname==="127.0.0.1")&&$("#save-dialog button.osm").show(),$("#save-dialog").addClass("is-active")}onSaveSumbit(){const B=$("#save-dialog input[name=save]")[0].value;settings.saves[htmlentities(B)]={overpass:this.getRawQuery(),type:"saved_query"},settings.save(),$("#save-dialog").removeClass("is-active")}onSaveOsmSumbit(){const B=$("#save-dialog input[name=save]")[0].value,M=this.compose_share_link(this.getRawQuery(),!0).slice(3);sync.save({name:B,query:M},P=>{if(P)return console.error(P);$("#logout").show(),$("#logout").appendTo($("#logout").parent()),$("#save-dialog").removeClass("is-active")})}onSaveClose(){$("#save-dialog").removeClass("is-active")}onLogoutClick(){sync.logout(),$("#load-dialog .panel.osm-queries .panel-block").remove(),$("#logout").hide(),$("#logout").insertBefore($("#logout").prev())}onRunClick(){this.update_map()}onRerenderClick(){this.rerender_map()}compose_share_link(B,M,P,K){const Y=new URLSearchParams;return M?(Y.append("q",Base64.encode(lzw_encode(B))),P&&Y.append("c",re(this.map.getCenter().lat,this.map.getCenter().lng)+Base64.encodeNum(this.map.getZoom()))):(Y.append("Q",B),P&&Y.append("C",`${L.Util.formatNum(this.map.getCenter().lat)};${L.Util.formatNum(this.map.getCenter().lng)};${this.map.getZoom()}`)),K&&Y.append("R",""),`?${Y}`.replace(/\+/g,"%20");function re(D,ne){const ae=Base64.encodeNum(Math.round((D+90)*1e5)+Math.round((ne+180)*1e5)*180*1e5);return"AAAAAAAA".substring(0,9-ae.length)+ae}}updateShareLink(){const B=`${location.protocol}//${location.host}${location.pathname}`,M=this.getRawQuery(),P=settings.share_compression=="auto"&&M.length>300||settings.share_compression=="on",K=$("div#share-dialog input[name=include_coords]")[0].checked,Y=$("div#share-dialog input[name=run_immediately]")[0].checked,re=this.compose_share_link(M,P,K,Y),D=B+re;let ne="";D.length>=2e3&&(ne=`<p class="warning">${i18n.t("warning.share.long")}</p>`),D.length>=4e3&&(ne=`<p class="warning severe">${i18n.t("warning.share.very_long")}</p>`),$("div#share-dialog #share_link_warning").html(ne),$("div#share-dialog #share_link_a")[0].href=D,$("div#share-dialog #share_link_textarea")[0].value=D}onShareClick(){$("div#share-dialog input[name=include_coords]")[0].checked=settings.share_include_pos,this.updateShareLink(),$("#share-dialog").addClass("is-active")}onShareClose(){$("#share-dialog").removeClass("is-active")}async onExportClick(){const B=await this.getQuery(),M=`${location.protocol}//${location.host}${location.pathname.match(/.*\//)[0]}`,P=this.data_source&&this.data_source.mode=="overpass"&&this.data_source.options.server?this.data_source.options.server:settings.server;let K=B;this.queryParser.hasStatement("style")&&(K+=`{{style: ${this.queryParser.getStatement("style")} }}`),this.queryParser.hasStatement("data")?K+=`{{data:${this.queryParser.getStatement("data")}}}`:settings.server!==configs.defaultServer&&(K+=`{{data:overpass,server=${settings.server}}}`),$("#export-dialog a#export-interactive-map")[0].href=`${M}map.html?${new URLSearchParams({Q:K})}`,$("#export-dialog a#export-overpass-api")[0].href=`${P}interpreter?data=${encodeURIComponent(B).replace(/!/g,"%21").replace(/\(/g,"%28").replace(/\)/g,"%29")}`;function Y(et,At){return`data:${At||"text/plain"};charset=${document.characterSet||document.charset};base64,${Base64.encode(et,!0)}`}function re(et,At,nt){const ft=document.createElement("a");ft.href=Y(et,At),ft.download=nt,ft.dispatchEvent(new MouseEvent("click"))}function D(et,At){return function(){return $("#export-clipboard-success").addClass("is-active"),copyData={"text/plain":et},document.execCommand("copy"),$("#export-clipboard-success .message").html(i18n.t("export.copy_to_clipboard_success-message")),$("#export-clipboard-success .export-copy_to_clipboard-content").html(At),!1}}$("#export-text .format").html(i18n.t("export.format_text")),$("#export-text .export").attr({download:"query.overpassql",target:"_blank",href:Y(B)}),$("#export-text .copy").attr("href","").click(D(B));const ne=this.getRawQuery();$("#export-text_raw .format").html(i18n.t("export.format_text_raw")),$("#export-text_raw .export").attr({download:"query-raw.overpassql",target:"_blank",href:Y(ne)}),$("#export-text_raw .copy").attr("href","").click(D(ne));let ae=`{{OverpassTurboExample|loc=${L.Util.formatNum(this.map.getCenter().lat)};${L.Util.formatNum(this.map.getCenter().lng)};${this.map.getZoom()}|query=
`;ae+=ne.replace(/{{/g,"mSAvmrw81O8NgWlX").replace(/{/g,"Z9P563g6zQYzjiLE").replace(/}}/g,"AtUhvGGxAlM1mP5i").replace(/}/g,"Yfxw6RTW5lewTqtg").replace(/mSAvmrw81O8NgWlX/g,"{{((}}").replace(/Z9P563g6zQYzjiLE/g,"{{(}}").replace(/AtUhvGGxAlM1mP5i/g,"{{))}}").replace(/Yfxw6RTW5lewTqtg/g,"{{)}}").replace(/\|/g,"{{!}}").replace(/{{!}}{{!}}/g,"{{!!}}"),ae+=`
}}`,$("#export-text_wiki .format").html(i18n.t("export.format_text_wiki")),$("#export-text_wiki .export").attr({download:"query-wiki.mediawiki",target:"_blank",href:Y(ae)}),$("#export-text_wiki .copy").attr("href","").click(D(ae));let ue=B;ue=ue.replace(/\/\*[\S\s]*?\*\//g,""),ue=ue.replace(/\/\/.*/g,""),ue=ue.replace(/\n\s*/g,""),ue=ue.replace(new RegExp(shortcuts().bbox,"g"),"{south},{west},{north},{east}"),$("#export-text_umap .format").html(i18n.t("export.format_text_umap")),$("#export-text_umap .export").attr({download:"query-umap.overpassql",target:"_blank",href:Y(ue)}),$("#export-text_umap .copy").attr("href","").click(D(ue,`${i18n.t("export.section.query")} (${i18n.t("export.format_text_umap")})`));const ge=[{name:i18n.t("dialog.done")}];$("#export-dialog a#export-map-state").unbind("click").bind("click",()=>{const et=`<h4>${i18n.t("export.map_view.permalink")}</h4><p><a href="//www.openhistoricalmap.org/#map=${this.map.getZoom()}/${L.Util.formatNum(this.map.getCenter().lat)}/${L.Util.formatNum(this.map.getCenter().lng)}" target="_blank">${i18n.t("export.map_view.permalink_osm")}</a></p><h4>${i18n.t("export.map_view.center")}</h4><p>${L.Util.formatNum(this.map.getCenter().lat)}, ${L.Util.formatNum(this.map.getCenter().lng)} <small>(${i18n.t("export.map_view.center_expl")})</small></p><h4>${i18n.t("export.map_view.bounds")}</h4><p>${L.Util.formatNum(this.map.getBounds().getSouthWest().lat)}, ${L.Util.formatNum(this.map.getBounds().getSouthWest().lng)}, ${L.Util.formatNum(this.map.getBounds().getNorthEast().lat)}, ${L.Util.formatNum(this.map.getBounds().getNorthEast().lng)}<br /><small>(${i18n.t("export.map_view.bounds_expl")})</small></p>${this.map.bboxfilter.isEnabled()?`<h4>${i18n.t("export.map_view.bounds_selection")}</h4><p>${L.Util.formatNum(this.map.bboxfilter.getBounds().getSouthWest().lat)}, ${L.Util.formatNum(this.map.bboxfilter.getBounds().getSouthWest().lng)}, ${L.Util.formatNum(this.map.bboxfilter.getBounds().getNorthEast().lat)}, ${L.Util.formatNum(this.map.bboxfilter.getBounds().getNorthEast().lng)}<br /><small>(${i18n.t("export.map_view.bounds_expl")})</small></p>`:""}<h4>${i18n.t("export.map_view.zoom")}</h4><p>${this.map.getZoom()}</p>`;return showDialog(i18n.t("export.map_view.title"),et,ge),!1}),$("#export-dialog a#export-image").unbind("click").on("click",()=>(this.onExportImageClick(),$("#export-dialog").removeClass("is-active"),!1));function Be(et){let At;if(!et)At=i18n.t("export.geoJSON.no_data");else{console.log(new Date);const nt={type:"FeatureCollection",generator:configs.appname,copyright:overpass.copyright,timestamp:overpass.timestamp,features:et.features.map(ft=>({type:"Feature",properties:ft.properties,geometry:ft.geometry}))};nt.features.forEach(ft=>{const Tt=ft.properties;ft.id=`${Tt.type}/${Tt.id}`,ft.properties={"@id":ft.id};for(const qt in Tt.tags||{})ft.properties[qt.replace(/^@/,"@@")]=Tt.tags[qt];for(const qt in Tt.meta||{})ft.properties[`@${qt}`]=Tt.meta[qt];Tt.tainted&&(ft.properties["@tainted"]=Tt.tainted),Tt.geometry&&(ft.properties["@geometry"]=Tt.geometry),Tt.relations&&Tt.relations.length>0&&(ft.properties["@relations"]=Tt.relations)}),At=JSON.stringify(nt,void 0,2)}return At}$("#export-geoJSON .format").text("GeoJSON"),$("#export-geoJSON .export").attr("href","").unbind("click").on("click",()=>{const et=Be(overpass.geojson),At=$("#export-download-dialog");return overpass.geojson?re(et,"application/geo+json","export.geojson"):(At.addClass("is-active"),$(".message",At).text(et)),!1}),$("#export-geoJSON .copy").attr("href","").click(()=>{const et=overpass.geojson?$("#export-clipboard-success"):$("#export-download-dialog");if(et.addClass("is-active"),overpass.geojson){const At=Be(overpass.geojson);copyData={"text/plain":At,"application/geo+json":At},document.execCommand("copy"),$(".message",et).html(i18n.t("export.copy_to_clipboard_success-message")),$(".export-copy_to_clipboard-content",et).text("GeoJSON")}else $(".message",et).text(i18n.t("export.geoJSON.no_data"));return!1}),$("#export-dialog a#export-geoJSON-gist").unbind("click").on("click",()=>{const et=Be(overpass.geojson);return $.ajax("https://api.github.com/gists",{method:"POST",data:JSON.stringify({description:"data exported by overpass turbo",public:!0,files:{"overpass.geojson":{content:et}}})}).done(At=>{const nt=[{name:i18n.t("dialog.done")}],ft=`<p>${i18n.t("export.geoJSON_gist.gist")}&nbsp;<a href="${At.html_url}" target="_blank" class="external">${At.id}</a></p><p>${i18n.t("export.geoJSON_gist.geojsonio")}&nbsp;<a href="http://geojson.io/#id=gist:anonymous/${At.id}" target="_blank" class="external">${i18n.t("export.geoJSON_gist.geojsonio_link")}</a></p>`;showDialog(i18n.t("export.geoJSON_gist.title"),ft,nt)}).fail(At=>{alert(`an error occurred during the creation of the overpass gist:
${JSON.stringify(At)}`)}),!1});function De(et){let At;return et?(At=togpx$1(et,{creator:configs.appname,metadata:{desc:"Filtered OSM data converted to GPX by overpass turbo",copyright:{"@author":overpass.copyright},time:overpass.timestamp},featureTitle(nt){if(nt.tags){if(nt.tags.name)return nt.tags.name;if(nt.tags.ref)return nt.tags.ref;if(nt.tags["addr:housenumber"]&&nt.tags["addr:street"])return`${nt.tags["addr:street"]} ${nt.tags["addr:housenumber"]}`}return`${nt.type}/${nt.id}`},featureLink(nt){return`http://osm.org/browse/${nt.type}/${nt.id}`}}),At[1]!=="?"&&(At=`<?xml version="1.0" encoding="UTF-8"?>
${At}`)):At=i18n.t("export.GPX.no_data"),At}$("#export-GPX .format").text("GPX"),$("#export-GPX .export").attr("href","").unbind("click").on("click",()=>{const et=overpass.geojson,At=De(et);if(et)re(At,"application/gpx+xml","export.gpx");else{const nt=$("#export-download-dialog");nt.addClass("is-active"),$(".message",nt).text(At)}return!1}),$("#export-GPX .copy").attr("href","").click(()=>{const et=overpass.geojson?$("#export-clipboard-success"):$("#export-download-dialog");if(et.addClass("is-active"),overpass.geojson){const At=De(overpass.geojson);copyData={"text/plain":At,"application/gpx+xml":At},document.execCommand("copy"),$(".message",et).html(i18n.t("export.copy_to_clipboard_success-message")),$(".export-copy_to_clipboard-content",et).text("GPX")}else $(".message",et).text(i18n.t("export.GPX.no_data"));return!1});function ze(et){return et=et&&JSON.parse(Be(et)),et?tokml$1(et,{documentName:"overpass-turbo.eu export",documentDescription:`Filtered OSM data converted to KML by overpass turbo.
Copyright: ${overpass.copyright}
Timestamp: ${overpass.timestamp}`,name:"name",description:"description"}):i18n.t("export.KML.no_data")}$("#export-KML .format").text("KML"),$("#export-KML .export").attr("href","").unbind("click").on("click",()=>{const et=overpass.geojson,At=ze(et);return et?re(At,"application/vnd.google-earth.kml+xml","export.kml"):($("#export-download-dialog").addClass("is-active"),$("#export-download-dialog .message").text(At)),!1}),$("#export-KML .copy").attr("href","").click(()=>{const et=overpass.geojson?$("#export-clipboard-success"):$("#export-download-dialog");if(et.addClass("is-active"),overpass.geojson){const At=ze(overpass.geojson);copyData={"text/plain":At,"application/vnd.google-earth.kml+xml":At},document.execCommand("copy"),$(".message",et).html(i18n.t("export.copy_to_clipboard_success-message")),$(".export-copy_to_clipboard-content",et).text("KML")}else $(".message",et).text(i18n.t("export.kml.no_data"));return!1});function Oe(et){let At,nt;if(!et)At=i18n.t("export.raw.no_data");else{const ft=overpass.data;if(ft instanceof XMLDocument)At=new XMLSerializer().serializeToString(ft),nt=At.match(/<osm/)?"osm":"xml";else if(ft instanceof Object)At=JSON.stringify(ft,void 0,2),nt="json";else try{At=ft.toString()}catch{At="Error while exporting the data"}}return{raw_str:At,raw_type:nt}}$("#export-raw .format").text(i18n.t("export.raw_data")),$("#export-raw .export").attr("href","").unbind("click").on("click",()=>{const et=overpass.geojson,At=Oe(et),nt=At.raw_str,ft=At.raw_type;if(et)ft=="osm"||ft=="xml"?re(nt,"application/xml",`export.${ft}`):ft=="json"?re(nt,"application/json","export.json"):re(nt,"application/octet-stream","export.dat");else{const Tt=$("#export-download-dialog");Tt.addClass("is-active"),$(".message",Tt).text(nt)}return!1}),$("#export-raw .copy").attr("href","").click(()=>{const et=overpass.geojson?$("#export-clipboard-success"):$("#export-download-dialog");et.addClass("is-active");const At=overpass.geojson;if(At){const nt=Oe(At),ft=nt.raw_str,Tt=nt.raw_type;copyData={"text/plain":ft},Tt=="osm"||Tt=="xml"?copyData["application/xml"]=ft:Tt=="json"?copyData["application/json"]=ft:copyData["application/octet-stream"]=ft,document.execCommand("copy"),$(".message",et).html(i18n.t("export.copy_to_clipboard_success-message")),$(".export-copy_to_clipboard-content",et).html(i18n.t("export.raw_data"))}else $(".message",et).text(i18n.t("export.raw.no_data"));return!1}),$("#export-dialog a#export-convert-xml")[0].href=`${P}convert?${new URLSearchParams({data:B,target:"xml"})}`,$("#export-dialog a#export-convert-ql")[0].href=`${P}convert?${new URLSearchParams({data:B,target:"mapql"})}`,$("#export-dialog a#export-convert-compact")[0].href=`${P}convert?${new URLSearchParams({data:B,target:"compact"})}`;const Je=autorepair.detect.editors(this.getRawQuery(),this.getQueryLang()),We=$("#export-dialog a#export-editors-level0");We.unbind("click");function ut(et){return`https://level0.osmz.ru/?${new URLSearchParams({url:`${P}interpreter?${new URLSearchParams({data:et})}`})}`}Je?We[0].href=ut(B):(We[0].href="",We.bind("click",()=>{const et=[{name:i18n.t("dialog.repair_query"),callback:async()=>{this.repairQuery("xml+metadata");const nt=await this.getQuery();We.unbind("click"),We[0].href=ut(nt),window.open(We[0].href,"_blank")}},{name:i18n.t("dialog.continue_anyway"),callback:()=>{We.unbind("click"),We[0].href=ut(B),window.open(We[0].href,"_blank")}}],At=`<p>${i18n.t("warning.incomplete.remote.expl.1")}</p><p>${i18n.t("warning.incomplete.remote.expl.2")}</p>`;return showDialog(i18n.t("warning.incomplete.title"),At,et),!1})),$("#export-dialog a#export-editors-josm").unbind("click").on("click",()=>{const et=$("#export-dialog");function At(ft){const Tt="http://127.0.0.1:8111/";$.getJSON(`${Tt}version`).done(qt=>{if(qt.protocolversion.major==1)$.get(`${Tt}import`,{url:`${P.replace(/^\/\//,`${location.protocol}//`)}interpreter?data=${encodeURIComponent(ft)}`}).fail(()=>{alert("Error: Unexpected JOSM remote control error.")}).done(()=>{console.log("successfully invoked JOSM remote control")});else{const Vt=[{name:i18n.t("dialog.dismiss")}],vt=`<p>${i18n.t("error.remote.incompat")}: ${qt.protocolversion.major}.${qt.protocolversion.minor} :(</p>`;showDialog(i18n.t("error.remote.title"),vt,Vt)}}).fail(()=>{const qt=[{name:i18n.t("dialog.dismiss")}],Vt=`<p>${i18n.t("error.remote.not_found")}</p>`;showDialog(i18n.t("error.remote.title"),Vt,qt)})}if(autorepair.detect.editors(this.getRawQuery(),this.getQueryLang()))return At(B),!1;{const ft=[{name:i18n.t("dialog.repair_query"),callback:async()=>{this.repairQuery("xml+metadata");const qt=await this.getQuery();At(qt),et.removeClass("is-active")}},{name:i18n.t("dialog.continue_anyway"),callback:()=>{At(B),et.removeClass("is-active")}}],Tt=`<p>${i18n.t("warning.incomplete.remote.expl.1")}</p><p>${i18n.t("warning.incomplete.remote.expl.2")}</p>`;return showDialog(i18n.t("warning.incomplete.title"),Tt,ft),!1}}),$("#export-dialog").addClass("is-active")}onExportDownloadClose(){$("#export-download-dialog").removeClass("is-active")}onExportClipboardClose(){$("#export-clipboard-success").removeClass("is-active")}onExportClose(){$("#export-dialog").removeClass("is-active")}async onExportImageClick(){this.waiter.open(i18n.t("waiter.export_as_image")),this.waiter.addInfo("prepare map"),$("#map .leaflet-control-container .leaflet-top").hide(),$("#data_stats").hide(),settings.export_image_attribution&&this.map.addControl(this.attribControl),settings.export_image_scale||this.map.removeControl(this.scaleControl),this.waiter.addInfo("rendering map tiles"),$("#map .leaflet-overlay-pane").hide();const B=await html2canvas(document.getElementById("map"),{useCORS:!0,allowTaint:!1,proxy:void 0});$("#map .leaflet-overlay-pane").show(),settings.export_image_attribution&&this.map.removeControl(this.attribControl),settings.export_image_scale||this.map.addControl(this.scaleControl),settings.show_data_stats&&$("#data_stats").show(),$("#map .leaflet-control-container .leaflet-top").show(),this.waiter.addInfo("rendering map data"),B.id="render_canvas";const M=B.getContext("2d"),P=$("#map .leaflet-overlay-pane svg").height(),K=$("#map .leaflet-overlay-pane svg").width(),Y=$("#map .leaflet-map-pane")[0].style.cssText.match(/.*?(-?\d+)px.*?(-?\d+)px.*/),re=+Y[1],D=+Y[2],ne=$("#map .leaflet-overlay-pane").html();ne.length>0&&(await Canvg.from(M,ne,{ignoreAnimation:!0,ignoreClear:!0,ignoreDimensions:!0,ignoreMouse:!0,offsetX:re,offsetY:D,scaleHeight:P,scaleWidth:K})).render(),this.waiter.addInfo("converting to png image");const ae=B.toDataURL("image/png");let ue="";settings.export_image_attribution||(ue='<p style="font-size:smaller; color:orange;">Make sure to include proper attributions when distributing this image!</p>');const ge=[{name:i18n.t("dialog.done")}];this.waiter.close();const Be=`<p><img src="${ae}" alt="${i18n.t("export.image.alt")}" width="480px"/><br><!--<a href="${ae}" download="export.png" target="_blank">${i18n.t("export.image.download")}</a>--></p>${ue}`;showDialog(i18n.t("export.image.title"),Be,ge);const De=document.createElement("a");De.href=ae,De.download="export.png",De.dispatchEvent(new MouseEvent("click"))}onFfsClick(){$("#ffs-dialog #ffs-dialog-parse-error").hide(),$("#ffs-dialog #ffs-dialog-typo").hide(),$("#ffs-dialog .loading").hide(),$("#ffs-dialog").addClass("is-active"),$("#ffs-dialog input[type=search]").removeClass("is-danger").unbind("keypress").bind("keypress",B=>{B.key==="Enter"&&(this.onFfsRun(!0),B.preventDefault())}).first().focus()}onFfsClose(){$("#ffs-dialog").removeClass("is-active")}onFfsBuild(){this.onFfsRun(!1)}onFfsRun(B){$("#ffs-dialog input[type=search]").removeClass("is-danger"),$("#ffs-dialog #ffs-dialog-parse-error").hide(),$("#ffs-dialog #ffs-dialog-typo").hide(),$("#ffs-dialog .loading").show(),this.update_ffs_query(void 0,(M,P)=>{if($("#ffs-dialog .loading").hide(),!M)$("#ffs-dialog").removeClass("is-active"),B!==!1&&this.onRunClick();else if(_$1.isArray(P)){$("#ffs-dialog #ffs-dialog-parse-error").hide(),$("#ffs-dialog #ffs-dialog-typo").show(),$("#ffs-dialog input[type=search]").addClass("is-danger");const K=P.join(""),Y=P.map((re,D)=>D%2===1?`<b>${re}</b>`:re).join("");$("#ffs-dialog #ffs-dialog-typo-correction").html(Y),$("#ffs-dialog #ffs-dialog-typo-correction").unbind("click").bind("click",function(re){$("#ffs-dialog input[type=search]").val(K),$(this).parent().hide(),re.preventDefault()})}else $("#ffs-dialog #ffs-dialog-typo").hide(),$("#ffs-dialog #ffs-dialog-parse-error").show(),$("#ffs-dialog input[type=search]").addClass("is-danger")})}onStylerClick(){if(!overpass.geojson||overpass.geojson.features.length===0)return;$("#styler-dialog").addClass("is-active");let B={};overpass.geojson.features.forEach(P=>B={...B,...P.properties.tags}),make_combobox($("#styler-dialog input[name=attribute]"),Object.keys(B));function M(P){return P=P||$("#styler-dialog input[type=text]").first().val(),B[P]!==void 0?($("#styler-dialog button.is-success").removeAttr("disabled"),!0):($("#styler-dialog button.is-success").attr("disabled","disabled"),!1)}$("#styler-dialog input[type=text]").first().unbind("keypress").bind("keypress",P=>{P.key==="Enter"&&M()&&(this.onStylerRun(),P.preventDefault())}).unbind("input").bind("input",M).unbind("autocompleteselect").bind("autocompleteselect",(P,K)=>M(K.item.value)).focus()}onStylerRun(){if(!overpass.geojson||overpass.geojson.features.length===0)return;const B=$("#styler-dialog input[name=attribute]").val(),M=[...new Set(overpass.geojson.features.map(D=>D.properties.tags[B]).filter(Boolean))].sort((D,ne)=>isFinite(D)&&isFinite(ne)?D-ne:D<ne?-1:D>ne?1:0);let P;$("#styler-dialog input[name=palette]:checked").val()==="qualitative"?P=index.Set1[Math.min(Math.max(M.length,3),9)]:M.length<=9?P=index.YlOrRd[Math.max(M.length,3)]:P=colormap$1({colormap:"inferno",nshades:M.length,format:"hex",alpha:1}).reverse();const K={};M.forEach((D,ne)=>{const ae=P[ne%P.length];K[ae]||(K[ae]=[]),K[ae].push(`*[${B}=${D}]`)});const Y=Object.keys(K).map(D=>`${K[D].join(`,
`)}
{ color: ${D}; fill-color:${D}; }`).join(`
`);let re=ide.getRawQuery();re=re.replace(/(\n\n)?{{style: \/\* added by auto-styler \*\/[\s\S]*?}}/,""),ide.setQuery(`${re}

{{style: /* added by auto-styler */
${Y}
}}`),this.rerender_map(),this.onStylerClose()}onStylerClose(){$("#styler-dialog").removeClass("is-active")}onSettingsClick(){$("#settings-dialog input[name=ui_language]")[0].value=settings.ui_language;const B=i18n.getSupportedLanguagesDescriptions();make_combobox($("#settings-dialog input[name=ui_language]"),["auto"].concat(i18n.getSupportedLanguages()).map(M=>({value:M,label:M=="auto"?"auto":`${M} - ${B[M]}`}))),$("#settings-dialog input[name=server]")[0].value=settings.server,make_combobox($("#settings-dialog input[name=server]"),configs.suggestedServers.concat(settings.customServers),settings.customServers,M=>{settings.customServers.splice(settings.customServers.indexOf(M),1),settings.save()}),$("#settings-dialog input[name=no_autorepair]")[0].checked=settings.no_autorepair,$("#settings-dialog input[name=use_rich_editor]")[0].checked=settings.use_rich_editor,$("#settings-dialog input[name=editor_width]")[0].value=settings.editor_width,$("#settings-dialog input[name=share_include_pos]")[0].checked=settings.share_include_pos,$("#settings-dialog input[name=share_compression]")[0].value=settings.share_compression,make_combobox($("#settings-dialog input[name=share_compression]"),["auto","on","off"]),$("#settings-dialog input[name=tile_server]")[0].value=settings.tile_server,make_combobox($("#settings-dialog input[name=tile_server]"),configs.suggestedTiles.concat(settings.customTiles),settings.customTiles,M=>{settings.customTiles.splice(settings.customTiles.indexOf(M),1),settings.save()}),$("#settings-dialog input[name=background_opacity]")[0].value=settings.background_opacity,$("#settings-dialog input[name=enable_crosshairs]")[0].checked=settings.enable_crosshairs,$("#settings-dialog input[name=disable_poiomatic]")[0].checked=settings.disable_poiomatic,$("#settings-dialog input[name=show_data_stats]")[0].checked=settings.show_data_stats,$("#settings-dialog input[name=export_image_scale]")[0].checked=settings.export_image_scale,$("#settings-dialog input[name=export_image_attribution]")[0].checked=settings.export_image_attribution,$("#settings-dialog").addClass("is-active")}onSettingsSave(){const B=$("#settings-dialog input[name=ui_language]")[0].value;settings.ui_language!=B&&i18n.translate(B),settings.ui_language=B,settings.server=$("#settings-dialog input[name=server]")[0].value,configs.suggestedServers.indexOf(settings.server)===-1&&settings.customServers.indexOf(settings.server)===-1&&settings.customServers.push(settings.server),settings.no_autorepair=$("#settings-dialog input[name=no_autorepair]")[0].checked,settings.use_rich_editor=$("#settings-dialog input[name=use_rich_editor]")[0].checked;const M=settings.editor_width;settings.editor_width=$("#settings-dialog input[name=editor_width]")[0].value,M!=settings.editor_width&&($("#editor").css("width",settings.editor_width),$("#dataviewer").css("left",settings.editor_width)),settings.share_include_pos=$("#settings-dialog input[name=share_include_pos]")[0].checked,settings.share_compression=$("#settings-dialog input[name=share_compression]")[0].value;const P=settings.tile_server;settings.tile_server=$("#settings-dialog input[name=tile_server]")[0].value,configs.suggestedTiles.indexOf(settings.tile_server)===-1&&settings.customTiles.indexOf(settings.tile_server)===-1&&settings.customTiles.push(settings.tile_server),P!=settings.tile_server&&this.map.tile_layer.setUrl(settings.tile_server);const K=settings.background_opacity;settings.background_opacity=+$("#settings-dialog input[name=background_opacity]")[0].value,settings.background_opacity!=K&&(settings.background_opacity==1?this.map.removeLayer(this.map.inv_opacity_layer):this.map.inv_opacity_layer.setOpacity(1-settings.background_opacity).addTo(this.map)),settings.enable_crosshairs=$("#settings-dialog input[name=enable_crosshairs]")[0].checked,settings.disable_poiomatic=$("#settings-dialog input[name=disable_poiomatic]")[0].checked,settings.show_data_stats=$("#settings-dialog input[name=show_data_stats]")[0].checked,$(".crosshairs").toggle(settings.enable_crosshairs),settings.export_image_scale=$("#settings-dialog input[name=export_image_scale]")[0].checked,settings.export_image_attribution=$("#settings-dialog input[name=export_image_attribution]")[0].checked,settings.save(),$("#settings-dialog").removeClass("is-active")}onSettingsClose(){$("#settings-dialog").removeClass("is-active")}onSettingsReset(){window.confirm("Reset?")&&(settings.reset(),location.reload())}onHelpClick(){$("#help-dialog").addClass("is-active")}onHelpClose(){$("#help-dialog").removeClass("is-active")}onKeyPress(B){(B.key==="F9"||B.key==="Enter"&&(B.ctrlKey||B.metaKey))&&(this.onRunClick(),B.preventDefault()),B.key=="e"&&(B.ctrlKey||B.metaKey)&&!B.shiftKey&&!B.altKey&&(this.onExportClick(),B.preventDefault()),B.key=="s"&&(B.ctrlKey||B.metaKey)&&!B.shiftKey&&!B.altKey&&(this.onSaveClick(),B.preventDefault()),B.key=="o"&&(B.ctrlKey||B.metaKey)&&!B.shiftKey&&!B.altKey&&(this.onLoadClick(),B.preventDefault()),B.key=="h"&&(B.ctrlKey||B.metaKey)&&!B.shiftKey&&!B.altKey&&(this.onHelpClick(),B.preventDefault()),(B.key=="i"&&(B.ctrlKey||B.metaKey)&&!B.shiftKey&&!B.altKey||B.key=="F"&&(B.ctrlKey||B.metaKey)&&B.shiftKey&&!B.altKey)&&(this.onFfsClick(),B.preventDefault()),B.key=="k"&&(B.ctrlKey||B.metaKey)&&!B.shiftKey&&!B.altKey&&(overpass.geojson&&this.onStylerClick(),B.preventDefault()),B.key==="Escape"&&$(".modal").removeClass("is-active")}async update_map(){this.waiter.open(i18n.t("waiter.processing_query")),this.waiter.addInfo("resetting map"),$("#data_stats").remove(),this.resetErrors(),this.dataViewer.setValue(""),typeof overpass.osmLayer<"u"&&this.map.removeLayer(overpass.osmLayer),$("#map_blank").remove(),this.waiter.addInfo("building query");const B=await this.getQuery();if(typeof history.pushState=="function"){const K=this.compose_share_link(this.getRawQuery(),!0);K.length>2e3?history.pushState({},"",`?#${K.slice(1)}`):history.pushState({},"",K)}const M=this.getQueryLang(),P=this.data_source&&this.data_source.mode=="overpass"&&this.data_source.options.server?this.data_source.options.server:settings.server;overpass.run_query(B,M,void 0,void 0,P,this.mapcss)}async rerender_map(){$("#data_stats").remove(),typeof overpass.osmLayer<"u"&&this.map.removeLayer(overpass.osmLayer),await this.getQuery(),overpass.rerender(this.mapcss)}update_ffs_query(B,M){const P=B||$("#ffs-dialog input[type=search]").val(),K=$("#ffs-dialog input[name='ffs.comments']")[0].checked;ffs_construct_query(P,K,(Y,re)=>{Y?ffs_repair_search(P,D=>{if(D)M("repairable query",D);else{if(B)return M(!0);this.update_ffs_query(`"${P}"`,M)}}):(this.setQuery(re),M(null))})}}const ide=new IDE;$(document).ready(()=>ide.init());$(document).ready(initClickHandler);function initClickHandler(){$("*[data-ide-handler]").each(function(){const g=$(this).attr("data-ide-handler").split(/:/),B=g[0],M=g[1],P=ide[M].bind(ide);$(this).on(B,P)})}
//# sourceMappingURL=index-54hA8hZr.js.map
